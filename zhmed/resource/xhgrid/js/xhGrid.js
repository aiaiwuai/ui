var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){if(i.get||i.set)throw new TypeError("ES3 does not support getters and setters.");t!=Array.prototype&&t!=Object.prototype&&(t[e]=i.value)},$jscomp.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:"undefined"!=typeof global&&null!=global?global:t},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(t,e,i,s){if(e){for(i=$jscomp.global,t=t.split("."),s=0;s<t.length-1;s++){var r=t[s];r in i||(i[r]={}),i=i[r]}t=t[t.length-1],s=i[t],e=e(s),e!=s&&null!=e&&$jscomp.defineProperty(i,t,{configurable:!0,writable:!0,value:e})}},$jscomp.polyfill("Array.prototype.fill",function(t){return t?t:function(t,e,i){var s=this.length||0;for(0>e&&(e=Math.max(0,s+e)),(null==i||i>s)&&(i=s),i=Number(i),0>i&&(i=Math.max(0,s+i)),e=Number(e||0);e<i;e++)this[e]=t;return this}},"es6-impl","es3"),function(){function ha(t){return"[object Array]"===Object.prototype.toString.call(t)}function bb(t){return"boolean"==typeof t}function F(t){return"string"==typeof t}function E(t){return!!(t=t&&(t.ownerDocument||t).documentElement)&&"HTML"!==t.nodeName}function Uc(t){var e=!1,i=null!=t&&"undefined"!=typeof t;try{e=i&&t instanceof NodeList}catch(s){}return t=i&&Xa(t.length)&&"undefined"!=typeof t.item,e||t}function Ea(t){return null!=t&&"object"==typeof t}function Xa(t){return"number"==typeof t}function U(t){return"[object Function]"===Object.prototype.toString.call(t)}function O(t){return isNaN(t)||"number"!=typeof t}function ze(t){return isNaN(t)||null==t||void 0==t||isNaN(parseFloat(t))}function I(t){return"undefined"==typeof t}function p(t){return null==t||"undefined"==typeof t}function dc(t){return t instanceof Date&&!isNaN(t.valueOf())}function bd(t,e){if(!t||!e)return null;if(t.hasOwnProperty(e))return t[e];var i=e.substr(0,1);return/[A-Z]/.test(i)?null:(i="get"+i.toUpperCase()+e.substr(1),U(t[i])?t[i]():null)}function jc(t,e){if(!t||!e)return!1;if(t.hasOwnProperty(e))return!0;var i=e.substr(0,1);return!/[A-Z]/.test(i)&&!!U(t["get"+i.toUpperCase()+e.substr(1)])}function Ja(t,e,i){if(t&&e)if(t.hasOwnProperty(e))t[e]=i;else{var s=e.substr(0,1);/[A-Z]/.test(s)||(s="set"+s.toUpperCase()+e.substr(1),U(t[s])?t[s](i):t[e]=i)}}function $c(t){this._owner=t}function kc(t,e,i,s){wa.call(this),this.className=t?t:this.className?this.className:"CSSStyleDeclaration",this.name=this.className+this.uno,this.id=null,this._findCSS=1<arguments.length?e:"Kool__",this._cssName=2<arguments.length?i?"Kool__"+this.name:t?t:this.className:"Kool__"+this.name,this._sheetIdx=3<arguments.length?s:-1,this._styles={},this._createRules()}function A(t,e){wa.call(this),this._useBorderBox=!1,this.element=t?t:this.element?this.element:"div",this.className=e?e:this.className?this.className:"HTMLObject",this.name=this.className+this.uno,this._visible=this._enabled=!0,this._createElement()}function R(t,e){this.element=t?t:this.element?this.element:"div",this.className=e?e:this.className?this.className:"LayoutManagerClient",A.call(this,this.element,this.className),this.id=null,this.uid=V.createUID(),this._unscaledHeight=this._unscaledWidth=this.measuredHeight=this.measuredWidth=this.measuredMinHeight=this.measuredMinWidth=0,this._useDelayInvalidate=this._runInvalidateDisplayListFlag=this._runInvalidateSizeFlag=this._runInvalidatePropertiesFlag=this._updateCompletePendingFlag=this._invalidateDisplayListFlag=this._invalidateSizeFlag=this._invalidatePropertiesFlag=!1,this._includeInLayout=!0,this._processedDescriptors=this._initialized=!1,this._updateDisplayListCallCount=this._measureCallCount=this._commitPropertiesCallCount=this._nestLevel=0,this._methodQueue=[],this._listeningForRender=!1,this._oldExplicitHeight=this._oldExplicitWidth=this._oldMinHeight=this._oldMinWidth=NaN,this._effectsStarted=[],this._affectedProperties={},this._preventDrawFocus=this._isEffectStarted=!1,this._endingEffectInstances=[],this._frameCallLater=new rc}function u(t,e){this.element=t?t:this.element?this.element:"div",this.className=e?e:this.className?this.className:"UIElement",R.call(this,this.element,this.className),this._unscaledHeight=this._unscaledWidth=0,this._styles={},this._explicitMaxHeight=this._explicitMaxWidth=this._explicitMinHeight=this._explicitMinWidth=this._explicitHeight=this._explicitWidth=NaN,this._errorString="",this._errorStringChanged=!1,this._errorColor="#FF0000",this._errorWidth="1px",this._saveOutlineColor=!0,this._doubleClickEnabled=!1}function pa(t){this.element=this.element?this.element:"span",this.className=t?t:this.className?this.className:"UITextField",u.call(this,this.element,this.className),this.ignorePadding=!0,this._offsetHeight=this._offsetWidth=NaN,this._wordWrapChanged=this._wordWrap=this._multilineChanged=this._multiline=!1,this._text="",this._textChanged=!1}function H(t,e){this.element=t?t:this.element?this.element:"div",this.className=e?e:this.className?this.className:"Container",u.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._numChildrenCreated=this.element.tabIndex=-1,this._oldScrollLeft=this._oldScrollTop=this._firstChildIndex=this._numChildren=0,this._doingLayout=this._forceLayout=!1,this._horizontalScrollPolicy=this._verticalScrollPolicy="auto",this._verticalScrollBarExist=this._horizontalScrollBarExist=!1,this._label="",this._clickFocused=!1,this._autoLayout=!0,this._contentPane=new A("div","ContentPane"),this._contentPane.setStyle("overflowX","auto"),this._contentPane.setStyle("overflowY","auto"),this._contentPane.setStyle("position",r.ie9?"relative":"absolute"),this._contentPane.setVisibility(!1),this.getRawChildren().addChild(this._contentPane),this._contentPane.addEvent("scroll",this._scrollHandler,this)}function jb(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ScrollControlBase",u.call(this,this.element,this.className),this.liveScrolling=!0,this.scrollTipFunction=null,this.showScrollTips=!1,this._viewMetrics=Pc.EMPTY,this._numberOfRows=this._numberOfCols=0,this._horizontalScrollPolicy="off",this._verticalScrollPolicy="auto",this._verticalScrollPosition=this._horizontalScrollPosition=0,this.element.style.position="relative"}function Ob(){}function lc(){var t=this;t.graphicIndex=0,"undefined"==typeof lc.elements&&(lc.elements={},lc.free={}),t.getElement=function(e){var i,s;if(s=!0,r.ie8H)for(var n in lc.elements)if(lc.free[n]){s=!1,i=lc.elements[n],i.style.visibility="",i.style.display="block",lc.free[n]=!1;break}return s&&("svg"==e&&window.SVGCanvas?(s=new window.SVGCanvas(1,1),i=s.svg.svgElement,i.svgContext=s):i=document.createElement(e),i.graphicIndex=t.graphicIndex,lc.elements[t.graphicIndex]=i,lc.free[t.graphicIndex]=!1,t.graphicIndex++),"canvas"==e.toLowerCase()&&r.ie8L&&(i=window.G_vmlCanvasManager.initElement(i)),m.setStyle(i,"position","absolute"),i},t.initElement=function(t){return r.ie8L?window.G_vmlCanvasManager.initElement(t):t},t.freeAllElements=function(e){var i=e.element.getElementsByTagName("canvas");for(e=i.length-1;-1<e;--e)0>i[e].className.indexOf("Trial")&&t.freeElement(i[e])},t.freeElement=function(t){var e,i=t.graphicIndex;e=m.clearStyle,I(i)||(r.ie8L?lc.elements[i]=null:(e(t,"left"),e(t,"top"),e(t,"fontSize"),e(t,"fontStyle"),e(t,"textAlign"),e(t,"fontFamily"),e(t,"color"),e(t,"fontWeight"),e(t,"lineHeight"),e(t,"letterSpacing"),e(t,"textDecoration"),U(t.getContext)&&(e=t.getContext("2d"),t.width=0,t.height=0,e.rotate(0),e.scale(1,1),e.translate(0,0),e.clearRect(0,0,t.width,t.height)),t.style.width="0px",t.style.height="0px",t.className="",lc.free[i]=!0,t.selfElement?(t.selfElement.getParent()&&t.selfElement.getParent().removeChild(t.selfElement),t.selfElement.resetInvalidate(),t.selfElement.element=null,t.selfElement=null):t.parentNode&&t.parentNode.removeChild(t),t.owner&&t.owner.selfElement&&(t.owner.selfElement=null,t.owner=null)))}}function Dd(){wa.call(this),this._async_previous=0}function zb(){wa.call(this),this._async_previous=0}function aa(t){this._position=0,this.endian=aa.LITTLE_ENDIAN,this._buffer=t?t:[]}function rc(t,e){var i=this;i._context=t,i._callbackHandler=e,i._stopped=!1,i._timer=null,i._frameHandler=function(){i._stopped||(i._callbackHandler(),i.start())}}function sc(t,e){wa.call(this),this._timer=null,this._delay=0<arguments.length?t:sc.REPEAT_DELAY,this._repeatCount=1<arguments.length?e:0,this._currentCount=0,this._running=!1}function Ae(t){var e=t.target?t.target:null,i=t.currentTarget?t.currentTarget:null;t={type:t.type||"GET",url:t.url||"",timeout:t.timeout||3e4,dataType:t.dataType||"",onError:t.onError||function(){},onSuccess:t.onSuccess||function(){},data:t.data||""};var s;try{s=location.href}catch(r){s=document.createElement("a"),s.href="",s=s.href}s=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/.exec(s.toLowerCase())||[];var n,o=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/.test(s[1]),a=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];if("ActiveXObject"in window&&o&&(n=new ActiveXObject("Microsoft.XMLHTTP")),!n)try{n=new XMLHttpRequest}catch(r){for(s=0;s<a.length;s++)try{n=new ActiveXObject(a[s]);break}catch(l){}}var h=!1;setTimeout(function(){h=!0},t.timeout),n.onreadystatechange=function(){if(4==n.readyState&&!h){var s={};e&&(s.target=e),i&&(s.currentTarget=i);var r;t:{var a=n;try{r=!a.status&&o||200<=a.status&&300>a.status||304==a.status||0<=navigator.userAgent.indexOf("Safari")&&p(a.status);break t}catch(l){}r=!1}r?(r=(r=n.getResponseHeader("content-type"))&&0<=r.indexOf("xml")?/msie/i.test(navigator.userAgent)&&!window.opera&&void 0!==n.responseXML.xml?G.parse(n.responseXML.xml):n.responseXML:n.responseText,t.onSuccess(r,s)):t.onError(n.status,s),n=null}};try{if(n.open(t.type,t.url,!0),t.type.match(/post|POST/)){n.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");var d,c;if(t.dataType.match(/json|JSON/)){c=[];for(d in t.data)c[c.length]=encodeURIComponent(d)+"="+encodeURIComponent(t.data[d]);c=c.join("&").replace(/%20/g,"+")}else c=t.data;n.send(c)}else n.send()}catch(r){t.onError(r.message)}}function Pb(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ProgrammaticSkin",u.call(this,this.element,this.className),this._nestLevel=this._height=this._width=0}function Ic(t,e){this.element=t?t:this.element?this.element:"div",this.className=e?e:this.className?this.className:"Box",H.call(this,this.element,this.className),this._layoutObject=new cd,this._layoutObject.setTarget(this)}function Ed(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"Canvas",H.call(this,this.element,this.className),this._layoutObject=new Zd,this._layoutObject.setTarget(this)}function cd(){this.direction="vertical"}function Zd(){}function Fd(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"HBox",Ic.call(this,this.element,this.className),this._layoutObject.direction="horizontal"}function Qd(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"VBox",Ic.call(this,this.element,this.className),this._layoutObject.direction="vertical"}function qa(t,e){this.element=t?t:this.element?this.element:"div",this.className=e?e:this.className?this.className:"IListItemRenderer",u.call(this,this.element,this.className)}function n(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ListBase",jb.call(this),this._useDelayInvalidate=!0,this.menuSelectionMode=this.allowDragSelection=!1,this._iteratorValid=!0,this._listContentStyleFilters=null,this._rowMap={},this._factoryMap={},this._freeItemRenderers=[],this._reservedItemRenderers={},this._unconstrainedRenderers={},this._dataItemWrappersByRenderer={},this._runningDataEffect=this._runDataEffectNextUpdate=!1,this._cachedItemsChangeEffect=null,this._offscreenExtraColumnsRight=this._offscreenExtraColumnsLeft=this._offscreenExtraColumns=this._offscreenExtraRowsBottom=this._offscreenExtraRowsTop=this._offscreenExtraRows=0,this._allowRendererStealingDuringLayout=!0,this._selectedData={},this._selectionIndicators={},this._selectionTweens={},this._itemsNeedMeasurement=!0,this._bCtrlKey=this._bShiftKey=this._bSortItemPending=this._truncateToFitChanged=this._keySelectionPending=this._wordWrapChanged=this._dataEffectCompleted=this._rendererChanged=this._itemsSizeChanged=!1,this._lastKey=0,this._approximate=this._bSelectItem=!1,this._bColumnScrolling=!0,this._listType="grid",this._bSelectedIndicesChanged=this._bSelectedItemsChanged=this._bSelectedItemChanged=this._bSelectedIndexChanged=this._bSelectionChanged=!1,this._cachedVerticalAlignInvalid=this._cachedPaddingBottomInvalid=this._cachedPaddingTopInvalid=!0,this._dragScrollingInterval=0,this._trackedRenderers=[],this._isPressed=this._rendererTrackingSuspended=!1,this._caretIndex=this._anchorIndex=-1,this._defaultRowCount=this._defaultColumnCount=4,this._explicitRowCount=this._explicitColumnCount=-1,this._allowMultipleSelection=!1,this._columnCount=-1,this._columnCountChanged=!0,this._columnWidthChanged=!1,this._dataTipField="label",this._dropEnabled=this._dragMoveEnabled=this._dragEnabled=!1,this._iconField="icon",this._labelField="label",this._offscreenExtraRowsOrColumns=0,this._offscreenExtraRowsOrColumnsChanged=!1,this._rowCount=-1,this._rowCountChanged=!0,this._rowHeightChanged=!1,this._selectable=!0,this._selectedIndex=-1,this._wordWrap=this._variableRowHeight=this._truncateToFit=this._showDataTips=!1,this._touchEventsStack=[],this.addEvent("keydown",this._keyDownHandler,this),this.addEvent("mousewheel",this._mouseWheelHandler,this),this.addEvent("mouseover",this._mouseOverHandler,this),this.addEvent("mouseout",this._mouseOutHandler,this),this.addEvent("mousedown",this._mouseDownHandler,this),this.addEvent("mousemove",this._mouseMoveHandler,this),this.addEvent("click",this._mouseClickHandler,this),this.addEvent("dblclick",this._mouseDoubleClickHandler,this),r.supportTouch&&(this.addEvent("touchstart",this._touchHandler,this),this.addEvent("touchend",this._touchHandler,this),this.addEvent("touchmove",this._touchHandler,this),this.addEvent("touchcancel",this._touchHandler,this)),this.element.tabIndex=0,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Kb(t){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ListBaseContentHolder",u.call(this,this.element,this.className),this.selectionLayer=new A("div","ListBaseContentHolder_SelectionLayer"),this.selectionLayer.name="selectionLayer",this.addChild(this.selectionLayer),this.visibleData={},this.listItems=[],this.rowInfo=[],this.iterator=void 0,this.bottomOffset=this.rightOffset=this.topOffset=this.leftOffset=0,this._parentList=t,this._allowItemSizeChangeNotification=!0,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Cc(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ListItemRenderer",qa.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function rb(){this.element=this.element?this.element:"button",this.className=this.className?this.className:"Button",u.call(this,this.element,this.className),this._useBorderBox=!0,this._type="button",this._iconSrcChanged=!1,this._label="",this._selected=this._toggleChanged=this._toggle=this._labelChanged=!1,this._iconColumnIndex=0,this._iconRowndex=1}function Gd(){u.call(this,"input","Input"),this._typeChanged=!1}function Ka(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"CheckBox",u.call(this,this.element,this.className),this.falseValue=this.trueValue=null,this._type="checkbox",this._labelPlacement="right",this._selectedChanged=this._selected=!1,this._label="",this._labelChanged=!1,this._skin=null,this._skinChanged=!1,this.element.style.position="absolute"}function Ca(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ComboBase",u.call(this,this.element,this.className),this._wrapDownArrowButton=this._useDelayInvalidate=!0,this._enabledChanged=this._editableChanged=this._editable=this._selectedItemChanged=this._selectedIndexChanged=this._selectionChanged=this._useFullDropdownSkin=!1,this._imeMode=null,this._restrictChanged=!1,this._text="",this._textChanged=!1,this._selectedIndex=-1,this.addEvent("keydown",this._keyDownHandler,this),this.element.tabIndex=0}function za(){this.element=this.element?this.element:"select",this.className=this.className?this.className:"ComboBox",u.call(this,this.element,this.className),this._useBorderBox=!0,this._implicitSelectedIndex=!1,this._labelField="label",this._multipleChanged=this._multiple=this._labelFunctionChanged=this._labelFieldChanged=!1,this._size=1,this._selectedIndexChanged=this._selectedItemSet=this._selectedItemChanged=this._sizeChanged=!1,this.addEvent("mousewheel",this._mouseWheelHandler,this)}function Dc(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ContextMenu",u.call(this,this.element,this.className),this._itemsChanged=!1,this.element.style.position="absolute",this.element.style.zIndex=Sa.zIndex++,this.addEvent("click",this._mouseClickHandler,this)}function Db(t){u.call(this,"div",t?t:"ScrollBar"),this._isScrolling=this._childrenCreated=this._thumbDown=!1,this.scrollPosition=this.trackScrollSize=this.minScrollPosition=this.maxScrollPosition=this.arrowScrollSize=0,this.direction="horizontal",this.inverted=!1,this.thumbSize=100,this.scrollHeight=this.arrowSize=14,this.thumbMinSize=20,this.thumbHeight=14,this.trackHeight=NaN,this.lineScrollSize=1,this._scrollTimer=null,this._trackPosition=this._trackScrollRepeatDirection=NaN,this._pageScrollSize=0}function Ta(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"BrowserScrollBar",u.call(this,this.element,this.className),this.isScrolling=!1,this.lineScrollSize=1,this._scrollByProgram=!1,this._direction="vertical",this._correctedPageSize=this._pageSize=this._pageScrollSize=this._scrollPosition=this._minScrollPosition=this._maxScrollPosition=0,this.element.style.overflow="hidden",this.element.style.textAlign="left",this.element.style.position="absolute"}function ka(){this.element=this.element?this.element:"table",this.className=this.className?this.className:"CalendarLayout",u.call(this,this.element,this.className),this._disabledArrays=[],this._selectionIndicator=[],this._selectedRangeCount=0,this._todayColumn=this._todayRow=-1,this._dayNamesChanged=this._enabledChanged=!1,this._disabledDays=[],this._disabledRanges=[],this._displayedMonth=(new Date).getMonth(),this._proposedDisplayedMonth=-1,this._displayedYear=(new Date).getFullYear(),this._proposedDisplayedYear=-1,this._firstDayOfWeek=0,this._selectableRange=null,this._selectableRangeChanged=!1,this._selectedRanges=[],this._selectedMonthYearChanged=this._selectedRangesChanged=!1,this._showToday=!0,this._selRangeMode=-1,this.allowDisjointSelection=!0,this.allowMultipleSelection=!1}function ba(){this.element=this.element?this.element:"table",this.className=this.className?this.className:"DateChooser",u.call(this,this.element,this.className),this._allowDisjointSelection=!0,this._dayNamesChanged=this._enabledChanged=this._allowMultipleSelectionChanged=this._allowMultipleSelection=this._allowDisjointSelectionChanged=!1,this._disabledDays=[],this._disabledDaysChanged=!1,this._disabledRanges=[],this._disabledRangesChanged=!1,this._displayedMonth=(new Date).getMonth(),this._displayedMonthChanged=!1,this._displayedYear=(new Date).getFullYear(),this._displayedYearChanged=!1,this._firstDayOfWeek=0,this._firstDayOfWeekChanged=!1,this._maxYear=2100,this._minYear=1970,this._selectableRangeChanged=this._monthNamesChanged=!1,this._selectedDate=null,this._selectedDateChanged=!1,this._selectedRanges=[],this._selectedRangesChanged=!1,this._showToday=!0,this._showTodayChanged=!1,this._yearNavigationEnabled=!0,this._yearNavigationEnabledChanged=!1,this.element.tabIndex=0,this.element.style.position="absolute"}function X(){this.className=this.className?this.className:"DateField",u.call(this,this.element,this.className),this.dataFormatString=void 0,this._updateDateFiller=!1,this._text="",this._editable=this._enabledChanged=this._addedToPopupManager=this._yearChangedWithKeys=this._showingDropdown=this._selectedDateSet=!1,this._editableChanged=!0,this._dayNamesChanged=!1,this._disabledDays=[],this._disabledDaysChanged=!1,this._disabledRanges=[],this._disabledRangesChanged=!1,this._displayedMonth=(new Date).getMonth(),this._displayedMonthChanged=!1,this._displayedYear=(new Date).getFullYear(),this._displayedYearChanged=!1,this._firstDayOfWeek=0,this._firstDayOfWeekChanged=!1,this._maxYear=2100,this._maxYearChanged=!1,this._minYear=1970,this._monthSymbolChanged=this._monthNamesChanged=this._minYearChanged=!1,this._parseFunction=this.stringToDate,this._selectableRangeChanged=!1,this._selectedDate=null,this._selectedDateChanged=!1,this._showToday=!0,this._showTodayChanged=!1,this._yearNavigationEnabled=!0,this._yearSymbolChanged=this._yearNavigationEnabledChanged=!1,this.element.tabIndex=0,this.element.style.position="absolute"}function Z(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ExComboBox",Ca.call(this),this._useDelayInvalidate=!0,this._tween=null,this._tweenUp=!1,this._dropdownBorderStyle="solid",this._showingDropdown=!1,this._selectedIndexOnDropdown=-1,this._bRemoveDropdown=!0,this._collectionChanged=this._bInKeyDown=this._inTween=!1,this._dropdownFactory=new kb(Q),this._dropdownWidth=100,this._tempdropdownHeight=this._dropdownHeight=200,this._labelField="label",this._promptChanged=!1,this._rowCount=5,this._implicitSelectedIndex=!1,this._useFullDropdownSkin=!0,this._wrapDownArrowButton=!1,this.setDataProvider(new P),Xb&&this.setAttr("role","listbox")}function Ec(){this.className="HBrowserScrollBar",Ta.call(this),this._direction="horizontal",this._lockedColumnCount=0}function Ua(){this.className=this.className?this.className:"Image",u.call(this,"span",this.className),this.naturalHeight=this.naturalWidth=NaN,this.complete=this.isError=!1,this._scale=-1,this._tryCount=0,this._altChanged=this._srcChanged=!1,this._maintainAspectRatio=!0,this._maintainAspectRatioChanged=!1,this.element.style.position="absolute",this.element.style.lineHeight="0"}function mc(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"Label",u.call(this,this.element,this.className),this._textChanged=!1}function Q(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"List",n.call(this),this.editable=!1,this.editorDataField="text",this.editorYOffset=this.editorXOffset=this.editorWidthOffset=this.editorHeightOffset=0,this.editorUsesEnterKey=!1,this.itemEditor=new kb(Y),this.itemEditorInstance=void 0,this.rendererIsEditor=!1,this._listType="vertical",this._bColumnScrolling=!1,this.setItemRenderer(new kb(Cc)),this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="off",this._defaultColumnCount=1,this._defaultRowCount=7,this._inEndEdit=this._losingFocus=this._dontEdit=!1,this._actualColIndex=0,this._bEditedItemPositionChanged=!1,this._imeMode=null,this._lockedRowCount=0,this.addEventListener(L.ITEM_EDIT_BEGINNING,this._itemEditorItemEditBeginningHandler,this,!1,-50),this.addEventListener(L.ITEM_EDIT_BEGIN,this._itemEditorItemEditBeginHandler,this,!1,-50),this.addEventListener(L.ITEM_EDIT_END,this._itemEditorItemEditEndHandler,this,!1,-50)}function ia(){this.element=this.element?this.element:"table",this.className=this.className?this.className:"MonthChooser",u.call(this,this.element,this.className),this.allowDisjointSelection=!0,this.allowMultipleSelection=!1,this._selRangeMode=-1,this._disabledArrays=[],this._selectionIndicator=[],this._enabledChanged=!1,this._disabledRanges=[],this._displayedYear=(new Date).getFullYear(),this._proposedDisplayedYear=-1,this._maxYear=2100,this._minYear=1970,this._selectableRangeChanged=this._monthNamesChanged=!1,this._selectedMonth=null,this._selectedRanges=[],this._showThisMonth=!0,this._selectedYearChanged=this._showThisMonthChanged=!1,this.element.tabIndex=1,this.element.style.position="absolute"}function da(){this.className=this.className?this.className:"MonthField",u.call(this,this.element,this.className),this.dataFormatString=void 0,this._updateDateFiller=!1,this._text="",this._editable=this._enabledChanged=this._addedToPopupManager=this._yearChangedWithKeys=this._showingDropdown=this._selectedMonthSet=!1,this._editableChanged=!0,this._disabledDays=[],this._disabledDaysChanged=!1,this._disabledRanges=[],this._disabledRangesChanged=!1,this._displayedYear=(new Date).getFullYear(),this._displayedYearChanged=!1,this._maxYear=2100,this._maxYearChanged=!1,this._minYear=1970,this._monthSymbolChanged=this._monthNamesChanged=this._minYearChanged=!1,this._parseFunction=this.stringToDate,this._selectableRangeChanged=!1,this._selectedMonth=null,this._selectedMonthChanged=!1,this._showThisMonth=!0,this._yearSymbolChanged=this._showThisMonthChanged=!1,this.element.tabIndex=0,this.element.style.position="absolute"}function ya(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"NumericStepper",u.call(this,this._element,this._className),this.autoRepeat=!0,this._proposedValue=this._lastValue=this._value=0,this._enabledChanged=this._valueChanged=!1,this._tabIndex=-1,this._tabIndexChanged=!1,this._maxChars=10,this._maxCharsChanged=!1,this._maximum=10,this._previousValue=this._nextValue=this._minimum=0,this._stepSize=1,this._imeMode=null,this.element.tabIndex=0,this.element.style.position="absolute"}function Fa(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"ProgressBar",u.call(this,this.element,this.className),this._percentComplete=this._minimum=0,this.element.style.position="absolute"}function qb(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"RadioButton",u.call(this,this.element,this.className),this._type="radio",this._labelPlacement="right",this._selectedChanged=this._selected=!1,this._label="",this._groupNameChanged=this._labelChanged=!1,this.element.style.position="absolute"}function Za(){u.call(this,"table","Table"),this._cellPadding=0,this._cellPaddingChanged=!1,this._cellSpacing=0,this._cellSpacingChanged=!1,this._border=0,this._borderChanged=!1,this._rowCount=1,this._rowCountChanged=!1,this._columnCount=1,this._columnCountChanged=!1}function Oa(t,e){this.element=t?t:"textarea",this.className=e?e:"TextArea",u.call(this,this.element,this.className),this._enabledChanged=this._textSet=!1,this._editable=!0,this._editableChanged=!1,this._imeMode=null,this._maxChars=0,this._restrictChanged=this._maxCharsChanged=!1,this._text="",this._textChanged=!1,this.element.style.position="absolute"}function Y(t,e){this.element=t?t:this.element?this.element:"input",this.className=e?e:this.className?this.className:"TextInput",u.call(this,this.element,this.className),this._textSet=!1,this._autocomplete="",this._displayAsPasswordChanged=this._displayAsPassword=this._enabledChanged=!1,this._editable=!0,this._editableChanged=!1,this._imeMode=null,this._maxChars=0,this._restrictChanged=this._maxCharsChanged=!1,this._text="",this._textChanged=!1,this._type="text",this.element.style.position="absolute",r.safari&&(this.element.style.webkitUserSelect="text")}function lb(t,e){this.element=t?t:"form",this.className=e?e:"AutocompleteTextInput",Y.call(this,this.element,this.className),this._autocomplete="on",this._nameChanged=this._listDataChanged=this._imeModeChanged=this._dataChanged=!1,this.element.style.position="absolute",this.setAttr("autocomplete",this._autocomplete)}function Qc(){u.call(this,"div","ToolTip"),this._textChanged=!1,this.element.style.position="absolute"}function $d(){this.className="VBrowserScrollBar",Ta.call(this)}function oa(t,e,i,s,r,n,o){wa.call(this),t&&(void 0==s&&(s=-1),void 0==r&&(r=-1),this.listener=t,this._startValue=e,this._endValue=i,O(s)||-1==s||(this.duration=s),O(r)||-1==r||(this._maxDelay=1e3/r),this._updateFunction=n,this._endFunction=o,this._tempDuration=s,this._needToLayout=!1,this._maxDelay=87.5,this._doSeek=!1,this._isPlaying=!0,this._doReverse=!1,this._userEquation=this._defaultEasingFunction,this._started=!1,this._playheadTime=0,this._invertValues=!1,ha(e)&&(this._arrayMode=!0),this._tempDuration?oa.addTween(this):(this._id=-1,this.endTween()))}function ae(){this.id=null,this.currencySymbol="$",this.alignSymbol="left",this.useNegativeSign=this.useThousandsSeparator=!0,this.precision=-1,this.applyPrecisionToInteger=!0,this.thousandsSeparatorTo=",",this.decimalSeparatorTo=".",this.rounding="none",this.returnValueWhenError=!1,this.format=function(t){var e=parseFloat(t),i=-1==this.precision?0:Math.abs(this.precision),s=this.decimalSeparatorTo,r=this.useThousandsSeparator?this.thousandsSeparatorTo:"",n=this.currencySymbol,o=this.alignSymbol,e="down"==this.rounding?-1<this.precision&&0<i?Math.floor(e*Math.pow(10,i))/Math.pow(10,i):Math.floor(e):"up"==this.rounding?-1<this.precision&&0<i?Math.ceil(e*Math.pow(10,i))/Math.pow(10,i):Math.ceil(e):"nearest"==this.rounding?-1<this.precision&&0<i?Math.round(e*Math.pow(10,i))/Math.pow(10,i):Math.round(e):e,a=0>e?this.useNegativeSign?"-":"(":"",l=parseInt(e=-1<this.precision?Math.abs(e).toFixed(i+1):Math.abs(e))+"",h=l.length,h=3<h?h%3:0,d=e-l,c="";return this.error=void 0,isNaN(d)?(this.error="invalid number",this.returnValueWhenError?t:""):(0<d?c=s+e.toString().slice(l.toString().length+1):0<i&&(c=s+d.toFixed(i+1).slice(2)),c&&!this.applyPrecisionToInteger&&0<i&&0==d&&(c=""),a+("left"==o?n:"")+(h?l.substr(0,h)+r:"")+l.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+r)+(-1<this.precision?i?c.substr(0,i+s.length):"":c)+("right"==o?n:"")+("("==a?")":""))}}function ad(t){this.className=this.className?this.className:"AsyncToken",wa.call(this),this._message=t}function le(t,e,i,s){this.className=this.className?this.className:"AsyncResponder",this._resultHandler=t,this._faultHandler=e,this._token=i,this._context=s}function Ub(){u.call(this,"div","CheckBoxEditor"),this.element.style.position="absolute"}function Ab(){qa.call(this,"div","CheckBoxHeaderRenderer"),this._sortItemRendererChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function tb(){u.call(this,"div","CheckBoxHeaderSelector"),this._sortItemRendererChanged=!1,this.element.style.position="absolute"}function nc(){qa.call(this,"div","CheckBoxItemRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute"}function Vb(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"CheckBoxItemSelector",qa.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute"}function rd(){this.className=this.className?this.className:"ComboBoxEditor",za.call(this),this.element.style.position="absolute",this.element.style.paddingLeft="0px",this.element.style.paddingRight="0px"}function vb(){qa.call(this,"div","ComboBoxHeaderRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=this._sortItemRendererChanged=this._dataChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Qb(){qa.call(this,"div","ComboBoxItemRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute"}function C(t){this.className=this.className?this.className:"DataGridColumn",kc.call(this,this.className),this.colNum=void 0,this.editable=this.draggable=this.copyWithItemRendererDataProvider=!0,this.editorDataField="text",this.editorYOffset=this.editorXOffset=this.editorWidthOffset=this.editorHeightOffset=0,this.editorUsesEnterKey=!1,this.exportWithItemRendererDataProvider=!0,
this.filterable=!1,this.filterFunction=this.filterOperators=this.filterType=null,this.filterCaseInSensitive=!1,this.indexStartNo=1,this.itemEditor=new kb(Y),this.resizable=!0,this.rendererIsEditor=!1,this.sortable=!0,this.sortDescending=!1,this.showEditableIcon="mouseover",this.editorProperties=this.imeMode=this.falseValue=this.trueValue=null,this.defaultWidth=100,this.updateImmediatelyAfterChange=!0,this._rendererData={},this._preferredWidth=100,this._headerColSpan=0,this._minWidth=20,this._visible=!0,this._width=100,this._itemRendererLabelField=this._headerRendererLabelField="label",this._spanable=!0,this._truncateToFit=!1,this._styles={backgroundColor:null},t&&(this._headerText=this._dataField=t)}function fb(t){this.className=this.className?this.className:"DataGridColumnGroup",C.call(this,t),this.children=[],this.childrenDragEnabled=!0,this._width=100,t&&(this._headerText=this._dataField=t)}function Va(){this.className=this.className?this.className:"DataGridFooter",Bb.call(this),this._useDelayInvalidate=!0,this._summaryObj={},this._useDataSourceChanged=this._summaryOnlyLeafChanged=this._summaryOnlyLeaf=this._footerRendererChanged=this._columnsChanged=this._dataChanged=!1,this._footerRenderer=new kb(Wb),this._explicitMinWidth=10}function wb(){this.className=this.className?this.className:"DataGridFooterColumn",kc.call(this,this.className),this.data=void 0,this.colSpan=1,this._wordWrap=!1,this._styles={backgroundColor:null}}function Wb(){qa.call(this,"div","DataGridFooterRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Jc(){qa.call(this,"div","DataGridGroupItemRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=this._disclosureIconElementVisible=this._iconElementVisible=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function oc(){this.className=this.className?this.className:"DataGridGroupingPanel",Fd.call(this),this._groupingFields=[],this._itemRenderer=new kb(yc)}function yc(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"DataGridGroupingPanelIndicator",u.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._textChanged=!1}function Wa(){qa.call(this,"div","DataGridHeaderRenderer"),this._useDelayInvalidate=!0,this._add_text_width_padding=this._sortItemRendererChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function mb(){this.element=this.element?this.element:"span",this.className=this.className?this.className:"DataGridItemRenderer",qa.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._offsetHeight=this._offsetWidth=NaN,this._listDataChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function kd(t){this.className=this.className?this.className:"DataGridRowStateColumn",C.call(this,t),this.editable=this.sortable=!1,this.rendererIsEditor=!0,this._itemRenderer=new kb(Rc),this._preferredWidth=this._explicitWidth=25}function Aa(t){this.className=this.className?this.className:"DataGridSelectorColumn",C.call(this,t),this.editable=this.sortable=!1,this.rendererIsEditor=!0,this.syncWithRowClick=this.allowChildrenSelection=!1,this._headerRenderer=new kb(tb),this._itemRenderer=new kb(Vb),this._preferredWidth=this._explicitWidth=40,this._selectedData={},this._allItemSelected=!1,this._allowMultipleSelection=this._allowAllSelection=!0,this._selectedItems=[]}function ec(){u.call(this,"div","DataGridSortItemRenderer"),this._useDelayInvalidate=!0,this.element.style.position="absolute",this.element.style.visibility="hidden",this.element.style.width="16px",this.element.style.height="13px"}function Pa(t){this.className=this.className?this.className:"DataGridSparkColumn",C.call(this,t),this._columnWidthRatio=.7,this._dataFields=null,this._horizontalAxisInvert=!1,this._radius=2,this._showZeroAxis=this._showMinusPoints=this._showMinPoint=this._showMaxPoint=this._showLastPoint=this._showFirstPoint=this._showAllPoints=!1,this._verticalAxisMinimum=this._verticalAxisMaximum=NaN,this._itemRenderer=new kb(me)}function Rb(){this.element=this.element?this.element:"canvas",this.className=this.className?this.className:"DataGridSparkItemRenderer",r.supportCanvas||(this.element="div"),qa.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Be(){this.element=this.element?this.element:"canvas",this.className=this.className?this.className:"DataGridSparkColumnItemRenderer",r.supportCanvas||(this.element="div"),Rb.call(this,this.element,this.className)}function me(){this.element=this.element?this.element:"canvas",this.className=this.className?this.className:"DataGridSparkLineItemRenderer",r.supportCanvas||(this.element="div"),Rb.call(this,this.element,this.className)}function Ce(){this.element=this.element?this.element:"canvas",this.className=this.className?this.className:"DataGridSparkWinLossItemRenderer",r.supportCanvas||(this.element="div"),Rb.call(this,this.element,this.className)}function be(){this.className="DataProviderItemRenderer",mb.call(this)}function ne(){this.className=this.className?this.className:"DateEditor",X.call(this)}function sd(){this.className="DynamicComboBoxEditor",za.call(this),this._dataChanged=!1,this.element.style.position="absolute"}function td(){this.className=this.className?this.className:"ExComboBoxEditor",Z.call(this),this._editable=!0,this.element.style.position="absolute",this.element.style.paddingLeft="0px",this.element.style.paddingRight="0px"}function Rd(){this.className=this.className?this.className:"FilterList",Q.call(this),this.setItemRenderer(new kb(tc))}function tc(){qa.call(this,"div","FilterListCheckBoxItemRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute"}function dd(){this.className=this.className?this.className:"HtmlEditableItemRenderer",mb.call(this)}function Hd(){this.className=this.className?this.className:"HtmlItemRenderer",mb.call(this)}function Eb(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"IconItemRenderer",qa.call(this,this.element,this.className),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Sd(){this.className="EditableIconItemRenderer",Eb.call(this)}function zc(){qa.call(this,"div","ImageItemRenderer"),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute"}function Rc(){qa.call(this,"div","ImageRowStateIndicator"),this._useDelayInvalidate=!0,this._listDataChanged=!1,this.element.style.position="absolute"}function ce(){this.className=this.className?this.className:"IndexNoItemRenderer",mb.call(this)}function oe(){this.className=this.className?this.className:"MonthEditor",da.call(this)}function Fc(){qa.call(this,"div","RadioButtonItemRenderer"),this.element.style.position="absolute"}function fc(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"RadioButtonItemSelector",qa.call(this,this.element,this.className),this._useDelayInvalidate=!0,this.element.style.position="absolute"}function ud(){this.className=this.className?this.className:"TextAreaItemRenderer",mb.call(this),this.element.style.overflowY="auto",r.ie9&&(this.setStyle(r.boxSizing,"content-box"),this._useContentBox=!0),this.addEvent(r.firefox?"DOMMouseScroll":"mousewheel",this._mouseWheelHandler,this)}function ed(){this.className=this.className?this.className:"PivotDataGridRendererProvider",this.styleName=void 0}function Kc(){qa.call(this,"div","PivotDataGridGroupRenderer"),this._useDelayInvalidate=!0,this.element.style.position="absolute",this.element.style.overflow="hidden"}function Yb(){this.className=this.className?this.className:"PivotDataGridHeaderRenderer",H.call(this),this._dataProviderChanged=this._factoriesChanged=!1,this._verticalScrollPolicy=this._horizontalScrollPolicy="off",this.element.style.position="absolute",this.element.style.overflow="hidden"}function Le(){this.className=this.className?this.className:"PivotDataGridHeaderRendererProvider",ed.call(this),this.headerWordWrap=void 0}function Me(){this.className=this.className?this.className:"PivotDataGridItemRendererProvider",ed.call(this),this.formatter=void 0}function Ga(t){this.numCells=0,this._level=0<arguments.length?t:-1}function fd(){this.className=this.className?this.className:"CubeNodeBuilder",this.rootNode=void 0,this.allNodePropertyName="(All)",this.levelPreviousToMeasuresIndex=void 0,this._computeEndMap={},this._computeEndMap2={},this._computeObjEndMap={},this._measureMap={}}function cb(){this.className=this.className?this.className:"DefaultCubeImpl",this._queryTotal=this._queryProgress=0,this._prepared=!1,this._currentPosition=t.getFIRST(),this._iterator=null,this._actionFunction=this._prepareForNewQuery,this._validRowPositions=!0,this._queryProgressEventThreashold=1e3,this._tupleIndexObject={},this._reachedEnd=!1}function uc(t,e){this.className=this.className?this.className:"OLAPElement",this._name=t,this._displayName=e}function Qa(t,e){this.className=this.className?this.className:"OLAPHierarchy",uc.call(this,t,e),this._hasAll=!0,this._levels=new P,this._levelMap={},this._allMemberName=this._allLevelName="(All)",nb.traceMsg("Creating hierarchy: "+this._name,nb.TRACE_LEVEL_3)}function ob(t,e){this.className=this.className?this.className:"OLAPAttribute",Qa.call(this,t,e),this.dataCompareFunction=this._internalDataCompareFunction,this.displayNameFunction=null,this._dataFunction=this._internalDataFunction,this._uniqueChildrenMap={},this._uniqueMembers=new P,this._userDataFunction=!1}function db(t,e){this.className=this.className?this.className:"OLAPLevel",uc.call(this,t,e),this._membersMapOnUName={},this._membersMapOnName={},this._orderedMembers=new P,this._allMemberName="(All)",nb.traceMsg("Created Level: "+this._name,nb.TRACE_LEVEL_3)}function Id(t){this.className=this.className?this.className:"OLAPAttributeLevel",db.call(this,t)}function vd(){this.className=this.className?this.className:"OLAPAxisPosition",this._members=new P}function pe(t,e){this.className=this.className?this.className:"OLAPCell",this._value=t,this._formattedValue=e}function La(t){this.className=this.className?this.className:"OLAPCube",wa.call(this),this.slicerFields=this.measureFields=this.columnFields=this.rowFields=void 0,this._dimensionMap={},this._measureDimensionName="Measures",this._prepare=!1,this._dimIndex=0,this._queriesPending=[],this._queryToken={},this._resultClass=gc,this._cubeBuildingTimeInterval=5,this._queryBuildingTimeInterval=1,this._workDuration=50,this._dimensions=new P,this._cubeImpl=new cb,nb.traceMsg("Creating cube: "+t,nb.TRACE_LEVEL_3)}function ub(t,e){this.className=this.className?this.className:"OLAPDimension",uc.call(this,t,e),this._attributeMap={},this._hierarchiesMap={},this._attributes=new P,this._hierarchies=new P,this._isMeasureDimension=!1,nb.traceMsg("Creating dimension: "+t,nb.TRACE_LEVEL_3)}function Sb(t,e){this.className=this.className?this.className:"OLAPMember",uc.call(this,t,e),this._childrenMap={},this._children=new P,this._all=!1,nb.traceMsg("Creating member: "+this._name,nb.TRACE_LEVEL_3)}function wd(t,e){this.className=this.className?this.className:"OLAPMeasure",Sb.call(this,t,e),this._aggregator=new xd}function Zb(){this.className=this.className?this.className:"OLAPQuery",this._axes=[new gd(0),new gd(1),new gd(2)]}function gd(t){this.className=this.className?this.className:"OLAPQueryAxis",this.axisOrdinal=t,this._sets=[],this._tuples=[]}function gc(){this.className=this.className?this.className:"OLAPResult",this._cellData=[],this._axes=[]}function Td(){this.className=this.className?this.className:"OLAPResultAxis",this._positions=new P}function yd(){this.className=this.className?this.className:"OLAPSchema",this._cubes={}}function Fb(){this.className=this.className?this.className:"OLAPSet",this._reverseCompare=!1,this._tuples=[]}function nb(){}function $b(){this.className=this.className?this.className:"OLAPTuple",this._cachedMembers=new P,this._explicitMembers=new P,this._explicitMembersValid=!1,this._userMembers=[]}function Vc(){this.className=this.className?this.className:"QueryCubeBuilder",this.rootNode=void 0,this.allNodePropertyName="(QAll)",this._computeEndMap={},this._computeEndMap2={},this._computeObjEndMap={},this._measureMap={},this._nodesToClose=[]}function De(t,e){this.className=this.className?this.className:"QueryError",this.message=0<arguments.length?t:null,this.id=1<arguments.length?e:0}function Lc(){}function Jd(){this.className=this.className?this.className:"AverageAggregator"}function Kd(){this.className=this.className?this.className:"CountAggregator"}function Ld(){this.className=this.className?this.className:"MaxAggregator"}function Md(){this.className=this.className?this.className:"MinAggregator"}function xd(){this.className=this.className?this.className:"SumAggregator"}function qe(){this.className="DataGridColumnDropIndicator",Pb.call(this),this.element.style.position="absolute"}function Ne(){this.className="DataGridColumnResizeSkin",Pb.call(this),this.element.style.position="absolute",this.measuredWidth=2,this.measuredHeight=10}function re(){this.className="DataGridHeaderBackgroundSkin",Pb.call(this),this.element.style.position="absolute"}function Oe(){this.className="DataGridHeaderHorizontalSeparator",Pb.call(this),this.measuredWidth=10,this.measuredHeight=2}function Pe(){this.className="DataGridHeaderSeparator",Pb.call(this),this.measuredWidth=2,this.measuredHeight=10}function M(){this.className=this.className?this.className:"PivotDataGrid",l.call(this),this.cellFormatter=void 0,this.defaultCellString="NaN",this._numHeaderCols=0,this._dataProviderChanged=!1,this._itemRendererProviders=[],this._itemRendererProvidersUnSorted=[],this._itemRendererProvidersChanged=!1,this._headerRendererProviders=[],this._headerRendererProvidersUnSorted=[],this._headerRendererProvidersChanged=!1,this.setGroupItemRenderer(new kb(Kc)),this._pivotElements=[],this._pivotElements.push(M.PIVOT_MEMBER),this._pivotElements.push(M.PIVOT_LEVEL),this._pivotElements.push(M.PIVOT_HIERARCHY),this._pivotElements.push(M.PIVOT_DIMENSION),this._pivotElements=this._pivotElements.sort(),this.sortableColumns=this.draggableColumns=!1,this._sortExpertMode=!0}function gb(t){this._wrapper=t,this._csses={}}function D(t,e,i,s,r){function n(){var t="xhtest";if(void 0==t)return void o("License is not registered.");var e=0;return 0!=e?(1==e?o("Invalid license."):2==e?o("This host is not authorized."):3==e?o("Period has expired."):4==e?o("Other versions of the license."):5==e?o("Invalid License Type."):6==e?o("Evaluation license."):7==e?o("Trial license is required."):8==e&&o("Invalid LicenseUrl."),e):void 0}function o(t){throw setTimeout('alert("'+t+'")',500),t}u.call(this,"div","Root"),this._useDelayInvalidate=!0,this.enableSortModeEditing=this.removeAllData=!1,this.showLoadingBar=!0,this._allDataImported=this.undoable=this.parsingDate=!1,this._componentIds={},this._dataURLInProcess=!1,this._undoStack=[],this._firstEditableField=this._lastRollOverIndex=this._undoStackPointer=-1,this._excelCSVImportOption=0,this._exportExcelAsync=!1,this._inLoadingBarCount=0,this.dataType="json",this.KoolOnLoadCallFunction=this.dataURL=this.layoutURL=null,this.showLoadingBar=!0,this.useDataGridFields=!1,this.csvParserAsyncLimit=10485760,this._searchStringChanged=this._layoutChanged=this._gridDataChanged=!1;this.prr=function(t){bbss(t)};new Array(1116352408,1899447441,(-1245643825),(-373957723),961987163,1508970993,(-1841331548),(-1424204075),(-670586216),310598401,607225278,1426881987,1925078388,(-2132889090),(-1680079193),(-1046744716),(-459576895),(-272742522),264347078,604807628,770255983,1249150122,1555081692,1996064986,(-1740746414),(-1473132947),(-1341970488),(-1084653625),(-958395405),(-710438585),113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,(-2117940946),(-1838011259),(-1564481375),(-1474664885),(-1035236496),(-949202525),(-778901479),(-694614492),(-200395387),275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,(-2067236844),(-1933114872),(-1866530822),(-1538233109),(-1090935817),(-965641998));n(),this._paramId=t,this._paramTarget=e,this._jsVars=i,p(s)?this._paramWidth="100%":this._paramWidth=s,p(r)?this._paramHeight="100%":this._paramHeight=r,this.element.style.position="relative",this.element.style.overflow="hidden"}function ReplacementFor_setP2(t,e,i){if(!t.hasOwnProperty(e)){var s=t[i];t[e]=s,t[i]=null}}function dSM(t){null!=t&&(ReplacementFor_tmm(t),ReplacementFor_dsmInterval=setInterval(function(){ReplacementFor_tmm(t)},6e4))}function ReplacementFor_setP(t,e){t.hasOwnProperty(e)||(t[e]=Object)}function ReplacementFor_tmm(t){if(null!=t){var e=document.getElementById(t);return e?void 0:void clearInterval(ReplacementFor_dsmInterval)}}function bbss(t){ReplacementFor_setP(t,"XMLListCollction"),ReplacementFor_setP2(t,"DataGridColumnGroup","DataGridColumnGroup"),ReplacementFor_setP2(t,"NumberFormatter","NumberParser"),ReplacementFor_setP2(t,"TextInput","TextInput")}function gms(){return eval("window.KoolGridLicense;")}var Ma="../Assets/",Xb=!1,z=function(){var t=function(){};return function(e,i){if(t.prototype=i.prototype,e.prototype=new t,e._super=i.prototype,e.prototype.constructor=e,i._defaultStyles){e._defaultStyles||(e._defaultStyles={});for(var s in i._defaultStyles)e._defaultStyles.hasOwnProperty(s)||(e._defaultStyles[s]=i._defaultStyles[s])}if(i._propertyType)for(s in e._propertyType||(e._propertyType={}),i._propertyType)e._propertyType.hasOwnProperty(s)||(e._propertyType[s]=i._propertyType[s]);i._defaultProperty&&!e._defaultProperty&&(e._defaultProperty=i._defaultProperty)}}();$c.prototype.getNumChildren=function(){return this._owner._$getNumChildren()},$c.prototype.addChild=function(t){return this._owner._rawChildren_addChild(t)},$c.prototype.addChildAt=function(t,e){return this._owner._rawChildren_addChildAt(t,e)},$c.prototype.removeChild=function(t){return this._owner._rawChildren_removeChild(t)},$c.prototype.removeChildAt=function(t){return this._owner._rawChildren_removeChildAt(t)},$c.prototype.getChildAt=function(t){return this._owner._rawChildren_getChildAt(t)},$c.prototype.getChildByName=function(t){return this._owner._rawChildren_getChildByName(t)},$c.prototype.getChildIndex=function(t){return this._owner._rawChildren_getChildIndex(t)},$c.prototype.setChildIndex=function(t,e){return this._owner._rawChildren_setChildIndex(t,e)},$c.prototype.contains=function(t){return this._owner._rawChildren_contains(t)};var wa=function(){this._eventList={},this.uno=Sa.elementNo++};wa.prototype.addEventListener=function(t,e,i,s,r){var n,o,a,l=2<arguments.length?i:window,h=3<arguments.length&&s,d=4<arguments.length?r:0,c=-1;for(I(this._eventList[t])&&(this._eventList[t]=[]),o=this._eventList[t],n=o.length-1;0<=n;n--){if((a=o[n])&&a.listener===e&&a.context===l){if(a.priority==d)return;o.splice(n,1)}a.priority<d&&0>c&&(c=n)}-1==c?o.unshift({listener:e,context:l,useCapture:h,priority:d}):o.splice(c+1,0,{listener:e,context:l,useCapture:h,priority:d})},wa.prototype.removeEventListener=function(t,e,i,s){i=2<arguments.length?i:window,s=3<arguments.length&&s;var r,n,o;if(this._eventList[t])for(n=this._eventList[t],r=n.length-1;0<=r;r--)if((o=n[r])&&o.listener===e&&o.context===i){o.listener=null,o.context=null,n.splice(r,1);break}},wa.prototype.hasEventListener=function(t){return!!(this._eventList[t]&&0<this._eventList[t].length)},wa.prototype.dispatchEvent=function(t){var e,i,s,r,n;if(e=t.type,this._eventList[e])for(i=this._eventList[e],e=i.length-1;0<=e;e--)if(s=i[e])if(r=s.listener,t.target||t.currentTarget){if(n=t.clone(),n.target=t.target?t.target:this.element?this.element:this,n.currentTarget=this.element,n.defaultPrevented=t.defaultPrevented,r.call(s.context,n),n._istoped)return!n.defaultPrevented;t.defaultPrevented=t.defaultPrevented&&n.defaultPrevented}else if(t.target=t.target?t.target:this.element?this.element:this,t.currentTarget=this.element||this,r.call(s.context,t),t._istoped)break;return!t.defaultPrevented},kc._defaultStyles={},z(kc,wa),kc.prototype._createRules=function(){var t;if(!this._rules)try{if("Kool__"===this._findCSS){if(this._sheetIdx=Tb.productCSSSheetIndex,0>this._sheetIdx&&document.styleSheets){var e,i,s,r="Kool__".replace("H5__","").replace("__","").toLowerCase();for(e=0;e<document.styleSheets.length;e++)if((i=document.styleSheets[e])&&i.href){s=i.href.substring(i.href.lastIndexOf("/")+1).toLowerCase();try{if(0<=s.indexOf(r)&&(i.rules||i.cssRules)){this._sheetIdx=e;break}}catch(n){}}}0>this._sheetIdx&&(this._sheetIdx=m.findCSSSheetIndex("Kool__(\\S)*")),0>this._sheetIdx&&(this._sheetIdx=m.createCSSSheet(this._findCSS)),0<=this._sheetIdx&&0>Tb.productCSSSheetIndex&&Tb.productCSSSheetIndex!=this._sheetIdx&&(Tb.productCSSSheetIndex=this._sheetIdx)}else 0>this._sheetIdx&&(this._sheetIdx=m.findCSSSheetIndex(this._findCSS),0>this._sheetIdx&&(this._sheetIdx=m.createCSSSheet(this._findCSS)));if(this._rules=m.addCSSRule(this._sheetIdx,this._cssName))for(t in this.constructor._defaultStyles)p(this._rules.style[t])?this._styles[t]=this.constructor._defaultStyles[t]:this._rules.style[t]=this.constructor._defaultStyles[t]}catch(n){throw Error("error in createRules() of "+this._cssName+"  error:"+n)}},kc.prototype.clearStyle=function(){this._styles={}},kc.prototype.getStyle=function(t){return this._styles&&this._styles.hasOwnProperty(t)?this._styles[t]:this.constructor._defaultStyles&&this.constructor._defaultStyles.hasOwnProperty(t)?this.constructor._defaultStyles[t]:this._rules.style[t]},kc.prototype.setStyle=function(t,e){this._styles.hasOwnProperty(t)?this._styles[t]=e:p(this._rules.style[t])?this._styles[t]=e:this._rules.style[t]=e},kc.prototype.getSizeStyle=function(t){return this._styles.hasOwnProperty(t)?parseFloat(this._styles[t]):this.constructor._defaultStyles&&this.constructor._defaultStyles.hasOwnProperty(t)?parseFloat(this.constructor._defaultStyles[t]):(t=parseFloat(this._rules.style[t]),isNaN(t)?0:t)};var se=function(){this.uno=Sa.elementNo++};se.prototype.newInstance=function(){};var kb=function(t){se.call(this),this.generator=0<arguments.length?t:null,this.properties=null};z(kb,se),kb.prototype.newInstance=function(){var t=new this.generator;if(null!=this.properties)for(var e in this.properties)t[e]=this.properties[e];return t};var Ud=function(){this._dataHolder={},this._formatHandlers={},this._context={},this._formats=[]};Ud.prototype.getFormats=function(){return this._formats},Ud.prototype.addData=function(t,e){this._formats.push(e),this._dataHolder[e]=t},Ud.prototype.addHandler=function(t,e,i){this._formats.push(e),this._formatHandlers[e]=t,this._context[e]=i},Ud.prototype.dataForFormat=function(t){var e=this._dataHolder[t];return e?e:this._formatHandlers[t]?this._formatHandlers[t].call(this._context[t]):null},Ud.prototype.hasFormat=function(t){var e,i=this._formats.length;for(e=0;e<i;e++)if(this._formats[e]==t)return!0;return!1};var Pc=function(t,e,i,s){this.left=0<arguments.length?t:0,this.top=1<arguments.length?e:0,this.right=2<arguments.length?i:0,this.bottom=3<arguments.length?s:0};Pc.prototype.clone=function(){return new Pc(this.left,this.top,this.right,this.bottom)},Pc.EMPTY=new Pc(0,0,0,0),z(A,wa),A.prototype.getAlpha=function(){return m.getAlpha(this.element)},A.prototype.setAlpha=function(t){m.setAlpha(this.element,t)},A.prototype.getX=function(){return m.getSizeStyle(this.element,"left")},A.prototype.setX=function(t){m.setPxStyle(this.element,"left",t)},A.prototype.getY=function(){return m.getSizeStyle(this.element,"top")},A.prototype.setY=function(t){m.setPxStyle(this.element,"top",t)},A.prototype.getWidth=function(){var t=this.element,e=m,i=e.getSizeStyle,s=e.getSizeStyleBorder,n=t.style.width;return n&&!isNaN(parseFloat(n))&&0>n.indexOf("%")?r.useBorderBox||this._useBorderBox?parseFloat(n):parseFloat(n)+i(t,"paddingLeft")+i(t,"paddingRight")+s(t,"borderLeftWidth")+s(t,"borderRightWidth"):this._visible?e.getOffsetWidth(t):0},A.prototype.setWidth=function(t){var e=this.element,i=m,s=i.getSizeStyle,n=i.getSizeStyleBorder;F(t)&&0<=t.indexOf("%")?i.setStyle(e,"width",t):(s=r.useBorderBox||this._useBorderBox?0:s(e,"paddingLeft")+s(e,"paddingRight")+n(e,"borderLeftWidth")+n(e,"borderRightWidth"),parseFloat(e.style.width)+s!=t&&i.setPxStyle(e,"width",0<t-s?t-s:0))},A.prototype.getHeight=function(){var t=this.element,e=m,i=e.getSizeStyle,s=e.getSizeStyleBorder,n=t.style.height;return n&&!isNaN(parseFloat(n))&&0>n.indexOf("%")?r.useBorderBox||this._useBorderBox?parseFloat(n):parseFloat(n)+i(t,"paddingTop")+i(t,"paddingBottom")+s(t,"borderTopWidth")+s(t,"borderBottomWidth"):this._visible?e.getOffsetHeight(t):0},A.prototype.setHeight=function(t){var e=this.element,i=m,s=i.getSizeStyle,n=i.getSizeStyleBorder;F(t)&&0<=t.indexOf("%")?i.setStyle(e,"height",t):(s=r.useBorderBox||this._useBorderBox?0:s(e,"paddingTop")+s(e,"paddingBottom")+n(e,"borderTopWidth")+n(e,"borderBottomWidth"),parseFloat(e.style.height)+s!=t&&i.setPxStyle(e,"height",0<t-s?t-s:0))},A.prototype.getWidthInline=function(){var t=this.element,e=t.style.width;return!this._visible||e&&!isNaN(parseFloat(e))&&0>e.indexOf("%")?isNaN(parseFloat(e))?0:parseFloat(e):m.getOffsetWidth(t)},A.prototype.setWidthInline=function(t){var e=this.element,i=m;F(t)&&0<=t.indexOf("%")?i.setStyle(e,"width",t):parseFloat(e.style.width)!=t&&i.setPxStyle(e,"width",t)},A.prototype.getHeightInline=function(){var t=this.element,e=t.style.height;return!this._visible||e&&!isNaN(parseFloat(e))&&0>e.indexOf("%")?isNaN(parseFloat(e))?0:parseFloat(e):m.getOffsetHeight(t)},A.prototype.setHeightInline=function(t){var e=this.element,i=m;F(t)&&0<=t.indexOf("%")?i.setStyle(e,"height",t):parseFloat(e.style.height)!=t&&i.setPxStyle(e,"height",t)},A.prototype.getEnabled=function(){return this._enabled},A.prototype.setEnabled=function(t){var e=this.element,i=m;this._enabled!=t&&(this._enabled=t,p(e.disabled)||(e.disabled=!t),t?i.removeClass(e,"disabled"):i.addClass(e,"disabled"))},A.prototype.getTabIndex=function(){return this.element.tabIndex},A.prototype.setTabIndex=function(t){this.element.tabIndex=t},A.prototype.getVisible=function(){return m.getDisplay(this.element)},A.prototype.setVisible=function(t){this._visible!=t&&((this._visible=t)?m.setDisplay(this.element,t,this._oldDisplay):this._oldDisplay=m.setDisplay(this.element,t))},A.prototype.getVisibility=function(){return m.getVisibility(this.element)},A.prototype.setVisibility=function(t){m.setVisibility(this.element,t)},A.prototype.getNumChildren=function(){return this.__getNumChildren()},A.prototype.__getNumChildren=function(){var t=this.element;return t.children?t.children.length:t.childNodes.length},A.prototype.getParent=function(){return this.parentElement},A.prototype._createElement=function(){if(!F(this.element))throw Error("element is not string in _createElement() of HTMLObject");this.element="svg"===this.element?document.createElementNS("http://www.w3.org/2000/svg",this.element):document.createElement(this.element),this.element.selfElement=this,this.element.className="Kool__"+this.className},A.prototype.addEvent=function(t,e,i,s,r){v.addEvent(this.element,t,e,i,s,r)},A.prototype.removeEvent=function(t,e,i,s){v.removeEvent(this.element,t,e,i,s)},A.prototype.addParent=function(t){t instanceof A||this.element.parentNode===t||(t.appendChild(this.element),this.parentElement=t,this.initialize())},A.prototype.addChild=function(t){if(t instanceof A){if(t.element.parentNode){if(t.element.parentNode==this.element)return t;t.element.parentNode.removeChild(t.element)}return this.element.appendChild(t.element),t.parentElement=this,t}throw Error("added element is not an instance of HTMLObject")},A.prototype.addChildAt=function(t,e){if(t instanceof A){var i=this.__getNumChildren();if(0<i&&i<e)throw Error("Out of range error in addChildAt "+e);return t.element.parentNode&&(t.element.parentNode.removeChild(t.element),i=this.__getNumChildren()),0===i||i<=e?this.element.appendChild(t.element):this.element.insertBefore(t.element,this.__getChildAt(e).element),t.parentElement=this,t}throw Error("added element is not an instance of HTMLObject")},A.prototype.getChildAt=function(t){return this.__getChildAt(t)},A.prototype.__getChildAt=function(t){var e,i;return e=this.element,e=e.children?e.children:e.childNodes,i=e.length,0>=i||i<=t?null:e&&0<e.length?e[t].selfElement:null},A.prototype.getChildIndex=function(t){return this.__getChildIndex(t)},A.prototype.__getChildIndex=function(t){if(!t)return-1;if(t instanceof A&&t.parentElement===this){var e=0;for(t=t.element;t=t.previousSibling;)e++;return e}return-1},A.prototype.setChildIndex=function(t,e){var i=this.__getNumChildren();if(!(0>=i||i<=e)&&(i=this.__getChildIndex(t),i!=e)){var s=this.__getChildAt(e);s&&(i<e?this.element.insertBefore(t.element,s.element.nextSibling):this.element.insertBefore(t.element,s.element))}},A.prototype.removeChild=function(t){return t instanceof A&&t.element.parentNode?(this.element.removeChild(t.element),t.parentElement=null,t):null},A.prototype.removeChildAt=function(t){var e=this.__getNumChildren();return 0>=e||e<=t?null:(t=this.__getChildAt(t),t instanceof A&&t.element.parentNode?(this.element.removeChild(t.element),t.parentElement=null,t):null)},A.prototype.getChildByName=function(t){var e,i,s,r;for(e=this.element,e=e.children?e.children:e.childNodes,i=e.length,r=0;r<i;r++)if((s=e[r].selfElement)&&s.name===t)return s;return null},A.prototype.swapChildren=function(t,e){if(this.element&&t&&e){var i=t.element.nextSibling;i===e.element?this.swapChildren(e,t):(this.element.insertBefore(t.element,e.element),this.removeChild(e.element),this.element.insertBefore(e.element,i))}},A.prototype.swapChildrenAt=function(t,e){this.swapChildren(this.__getChildAt(t),this.__getChildAt(e))},A.prototype.contains=function(t){return t instanceof A&&this.element.contains(t.element)},A.prototype.setStyle=function(t,e){m.setStyle(this.element,t,e)},A.prototype.setPxStyle=function(t,e){m.setPxStyle(this.element,t,e)},A.prototype.getStyle=function(t){return m.getStyle(this.element,t)},A.prototype.clearStyle=function(t){m.clearStyle(this.element,t)},A.prototype.getSizeStyle=function(t){return 0<=t.indexOf("border")?m.getSizeStyleBorder(this.element,t):m.getSizeStyle(this.element,t)},A.prototype.setAttr=function(t,e){m.setAttr(this.element,t,e)},A.prototype.getAttr=function(t){return m.getAttr(this.element,t)},A.prototype.removeAttr=function(t){m.removeAttr(this.element,t)},A.prototype.globalToLocal=function(t){var e=this.element,i=m.pageXY(e);return new ra(t.x-i.x-m.getSizeStyleBorder(e,"borderLeftWidth"),t.y-i.y-m.getSizeStyleBorder(e,"borderTopWidth"))},A.prototype.localToGlobal=function(t){var e=this.element,i=m.pageXY(e);return new ra(t.x+i.x+m.getSizeStyleBorder(e,"borderLeftWidth"),t.y+i.y+m.getSizeStyleBorder(e,"borderTopWidth"))},A.prototype.validateNow=function(){},A.prototype.isFocused=function(){return this.element==document.activeElement},A.prototype.focus=function(){this.element.focus()},A.prototype.blur=function(){this.element.blur()};var ra=function(t,e){var i=this;i.x=0<arguments.length?t:0,i.y=1<arguments.length?e:0,i.clone=function(){return new ra(i.x,i.y)}},zd=function(t,e,i,s){this.x=0<arguments.length?t:0,this.y=1<arguments.length?e:0,this.width=2<arguments.length?i:0,this.height=3<arguments.length?s:0};z(R,A),R.prototype.getNestLevel=function(){return this._nestLevel},R.prototype.setNestLevel=function(t){var e,i,s,r;if(0<t&&this._nestLevel!=t)for(this._nestLevel=t,this._updateCallbacks(),s=U(this.getRawChildren)?this.getRawChildren():this,i=s.getNumChildren(),e=0;e<i;e++)r=s.getChildAt(e),r instanceof R&&r.setNestLevel(t+1)},R.prototype.getInitialized=function(){return this._initialized},R.prototype.setInitialized=function(t){
(this._initialized=t)&&this.dispatchEvent(new w("creationComplete"))},R.prototype.getProcessedDescriptors=function(){return this._processedDescriptors},R.prototype.setProcessedDescriptors=function(t){(this._processedDescriptors=t)&&this.dispatchEvent(new w("initialize"))},R.prototype.getIncludeInLayout=function(){return this._includeInLayout},R.prototype.setIncludeInLayout=function(t){this._includeInLayout!=t&&(this._includeInLayout=t,t=this.getParent())&&(t.invalidateSize(),t.invalidateDisplayList())},R.prototype.getParent=function(){return this._parent?this._parent:R._super.getParent.call(this)},R.prototype.getOwner=function(){return this.owner?this.owner:this.getParent()},R.prototype.setOwner=function(t){return this.owner=t},R.prototype.stylesInitialized=function(){},R.prototype.addChild=function(t){if(t instanceof A){var e=t.getParent();return e&&e.removeChild(t),this._addingChild(t),this._$addChild(t),this._childAdded(t),t}throw Error("added element is not an instance of HTMLObject")},R.prototype.addChildAt=function(t,e){if(t instanceof A){var i=t.getParent();return i&&i.removeChild(t),this._addingChild(t),this._$addChildAt(t,e),this._childAdded(t),t}throw Error("added element is not an instance of HTMLObject")},R.prototype._addingChild=function(t){t instanceof R&&(t.parentChanged(this),t.stylesInitialized())},R.prototype._childAdded=function(t){t instanceof R&&(t.setNestLevel(this._nestLevel+1),t.notifyStyleChangeInChildren(null,!0),t.initialize())},R.prototype.removeChild=function(t){return this._removingChild(t),this._$removeChild(t),this._childRemoved(t),t},R.prototype.removeChildAt=function(t){return t=this.getChildAt(t),this._removingChild(t),this._$removeChild(t),this._childRemoved(t),t},R.prototype._removingChild=function(t){},R.prototype._childRemoved=function(t){t instanceof R&&t.parentChanged(null)},R.prototype.parentChanged=function(t){t?this._parent=t instanceof R?t:t.getParent()instanceof R?t.getParent():t.getParent().getParent():(this._parent=null,this._nestLevel=0)},R.prototype.owns=function(t){if(this.contains(t))return!0;try{for(;t&&t!=this;)t=t instanceof R?t.getOwner():t.getParent()}catch(e){return!1}return t==this},R.prototype.callLater=function(t,e){this._methodQueue.push({method:t,args:e,context:this}),this._listeningForRender||(this._frameCallLater.startTimeout(this,this._callLaterDispatcher),this._listeningForRender=!0)},R.prototype._callLaterDispatcher=function(){this._listeningForRender&&(this._listeningForRender=!1);var t=this._methodQueue;this._methodQueue=[];var e,i=t.length;for(e=0;e<i;e++){var s=t[e];s.args?s.method.apply(this,s.args):s.method.apply(this)}},R.prototype._doPhasedInstantiation=function(){this._invalidatePropertiesFlag&&this.validateProperties(),this._invalidateSizeFlag&&this.validateSize(),this._invalidateDisplayListFlag&&this.validateDisplayList(),this._invalidatePropertiesFlag||this._invalidateSizeFlag||this._invalidateDisplayListFlag?this._doPhasedInstantiation():(!this.getInitialized()&&this.getProcessedDescriptors()&&this.setInitialized(!0),this.dispatchEvent(new w("updateComplete")))},R.prototype._updateCallbacks=function(){this._useDelayInvalidate?(this._invalidateDisplayListFlag&&Ba.getInstance().invalidateDisplayList(this),this._invalidateSizeFlag&&Ba.getInstance().invalidateSize(this),this._invalidatePropertiesFlag&&Ba.getInstance().invalidateProperties(this)):this._initialized&&(this._invalidatePropertiesFlag?this.validateProperties():this.invalidateProperties(),this._invalidateSizeFlag?this.validateSize():this.invalidateSize(),this._invalidateDisplayListFlag?this.validateDisplayList():this.invalidateDisplayList())},R.prototype.initialize=function(){this._initialized||(this.dispatchEvent(new w("preinitialize")),this.createChildren(),this._useDelayInvalidate?(this.childrenCreated(),this.setProcessedDescriptors(!0)):(this.setProcessedDescriptors(!0),this.childrenCreated()))},R.prototype.createChildren=function(){},R.prototype.childrenCreated=function(){this._useDelayInvalidate?(this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()):(this._invalidatePropertiesFlag?this.validateProperties():this.invalidateProperties(),this._invalidateSizeFlag?this.validateSize():this.invalidateSize(),this._invalidateDisplayListFlag?this.validateDisplayList():this.invalidateDisplayList())},R.prototype.invalidateProperties=function(){this._invalidatePropertiesFlag||(this._invalidatePropertiesFlag=!0,this._useDelayInvalidate?this.element.parentNode&&Ba.getInstance().invalidateProperties(this):this.element.parentNode&&(this._runInvalidateSizeFlag||this._runInvalidateDisplayListFlag?Ba.getInstance().invalidateProperties(this):this.validateProperties()))},R.prototype.styleChanged=function(t){(p(t)||Tb.sizeInvalidatingStyles[t]||"styleName"==t)&&this.invalidateSize(),this.invalidateDisplayList()},R.prototype.invalidateSize=function(){this._invalidateSizeFlag||(this._invalidateSizeFlag=!0,this._useDelayInvalidate?this.element.parentNode&&Ba.getInstance().invalidateSize(this):this.element.parentNode&&(this._runInvalidatePropertiesFlag||this._runInvalidateDisplayListFlag?Ba.getInstance().invalidateSize(this):this.validateSize()))},R.prototype.invalidateDisplayList=function(){this._invalidateDisplayListFlag||(this._invalidateDisplayListFlag=!0,this._useDelayInvalidate?this.element.parentNode&&Ba.getInstance().invalidateDisplayList(this):this.element.parentNode&&(this._runInvalidatePropertiesFlag||this._runInvalidateSizeFlag?Ba.getInstance().invalidateDisplayList(this):this.validateDisplayList()))},R.prototype.validateProperties=function(){this._invalidatePropertiesFlag&&(this._runInvalidatePropertiesFlag=!0,this.commitProperties(),this._runInvalidatePropertiesFlag=this._invalidatePropertiesFlag=!1)},R.prototype.commitProperties=function(){this._commitPropertiesCallCount++},R.prototype.validateSize=function(t){var e,i;if(t)for(t=0,e=this.getNumChildren();t<e;t+=1)i=this.getChildAt(t),i instanceof R&&i.validateSize(!0);this._invalidateSizeFlag&&(t=this._measureSizes())&&this._includeInLayout&&this.getProcessedDescriptors()&&(this.invalidateDisplayList(),(t=this.getParent())&&t.isContentPane&&(t=t.getParent()),t&&t instanceof R&&t.getProcessedDescriptors()&&(t.invalidateSize(),t.invalidateDisplayList()))},R.prototype._measureSizes=function(){var t,e=!1;return this._invalidateSizeFlag?(O(this._explicitWidth)||O(this._explicitHeight)?(this._runInvalidateSizeFlag=!0,this.measure(),this._runInvalidateSizeFlag=this._invalidateSizeFlag=!1,!isNaN(this._explicitMinWidth)&&this.measuredWidth<this._explicitMinWidth&&(this.measuredWidth=this._explicitMinWidth),!isNaN(this._explicitMaxWidth)&&this.measuredWidth>this._explicitMaxWidth&&(this.measuredWidth=this._explicitMaxWidth),!isNaN(this._explicitMinHeight)&&this.measuredHeight<this._explicitMinHeight&&(this.measuredHeight=this._explicitMinHeight),!isNaN(this._explicitMaxHeight)&&this.measuredHeight>this._explicitMaxHeight&&(this.measuredHeight=this._explicitMaxHeight)):(this._invalidateSizeFlag=!1,this._measuredMinHeight=this._measuredMinWidth=0),O(this._oldMinWidth)?(this._oldMinWidth=O(this._explicitMinWidth)?this.measuredMinWidth:this._explicitMinWidth,this._oldMinHeight=O(this._explicitMinHeight)?this.measuredMinHeight:this._explicitMinHeight,this._oldExplicitWidth=O(this._explicitWidth)?this.measuredWidth:this._explicitWidth,this._oldExplicitHeight=O(this._explicitHeight)?this.measuredHeight:this._explicitHeight,e=!0):(t=O(this._explicitMinWidth)?this.measuredMinWidth:this._explicitMinWidth,t!=this._oldMinWidth&&(this._oldMinWidth=t,e=!0),t=O(this._explicitMinHeight)?this.measuredMinHeight:this._explicitMinHeight,t!=this._oldMinHeight&&(this._oldMinHeight=t,e=!0),t=O(this._explicitWidth)?this.measuredWidth:this._explicitWidth,t!=this._oldExplicitWidth&&(this._oldExplicitWidth=t,e=!0),t=O(this._explicitHeight)?this.measuredHeight:this._explicitHeight,t!=this._oldExplicitHeight&&(this._oldExplicitHeight=t,e=!0)),e):e},R.prototype.measure=function(){this._measureCallCount++},R.prototype.validateDisplayList=function(){this._invalidateDisplayListFlag&&(this._runInvalidateDisplayListFlag=!0,this._unscaledWidth=this.getWidth(),this._unscaledHeight=this.getHeight(),this.updateDisplayList(this._unscaledWidth,this._unscaledHeight),this._runInvalidateDisplayListFlag=this._invalidateDisplayListFlag=!1,this._useDelayInvalidate||this._doPhasedInstantiation())},R.prototype.updateDisplayList=function(t,e){this._updateDisplayListCallCount++},R.prototype.validateNow=function(){Ba.getInstance().validateClient(this)},R.prototype.notifyStyleChangeInChildren=function(t,e){this._cachedTextFormat=null;var i,s=this.getNumChildren();for(i=0;i<s;i++){var r=this.getChildAt(i);r&&r instanceof R&&(r.styleChanged(t),r.notifyStyleChangeInChildren(t,e))}},R.prototype.effectStarted=function(t){var e,i,s,r;for(this._effectsStarted.push(t),s=t.getEffect().getAffectedProperties(),i=s.length,e=0;e<i;e+=1)r=s[e],void 0==this._affectedProperties[r]&&(this._affectedProperties[r]=[]),this._affectedProperties[r].push(t);this._isEffectStarted=!0,t.getHideFocusRing()&&(this._preventDrawFocus=!0)},R.prototype.effectFinished=function(t){this._endingEffectInstances.push(t),this.invalidateProperties(),Ba.getInstance().addEventListener("updateComplete",this._updateCompleteHandler,this)},R.prototype.resetInvalidate=function(){var t,e,i,s;for(this._invalidateDisplayListFlag=this._invalidateSizeFlag=this._invalidatePropertiesFlag=!1,i=U(this.getRawChildren)?this.getRawChildren():this,e=i.getNumChildren(),t=0;t<e;t++)s=i.getChildAt(t),this!=s&&s instanceof R&&s.resetInvalidate()},R.prototype._updateCompleteHandler=function(t){Ba.getInstance().removeEventListener("updateComplete",this._updateCompleteHandler,this),this._processEffectFinished(this._endingEffectInstances),this._endingEffectInstances=[]},R.prototype._processEffectFinished=function(t){var e,i,s,r,n,o;for(e=this._effectsStarted.length-1;0<=e;e--)for(i=0;i<t.length;i++)if(o=t[i],o==this._effectsStarted[e]){for(i=this._effectsStarted[e],this._effectsStarted.splice(e,1),r=i.getEffect().getAffectedProperties(),s=0;s<r.length;s++)if(n=r[s],void 0!=this._affectedProperties[n]){for(i=0;i<this._affectedProperties[n].length;i++)if(this._affectedProperties[n][i]==o){this._affectedProperties[n].splice(i,1);break}0==this._affectedProperties[n].length&&delete this._affectedProperties[n]}break}this._isEffectStarted=0<this._effectsStarted.length,o&&o.getHideFocusRing()&&(this._preventDrawFocus=!1)},R.prototype._getEffectsForProperty=function(t){return void 0!=this._affectedProperties[t]?this._affectedProperties[t]:[]},R.prototype._$addChild=function(t){return R._super.addChild.call(this,t)},R.prototype._$addChildAt=function(t,e){return R._super.addChildAt.call(this,t,e)},R.prototype._$removeChild=function(t){return R._super.removeChild.call(this,t)},R.prototype._$removeChildAt=function(t){return R._super.removeChildAt.call(this,t)},z(u,R),u._defaultStyles={backgroundAlpha:1},u.prototype.setWidth=function(t){u._super.setWidth.call(this,t),this._percentWidth=null,this._explicitWidth!=t&&(this._explicitWidth=t,this.invalidateSize()),(t=this.getParent())&&t instanceof R&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList())},u.prototype.setHeight=function(t){u._super.setHeight.call(this,t),this._percentHeight=null,this._explicitHeight!=t&&(this._explicitHeight=t,this.invalidateSize()),(t=this.getParent())&&t instanceof R&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList())},u.prototype.getDoubleClickEnabled=function(){return this._doubleClickEnabled},u.prototype.setDoubleClickEnabled=function(t){this._doubleClickEnabled=t;var e,i,s,r=U(this.getRawChildren)?this.getRawChildren():this;for(e=0,i=r.getNumChildren();e<i;e++)s=r.getChildAt(e),s instanceof u&&s.setDoubleClickEnabled(t)},u.prototype.getMinWidth=function(){return isNaN(this._explicitMinWidth)?this.measuredMinWidth:this._explicitMinWidth},u.prototype.setMinWidth=function(t){this.getExplicitMinWidth()!=t&&this.setExplicitMinWidth(t)},u.prototype.getMinHeight=function(){return isNaN(this._explicitMinHeight)?this.measuredMinHeight:this._explicitMinHeight},u.prototype.setMinHeight=function(t){this.getExplicitMinHeight()!=t&&this.setExplicitMinHeight(t)},u.prototype.getMaxWidth=function(){return isNaN(this._explicitMaxWidth)?1193046:this._explicitMaxWidth},u.prototype.setMaxWidth=function(t){this.getExplicitMaxWidth()!=t&&this.setExplicitMaxWidth(t)},u.prototype.getMaxHeight=function(){return isNaN(this._explicitMaxHeight)?1193046:this._explicitMaxHeight},u.prototype.setMaxHeight=function(t){this.getExplicitMaxHeight()!=t&&this.setExplicitMaxHeight(t)},u.prototype.getExplicitMinWidth=function(){return this._explicitMinWidth},u.prototype.setExplicitMinWidth=function(t){this._explicitMinWidth!=t&&(this._explicitMinWidth=t,this.invalidateSize(),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getExplicitMinHeight=function(){return this._explicitMinHeight},u.prototype.setExplicitMinHeight=function(t){this._explicitMinHeight!=t&&(this._explicitMinHeight=t,this.invalidateSize(),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getExplicitMaxWidth=function(){return this._explicitMaxWidth},u.prototype.setExplicitMaxWidth=function(t){this._explicitMaxWidth!=t&&(this._explicitMaxWidth=t,this.invalidateSize(),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getExplicitMaxHeight=function(){return this._explicitMaxHeight},u.prototype.setExplicitMaxHeight=function(t){this._explicitMaxHeight!=t&&(this._explicitMaxHeight=t,this.invalidateSize(),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getExplicitWidth=function(){return this._explicitWidth},u.prototype.setExplicitWidth=function(t){this._explicitWidth!=t&&(O(t)||(this._percentWidth=null),this._explicitWidth=t,u._super.setWidth.call(this,t),this.invalidateSize(),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getExplicitHeight=function(){return this._explicitHeight},u.prototype.setExplicitHeight=function(t){this._explicitHeight!=t&&(O(t)||(this._percentHeight=null),this._explicitHeight=t,u._super.setHeight.call(this,t),this.invalidateSize(),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getPercentWidth=function(){return this._percentWidth},u.prototype.setPercentWidth=function(t){this._percentWidth!=t&&(O(t)||(this._explicitWidth=NaN),this._percentWidth=t,m.setStyle(this,"width",t+"%"),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.getPercentHeight=function(){return this._percentHeight},u.prototype.setPercentHeight=function(t){this._percentHeight!=t&&(O(t)||(this._explicitHeight=NaN),this._percentHeight=t,m.setStyle(this,"height",t+"%"),(t=this.getParent())&&t instanceof u&&this._includeInLayout&&(t.invalidateSize(),t.invalidateDisplayList()))},u.prototype.setEnabled=function(t){this._enabled!=t&&(u._super.setEnabled.call(this,t),this.invalidateDisplayList())},u.prototype.getStyleName=function(){return this._styleName},u.prototype.setStyleName=function(t){this._styleName!=t&&(this._styleName&&(this._styleName instanceof u?(m.removeClass(this.element,"Kool__"+this._styleName.className),this._classStyle=null):m.removeClass(this.element,this._styleName)),this._styleName=t)&&(t instanceof u?(m.addClass(this.element,"Kool__"+t.className),this._classStyle=t):t instanceof kc?(m.addClass(this.element,t._cssName),this._classStyle=t):t.hasOwnProperty("className")?(m.addClass(this.element,"Kool__"+t.className),this._classStyle=t):m.addClass(this.element,t),this.styleChanged("styleName"))},u.prototype.getContextMenu=function(){return this._contextMenu},u.prototype.setContextMenu=function(t){this._contextMenu!=t&&(this._contextMenu&&(this._contextMenu.removeEventListener(Ad.MENU_ITEM_SELECT,this._contextMenuItemSelectHandler,this),this.removeEvent("contextmenu",this._contextMenuHandler,this),this.removeChild(this._contextMenu)),this._contextMenu=t,t instanceof Dc&&(this._contextMenu.setVisible(!1),this._contextMenu.addEventListener(Ad.MENU_ITEM_SELECT,this._contextMenuItemSelectHandler,this),this.addChild(this._contextMenu),this.addEvent("contextmenu",this._contextMenuHandler,this)))},u.prototype.setVisible=function(t){u._super.setVisible.call(this,t),t&&(0<(this.element.style.width+"").indexOf("%")||0<(this.element.style.height+"").indexOf("%"))&&(this.invalidateSize(),this.invalidateDisplayList())},u.prototype.clearStyles=function(){this._styles={},this._classStyle=null,this._cachedTextFormat=this.element.style.cssText=null},u.prototype.setStyle=function(t,e){var i;0==t.indexOf("padding")?this.setPxStyle(t,e):(this._styles.hasOwnProperty(t)||this.constructor._defaultStyles&&this.constructor._defaultStyles.hasOwnProperty(t)?(this._styles[t]=e,"backgroundAlpha"===t&&m.setBackgroundAlpha(this,e)):(m.setStyle(this.element,t,e),i=this.getStyle("backgroundAlpha"),"backgroundColor"!==t||I(i)||1==i||m.setBackgroundAlpha(this,i)),this.styleChanged(t))},u.prototype.setPxStyle=function(t,e){this._styles.hasOwnProperty(t)||this.constructor._defaultStyles&&this.constructor._defaultStyles.hasOwnProperty(t)?this._styles[t]=e:m.setPxStyle(this.element,t,e),this.styleChanged(t)},u.prototype.getStyle=function(t){if(0==t.indexOf("padding"))return this.getSizeStyle(t);if(this._styles.hasOwnProperty(t))return this._styles[t];if(this._classStyle){if(this._classStyle._styles&&this._classStyle._styles.hasOwnProperty(t))return this._classStyle._styles[t];if(this._classStyle instanceof u&&!p(this._classStyle.getStyle(t)))return this._classStyle.getStyle(t);if(this._classStyle.constructor&&this._classStyle.constructor._defaultStyles&&this._classStyle.constructor._defaultStyles.hasOwnProperty(t))return this._classStyle.constructor._defaultStyles[t]}return this.constructor._defaultStyles&&this.constructor._defaultStyles.hasOwnProperty(t)?this.constructor._defaultStyles[t]:m.getStyle(this.element,t)},u.prototype.getSizeStyle=function(t){if(this._styles.hasOwnProperty(t))return parseFloat(this._styles[t]);if(this._classStyle){if(this._classStyle._styles&&this._classStyle._styles.hasOwnProperty(t))return parseFloat(this._classStyle._styles[t]);if(this._classStyle instanceof u&&!p(this._classStyle.getStyle(t)))return this._classStyle.getSizeStyle(t);if(this._classStyle.constructor&&this._classStyle.constructor._defaultStyles&&this._classStyle.constructor._defaultStyles.hasOwnProperty(t))return parseFloat(this._classStyle.constructor._defaultStyles[t])}return this.constructor._defaultStyles&&this.constructor._defaultStyles.hasOwnProperty(t)?parseFloat(this.constructor._defaultStyles[t]):0<=t.indexOf("border")?m.getSizeStyleBorder(this.element,t):m.getSizeStyle(this.element,t)},u.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i,s=this.element,n=m,o=n.getSizeStyle,a=n.getSizeStyleBorder;i=!1,this.getHeight()!=e&&(i=r.useBorderBox||this._useBorderBox?0:o(s,"paddingTop")+o(s,"paddingBottom")+a(s,"borderTopWidth")+a(s,"borderBottomWidth"),n.setPxStyle(s,"height",0<e-i?e-i:0),i=!0),this.getWidth()!=t&&(i=r.useBorderBox||this._useBorderBox?0:o(s,"paddingLeft")+o(s,"paddingRight")+a(s,"borderLeftWidth")+a(s,"borderRightWidth"),n.setPxStyle(s,"width",0<t-i?t-i:0),i=!0),i&&this.invalidateDisplayList()}},u.prototype.move=function(t,e){O(t)||O(e)||(m.setPxStyle(this.element,"left",t),m.setPxStyle(this.element,"top",e))},u.prototype.measureText=function(t){var e=this._cachedTextFormat;return e||(e={},e.font=this.getStyle("fontFamily"),e.size=this.getStyle("fontSize"),e.bold=this.getStyle("fontWeight"),e.underline=this.getStyle("textDecoration"),e.italic=this.getStyle("fontStyle"),e.align=this.getStyle("textAlign"),e.indent=this.getStyle("textIndent"),e.lineHeight=this.getStyle("lineHeight"),e.spacing=this.getStyle("letterSpacing"),this._cachedTextFormat=e),ld.getInstance().measureText(e,t)},u.prototype.getExplicitOrMeasuredWidth=function(){return O(this._explicitWidth)?this.measuredWidth:this._explicitWidth},u.prototype.getExplicitOrMeasuredHeight=function(){return O(this._explicitHeight)?this.measuredHeight:this._explicitHeight},u.prototype.getErrorString=function(){return this._errorString},u.prototype.setErrorString=function(t){var e=this._errorString;this._errorString=t,Ha.getInstance().registerErrorString(this,e,t),this._errorStringChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("errorStringChanged"))},u.prototype.showErrorString=function(){},u.prototype.hitTestPoint=function(t,e){var i=this.element.getBoundingClientRect();return t>=i.left&&t<=i.right&&e>=i.top&&e<=i.bottom},u.prototype.setBorderColorForErrorString=function(){this._errorString&&0!=this._errorString.length?(this._saveOutlineColor&&(this._saveOutlineColor=!1,this._origOutlineColor=this.getStyle("outlineColor"),this._origOutlineWidth=this.getStyle("outlineWidth")),this.setStyle("outlineColor",this._errorColor),this.setStyle("outlineStyle","solid"),this.setStyle("outlineWidth",this._errorWidth),this.setAttr("title",this._errorString)):I(this._origOutlineColor)||(this.setStyle("outlineColor",this._origOutlineColor),this.setStyle("outlineWidth",this._origOutlineWidth),this._saveOutlineColor=!0),this.focus()},u.prototype.getToolTip=function(){return this._toolTip},u.prototype.setToolTip=function(t){this._oldValue=this._toolTip,this._toolTip=t,p(t)?this.element.removeAttribute("title"):this.element.title=t,this.dispatchEvent(new w("toolTipChanged"))},u.prototype.createChildren=function(){var t=this.element,e="Kool__"+this.className;t.className||(t.className=e,this._styleName&&(e=this._styleName,e instanceof kc?m.addClass(t,e._cssName):e.hasOwnProperty("className")?m.addClass(t,"Kool__"+e.className):m.addClass(t,e)))},u.prototype.styleChanged=function(t){this._cachedTextFormat=null,u._super.styleChanged.call(this,t)},u.prototype.commitProperties=function(){u._super.commitProperties.call(this),this._errorStringChanged&&(this._errorStringChanged=!1,this.setBorderColorForErrorString())},u.prototype.addPopUpContextMenu=function(t,e){var i=m.getWindowSize(),s=this._contextMenu.getWidth(),n=this._contextMenu.getHeight(),o=t,a=e;i.l+i.w>s+t&&i.t+i.h<n+e?a=e-n:i.l+i.w<s+t&&i.t+i.h<n+e?(o=t-s,a=e-n):i.l+i.w<s+t&&i.t+i.h>n+e&&(o=t-s),this._contextMenu.getParent()===this&&this.removeChild(this._contextMenu),Ob.addPopUp(this._contextMenu,this,!1),Ob.movePopUp(this._contextMenu,o,a),this._contextMenu.setVisibility(!0),v.documentAddEvent("mousedown",this._contextMenuDocumentMouseDownHandler,this),r.ie8L||v.windowAddEvent("blur",this._contextMenuWindowBlurHandler,this)},u.prototype.removePopUpContextMenu=function(){this._contextMenu&&(Ob.removePopUp(this._contextMenu),this._contextMenu.setVisible(!1),this.addChild(this._contextMenu),v.documentRemoveEvent("mousedown",this._contextMenuDocumentMouseDownHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._contextMenuWindowBlurHandler,this))},u.prototype._contextMenuHandler=function(t){t.target&&(t.target.selfElement instanceof Db||t.target.selfElement instanceof Ta)||t.defaultPrevented||(t.preventDefault(),t.stopPropagation(),this._contextMenu.setVisible(!0),this._contextMenu.setVisibility(!1),(t=v.getEventPageXY(t))&&this.addPopUpContextMenu(t.x,t.y))},u.prototype._contextMenuDocumentMouseDownHandler=function(t){this._contextMenu&&this._contextMenu.getVisible()&&(!t.target||!t.target.selfElement||t.target.selfElement!=this._contextMenu&&t.target.selfElement.getParent()!=this._contextMenu)&&(t.target&&this._contextMenu.element.contains(t.target)||this.removePopUpContextMenu())},u.prototype._contextMenuItemSelectHandler=function(t){this.removePopUpContextMenu(),this.dispatchEvent(t)},u.prototype._contextMenuWindowBlurHandler=function(t){this.removePopUpContextMenu()},z(pa,u),pa.TEXT_WIDTH_PADDING=3,pa.TEXT_HEIGHT_PADDING=1,pa.prototype.getMultiline=function(){return this._multiline},pa.prototype.setMultiline=function(t){this._multiline!=t&&(this._multiline=t,this._multilineChanged=!0,this.invalidateProperties())},pa.prototype.getText=function(){return this._text},pa.prototype.setText=function(t){this._text!=t&&(this._text=t,this._textChanged=!0,this.clearStyle("width"),this.clearStyle("height"),this.invalidateProperties())},pa.prototype.getTextHeight=function(){var t=this.element.style;if(t.height&&"auto"!=t.height){var e=t.height;t.height="auto";var i=m.getOffsetHeight(this.element);return t.height=e,i}return this.getHeight()},pa.prototype.getTextWidth=function(){var t=this.element,e=t.style;return e.width&&"auto"!=e.width?t.scrollWidth>t.offsetWidth?t.scrollWidth:t.offsetWidth:this.getWidth()},pa.prototype.getWordWrap=function(){return this._wordWrap},pa.prototype.setWordWrap=function(t){this._wordWrap!=t&&(this._wordWrap=t,this._wordWrapChanged=!0,this.invalidateProperties())},pa.prototype.getHeight=function(){var t=this.element,e=t.style,i=e.height;return!this._visible||i?this.ignorePadding?r.useBorderBox?this._num(i)-this._num(e.paddingTop)-this._num(e.paddingBottom):this._num(i):r.useBorderBox?this._num(i):this._num(i)+this._num(e.paddingTop)+this._num(e.paddingBottom)+this._num(e.borderTopWidth)+this._num(e.borderBottomWidth):isNaN(this._offsetHeight)&&(this._offsetHeight=m.getOffsetHeight(t),this._text&&0===this._offsetHeight)?(this._offsetHeight=NaN,0):this._offsetHeight},pa.prototype.setHeight=function(t){var e,i=this.element,s=i.style,n=m;this._explicitHeight!=t&&(this._explicitHeight=t,this._offsetHeight=this._offsetWidth=NaN),F(t)&&0<=t.indexOf("%")?n.setStyle(i,"height",t):(e=this.ignorePadding?r.useBorderBox?this._num(s.paddingTop)+this._num(s.paddingBottom):0:r.useBorderBox?0:this._num(s.paddingTop)+this._num(s.paddingBottom)+this._num(s.borderTopWidth)+this._num(s.borderBottomWidth),this._num(s.height)+e!=t&&n.setPxStyle(i,"height",0<t-e?t-e:0))},pa.prototype.getWidth=function(){var t=this.element,e=t.style,i=e.width;return!this._visible||i?this.ignorePadding?r.useBorderBox?this._num(i)-this._num(e.paddingLeft)-this._num(e.paddingRight):this._num(i):r.useBorderBox?this._num(i):this._num(i)+this._num(e.paddingLeft)+this._num(e.paddingRight)+this._num(e.borderLeftWidth)+this._num(e.borderRightWidth):isNaN(this._offsetWidth)&&(this._offsetWidth=m.getOffsetWidth(t),this._text&&0===this._offsetWidth)?(this._offsetWidth=NaN,0):this._offsetWidth},pa.prototype.setWidth=function(t){var e,i=this.element,s=i.style,n=m;this._explicitWidth!=t&&(this._explicitWidth=t,this._offsetHeight=this._offsetWidth=NaN),F(t)&&0<=t.indexOf("%")?n.setStyle(i,"width",t):(e=this.ignorePadding?r.useBorderBox?this._num(s.paddingLeft)+this._num(s.paddingRight):0:r.useBorderBox?0:this._num(s.paddingLeft)+this._num(s.paddingRight)+this._num(s.borderLeftWidth)+this._num(s.borderRightWidth),this._num(s.width)+e!=t&&n.setPxStyle(i,"width",0<t-e?t-e:0))},pa.prototype.truncateToFit=function(){"ellipsis"!=this.getStyle("textOverflow")&&this.setStyle("textOverflow","ellipsis"),this._offsetHeight=this._offsetWidth=NaN},pa.prototype.commitProperties=function(){pa._super.commitProperties.call(this),this._offsetHeight=this._offsetWidth=NaN,this._textChanged&&(this.element.innerHTML=this._text,this._textChanged=!1),this._multilineChanged&&(this._visible?m.setStyle(this.element,"display",this._multiline?"inline-block":"inline"):this._oldDisplay=this._multiline?"inline-block":"inline",this._multilineChanged=!1),this._wordWrapChanged&&(m.setWordWrap(this.element,this._wordWrap),this._wordWrapChanged=!1)},pa.prototype.getExplicitOrMeasuredWidth=function(){return isNaN(this._explicitWidth)?this.getWidth():this._explicitWidth},pa.prototype.getExplicitOrMeasuredHeight=function(){return isNaN(this._explicitHeight)?this.getHeight():this._explicitHeight},pa.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i,s=this.element,r=s.style,n=m;this.getHeight()!=e&&(i=this._num(r.paddingTop)+this._num(r.paddingBottom)+this._num(r.borderTopWidth)+this._num(r.borderBottomWidth),n.setPxStyle(s,"height",0<e-i?e-i:0)),this.getWidth()!=t&&(i=this._num(r.paddingLeft)+this._num(r.paddingRight)+this._num(r.borderLeftWidth)+this._num(r.borderRightWidth),n.setPxStyle(s,"width",0<t-i?t-i:0))}},pa.prototype.notifyStyleChangeInChildren=function(t,e){},pa.prototype.styleChanged=function(t){(p(t)||Tb.sizeInvalidatingStyles[t]||"styleName"==t)&&(this._offsetHeight=this._offsetWidth=NaN)},pa.prototype.validateDisplayList=function(){},pa.prototype._num=function(t){return t=parseFloat(t),isNaN(t)?0:t},H._propertyType={children:Array},z(H,u),H.prototype._defaultProperty="children",H.prototype.getAutoLayout=function(){return this._autoLayout},H.prototype.setAutoLayout=function(t){(this._autoLayout=t)&&(this.invalidateSize(),this.invalidateDisplayList(),(t=this.getParent())&&(t.invalidateSize(),t.invalidateDisplayList()))},H.prototype.getBorderMetrics=function(){return this._border?this._border.getBorderMetrics():m.getBorderMetrics(this)},H.prototype._getFirstChildIndex=function(){return this._firstChildIndex},H.prototype.getHorizontalScrollPolicy=function(){return this._horizontalScrollPolicy},H.prototype.setHorizontalScrollPolicy=function(t){this._horizontalScrollPolicy!=t&&(this._horizontalScrollPolicy=t,t="on"==t?"scroll":"off"==t?"hidden":"auto",this._contentPane?this._contentPane.setStyle("overflowX",t):this.setStyle("overflowX",t),this.invalidateDisplayList())},H.prototype.getHorizontalScrollPosition=function(){return this._contentPane?this._contentPane.element.scrollLeft:this.element.scrollLeft},H.prototype.setHorizontalScrollPosition=function(t){this._contentPane&&(this._contentPane.element.scrollLeft=t),this.element.scrollLeft=t},H.prototype.getIconSrc=function(){return this._iconSrc},H.prototype.setIconSrc=function(t){this._iconSrc=t,this.dispatchEvent(new w("iconSrcChanged"))},H.prototype.getLabel=function(){return this._label},H.prototype.setLabel=function(t){this._label=t,this.dispatchEvent(new w("labelChanged"))},H.prototype.getMaxHorizontalScrollPosition=function(){return this._contentPane?this._contentPane.element.scrollWidth-this._contentPane.element.clientWidth:this.element.scrollWidth-this.element.clientWidth},H.prototype.getMaxVerticalScrollPosition=function(){return this._contentPane?this._contentPane.element.scrollHeight-this._contentPane.element.clientHeight:this.element.scrollHeight-this.element.clientHeight},H.prototype._$getNumChildren=function(){return H._super.getNumChildren.call(this)},H.prototype.getNumChildren=function(){return this._contentPane?this._contentPane.getNumChildren():this._numChildren},H.prototype.getRawChildren=function(){return this._rawChildren||(this._rawChildren=new $c(this)),this._rawChildren},H.prototype.getSelectedIconSrc=function(){return this._selectedIconSrc},H.prototype.setSelectedIconSrc=function(t){this._selectedIconSrc=t,this.dispatchEvent(new w("selectedIconSrcChanged"))},H.prototype._getUsePadding=function(){return!0},H.prototype.getVerticalScrollPolicy=function(){return this._verticalScrollPolicy},H.prototype.setVerticalScrollPolicy=function(t){this._verticalScrollPolicy!=t&&(this._verticalScrollPolicy=t,t="on"==t?"scroll":"off"==t?"hidden":"auto",this._contentPane?this._contentPane.setStyle("overflowY",t):this.setStyle("overflowY",t),this.invalidateDisplayList())},H.prototype.getVerticalScrollPosition=function(){return this._contentPane?this._contentPane.element.scrollTop:this.element.scrollTop},H.prototype.setVerticalScrollPosition=function(t){this._contentPane&&(this._contentPane.element.scrollTop=t),this.element.scrollTop=t},H.prototype.getViewMetrics=function(){var t=this.getBorderMetrics();return this._horizontalScrollBarExist||this._verticalScrollBarExist?(this._viewMetrics?(this._viewMetrics.left=t.left,
this._viewMetrics.right=t.right,this._viewMetrics.top=t.top,this._viewMetrics.bottom=t.bottom):this._viewMetrics=t.clone(),this._verticalScrollBarExist&&(this._viewMetrics.right+=r.getScrollBarWidth()),this._horizontalScrollBarExist&&(this._viewMetrics.bottom+=r.getScrollBarHeight()),this._viewMetrics):t},H.prototype.getViewMetricsAndPadding=function(){if(!(!this._viewMetricsAndPadding||this._horizontalScrollBarExist&&"on"!=this._horizontalScrollPolicy||this._verticalScrollBarExist&&"on"!=this._verticalScrollPolicy))return this._viewMetricsAndPadding;this._viewMetricsAndPadding||(this._viewMetricsAndPadding=new Pc);var t=this._viewMetricsAndPadding,e=this.getViewMetrics(),i=m.getPaddingMetrics(this._contentPane);return t.left=e.left+i.left,t.right=e.right+i.right,t.top=e.top+i.top,t.bottom=e.bottom+i.bottom,t},H.prototype.setVisible=function(t){if(H._super.setVisible.call(this,t),t){var e,i;for(t=0,e=this.getNumChildren();t<e;t++)i=this.getChildAt(t),i instanceof R&&(i instanceof H&&(r.ie&&!r.ie8L||r.edge)&&i._invalidateViewMetricsAndPadding(),i.invalidateSize())}},H.prototype.addChild=function(t){return this.addChildAt(t,this.getNumChildren())},H.prototype.addChildAt=function(t,e){var i=t.getParent();return i&&(i==this&&(e=e==this.getNumChildren()?e-1:e),i.removeChild(t)),this._addingChild(t),this._contentPane?(this._contentPane.addChildAt(t,e),m.setStyle(t,"position","absolute")):this._$addChildAt(t,this._firstChildIndex+e),this._childAdded(t),t},H.prototype._addingChild=function(t){H._super._addingChild.call(this,t),this.invalidateSize(),this.invalidateDisplayList(),this._contentPane||(0==this._numChildren&&(this._firstChildIndex=H._super.getNumChildren.call(this)),this._numChildren++),this._contentPane&&!this._autoLayout&&(this._forceLayout=!0,Ba.getInstance().addEventListener("updateComplete",this._layoutCompleteHandler,this))},H.prototype._childAdded=function(t){H._super._childAdded.call(this,t),this.dispatchEvent(new md(md.CHILD_ADD,(!1),(!1),t)),t.dispatchEvent(new w("add"))},H.prototype.removeChild=function(t){return this._removingChild(t),this._contentPane?this._contentPane.removeChild(t):this._$removeChild(t),this._childRemoved(t),t},H.prototype.removeChildAt=function(t){return this.removeChild(this.getChildAt(t))},H.prototype._removingChild=function(t){H._super._removingChild.call(this,t),t.dispatchEvent(new w("remove")),this.dispatchEvent(new md(md.CHILD_REMOVE,(!1),(!1),t))},H.prototype._childRemoved=function(t){H._super._childRemoved.call(this,t),this.invalidateSize(),this.invalidateDisplayList(),this._contentPane||(this._numChildren--,0==this._numChildren&&(this._firstChildIndex=H._super.getNumChildren.call(this))),this._contentPane&&!this._autoLayout&&(this._forceLayout=!0,Ba.getInstance().addEventListener("updateComplete",this._layoutCompleteHandler,this))},H.prototype.getChildAt=function(t){return this._contentPane?this._contentPane.getChildAt(t):H._super.getChildAt.call(this,this._firstChildIndex+t)},H.prototype.getChildByName=function(t){if(this._contentPane)return this._contentPane.getChildByName(t);if(t=H._super.getChildByName.call(this,t),!t)return null;var e=H._super.getChildIndex.call(this,t)-this._firstChildIndex;return 0>e||e>=this._numChildren?null:t},H.prototype.getChildIndex=function(t){return this._contentPane?this._contentPane.getChildIndex(t):H._super.getChildIndex.call(this,t)-this._firstChildIndex},H.prototype.setChildIndex=function(t,e){var i,s=e;if(this._contentPane)this._contentPane.setChildIndex(t,e);else{if(i=H._super.getChildIndex.call(this,t),e+=this._firstChildIndex,e==i)return;H._super.setChildIndex.call(this,t,e),i-=this._firstChildIndex,s=e-this._firstChildIndex}this.invalidateDisplayList(),this.dispatchEvent(new ac(ac.CHILD_INDEX_CHANGE,(!1),(!1),t,i,s)),this.dispatchEvent(new w("childrenChanged"))},H.prototype.contains=function(t){return this._contentPane?this._contentPane.contains(t):H._super.contains.call(this,t)},H.prototype.swapChildren=function(t,e){this._contentPane?this._contentPane.swapChildren(t,e):H._super.swapChildren.call(this,t,e)},H.prototype.swapChildrenAt=function(t,e){this._contentPane?this._contentPane.swapChildrenAt(t,e):H._super.swapChildrenAt.call(this,t,e)},H.prototype._$getChildAt=function(t){return this.getChildAt(t)},H.prototype._layoutChrome=function(t,e){this._border&&(this._border.move(0,0),this._border.setActualSize(t,e))},H.prototype._createBorder=function(){if(!this._border){var t=this.getStyle("borderSkin");p(t)||(this._border=new t,this._border.name="border",this._border instanceof u&&this._border.setEnabled(this._enabled),this.getRawChildren().addChildAt(this._border,0),this.invalidateDisplayList())}},H.prototype._invalidateViewMetricsAndPadding=function(){this._viewMetricsAndPadding=null},H.prototype._checkScrollBarExist=function(){var t,e;return t="off"!==this._horizontalScrollPolicy&&("on"===this._horizontalScrollPolicy||(this._contentPane?this._contentPane.element.scrollWidth>this._contentPane.element.clientWidth:this.element.scrollWidth>this.element.clientWidth)),e="off"!==this._verticalScrollPolicy&&("on"===this._verticalScrollPolicy||(this._contentPane?this._contentPane.element.scrollHeight>this._contentPane.element.clientHeight:this.element.scrollHeight>this.element.clientHeight)),(t!=this._horizontalScrollBarExist||e!=this._verticalScrollBarExist)&&(this._horizontalScrollBarExist=t,this._verticalScrollBarExist=e,this._invalidateViewMetricsAndPadding(),!0)},H.prototype.createChildren=function(){H._super.createChildren.call(this),this._createBorder(),this._autoLayout||(this._forceLayout=!0),Ba.getInstance().addEventListener("updateComplete",this._layoutCompleteHandler,this),this._numChildrenCreated=this.getNumChildren(),this.setStyle("position","absolute"),this.setStyle("overflow","hidden"),this.setStyle("outline","none")},H.prototype.commitProperties=function(){H._super.commitProperties.call(this),this._changedStyles&&(H._super.notifyStyleChangeInChildren.call(this,"<MULTIPLE>"==this._changedStyles?null:this._changedStyles,!0),this._changedStyles=null)},H.prototype.validateSize=function(t){var e,i;if(this._autoLayout||this._forceLayout)H._super.validateSize.call(this,t);else if(t)for(t=0,e=this.getNumChildren();t<e;t+=1)i=this.getChildAt(t),i instanceof R&&i.validateSize(!0)},H.prototype.validateDisplayList=function(){this._checkScrollBarExist(),(this._autoLayout||this._forceLayout)&&(this._doingLayout=!0,H._super.validateDisplayList.call(this),this._checkScrollBarExist()&&(this._layoutObject&&this._layoutObject.updateDisplayList(this._unscaledWidth,this._unscaledHeight),this._checkScrollBarExist()),this._doingLayout=!1)},H.prototype.updateDisplayList=function(t,e){var i=this._contentPane,s=!1;if(H._super.updateDisplayList.call(this,t,e),this._layoutChrome(t,e),i){if(0<t&&0<e?s=!0:(0>=t||0>=e)&&(s=!1),m.setVisibility(this._contentPane,s),!s)return;s=this.getBorderMetrics(),i.setX(0),i.setY(0),i.setWidth(t-s.left-s.right),i.setHeight(e-s.top-s.bottom)}i&&("auto"==this._horizontalScrollPolicy&&this._horizontalScrollBarExist||"auto"==this._verticalScrollPolicy&&this._verticalScrollBarExist)&&i.element.style.setProperty&&(i.element.style.display="none",i.element.style.display="")},H.prototype.notifyStyleChangeInChildren=function(t,e){var i,s=this._numChildren;for(i=0;i<s;i++)if(this._contentPane||i<this._firstChildIndex||i>=this._firstChildIndex+this._numChildren){var r=H._super.getChildAt.call(this,i);r&&(r.styleChanged(t),r instanceof R&&r.notifyStyleChangeInChildren(t,e))}e&&(this._changedStyles=!p(this._changedStyles)||p(t)?"<MULTIPLE>":t,this.invalidateProperties())},H.prototype.styleChanged=function(t){(p(t)||Tb.sizeInvalidatingStyles[t]||"styleName"==t)&&this._invalidateViewMetricsAndPadding(),H._super.styleChanged.call(this,t)},H.prototype.getSizeStyle=function(t){return 0==t.indexOf("padding")&&this._contentPane?this._contentPane.getSizeStyle(t):H._super.getSizeStyle.call(this,t)},H.prototype.setPxStyle=function(t,e){0==t.indexOf("padding")&&this._contentPane?(this._contentPane.setPxStyle(t,e),this.styleChanged(t)):H._super.setPxStyle.call(this,t,e)},H.prototype.contentToGlobal=function(t){return this._contentPane?this._contentPane.localToGlobal(t):this.localToGlobal(t)},H.prototype.globalToContent=function(t){return this._contentPane?this._contentPane.globalToLocal(t):this.globalToLocal(t)},H.prototype.contentToLocal=function(t){return this._contentPane?this.globalToLocal(this.contentToGlobal(t)):t},H.prototype.localToContent=function(t){return this._contentPane?this.globalToContent(this.localToGlobal(t)):t},H.prototype.getChildren=function(){var t,e,i=[];for(e=this.getNumChildren(),t=0;t<e;t++)i.push(this.getChildAt(t));return i},H.prototype.removeAllChildren=function(){for(;0<this.getNumChildren();)this.removeChildAt(0)},H.prototype._rawChildren_addChild=function(t){return 0==this._numChildren&&this._firstChildIndex++,H._super._addingChild.call(this,t),this._$addChild(t),H._super._childAdded.call(this,t),this.dispatchEvent(new w("childrenChanged")),t},H.prototype._rawChildren_addChildAt=function(t,e){return this._firstChildIndex<e&&e<this._firstChildIndex+this._numChildren+1?this._numChildren++:e<=this._firstChildIndex&&this._firstChildIndex++,H._super._addingChild.call(this,t),this._$addChildAt(t,e),H._super._childAdded.call(this,t),this.dispatchEvent(new w("childrenChanged")),t},H.prototype._rawChildren_removeChild=function(t){return t=this._rawChildren_getChildIndex(t),this._rawChildren_removeChildAt(t)},H.prototype._rawChildren_removeChildAt=function(t){var e=H._super.getChildAt.call(this,t);return H._super._removingChild.call(this,e),this._$removeChildAt(t),H._super._childRemoved.call(this,e),this._firstChildIndex<t&&t<this._firstChildIndex+this._numChildren?this._numChildren--:(0==this._numChildren||t<this._firstChildIndex)&&this._firstChildIndex--,this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("childrenChanged")),e},H.prototype._rawChildren_getChildAt=function(t){return H._super.getChildAt.call(this,t)},H.prototype._rawChildren_getChildByName=function(t){return H._super.getChildByName.call(this,t)},H.prototype._rawChildren_getChildIndex=function(t){return H._super.getChildIndex.call(this,t)},H.prototype._rawChildren_setChildIndex=function(t,e){var i=H._super.getChildIndex.call(this,t);H._super.setChildIndex.call(this,t,e),i<this._firstChildIndex&&e>=this._firstChildIndex?this._firstChildIndex--:i>=this._firstChildIndex&&e<=this._firstChildIndex&&this._firstChildIndex++,this.dispatchEvent(new w("childrenChanged"))},H.prototype._rawChildren_contains=function(t){return H._super.contains.call(this,t)},H.prototype._layoutCompleteHandler=function(t){Ba.getInstance().removeEventListener("updateComplete",this._layoutCompleteHandler,this),this._forceLayout=!1},H.prototype._scrollHandler=function(t){t=new ma(ma.SCROLL,(!1),(!1),(!1),0,"vertical",t.delta,t),t.detail=!1,this._contentPane?this._oldScrollTop!=this._contentPane.scrollTop?t.position=this._contentPane.scrollTop:this._oldScrollLeft!=this._contentPane.scrollLeft&&(t.position=this._contentPane.scrollLeft,t.direction="horizontal"):this._oldScrollTop!=this.element.scrollTop?t.position=this.element.scrollTop:this._oldScrollLeft!=this.element.scrollLeft&&(t.position=this.element.scrollLeft,t.direction="horizontal"),this.dispatchEvent(t),this._oldScrollTop=this._contentPane?this._contentPane.scrollTop:this.element.scrollTop,this._oldScrollLeft=this._contentPane?this._contentPane.scrollLeft:this.element.scrollLeft},z(jb,u),jb.prototype.getBorderMetrics=function(){return this._border?this._border:Pc.EMPTY},jb.prototype.getHorizontalScrollPolicy=function(){return this._horizontalScrollPolicy},jb.prototype.setHorizontalScrollPolicy=function(t){t=t.toLowerCase(),this._horizontalScrollPolicy!=t&&(this._horizontalScrollPolicy=t,this.invalidateDisplayList())},jb.prototype.getHorizontalScrollPosition=function(){return this._horizontalScrollPosition},jb.prototype.setHorizontalScrollPosition=function(t){this._horizontalScrollPosition=t,this._horizontalScrollBar&&this._horizontalScrollBar.setScrollPosition(t)},jb.prototype.getMaxHorizontalScrollPosition=function(){return isNaN(this._maxHorizontalScrollPosition)?this._horizontalScrollBar?this._horizontalScrollBar.getMaxScrollPosition():0:this._maxHorizontalScrollPosition},jb.prototype.setMaxHorizontalScrollPosition=function(t){this._maxHorizontalScrollPosition=t},jb.prototype.getMaxVerticalScrollPosition=function(){return isNaN(this._maxVerticalScrollPosition)?this._verticalScrollBar?this._verticalScrollBar.getMaxScrollPosition():0:this._maxVerticalScrollPosition},jb.prototype.setMaxVerticalScrollPosition=function(t){this._maxVerticalScrollPosition=t},jb.prototype.getVerticalScrollPolicy=function(){return this._verticalScrollPolicy},jb.prototype.setVerticalScrollPolicy=function(t){t=t.toLowerCase(),this._verticalScrollPolicy!=t&&(this._verticalScrollPolicy=t,this.invalidateDisplayList())},jb.prototype.getVerticalScrollPosition=function(){return this._verticalScrollPosition},jb.prototype.setVerticalScrollPosition=function(t){this._verticalScrollPosition=t,this._verticalScrollBar&&this._verticalScrollBar.setScrollPosition(t)},jb.prototype.getViewMetrics=function(){return this._viewMetrics=this.getBorderMetrics().clone(),this._horizontalScrollBar||"on"!=this._horizontalScrollPolicy||(this._createHScrollBar(!0),this._horizontalScrollBar.addEventListener("scroll",this._scrollHandler,this),this._horizontalScrollBar.addEventListener("scroll",this._scrollTipHandler,this),this._horizontalScrollBar.setScrollPosition(this._horizontalScrollPosition),this.invalidateDisplayList()),this._verticalScrollBar||"on"!=this._verticalScrollPolicy||(this._createVScrollBar(!0),this._verticalScrollBar.addEventListener("scroll",this._scrollHandler,this),this._verticalScrollBar.addEventListener("scroll",this._scrollTipHandler,this),this._verticalScrollBar.setScrollPosition(this._verticalScrollPosition),this.invalidateDisplayList()),this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this._viewMetrics.right+=this._verticalScrollBar.getMinWidth()),this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this._viewMetrics.bottom+=this._horizontalScrollBar.getMinHeight()),this._viewMetrics},jb.prototype._roomForScrollBar=function(t,e,i){var s=this.getBorderMetrics();return e>=t.getMinWidth()+s.left+s.right&&i>=t.getMinHeight()+s.top+s.bottom},jb.prototype._setScrollBarProperties=function(t,e,i,s,r,n){var o=this._horizontalScrollPolicy,a=this._verticalScrollPolicy;this._scrollAreaChanged=!1,"on"==o||e<t&&0<t&&"auto"==o?(this._horizontalScrollBar||(this._createHScrollBar(!1),this._horizontalScrollBar.addEventListener("scroll",this._scrollHandler,this),this._horizontalScrollBar.addEventListener("scroll",this._scrollTipHandler,this),this._horizontalScrollBar.setScrollPosition(this._horizontalScrollPosition)),o=this._roomForScrollBar(this._horizontalScrollBar,this.getWidth(),this.getHeight()),o!=this._horizontalScrollBar.getVisible()&&(this._horizontalScrollBar.setVisible(o),this._scrollAreaChanged=!0),r&&(this._horizontalScrollBar.setLockedColumnCount(n),this._horizontalScrollBar.setColumnArray(r)),this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this._numberOfCols!=t||this._viewableColumns!=e||this._scrollAreaChanged)&&(r?this._horizontalScrollBar._correctedPageSize=e:this._horizontalScrollBar.setScrollProperties(e,0,t-e),this._horizontalScrollBar.getScrollPosition()!=this._horizontalScrollPosition&&this._horizontalScrollBar.setScrollPosition(this._horizontalScrollPosition),this._viewableColumns=e,this._numberOfCols=t)):("auto"==o||"off"==o)&&this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this.setHorizontalScrollPosition(0),this._horizontalScrollBar.setScrollProperties(e,0,0),this._horizontalScrollBar.setVisible(!1),this._viewableColumns=NaN,this._scrollAreaChanged=!0),"on"==a||s<i&&0<i&&"auto"==a?(this._verticalScrollBar||(this._createVScrollBar(!1),this._verticalScrollBar.addEventListener("scroll",this._scrollHandler,this),this._verticalScrollBar.addEventListener("scroll",this._scrollTipHandler,this),this._verticalScrollBar.setScrollPosition(this._verticalScrollPosition)),o=this._roomForScrollBar(this._verticalScrollBar,this.getWidth(),this.getHeight()),o!=this._verticalScrollBar.getVisible()&&(this._verticalScrollBar.setVisible(o),this._scrollAreaChanged=!0),this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this._numberOfRows!=i||this._viewableRows!=s||this._scrollAreaChanged)&&(this._verticalScrollBar.setScrollProperties(s,0,i-s),this._verticalScrollBar.getScrollPosition()!=this._verticalScrollPosition&&this._verticalScrollBar.setScrollPosition(this._verticalScrollPosition),this._viewableRows=s,this._numberOfRows=i)):("auto"==a||"off"==a)&&this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this.setVerticalScrollPosition(0),this._verticalScrollBar.setScrollProperties(s,0,0),this._verticalScrollBar.setVisible(!1),this._viewableRows=NaN,this._scrollAreaChanged=!0),this._scrollAreaChanged&&this.updateDisplayList(this._unscaledWidth,this._unscaledHeight)},jb.prototype._createHScrollBar=function(t){return this._horizontalScrollBar=new Ec,this._horizontalScrollBar.setVisible(t),this._horizontalScrollBar.setEnabled(this.getEnabled()),this.addChild(this._horizontalScrollBar),this._horizontalScrollBar.invalidateDisplayList(),this._horizontalScrollBar},jb.prototype._createVScrollBar=function(t){return this._verticalScrollBar=new $d,this._verticalScrollBar.setVisible(t),this._verticalScrollBar.setEnabled(this.getEnabled()),this.addChild(this._verticalScrollBar),this._verticalScrollBar.invalidateDisplayList(),this._verticalScrollBar},jb.prototype._createBorder=function(){this._border||(this._border=m.getBorderMetrics(this))},jb.prototype.createChildren=function(){jb._super.createChildren.call(this),this._createBorder()},jb.prototype.styleChanged=function(t){jb._super.styleChanged.call(this,t),t&&0<=t.indexOf("border")&&0>t.indexOf("Color")&&(this._border=null,this._initialized&&this._createBorder())},jb.prototype.updateDisplayList=function(t,e){jb._super.updateDisplayList.call(this,t,e);var i=this._viewMetrics=this.getViewMetrics();this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this._horizontalScrollBar.setActualSize(t-i.left-i.right,this._horizontalScrollBar.getMinHeight()),this._horizontalScrollBar.move(0,e-i.bottom-i.top),this._horizontalScrollBar.setEnabled(this.getEnabled())),this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this._verticalScrollBar.setActualSize(this._verticalScrollBar.getMinWidth(),e-i.top-i.bottom),this._verticalScrollBar.move(t-i.right-i.left,0),this._verticalScrollBar.setEnabled(this.getEnabled()))},jb.prototype._scrollHandler=function(t){if("scroll"==t.type){var e,i=t.target.selfElement.getScrollPosition();"vertical"===t.direction?e="_verticalScrollPosition":"horizontal"==t.direction&&(e="_horizontalScrollPosition"),this.dispatchEvent(t),e&&(this[e]=i)}},jb.prototype._scrollTipHandler=function(t){if("scroll"==t.type&&this.showScrollTips)if(t.detail){t=t.target.selfElement;var e=t==this._verticalScrollBar,i=e?"vertical":"horizontal",s=t.getScrollPosition();this._scrollTip||(this._scrollTip=new Qc,document.body.appendChild(this._scrollTip.element),this._scrollTip.setNestLevel(1),this._scrollTip.initialize(),this._oldTTMEnabled=Ha.getInstance().enabled,Ha.getInstance().enabled=!1);var r=(s+1).toString();null!=this.scrollTipFunction&&(r=this.scrollTipFunction(i,s)),""==r?this._scrollTip.setVisible(!1):(this._scrollTip.setText(r),Ha.getInstance().sizeTip(this._scrollTip),i=new ra,e?(i.x=-3-this._scrollTip.getWidth(),i.y=(t.getHeight()-this._scrollTip.getHeight())/2):(i.x=(t.getWidth()-this._scrollTip.getWidth())/2,i.y=-1-this._scrollTip.getHeight()),i=t.localToGlobal(i),this._scrollTip.move(i.x,i.y),this._scrollTip.setVisible(!0))}else this._scrollTip&&(document.body.removeChild(this._scrollTip.element),this._scrollTip=null,Ha.getInstance().enabled=this._oldTTMEnabled)};var hd=function(t){this.className=this.className?this.className:"CursorError",this.message=0<arguments.length?t:null};hd.prototype=Error.prototype;var ca=function(t){this.className=this.className?this.className:"ItemPendingError",this.message=0<arguments.length?t:null};ca.prototype=Error.prototype,ca.prototype.getResponders=function(){return this._responders},ca.prototype.addResponder=function(t){this._responders||(this._responders=[]),this._responders.push(t)};var vc=function(t){this.className=this.className?this.className:"RangeError",this.message=0<arguments.length?t:null};vc.prototype=Error.prototype;var de=function(t){this.className=this.className?this.className:"SortError",this.message=0<arguments.length?t:null};de.prototype=Error.prototype;var Lb={isDragging:!1,_dragProxy:null,doDrag:function(t,e,i,s){if(s=!(3<arguments.length)||s,!Lb.isDragging){Lb.isDragging=!0;var r=t.uno;p(r)||(Lb._dragProxy={uno:r,ds:e,am:s},i.dataTransfer.clearData("Text"),i.dataTransfer.setData("Text",r.toString()))}},getDragSource:function(t){return!p(t)&&Lb._dragProxy&&Lb._dragProxy.uno==t?Lb._dragProxy:null},endDrag:function(t){Lb.isDragging=!1,Lb._dragProxy=null}},Sa={elementNo:0,eventNo:0,zIndex:3450,uid:0,cache:{},stores:{},insert:function(t,e,i,s){var r;t==document?(r="document",Sa.cache[r]||(Sa.cache[r]={elem:t,events:[]})):t==window?(r="window",Sa.cache[r]||(Sa.cache[r]={elem:t,events:[]})):I(t.euid)?(r="Kool__"+Sa.uid++,t.euid=r,Sa.cache[r]={elem:t,events:[]}):r=t.euid,Sa.cache[r].events.push({type:e,listener:i,context:s.context,useCapture:s.useCapture,priority:s.priority})},clean:function(){var t,e,i,s,r=Sa.cache;for(t in r){for(s=r[t],e=s.events.length-1;-1<e;--e)i=s.events[e],s.elem==document?v.documentRemoveEvent(i.type,i.listener,i.context,i.useCapture,i.priority):s.elem==window?v.windowRemoveEvent(i.type,i.listener,i.context,i.useCapture,i.priority):v.removeEvent(s.elem,i.type,i.listener,i.context,i.useCapture,i.priority);s.elem=s.events=null}Sa.cache={},v.docuemntEvent={},v.windowEvent={},V.uidDictionary={}},remove:function(t,e){var i,s,r,n,o,a,l;if(t){if(t instanceof A&&(t=t.element),r=Sa.cache[t.euid],0<t.childNodes.length)for(i=t.childNodes.length-1;-1<i;)Sa.remove(t.childNodes[i]),i--;if(r){for(i=r.events.length-1;-1<i;)a=r.events[i],v.removeEvent(r.elem,a.type,a.listener,a.context,a.useCapture,a.priority),r.events[i]=null,i--;if(r.elem.selfElement&&r.elem.selfElement._eventList)for(o in l=r.elem.selfElement._eventList)for(s=l[o].length-1;-1<s;--s)a=l[o][s],r.elem.selfElement.removeEventListener(o,a.listener,a.context,a.useCapture);r.events=r.elem=o=null}Sa.cache[t.euid]=null;try{delete Sa.cache[t.euid],t.euid=void 0}catch(h){}for(i=t.childNodes.length-1;0<=i;--i){if(r=t.childNodes[i],r.euid&&r.events){for(n in r.events)for(a=r.events[n],s=a.length-1;-1<s;--s)v.removeEvent(r,n,a.listener,a.context,a.useCapture,a.priority);if(r.selfElement&&r.selfElement._eventList){l=r.selfElement._eventList;for(o in l)for(s=l[o].length-1;-1<s;--s)a=l[o][s],r.selfElement.removeEventListener(o,a.listener,a.context,a.useCapture);o=null}r.events=null,Sa.cache[r.euid]=null;try{delete Sa.cache[r.euid],r.euid=void 0}catch(h){}}t.removeChild(r)}"CANVAS"==t.tagName&&lc.getInstance().freeElement(t),e&&t.parentNode&&t.parentNode.removeChild(t)}}},Ba=function(){wa.call(this),this.className="LayoutManager",this.name=this.className+this.uno,this._updateCompleteQueue=new Wc,this._invalidatePropertiesQueue=new Wc,this._invalidateSizeQueue=new Wc,this._invalidateDisplayListQueue=new Wc,this._callLaterPending=this._usePhasedInstantiation=this._invalidateDisplayListFlag=this._invalidateClientSizeFlag=this._invalidateSizeFlag=this._invalidateClientPropertiesFlag=this._invalidatePropertiesFlag=!1,this._targetLevel=Number.MAX_VALUE};z(Ba,wa),Ba.getInstance=function(){return Ba._instance||(Ba._instance=new Ba),Ba._instance},Ba.prototype.getUsePhasedInstantiation=function(){return this._usePhasedInstantiation},Ba.prototype.setUsePhasedInstantiation=function(t){this._usePhasedInstantiation!=t&&(this._usePhasedInstantiation=t)},Ba.prototype.invalidateProperties=function(t){var e=this;e._invalidatePropertiesFlag||(e._invalidatePropertiesFlag=!0,e._callLaterPending||(e._callLaterObject?e._callLaterObject.callLater(function(){e._doPhasedInstantiation()}):(e._callLaterObject=new u,e._callLaterObject.callLater(function(){e._waitAFrame()})),e._callLaterPending=!0)),e._targetLevel<=t._nestLevel&&(e._invalidateClientPropertiesFlag=!0),e._invalidatePropertiesQueue.addObject(t,t._nestLevel)},Ba.prototype.invalidateSize=function(t){var e=this;e._invalidateSizeFlag||(e._invalidateSizeFlag=!0,e._callLaterPending||(e._callLaterObject?e._callLaterObject.callLater(function(){e._doPhasedInstantiation()}):(e._callLaterObject=new u,e._callLaterObject.callLater(function(){e._waitAFrame()})),e._callLaterPending=!0)),e._targetLevel<=t._nestLevel&&(e._invalidateClientSizeFlag=!0),e._invalidateSizeQueue.addObject(t,t._nestLevel)},Ba.prototype.invalidateDisplayList=function(t){var e=this;e._invalidateDisplayListFlag||(e._invalidateDisplayListFlag=!0,e._callLaterPending||(e._callLaterObject?e._callLaterObject.callLater(function(){e._doPhasedInstantiation()}):(e._callLaterObject=new u,e._callLaterObject.callLater(function(){e._waitAFrame()})),e._callLaterPending=!0)),e._invalidateDisplayListQueue.addObject(t,t._nestLevel)},Ba.prototype._validateProperties=function(){for(var t=this._invalidatePropertiesQueue.removeSmallest();t;)t.validateProperties(),t._updateCompletePendingFlag||(this._updateCompleteQueue.addObject(t,t._nestLevel),t._updateCompletePendingFlag=!0),t=this._invalidatePropertiesQueue.removeSmallest();this._invalidatePropertiesQueue.isEmpty()&&(this._invalidatePropertiesFlag=!1)},Ba.prototype._validateSize=function(){for(var t=this._invalidateSizeQueue.removeLargest();t;)t.validateSize(),t._updateCompletePendingFlag||(this._updateCompleteQueue.addObject(t,t._nestLevel),t._updateCompletePendingFlag=!0),t=this._invalidateSizeQueue.removeLargest();this._invalidateSizeQueue.isEmpty()&&(this._invalidateSizeFlag=!1)},Ba.prototype._validateDisplayList=function(){for(var t=this._invalidateDisplayListQueue.removeSmallest();t;)t.validateDisplayList(),t._updateCompletePendingFlag||(this._updateCompleteQueue.addObject(t,t._nestLevel),t._updateCompletePendingFlag=!0),t=this._invalidateDisplayListQueue.removeSmallest();this._invalidateDisplayListQueue.isEmpty()&&(this._invalidateDisplayListFlag=!1)},Ba.prototype._doPhasedInstantiation=function(){var t=this;if(t._usePhasedInstantiation?t._invalidatePropertiesFlag?t._validateProperties():t._invalidateSizeFlag?t._validateSize():t._invalidateDisplayListFlag&&t._validateDisplayList():(t._invalidatePropertiesFlag&&t._validateProperties(),t._invalidateSizeFlag&&t._validateSize(),t._invalidateDisplayListFlag&&t._validateDisplayList()),t._invalidatePropertiesFlag||t._invalidateSizeFlag||t._invalidateDisplayListFlag)t._callLaterObject.callLater(function(){t._doPhasedInstantiation()});else{t.setUsePhasedInstantiation(!1),t._callLaterPending=!1;for(var e=t._updateCompleteQueue.removeLargest();e;)!e.getInitialized()&&e.getProcessedDescriptors()&&e.setInitialized(!0),e.dispatchEvent(new w("updateComplete")),e._updateCompletePendingFlag=!1,e=t._updateCompleteQueue.removeLargest();t.dispatchEvent(new w("updateComplete"))}},Ba.prototype.validateNow=function(){if(!this._usePhasedInstantiation)for(var t=0;this._callLaterPending&&100>t++;)this._doPhasedInstantiation()},Ba.prototype.validateClient=function(t,e){e=1<arguments.length&&e;var i,s=!1,r=this._targetLevel;if(t._useDelayInvalidate){for(this._targetLevel==Number.MAX_VALUE&&(this._targetLevel=t._nestLevel);!s;){for(s=!0,i=this._invalidatePropertiesQueue.removeSmallestChild(t);i;)i.validateProperties(),i._updateCompletePendingFlag||(this._updateCompleteQueue.addObject(i,i._nestLevel),i._updateCompletePendingFlag=!0),i=this._invalidatePropertiesQueue.removeSmallestChild(t);for(this._invalidatePropertiesQueue.isEmpty()&&(this._invalidateClientPropertiesFlag=this._invalidatePropertiesFlag=!1),i=this._invalidateSizeQueue.removeLargestChild(t);i;){if(i.validateSize(),i._updateCompletePendingFlag||(this._updateCompleteQueue.addObject(i,i._nestLevel),i._updateCompletePendingFlag=!0),this._invalidateClientPropertiesFlag&&(i=this._invalidatePropertiesQueue.removeSmallestChild(t))){this._invalidatePropertiesQueue.addObject(i,i._nestLevel),s=!1;break}i=this._invalidateSizeQueue.removeLargestChild(t)}if(this._invalidateSizeQueue.isEmpty()&&(this._invalidateClientSizeFlag=this._invalidateSizeFlag=!1),!e){for(i=this._invalidateDisplayListQueue.removeSmallestChild(t);i;){if(i.validateDisplayList(),i._updateCompletePendingFlag||(this._updateCompleteQueue.addObject(i,i._nestLevel),i._updateCompletePendingFlag=!0),this._invalidateClientPropertiesFlag&&(i=this._invalidatePropertiesQueue.removeSmallestChild(t))){this._invalidatePropertiesQueue.addObject(i,i._nestLevel),s=!1;break}if(this._invalidateClientSizeFlag&&(i=this._invalidateSizeQueue.removeLargestChild(t))){this._invalidateSizeQueue.addObject(i,i._nestLevel),s=!1;break}i=this._invalidateDisplayListQueue.removeSmallestChild(t)}this._invalidateDisplayListQueue.isEmpty()&&(this._invalidateDisplayListFlag=!1)}}if(r==Number.MAX_VALUE&&(this._targetLevel=Number.MAX_VALUE,!e))for(i=this._updateCompleteQueue.removeLargestChild(t);i;)i.getInitialized()||i.setInitialized(!0),i.dispatchEvent(new w("updateComplete")),i._updateCompletePendingFlag=!1,i=this._updateCompleteQueue.removeLargestChild(t)}else t.validateProperties(),t.validateSize(),e||t.validateDisplayList()},Ba.prototype.isInvalid=function(){return this._invalidatePropertiesFlag||this._invalidateSizeFlag||this._invalidateDisplayListFlag},Ba.prototype._waitAFrame=function(){var t=this;t._callLaterObject.callLater(function(){t._doPhasedInstantiation()})},Ob.createPopUp=function(t,e,i,s){return e=new e,this.addPopUp(e,t,i,s),e},Ob.centerPopUp=function(t){var e=t.element.parentNode.selfElement;e&&(0==e.getWidth()||0==e.getHeight()?(e.setStyle("left","50%"),e.setStyle("top","50%"),t.setStyle("left","50%"),t.setStyle("top","50%"),t.setStyle("marginLeft","-"+t.getWidth()/2+"px"),t.setStyle("marginTop","-"+t.getHeight()/2+"px")):(e.setStyle("left","50%"),e.setStyle("top","50%"),e.setStyle("marginLeft","-"+e.getWidth()/2+"px"),e.setStyle("marginTop","-"+e.getHeight()/2+"px")),e instanceof R&&(e.invalidateProperties(),e.invalidateDisplayList()))},Ob.movePopUp=function(t,e,i){t&&t.element&&t.element.parentNode&&(t.element.parentNode.style.left=e+"px",t.element.parentNode.style.top=i+"px")},Ob.addPopUp=function(t,e,i,s){t.setStyle("position","absolute");var r;e=document.body;var n=new u("div","Root");if(n.setStyle("position","absolute"),n.setX(0),n.setY(0),s)for(r in s)n.element.style[r]=s[r];n.addChild(t),1==i?(t=new u("div","PopUp_ModalDiv"),e.appendChild(t.element),t.setNestLevel(1),t.initialize(),t.addChild(n)):e.appendChild(n.element),n.invalidateProperties(),n.invalidateDisplayList(),n.setNestLevel(1),n.initialize()},Ob.removePopUp=function(t){t&&t.element&&t.element.parentNode&&t.element.parentNode.parentNode&&"Kool__PopUp_ModalDiv"==t.element.parentNode.parentNode.className?t.element.parentNode.parentNode.parentNode.removeChild(t.element.parentNode.parentNode):t&&t.element&&t.element.parentNode&&t.element.parentNode.parentNode&&t.element.parentNode.parentNode.removeChild(t.element.parentNode)},Ob.bringToFront=function(t){t&&t.element&&t.element.parentNode&&t.element.parentNode.parentNode&&"Kool__PopUp_ModalDiv"==t.element.parentNode.parentNode.className?m.setStyle(t.element.parentNode.parentNode,"zIndex",Sa.zIndex++):t&&t.element&&t.element.parentNode&&m.setStyle(t.element.parentNode,"zIndex",Sa.zIndex++)};var Wc=function(){this.className="PriorityQueue",this._arrayOfArrays=[],this._minPriority=0,this._maxPriority=-1};Wc.prototype.addObject=function(t,e){this._arrayOfArrays[e]||(this._arrayOfArrays[e]=[]),
this._arrayOfArrays[e].push(t),this._maxPriority<this._minPriority?this._minPriority=this._maxPriority=e:(e<this._minPriority&&(this._minPriority=e),e>this._maxPriority&&(this._maxPriority=e))},Wc.prototype.removeLargest=function(){var t=null;if(this._minPriority<=this._maxPriority){for(;!this._arrayOfArrays[this._maxPriority]||0==this._arrayOfArrays[this._maxPriority].length;)if(this._maxPriority--,this._maxPriority<this._minPriority)return null;for(t=this._arrayOfArrays[this._maxPriority].shift();!(this._arrayOfArrays[this._maxPriority]&&0!=this._arrayOfArrays[this._maxPriority].length||(this._maxPriority--,this._maxPriority<this._minPriority)););}return t},Wc.prototype.removeLargestChild=function(t){for(var e,i,s=null,r=this._maxPriority,n=t._nestLevel;n<=r;)if(this._arrayOfArrays[r]&&0<this._arrayOfArrays[r].length){if(r==t._nestLevel){if(e=Ra.indexOf(this._arrayOfArrays[r],t),0<=e){s=this._arrayOfArrays[r][e],this._arrayOfArrays[r].splice(e,1);break}}else if(0<t.element.children.length)for(e=0,i=this._arrayOfArrays[r].length;e<i;e++)if(this._contains(t,this._arrayOfArrays[r][e]))return s=this._arrayOfArrays[r][e],this._arrayOfArrays[r].splice(e,1),s;r--}else if(r==this._maxPriority&&this._maxPriority--,r--,r<n)break;return s},Wc.prototype.removeSmallest=function(t){if(t=null,this._minPriority<=this._maxPriority){for(;!this._arrayOfArrays[this._minPriority]||0==this._arrayOfArrays[this._minPriority].length;)if(this._minPriority++,this._minPriority>this._maxPriority)return null;for(t=this._arrayOfArrays[this._minPriority].shift();!(this._arrayOfArrays[this._minPriority]&&0!=this._arrayOfArrays[this._minPriority].length||(this._minPriority++,this._minPriority>this._maxPriority)););}return t},Wc.prototype.removeSmallestChild=function(t){for(var e,i,s=null,r=t._nestLevel;r<=this._maxPriority;)if(this._arrayOfArrays[r]&&0<this._arrayOfArrays[r].length){if(r==t._nestLevel){if(e=Ra.indexOf(this._arrayOfArrays[r],t),0<=e){s=this._arrayOfArrays[r][e],this._arrayOfArrays[r].splice(e,1);break}}else if(0<t.element.children.length)for(e=0,i=this._arrayOfArrays[r].length;e<i;e++)if(this._contains(t,this._arrayOfArrays[r][e]))return s=this._arrayOfArrays[r][e],this._arrayOfArrays[r].splice(e,1),s;r++}else if(r==this._minPriority&&this._minPriority++,r++,r>this._maxPriority)break;return s},Wc.prototype.removeAll=function(){this._arrayOfArrays.splice(0,this._arrayOfArrays.length),this._minPriority=0,this._maxPriority=-1},Wc.prototype.isEmpty=function(){return this._minPriority>this._maxPriority},Wc.prototype._contains=function(t,e){return t.getRawChildren?t.getRawChildren().contains(e):t instanceof A?t.contains(e):t===e};var B={resources:{"ko-KR":{shared:{dateFormat:"YYYY/MM/DD",monthFormat:"YYYY/MM",monthSymbol:"",yearSymbol:""},controls:{firstDayOfWeek:0,dayNamesShortest:",,,,,,",disclosureIcon:" /",okLabel:"",yesLabel:"",noLabel:"",cancelLabel:""},formatters:{am:"",pm:"",dayNamesShort:",,,,,,",monthNamesShort:"1,2,3,4,5,6,7,8,9,10,11,12"},utils:{overClipboardLimit:"   .   . ( 64000)",clipboardCopy:" Ctrl+C  Enter ",clipboardPaste:" Ctrl+V "}},"en-US":{shared:{dateFormat:"MM/DD/YYYY",monthFormat:"MM/YYYY",monthSymbol:"",yearSymbol:""},controls:{firstDayOfWeek:0,dayNamesShortest:"S,M,T,W,T,F,S",disclosureIcon:"Tree open/close",okLabel:"OK",yesLabel:"Yes",noLabel:"No",cancelLabel:"Cancel"},formatters:{am:"AM",pm:"PM",dayNamesShort:"Sun,Mon,Tue,Wed,Thu,Fri,Sat",monthNamesShort:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec"},utils:{overClipboardLimit:"Too many characters to copy. Reduce selection range. (maximum 64Kbytes)",clipboardCopy:"Copy to clipboard: Ctrl+C, Enter",clipboardPaste:"Paste from clipboard: Ctrl+V"}},"fr-FR":{shared:{dateFormat:"DD/MM/YYYY",monthFormat:"MM/YYYY",monthSymbol:"",yearSymbol:""},controls:{firstDayOfWeek:0,dayNamesShortest:"D,L,M,M,J,V,S",disclosureIcon:"Arbre d'ouverture / fermeture",okLabel:"OK",yesLabel:"Oui",noLabel:"Non",cancelLabel:"Annuler"},formatters:{am:"AM",pm:"PM",dayNamesShort:"Dim,Lun,Mar,Mer,Jeu,Ven,Sam",monthNamesShort:"Jan,Fv,Mar,Avr,Mai,Jui,Juil,Ao,Sep,Oct,Nov,Dc"},utils:{overClipboardLimit:"Trop de caractres pour etre copi. Rduire la plage de slection. (maximum 64Kbytes)",clipboardCopy:"Copier dans le Presse-papier: Ctrl+C, Entre",clipboardPaste:"Coller du Presse-papier: Ctrl+V"}},"de-DE":{shared:{dateFormat:"DD.MM.YYYY",monthFormat:"MM.YYYY",monthSymbol:"",yearSymbol:""},controls:{firstDayOfWeek:0,dayNamesShortest:"S,M,D,M,D,F,S",disclosureIcon:"Baum ffnen / Schlieen",okLabel:"OK",yesLabel:"Ja",noLabel:"Nein",cancelLabel:"Abbrechen"},formatters:{am:"vorm.",pm:"nachm.",dayNamesShort:"Son,Mon,Die,Mit,Don,Fre,Sam",monthNamesShort:"Jan,Feb,Mrz,Apr,Mai,Jun,Jul,Aug,Sep,Okt,Nov,Dez"},utils:{overClipboardLimit:"Zu viele Zeichensatze fr Kopie. Reduzieren Sie die Wahlsbereich. (maximum 64Kbytes)",clipboardCopy:"Kopien in der Zwischenablage. Ctrl+C, Eingabe",clipboardPaste:"Einfugen aus der Zwischenablage: Ctrl+V"}},"zh-CN":{shared:{dateFormat:"YYYY-MM-DD",monthFormat:"YYYY-MM",monthSymbol:"",yearSymbol:""},controls:{firstDayOfWeek:0,dayNamesShortest:",,,,,,",disclosureIcon:"/",okLabel:"",yesLabel:"",noLabel:"",cancelLabel:""},formatters:{am:"",pm:"",dayNamesShort:",,,,,,",monthNamesShort:"1,2,3,4,5,6,7,8,9,10,11,12"},utils:{overClipboardLimit:"64K",clipboardCopy:"Ctrl + C",clipboardPaste:"Ctrl + V"}}},_localeChain:["en-US","ko-KR","fr-FR","de-DE","zh-CN"],getLocaleChain:function(){return this._localeChain},setLocaleChain:function(t){ha(t)?this._localeChain=t:this._localeChain=[t]},addResourceBundle:function(t,e,i){i=i?i:this._localeChain[0],this.resources[i]||(this.resources[i]={}),this.resources[i][t]=e},getResourceBundle:function(t,e){var i=e?e:this._localeChain[0];if(this.resources[i])return this.resources[i][t]},getString:function(t,e,i,s){var r,n="",o=this.resources;if(s)o[s]&&o[s][t]&&(p(o[s][t][e])||(n=o[s][t][e]));else for(s=0;s<this._localeChain.length;s++)if(r=this._localeChain[s],o[r]&&o[r][t]&&!p(o[r][t][e])){n=o[r][t][e];break}if(n&&i)for(s=0;s<i.length;s++)n=n.replace("{"+s+"}",i[s]);return n},getNumber:function(t,e,i){var s,r=0,n=this.resources;if(i)n[i]&&n[i][t]&&(p(n[i][t][e])||(r=n[i][t][e]));else for(i=0;i<this._localeChain.length;i++)if(s=this._localeChain[i],n[s]&&n[s][t]&&!p(n[s][t][e])){r=n[s][t][e];break}return Number(r)}},sa=function(){wa.call(this),this.className="SystemManager",this.name=this.className+this.uno};z(sa,wa),sa.apps={},sa.getInstance=function(){return sa._instance||(sa._instance=new sa),sa._instance},sa.domReadyDelayCall=!1,sa.domReadyInteractive=!1,sa.prototype.getRootElement=function(){return this._rootElement},sa.prototype.setRootElement=function(t){this._rootElement=t},sa.prototype.getDocument=function(){return document},sa.prototype.getClassMap=function(){return this._classMap},sa.prototype.getToolTipChildren=function(){return this._toolTipChildren?this._toolTipChildren.element!=this._toolTipChildren.element.parentNode.lastChild&&this._toolTipChildren.element.parentNode.appendChild(this._toolTipChildren.element):(this._toolTipChildren=new u,document.body.appendChild(this._toolTipChildren.element),this._toolTipChildren.setNestLevel(1),this._toolTipChildren.initialize()),this._toolTipChildren},sa.destroy=function(t){delete sa.apps[t]},sa.domReady=function(t,e,i){sa.domReady.done?sa.apps[i]=t.call(e):!sa.domReadyDelayCall&&document&&document.getElementsByTagName&&document.getElementById&&document.body&&("complete"==document.readyState||sa.domReadyInteractive&&"interactive"==document.readyState)?(sa.domReady.ready=[{f:t,c:e,id:i}],sa.isDOMReady()):sa.domReady.timer?sa.domReady.ready.push({f:t,c:e,id:i}):(sa.domReady.ready=[{f:t,c:e,id:i}],sa.domReady.timer=setInterval(sa.isDOMReady,30))},sa.isDOMReady=function(){if(sa.domReady.done)return!1;if(document&&document.getElementsByTagName&&document.getElementById&&document.body&&("complete"==document.readyState||sa.domReadyInteractive&&"interactive"==document.readyState)){clearInterval(sa.domReady.timer),sa.domReady.timer=null,sa.domReady.done=!0;for(var t=0;t<sa.domReady.ready.length;t++){var e=sa.domReady.ready[t];e.c?sa.apps[e.id]=e.f.call(e.c):e.f()}sa.domReady.ready=null,v.windowAddEvent("resize",sa.windowResizeHandler,this),v.windowAddEvent("unload",sa.destroyHandler,this)}},sa.windowResizeHandler=function(){for(var t in sa.apps)sa.apps[t].resize(t)},sa.destroyHandler=function(){try{v.windowRemoveEvent("resize",sa.windowResizeHandler,this),v.windowRemoveEvent("unload",sa.destroyHandler,this);var t,e,i,s=m.getHasClass("Kool__[a-zA-Z]*Root","div");for(t=0,e=s.length;t<e;t++)i=s[t].selfElement,i.destroy&&i.destroy(i);Sa.clean(),sa.apps={}}catch(r){}},sa.addClassMap=function(t){var e=sa.getInstance();e._classMap||(e._classMap={}),m.extend(e._classMap,t,!0)};var ld=function(){this._textFields={}};ld.getInstance=function(){return ld._instance||(ld._instance=new ld),ld._instance},ld.prototype.measureText=function(t,e){var i,s,r="";return i=e?e:"",s=document.body,this._textFieldHolder||(this._textFieldHolder=document.createElement("div"),m.addClass(this._textFieldHolder,"Kool__Root"),m.setVisibility(this._textFieldHolder,!1),m.setStyle(this._textFieldHolder,"position","absolute"),m.setPxStyle(this._textFieldHolder,"left",-6e3),m.setPxStyle(this._textFieldHolder,"top",-300),m.setPxStyle(this._textFieldHolder,"width",5e3),s.appendChild(this._textFieldHolder)),t?(r+=t.font+",",r+=t.size+",",r+=t.bold+",",r+=t.underline+",",r+=t.italic+",",r+=t.align+",",r+=t.indent+",",r+=t.lineHeight+",",r+=t.spacing,this._textFields[r]?s=this._textFields[r]:(s=document.createElement("div"),t.font&&m.setStyle(s,"fontFamily",t.font),t.size&&m.setStyle(s,"fontSize",t.size),t.bold&&m.setStyle(s,"fontWeight",t.bold),t.underline&&m.setStyle(s,"textDecoration",t.underline),t.italic&&m.setStyle(s,"fontStyle",t.italic),t.align&&m.setStyle(s,"textAlign",t.align),t.indent&&m.setStyle(s,"textIndent",t.indent),t.lineHeight&&"0"!=t.lineHeight&&"0px"!=t.lineHeight&&m.setStyle(s,"lineHeight",t.lineHeight),t.spacing&&m.setStyle(s,"letterSpacing",t.spacing),m.setStyle(s,"position","absolute"),this._textFieldHolder.appendChild(s),this._textFields[r]=s),s.innerHTML!=i.toString()&&(s.innerHTML=i.toString()),new zd(0,0,s.offsetWidth,s.offsetHeight)):new zd(0,0,0,0)},ld.prototype.saveAutocomplete=function(t,e){if(e){var i,s=document.body;if(!this._autocompleteHolder){this._autocompleteHolder=document.createElement("div"),m.addClass(this._autocompleteHolder,"Kool__AutocompleteRoot"),m.setVisibility(this._autocompleteHolder,!1),m.setStyle(this._autocompleteHolder,"position","absolute"),m.setPxStyle(this._autocompleteHolder,"left",-1e3),m.setPxStyle(this._autocompleteHolder,"top",-200),m.setPxStyle(this._autocompleteHolder,"width",100);try{i=document.createElement("<iframe name='Kool__AutocompleteIframe'>")}catch(r){i=document.createElement("iframe"),i.id="Kool__AutocompleteIframe",i.name="Kool__AutocompleteIframe"}m.setStyle(i,"width","200px"),m.setStyle(i,"height","0px"),m.setStyle(i,"border","0px"),this._autocompleteHolder.appendChild(i),this._autocompleteForm=document.createElement("form"),this._autocompleteForm.target=i.name,this._autocompleteForm.action=Ma+"close.png",m.setAttr(this._autocompleteForm,"autocomplete","on"),this._autocompleteInputElement=document.createElement("input"),this._autocompleteInputElement.type="text",this._autocompleteForm.appendChild(this._autocompleteInputElement),this._autocompleteHolder.appendChild(this._autocompleteForm),s.appendChild(this._autocompleteHolder)}if(this._autocompleteInputElement)if(m.setAttr(this._autocompleteInputElement,"name",t),this._autocompleteInputElement.value=e,window.external&&"AutoCompleteSaveForm"in window.external)window.external.AutoCompleteSaveForm(this._autocompleteForm);else try{this._autocompleteForm.submit()}catch(r){}}};var Ha=function(){wa.call(this),this.className="ToolTipManager",this.name=this.className+this.uno,this.alwaysShowErrorTip=!1,this.enabled=!0,this.toolTipClass=Qc};z(Ha,wa),Ha.getInstance=function(){return Ha._instance||(Ha._instance=new Ha),Ha._instance},Ha.prototype.getCurrentToolTip=function(){return this._currentToolTip},Ha.prototype.setCurrentToolTip=function(t){this._currentToolTip=t},Ha.prototype._isActiveElement=function(t){return!!t&&t.element==document.activeElement},Ha.prototype._showImmediately=function(t){this._checkIfTargetChanged(t)},Ha.prototype._hideImmediately=function(t){this._checkIfTargetChanged(null)},Ha.prototype._getSystemManager=function(t){return document.body},Ha.prototype._getGlobalBounds=function(t){var e=new ra(0,0),e=t.localToGlobal(e);return new zd(e.x,e.y,t.getWidth(),t.getHeight())},Ha.prototype._mouseIsOver=function(t){return!(!t||!t.mousePt||0==t.mousePt.x&&0==t.mousePt.y)&&t.hitTestPoint(t.mousePt.x,t.mousePt.y,!0)},Ha.prototype._checkIfTargetChanged=function(t){this.enabled&&(this._findTarget(t),this.currentTarget!=this._previousTarget&&(this._targetChanged(),this._previousTarget=this.currentTarget))},Ha.prototype._findTarget=function(t){for(;t;){if(U(t.getErrorString)&&(this._currentText=t.getErrorString(),null!=this._currentText&&""!=this._currentText))return this.currentTarget=t,void(this._isError=!0);if(U(t.getToolTip)&&(this._currentText=t.getToolTip(),null!=this._currentText))return this.currentTarget=t,void(this._isError=!1);t=t instanceof A?t.getParent():null}this.currentTarget=this._currentText=null},Ha.prototype._targetChanged=function(){var t;this._previousTarget&&this._currentToolTip&&(this._currentToolTip instanceof Qc?(t=new bc(bc.TOOL_TIP_HIDE),t.toolTip=this._currentToolTip,this._previousTarget.dispatchEvent(t)):(t=new w("tooltipManagerRequest"),t.name=bc.TOOL_TIP_HIDE,this.dispatchEvent(t))),this._reset(),this.currentTarget&&""!=this._currentText&&(t=new bc(bc.TOOL_TIP_START),this.currentTarget.dispatchEvent(t),this._createTip(),this._initializeTip(),this._positionTip(),this._showTip())},Ha.prototype._createTip=function(){var t=new bc(bc.TOOL_TIP_CREATE);this.currentTarget.dispatchEvent(t),this._currentToolTip=t.toolTip?t.toolTip:new this.toolTipClass,this._currentToolTip.setVisibility(!1),this._getSystemManager(this.currentTarget).appendChild(this._currentToolTip.element),this._currentToolTip instanceof R&&(this._currentToolTip.setNestLevel(1),this._currentToolTip.initialize())},Ha.prototype._initializeTip=function(){this._currentToolTip instanceof Qc&&this._currentToolTip.setText(this._currentText),this._isError&&U(this._currentToolTip.setStyle)&&this._currentToolTip.setStyleName("Kool__ErrorTip"),this.sizeTip(this._currentToolTip)},Ha.prototype._positionTip=function(){var t,e;t=m.getWindowSize();var i=t.w,s=t.h;if(this._isError){if(s=this._getGlobalBounds(this.currentTarget),t=s.x+s.width+4,e=s.y-1,t+this._currentToolTip.getWidth()>i){var r=NaN,n=NaN;t=s.x-2,t+this._currentToolTip.getWidth()+4>i&&(r=i-t-4,n=this.toolTipClass.maxWidth,this.toolTipClass.maxWidth=r),U(this._currentToolTip.setStyle)&&this._currentToolTip.setStyle("borderStyle","errorTipAbove"),this._currentToolTip.setText(this._currentToolTip.getText()),this._currentToolTip.getHeight()+2<s.top?e=s.y-(this._currentToolTip.getHeight()+2):(e=s.y+s.height+2,isNaN(r)||(this.toolTipClass.maxWidth=r),U(this._currentToolTip.setStyle)&&this._currentToolTip.setStyle("borderStyle","errorTipBelow"),this._currentToolTip.setText(this._currentToolTip.getText()))}this.sizeTip(this._currentToolTip),isNaN(n)||(this.toolTipClass.maxWidth=n)}else this._getSystemManager(this.currentTarget),this._mousePt?(e=this.currentTarget.globalToLocal(this._mousePt),t=e.x+11,e=e.y+5):(t=this.currentTarget.getWidth(),e=0),n=this._currentToolTip.getWidth(),t+n>i&&(t=i-n),i=this._currentToolTip.getHeight(),e+i>s&&(e=s-i),e=new ra(t,e),e=this.currentTarget.localToGlobal(e),t=e.x,e=e.y;this._currentToolTip.move(t,e)},Ha.prototype._showTip=function(){var t=new bc(bc.TOOL_TIP_SHOW);t.toolTip=this._currentToolTip,this.currentTarget.dispatchEvent(t),this._isError?this.currentTarget instanceof Y?this.currentTarget.addEventListener("input",this._changeHandler,this):this.currentTarget.addEventListener("change",this._changeHandler,this):v.documentAddEvent("mousedown",this._systemManager_mouseDownHandler,this),this._currentToolTip.setVisibility(!0)},Ha.prototype._hideTip=function(){if(this._previousTarget){var t=new bc(bc.TOOL_TIP_HIDE);t.toolTip=this._currentToolTip,this._previousTarget.dispatchEvent(t)}this._currentToolTip&&this._currentToolTip.setVisibility(!1),this._isError?this.currentTarget&&(this.currentTarget instanceof Y?this.currentTarget.removeEventListener("input",this._changeHandler,this):this.currentTarget.removeEventListener("change",this._changeHandler,this)):this._previousTarget&&v.documentRemoveEvent("mousedown",this._systemManager_mouseDownHandler,this)},Ha.prototype._reset=function(){this._currentToolTip&&(this._getSystemManager(this._currentToolTip).removeChild(this._currentToolTip.element),this._currentToolTip=null)},Ha.prototype.registerToolTip=function(t,e,i){!e&&i?(t.addEvent("mouseover",this._toolTipMouseOverHandler,this),t.addEvent("mouseout",this._toolTipMouseOutHandler,this),this._showImmediately(t)):e&&!i&&(t.removeEvent("mouseover",this._toolTipMouseOverHandler,this),t.removeEvent("mouseout",this._toolTipMouseOutHandler,this),this._hideImmediately(t))},Ha.prototype.registerErrorString=function(t,e,i){!e&&i?(t.addEvent("mouseover",this._errorTipMouseOverHandler,this),t.addEvent("mouseout",this._errorTipMouseOutHandler,this),this._showImmediately(t)):e&&!i?(t.removeEvent("mouseover",this._errorTipMouseOverHandler,this),t.removeEvent("mouseout",this._errorTipMouseOutHandler,this),this._hideImmediately(t)):this._isError&&this._currentToolTip&&this.currentTarget&&this._currentToolTip.setText(i)},Ha.prototype.sizeTip=function(t){U(t.validateNow)&&t.validateNow(),t.setActualSize(t.getExplicitOrMeasuredWidth(),t.getExplicitOrMeasuredHeight())},Ha.prototype.createToolTip=function(t,e,i,s,r){return r=new Qc,s&&(r.setStyle("styleName","errorTip"),r.setStyle("borderStyle",s)),r.setText(t),this._getSystemManager().appendChild(r.element),r.setNestLevel(1),r.initialize(),this.sizeTip(r),r.move(e,i),r},Ha.prototype.destroyToolTip=function(t){var e=this._getSystemManager();t instanceof A?e.removeChild(t.element):e.removeChild(t)},Ha.prototype._toolTipMouseOverHandler=function(t){this._mousePt=v.getEventPageXY(t),this._checkIfTargetChanged(t.target.selfElement)},Ha.prototype._toolTipMouseOutHandler=function(t){this._checkIfTargetChanged(t.relatedTarget&&t.relatedTarget.selfElement||t.relatedTarget)},Ha.prototype._errorTipMouseOverHandler=function(t){this._mousePt=v.getEventPageXY(t),this._checkIfTargetChanged(t.target.selfElement)},Ha.prototype._errorTipMouseOutHandler=function(t){this._isError&&this.alwaysShowErrorTip?this._checkIfTargetChanged(t.currentTarget&&t.currentTarget.selfElement||t.currentTarget):this._checkIfTargetChanged(t.relatedTarget&&t.relatedTarget.selfElement||t.relatedTarget)},Ha.prototype._systemManager_mouseDownHandler=function(t){this._reset()},Ha.prototype._changeHandler=function(t){this._isError&&this.alwaysShowErrorTip||this._reset()},lc._instance=null,lc.getInstance=function(){return lc._instance||(lc._instance=new lc),lc._instance};var Qe={slice:function(t,e,i){if(!t)return null;if(U(t.slice))return r.safari&&I(i)&&(i=t.byteLength),t.slice(e,i);var s=t.byteLength;e=Math.min(e,s);var n=s;return void 0!==i&&(n=Math.min(i,s)),e>n?new ArrayBuffer(0):(n-=e,i=new ArrayBuffer(n),s=new Uint8Array(i),t=new Uint8Array(t,e,n),s.set(t),i)}},Ra={sortOn:function(t,e){var i=t.slice();if(1>=arguments.length)return i.sort(function(t,e){return t>e?1:-1});var s=Array.prototype.slice.call(arguments);return s.shift(),i.sort(function(t,e){for(var i=s.slice(),r=i.shift();t[r]==e[r]&&i.length;)r=i.shift();return t[r]==e[r]?0:t[r]>e[r]?1:-1})},map:function(t,e){var i=Array.prototype.slice.call(arguments,3);if(U(t.map))return t.map(e,i);var s=t.length;if("function"!=typeof e)throw new(e+" is not a function");var r,n=Array(s),o=arguments[2];for(r=0;r<s;r++)n[r]=e.apply(o,[t[r],r,t].concat(i));return n},indexOf:function(t,e,i){if(U(t.indexOf))return t.indexOf(e,i);i=i||0;for(var s=t.length;i<s;i++)if(t[i]===e)return i;return-1}};z(Dd,wa),Dd.KeyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Dd.decode=function(t){var e,i,s,r,n,o,a=[],l=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),o=t.length;l<o;)e=Dd.KeyStr.indexOf(t.charAt(l++)),i=Dd.KeyStr.indexOf(t.charAt(l++)),r=Dd.KeyStr.indexOf(t.charAt(l++)),n=Dd.KeyStr.indexOf(t.charAt(l++)),e=e<<2|i>>4,i=(15&i)<<4|r>>2,s=(3&r)<<6|n,a.push(e),64!==r&&a.push(i),64!==n&&a.push(s);return a},z(zb,wa),zb.KeyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",zb.encode=function(t){for(var e,i=new Bd,s=0,r=0,n=0,o=t.length;s<o;){switch(e=t[s],n=s%3){case 0:i.append(zb.KeyStr.charAt(e>>2));break;case 1:i.append(zb.KeyStr.charAt((3&r)<<4|e>>4));break;case 2:i.append(zb.KeyStr.charAt((15&r)<<2|e>>6)),i.append(zb.KeyStr.charAt(63&e))}r=e,s++}return 0===n?(i.append(zb.KeyStr.charAt((3&r)<<4)),i.append("==")):1===n&&(i.append(zb.KeyStr.charAt((15&r)<<2)),i.append("=")),i.toString()},zb.prototype.encodeAsync=function(t){this.asyncOuput="",this._async_output=new Bd,this._async_input=t,this._async_previous=0,this._encodeString(0)},zb.prototype._encodeString=function(t){for(var e,i,s=this,r=s._async_input.length;t<r;){switch(i=s._async_input[t],e=t%3){case 0:s._async_output.append(zb.KeyStr.charAt(i>>2));break;case 1:s._async_output.append(zb.KeyStr.charAt((3&s._async_previous)<<4|i>>4));break;case 2:s._async_output.append(zb.KeyStr.charAt((15&s._async_previous)<<2|i>>6)),s._async_output.append(zb.KeyStr.charAt(63&i))}if(s._async_previous=i,t++,0==t%2e4)break}t>=r?(0===e?(s._async_output.append(zb.KeyStr.charAt((3&s._async_previous)<<4)),s._async_output.append("==")):1===e&&(s._async_output.append(zb.KeyStr.charAt((15&s._async_previous)<<2)),s._async_output.append("=")),s.asyncOuput=s._async_output.toString(),s.dispatchEvent(new w("complete"))):setTimeout(function(){s._encodeString(t)},20)};var Mc={trim:function(t){return t.replace(/^\s+|\s+$/g,"")},lowerToUpper:function(t){return t.replace(/^[a-z|A-Z]/,function(t){return t.toUpperCase()})},addHyphen:function(t){return((t=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()}))&&0==t.indexOf("ms-")||0==t.indexOf("webkit-")||0==t.indexOf("moz-"))&&(t="-"+t),t},removeHyphen:function(t){return(t&&0==t.indexOf("-ms-")||0==t.indexOf("-webkit-"))&&(t=t.substr(1)),t.replace(/-[a-z]/g,function(t){return Mc.lowerToUpper(t.substring(1,2))})}},r={};!function(){var t=this.document,e="",i="";try{e=navigator.userAgent,i=navigator.platform,i=i.toLowerCase()}catch(s){}var n=e.toLowerCase(),o=n.match(/(edge)[\s\/:]([\w\d\.]+)?/)||n.match(/(opera|ie|firefox|chrome|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||n.match(/(rv)[\s\/:]([\w\d\.]+)?/)||[null,"unknown",0],a=("ie"==o[1]||"rv"==o[1])&&t.documentMode,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e);r={name:"version"==o[1]?o[3]:"rv"==o[1]?"ie":o[1],version:a||parseFloat("opera"==o[1]&&o[4]?o[4]:o[2]),Platform:{name:n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||i.match(/mac|win|linux/)||["other"])[0]}},r[r.name]=!0,r[r.name+parseInt(r.version)]=!0,r[r.name+(8<parseInt(r.version)?"8H":"8L")]=!0,r[r.name+(7<parseInt(r.version)?"7H":"7L")]=!0,r[r.name+(6<parseInt(r.version)?"6H":"6L")]=!0,r.Platform[r.Platform.name]=!0,r.isMobile=e,r.appleWebKit=r.isMobile?function(){var t=n.indexOf("applewebkit"),t=n.substring(t,n.length);return Mc.trim(t.substring(12,t.indexOf("(")))}():"",r.supportAttribute=function(){try{var e=t.createElement("div");return e.className="i","i"==e.getAttribute("class")}catch(i){return!1}}(),r.supportSetAttribute=function(){try{var e=t.createElement("input");return e.setAttribute("type","hidden"),"hidden"==e.getAttribute("type")}catch(i){return!1}}(),r.quirks=r.ie&&"BackCompat"==t.compatMode,r.boxSizing=r.ie||r.opera||r.safari?"boxSizing":r.firefox?"MozBoxSizing":"webkitBoxSizing",r.useBorderBox=!(r.ie7L&&!r.quirks),r.overflow="hidden",r.supportTouch=r.isMobile&&"ontouchend"in t&&"ontouchstart"in t,r.tabIndexStartNo=1030,r.divMaxSize=r.chrome?33554428:r.firefox?17895700:r.safari?1e8:r.edge?1533916:1193046,r.checkPrefix=function(){return t.body?I(t.body.style.MozAnimation)?I(t.body.style.webkitBorderRadius)?I(t.body.style.OBorderRadius)?I(t.body.style.KhtmlBorderRadius)?I(t.body.style.msTransform)?"":"-ms-":"-khtml-":"-o-":"-webkit-":"-moz-":null},r.getCssPrefix=function(){return I(r.cssPrefix)?(r.cssPrefix=r.checkPrefix(),r.cssPrefix):r.cssPrefix},r.supportCanvas=function(){try{var e=t.createElement("canvas");return!(!e||!e.getContext)}catch(i){return!1}}(),r.useExCanvas=!(!r.ie||r.supportCanvas),r.checkRetinaRatio=function(){var e,i=1;if(!r.useExCanvas)try{e=t.createElement("canvas").getContext("2d"),i=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,i=(window.devicePixelRatio||1)/i}catch(s){}return i},r.scrollBarWidth=NaN,r.scrollBarHeight=NaN,r.getScrollBarSize=function(){if(t.body){var e=t.createElement("p");e.style.width="100px",e.style.height="100px";var i=t.createElement("div");i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.visibility="hidden",i.style.width="100px",i.style.height="100px",i.style.overflow="hidden",i.appendChild(e),t.body.appendChild(i);var s;s=e.offsetWidth;var n;n=e.offsetHeight,i.style.overflow="scroll";var o;o=e.offsetWidth,e=e.offsetHeight,s==o&&(o=i.clientWidth),n==e&&(e=i.clientHeight),r.scrollBarWidth=s-o,r.scrollBarHeight=n-e,t.body.removeChild(i)}},r.getScrollBarWidth=function(){return isNaN(r.scrollBarWidth)?(r.getScrollBarSize(),r.scrollBarWidth):r.scrollBarWidth},r.getScrollBarHeight=function(){return isNaN(r.scrollBarHeight)?(r.getScrollBarSize(),r.scrollBarHeight):r.scrollBarHeight},r.setClipboard=function(e,i,s){if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData("Text",e);else{if(65536<e.length)return void alert(B.getString("utils","overClipboardLimit"));try{var r,n,o,a,l;r=i?i.element:t.body,n=t.createElement("div"),l=t.createElement("textarea"),l.value=e,s?(m.setPxStyle(n,"width",0),m.setPxStyle(n,"height",0),r.appendChild(n),m.setPxStyle(l,"width",1),m.setPxStyle(l,"height",1),n.appendChild(l),l.focus(),l.select(),setTimeout(function(){r.removeChild(n)},100)):(o=t.createElement("span"),o.innerHTML=B.getString("utils","clipboardCopy"),n.id="Kool__CopyPanel",m.addClass(n,"Kool__CopyPanel"),r.appendChild(n),m.setPxStyle(n,"left",i.getWidth()/2-m.getWidth(n)/2),m.setPxStyle(n,"top",i.getHeight()/2-m.getHeight(n)/2),n.appendChild(o),a=t.createElement("img"),a.src=Ma+"close.png",v.addEvent(a,"click",function(){r.removeChild(n)}),n.appendChild(a),n.appendChild(l),n.onkeydown=function(t){13==t.keyCode||27==t.keyCode?r.removeChild(n):67==t.keyCode&&t.ctrlKey||(t.preventDefault(),t.stopPropagation())},l.focus(),l.select())}catch(h){window.prompt(B.getString("utils","clipboardCopy"),e)}}return!0},r.getClipboard=function(e,i){if(window.clipboardData&&window.clipboardData.getData){var s=window.clipboardData;if(!s.types)return s.getData("Text");if(/text\/html/.test(s.types))return s.getData("text/html");if(/text\/plain/.test(s.types))return s.getData("text/plain")}else if(i&&i.clipboardData&&i.clipboardData.types&&i.clipboardData.getData){if(s=i.clipboardData.types,s instanceof DOMStringList&&s.contains("text/plain")||s.indexOf&&-1!==s.indexOf("text/plain"))return i.clipboardData.getData("text/plain");if(s instanceof DOMStringList&&s.contains("text/html")||s.indexOf&&-1!==s.indexOf("text/html"))return i.clipboardData.getData("text/html")}else try{var r,n,o,a;r=e?e.element:t.body,n=t.createElement("div"),a=t.createElement("textarea"),a.onpaste=function(t){setTimeout(function(){var t=a.value;r.removeChild(n),e&&e.clipboardPaste&&e.clipboardPaste(t)},100)},i?(m.setPxStyle(n,"width",0),m.setPxStyle(n,"height",0),r.appendChild(n),m.setPxStyle(a,"width",1),m.setPxStyle(a,"height",1),n.appendChild(a)):(s=t.createElement("span"),s.innerHTML=B.getString("utils","clipboardPaste"),n.id="Kool__PastePanel",m.addClass(n,"Kool__PastePanel"),r.appendChild(n),m.setPxStyle(n,"left",e.getWidth()/2-m.getWidth(n)/2),m.setPxStyle(n,"top",e.getHeight()/2-m.getHeight(n)/2),n.appendChild(s),o=t.createElement("img"),o.src=Ma+"close.png",v.addEvent(o,"click",function(){r.removeChild(n)}),n.appendChild(o),n.appendChild(a),n.onkeydown=function(t){13==t.keyCode||27==t.keyCode?r.removeChild(n):86==t.keyCode&&t.ctrlKey||(t.preventDefault(),t.stopPropagation())}),a.focus()}catch(l){return window.prompt(B.getString("utils","clipboardPaste"))}return null},r.locale="ko-KR"}(),aa.MAX_INT32=4294967295,aa.MAX_SIGNED_INT32=2147483647,aa.MAX_INT16=65535,aa.MAX_SIGNED_INT16=32767,aa.MAX_BYTE=255,aa.MAX_SIGNED_BYTE=127,aa.BIG_ENDIAN="b",aa.LITTLE_ENDIAN="l",aa.prototype._checkBuffer=function(t){if(0>=this.getBytesAvailable()||this.getBytesAvailable()<t)throw Error("Buffer underrun")},aa.prototype._checkWriteBuffer=function(t){var e;if(e=this.getBytesAvailable(),e<t)for(;e<t-1;e++)this._buffer[this._position+e]=0},aa.prototype.getBytesAvailable=function(){return this._buffer.length<this._position?0:this._buffer.length-this._position},aa.prototype.getBuffer=function(){return this._buffer},aa.prototype.getPosition=function(){return this._position},aa.prototype.setPosition=function(t){this._position=t},aa.prototype.getLength=function(){return this._buffer.length},aa.prototype.setLength=function(t){var e;if(this._buffer.length>t)this._buffer.splice(t,this._buffer.length-t);else for(e=this._buffer.length;e<t;e++)this._buffer[e]=0},aa.prototype.readBoolean=function(){return this._checkBuffer(1),0!==this.readByte()},aa.prototype.readInt=function(){this._checkBuffer(4);var t=this._buffer[this._position++],t=t+(this._buffer[this._position++]<<8),t=t+(this._buffer[this._position++]<<16),t=t+(this._buffer[this._position++]<<24);return t>aa.MAX_SIGNED_INT32&&(t-=aa.MAX_INT32+1),t},aa.prototype.readShort=function(){this._checkBuffer(2);var t=this._buffer[this._position++],t=t+(this._buffer[this._position++]<<8);return t>aa.MAX_SIGNED_INT16&&(t-=aa.MAX_INT16+1),t},aa.prototype.readByte=function(){this._checkBuffer(1);var t=this._buffer[this._position++];return t>aa.MAX_SIGNED_BYTE&&(t-=aa.MAX_BYTE+1),t},aa.prototype.readBytes=function(t,e,i){if(0!=i){this._checkBuffer(i),t.setPosition(e);var s=t._position+i;for(e=t._position;e<s;e++)t._buffer[e]=this._buffer[this._position++];t._position+=i}},aa.prototype.readUnsignedInt=function(){var t=this.readInt();return 0>t&&(t+=aa.MAX_INT32+1),t},aa.prototype.readUnsignedShort=function(){var t=this.readShort();return 0>t&&(t+=aa.MAX_INT16+1),t},aa.prototype.readUnsignedByte=function(){var t=this.readByte();return 0>t&&(t+=aa.MAX_BYTE+1),t},aa.prototype.readString=function(){this._checkBuffer(2);var t=this.readShort(),e=this._buffer.slice(this._position,this._position+t);return this.setPosition(this._position+t),ee.fromByteArray(e)},aa.prototype.writeBoolean=function(t){this._checkWriteBuffer(1),this.writeByte(!0===t?1:0)},aa.prototype.writeString=function(t){var e,i=ee.toByteArray(t);for(this.writeUnsignedShort(i.length),t=0,e=i.length;t<e;t++)this.writeUnsignedByte(i[t])},aa.prototype.writeInt=function(t){var e=255&t;0>e&&(e+=256),this._checkWriteBuffer(4),this._buffer[this._position++]=e,this._buffer[this._position++]=(65280&t)>>8,this._buffer[this._position++]=(16711680&t)>>16,this._buffer[this._position++]=(4278190080&t)>>24},aa.prototype.writeDouble=function(t){function e(t){var e=Math.floor(t);return t-=e,.5>t?e:.5<t?e+1:e%2?e+1:e}var i,s,r,n;for(t!==t?(s=2047,r=Math.pow(2,51),i=0):1/0===t||-(1/0)===t?(s=2047,r=0,i=0>t?1:0):0===t?(r=s=0,i=-(1/0)===1/t?1:0):(i=0>t,
t=Math.abs(t),t>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),r=e(t/Math.pow(2,s)*Math.pow(2,52)),2<=r/Math.pow(2,52)&&(s+=1,r=1),1023<s?(s=2047,r=0):(s+=1023,r-=Math.pow(2,52))):(s=0,r=e(t/Math.pow(2,-1074)))),n=[],t=52;t;--t)n.push(r%2?1:0),r=Math.floor(r/2);for(t=11;t;--t)n.push(s%2?1:0),s=Math.floor(s/2);for(n.push(i?1:0),n.reverse(),t=n.join(""),i=[];t.length;)i.push(parseInt(t.substring(0,8),2)),t=t.substring(8);for(i.reverse(),t=0,s=i.length;t<s;t++)this._buffer[this._position++]=i[t]},aa.prototype.writeShort=function(t){this._checkWriteBuffer(2),this._buffer[this._position++]=255&t,this._buffer[this._position++]=(65280&t)>>8},aa.prototype.writeByte=function(t){this._checkWriteBuffer(1),this._buffer[this._position++]=255&t},aa.prototype.writeBytes=function(t,e,i){e=1<arguments.length?e:0,i=2<arguments.length?i:-1;var s,r=0>i?t._buffer.length:e+i;for(s=e;s<r;s++)this._buffer[this._position++]=255&t._buffer[s]},aa.prototype.writeUnsignedInt=function(t){0>t&&(t+=aa.MAX_INT32),this.writeInt(t)},aa.prototype.writeUnsignedShort=function(t){t&=65535,0>t&&(t+=aa.MAX_INT16),this.writeShort(t)},aa.prototype.writeUnsignedByte=function(t){t&=255,0>t&&(t+=aa.MAX_BYTE),this.writeByte(t)},aa.prototype.writeArray=function(t){this._buffer=t=this._buffer.concat(t._buffer?t._buffer:t),this.setPosition(t.length)},aa.prototype.clear=function(){this._position=0,this._buffer=[]};var ee=ee||{};ee.toByteArray=function(t){var e,i,s,r,n,o=[];for(e=0,s=t.length;e<s;e++)if(127>=t.charCodeAt(e))o.push(t.charCodeAt(e));else for(n=encodeURIComponent(t.charAt(e)).substr(1).split("%"),i=0,r=n.length;i<r;i++)o.push(parseInt(n[i],16));return o},ee.fromByteArray=function(t){var e,i,s="";for(e=0,i=t.length;e<i;e++)s=127>=t[e]?37===t[e]?s+"%25":s+String.fromCharCode(t[e]):s+("%"+t[e].toString(16).toUpperCase());return decodeURIComponent(s)};var v={addEvent:function(t,e,i,s,r,n){s=s?s:window,r=!p(r)&&r;var o=p(n)?0:n;if(i){t instanceof A&&(t=t.element),t.events||(t.events={}),v.changeEventType[e]&&(e=v.changeEventType[e]());var a,l;n=-1;var h=t.events[e];if(h&&0!=h.length)for(a=h.length-1;0<=a;a--){if((l=h[a])&&l.listener===i&&l.context===s){if(l.priority==o)return;h.splice(a,1)}l.priority<o&&0>n&&(n=a)}else h=t.events[e]=[],document.addEventListener?t.addEventListener(e,v.handleEvent,r):t["on"+e]=v.handleEvent;s={listener:i,context:s,useCapture:r,priority:o},-1==n?h.unshift(s):h.splice(n+1,0,s),Sa.insert(t,e,i,s)}},addEvent2:function(t,e,i,s,r,n){s=s?s:window,r=!p(r)&&r;var o=p(n)?0:n;if(i){t instanceof A&&(t=t.element),t.events||(t.events={}),v.changeEventType[e]&&(e=v.changeEventType[e]());var a,l;n=-1;var h=t.events[e];if(h&&0!=h.length)for(a=h.length-1;0<=a;a--){if((l=h[a])&&l.listener===i&&l.context===s){if(l.priority==o)return;h.splice(a,1)}l.priority<o&&0>n&&(n=a)}else h=t.events[e]=[],document.addEventListener?t.addEventListener(e,v.handleEvent,r):t.attachEvent("on"+e,v.handleEvent);s={listener:i,context:s,useCapture:r,priority:o},-1==n?h.unshift(s):h.splice(n+1,0,s),Sa.insert(t,e,i,s)}},removeEvent:function(t,e,i,s,r){if(s=s?s:window,r=!p(r)&&r,t.events){v.changeEventType[e]&&(e=v.changeEventType[e]());var n,o,a=t.events[e];if(a){for(n=a.length-1;0<=n;n--)if((o=a[n])&&o.listener===i&&o.context===s){o.listener=null,o.context=null,a.splice(n,1);break}0==a.length&&(document.removeEventListener?t.removeEventListener(e,v.handleEvent,r):t["on"+e]=null)}}},removeEvent2:function(t,e,i,s,r){if(s=s?s:window,r=!p(r)&&r,t.events){v.changeEventType[e]&&(e=v.changeEventType[e]());var n,o,a=t.events[e];if(a){for(n=a.length-1;0<=n;n--)if((o=a[n])&&o.listener===i&&o.context===s){o.listener=null,o.context=null,a.splice(n,1);break}0==a.length&&(document.removeEventListener?t.removeEventListener(e,v.handleEvent,r):t.detachEvent(e,v.handleEvent))}}},handleEvent:function(t){var e=!0;t=t||v.fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event);var i;if(this.events)i=this.events[t.type];else{if(!t.srcElement||!t.srcElement.events)throw"not found element.events";t=v.fixEvent(t),i=t.target.events[t.type]}t.currentTarget||(t.currentTarget=this),t.stopImmediatePropagation&&t.stopImmediatePropagation!=v.fixEvent.stopImmediatePropagation&&(t.stopImmediatePropagationNative=t.stopImmediatePropagation,t.stopImmediatePropagation=v.fixEvent.stopImmediatePropagation),!t.wheelDelta&&t.detail&&(t.wheelDelta=-40*t.detail);for(var s=i.length-1;0<=s&&(!1===i[s].listener.call(i[s].context,t)&&(e=!1),!t._istoped);s--);return e},fixEvent:function(t){if(t.preventDefault||(t.preventDefault=v.fixEvent.preventDefault,t.defaultPrevented=!1),t.stopPropagation||(t.stopPropagation=v.fixEvent.stopPropagation),t.stopImmediatePropagation||(t.stopImmediatePropagation=v.fixEvent.stopImmediatePropagation),t.target||(t.target=t.srcElement||document),3===t.target.nodeType&&(t.target=t.target.parentNode),null==t.pageX&&null!=t.clientX){var e=t.target.ownerDocument||document,i=e.documentElement,e=e.body;t.pageX=t.clientX+(i&&i.scrollLeft||e&&e.scrollLeft||0)-(i&&i.clientLeft||e&&e.clientLeft||0),t.pageY=t.clientY+(i&&i.scrollTop||e&&e.scrollTop||0)-(i&&i.clientTop||e&&e.clientTop||0)}return t}};v.fixEvent.preventDefault=function(){this.returnValue=!1,this.defaultPrevented=!0},v.fixEvent.stopPropagation=function(){this._stoped=this.cancelBubble=!0},v.fixEvent.stopImmediatePropagation=function(){this.stopImmediatePropagationNative&&this.stopImmediatePropagationNative(),this._istoped=this.cancelBubble=!0},v.docuemntEvent={},v.documentAddEvent=function(t,e,i,s,r){i=i?i:window,s=!p(s)&&s;var n=p(r)?0:r;if(e){v.changeEventType[t]&&(t=v.changeEventType[t]());var o,a;r=-1;var l=v.docuemntEvent[t];if(l&&0!=l.length)for(o=l.length-1;0<=o;o--){if((a=l[o])&&a.listener===e&&a.context===i){if(a.priority==n)return;l.splice(o,1)}a.priority<n&&0>r&&(r=o)}else l=v.docuemntEvent[t]=[],document.addEventListener?document.addEventListener(t,v.documentHandleEvent,s):document.attachEvent("on"+t,v.documentHandleEvent);i={listener:e,context:i,useCapture:s,priority:n},-1==r?l.unshift(i):l.splice(r+1,0,i),Sa.insert(document,t,e,i)}},v.documentRemoveEvent=function(t,e,i,s){i=i?i:window,s=!p(s)&&s,v.changeEventType[t]&&(t=v.changeEventType[t]());var r,n,o=v.docuemntEvent[t];if(o){for(r=o.length-1;0<=r;r--)if((n=o[r])&&n.listener===e&&n.context===i){n.listener=null,n.context=null,o.splice(r,1);break}0==o.length&&(document.removeEventListener?document.removeEventListener(t,v.documentHandleEvent,s):document.detachEvent(t,v.documentHandleEvent))}},v.documentHandleEvent=function(t){var e=!0;t=t||v.fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event),t.currentTarget||(t=v.fixEvent(t),t.currentTarget=document),t.stopImmediatePropagation&&t.stopImmediatePropagation!=v.fixEvent.stopImmediatePropagation&&(t.stopImmediatePropagationNative=t.stopImmediatePropagation,t.stopImmediatePropagation=v.fixEvent.stopImmediatePropagation);var i,s=v.docuemntEvent[t.type];if(!s)return e;for(i=s.length-1;0<=i&&(!1===s[i].listener.call(s[i].context,t)&&(e=!1),!t._istoped);i--);return e},v.windowEvent={},v.windowAddEvent=function(t,e,i,s,r){i=i?i:window,s=!p(s)&&s;var n=p(r)?0:r;if(e){v.changeEventType[t]&&(t=v.changeEventType[t]());var o,a;r=-1;var l=v.windowEvent[t];if(l&&0!=l.length)for(o=l.length-1;0<=o;o--){if((a=l[o])&&a.listener===e&&a.context===i){if(a.priority==n)return;l.splice(o,1)}a.priority<n&&0>r&&(r=o)}else l=v.windowEvent[t]=[],document.addEventListener?window.addEventListener(t,v.windowHandleEvent,s):window.attachEvent("on"+t,v.windowHandleEvent);i={listener:e,context:i,useCapture:s,priority:n},-1==r?l.unshift(i):l.splice(r+1,0,i),Sa.insert(window,t,e,i)}},v.windowRemoveEvent=function(t,e,i,s){i=i?i:window,s=!p(s)&&s,v.changeEventType[t]&&(t=v.changeEventType[t]());var r,n,o=v.windowEvent[t];if(o){for(r=o.length-1;0<=r;r--)if((n=o[r])&&n.listener===e&&n.context===i){n.listener=null,n.context=null,o.splice(r,1);break}0==o.length&&(document.removeEventListener?window.removeEventListener(t,v.windowHandleEvent,s):window.detachEvent(t,v.windowHandleEvent))}},v.windowHandleEvent=function(t){var e=!0;t=t||v.fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event),t.currentTarget||(t=v.fixEvent(t),t.currentTarget=window),t.stopImmediatePropagation&&t.stopImmediatePropagation!=v.fixEvent.stopImmediatePropagation&&(t.stopImmediatePropagationNative=t.stopImmediatePropagation,t.stopImmediatePropagation=v.fixEvent.stopImmediatePropagation);var i,s=v.windowEvent[t.type];if(!s)return e;for(i=s.length-1;0<=i&&(!1===s[i].listener.call(s[i].context,t)&&(e=!1),!t._istoped);i--);return e},v.getButtonDown=function(t,e){return I(t.buttons)?I(t.which)&&!I(t.button)?"mousemove"==t.type||"mouseup"==t.type||"mousedown"==t.type?1&t.button:e?1:0:r.chrome?0==t.which?0:1==t.which?1:2==t.which?4:3==t.which?2:0:e?1:0:r.ie9&&"mousedown"!=t.type?e?1:0:1&t.buttons},v.getEventPageXY=function(t){return I(t.pageX2)?t.touches?new ra(t.touches[0].pageX,t.touches[0].pageY):new ra(t.pageX,t.pageY):new ra(t.pageX2,t.pageY2)},v.isRightButtonDown=function(t){return!I(t.buttons)&&2==t.buttons||!((!I(t.which)||I(t.button)||2!=t.button)&&3!=t.which)},v.changeEventType={mousewheel:function(){return r.firefox?"DOMMouseScroll":"mousewheel"}},v.htmlEventType={abort:!0,blur:!0,cellchange:!0,change:!0,click:!0,contextmenu:!0,copy:!0,cut:!0,dblclick:!0,drag:!0,dragend:!0,dragenter:!0,dragleave:!0,dragover:!0,dragstart:!0,drop:!0,error:!0,focus:!0,focusin:!0,focusout:!0,keydown:!0,keypress:!0,keyup:!0,load:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mousewheel:!0,mouseup:!0,paste:!0,readystatechange:!0,resize:!0,resizeend:!0,resizestart:!0,scroll:!0,selectstart:!0,submit:!0,unload:!0};var N={colorTable:{transparent:[0,0,0,0],aqua:[0,255,255,1],black:[0,0,0,1],blue:[0,0,255,1],fuchsia:[255,0,255,1],gray:[128,128,128,1],green:[0,128,0,1],lime:[0,255,0,1],maroon:[128,0,0,1],navy:[0,0,128,1],olive:[128,128,0,1],purple:[128,0,128,1],red:[255,0,0,1],silver:[192,192,192,1],teal:[0,128,128,1],white:[255,255,255,1],yellow:[255,255,0,1]},color2rgba:function(t,e){if(!t)return!1;var i=N.color2RgbaArr(t);return 0!=e&&O(e)&&(e=1),i?"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")":null},color2hex:function(t){return!!t&&((t=N.color2RgbaArr(t))?N.rgbaArr2hex(t):null)},_pad2:function(t){return 1==t.length?"0"+t:""+t},_clamp_css_byte:function(t){return t=Math.round(t),0>t?0:255<t?255:t},_clamp_css_float:function(t){return 0>t?0:1<t?1:t},_parse_css_int:function(t){return"%"===t[t.length-1]?N._clamp_css_byte(parseFloat(t)/100*255):N._clamp_css_byte(parseInt(t))},_parse_css_float:function(t){return"%"===t[t.length-1]?N._clamp_css_float(parseFloat(t)/100):N._clamp_css_float(parseFloat(t))},_css_hue_to_rgb:function(t,e,i){return 0>i?i+=1:1<i&&--i,1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t},color2RgbaArr:function(t){if(!t)return null;var e=Mc.trim(t).toLowerCase();if(N.colorTable[e])return N.colorTable[e];if(0===e.indexOf("0x")&&(e=e.replace(/0x/,"#")),"#"===e.charAt(0))return 4===e.length?(t=parseInt(e.substr(1),16),0<=t&&4095>=t?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null):7===e.length?(t=parseInt(e.substr(1),16),0<=t&&16777215>=t?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null):null;var i=e.indexOf("("),s=e.indexOf(")");if(-1!==i&&s+1===e.length)switch(e=t.substr(0,i),i=t.substr(i+1,s-(i+1)).split(","),t=1,e){case"rgba":if(4!==i.length)break;t=N._parse_css_float(i.pop());case"rgb":if(3!==i.length)break;return[N._parse_css_int(i[0]),N._parse_css_int(i[1]),N._parse_css_int(i[2]),t];case"hsla":if(4!==i.length)break;t=N._parse_css_float(i.pop());case"hsl":if(3===i.length)return e=(parseFloat(i[0])%360+360)%360/360,s=N._parse_css_float(i[1]),i=N._parse_css_float(i[2]),s=.5>=i?i*(s+1):i+s-i*s,i=2*i-s,[N._clamp_css_byte(255*N._css_hue_to_rgb(i,s,e+1/3)),N._clamp_css_byte(255*N._css_hue_to_rgb(i,s,e)),N._clamp_css_byte(255*N._css_hue_to_rgb(i,s,e-1/3)),t]}return null},rgbaArr2hex:function(t){return"#"+N._pad2(Number(t[0]).toString(16))+N._pad2(Number(t[1]).toString(16))+N._pad2(Number(t[2]).toString(16))},color2no:function(t){return!!t&&((t=N.color2RgbaArr(t))?t[2]|t[1]<<8|t[0]<<16:0)},no2hex:function(t){return"number"==typeof t&&(t="00000"+(0|t).toString(16),t=t.substr(t.length-6).toUpperCase()),t},hex2rgb:function(t){return t.replace(/0x/,"#")},rgb2hex:function(t){return t.replace(/#/,"0x")},rgbToHex:function(t){return N.rgbaArr2hex(N.color2RgbaArr(t))},rgbPoint:function(t,e,i){var s=t>>16&255,r=t>>8&255;t&=255;var n=e>>16&255,o=e>>8&255;return e&=255,(s<n?s+(n-s)*i:s-(s-n)*i)<<16|(r<o?r+(o-r)*i:r-(r-o)*i)<<8|(t<e?t+(e-t)*i:t-(t-e)*i)},rgbInterpolate:function(t,e,i){var s,r,n,o=[],a=t>>16&255,l=t>>8&255;t&=255;var h=e>>16&255,d=e>>8&255,c=255&e,_=function(t,e,s,r){return t<e?s/i*(e-t)+t:(t-e)*(1-s/i)+e};for(e=0;e<=i;e+=1)s=_(a,h,e),r=_(l,d,e),n=_(t,c,e),o.push("#"+N.no2hex((s<<8|r)<<8|n));return o},rgbMiddle:function(t,e){var i=t>>16&255,s=t>>8&255,r=255&t,n=e>>16&255,o=e>>8&255,a=255&e;return(i<n?i+(n-i)/2:i-(i-n)/2)<<16|(s<o?s+(o-s)/2:s-(s-o)/2)<<8|(r<a?r+(a-r)/2:r-(r-a)/2)},adjustBrightness:function(t,e){var i,s;return Ea(t)?(i=t.color||"#000000",s=O(t.alpha)?1:t.alpha):(i=t,s=1),void 0==e&&(e=0),i=i.replace(/#/,"0x"),i=Number(i),"rgba("+Math.max(Math.min((i>>16&255)+e,255),0)+", "+Math.max(Math.min((i>>8&255)+e,255),0)+", "+Math.max(Math.min((255&i)+e,255),0)+", "+s+")"},adjustBrightness2:function(t,e){var i,s;if(Ea(t)?(i=t.color||"#000000",s=O(t.alpha)?1:t.alpha):(i=t,s=1),void 0==e&&(e=0),0==t.alpha)return"rgb(255,255,255)";i=i.replace(/#/,"0x"),i=parseInt(i);var r=Math.max(Math.min(i>>16&255,255),0),n=Math.max(Math.min(i>>8&255,255),0),o=Math.max(Math.min(255&i,255),0);return 0==e?"rgba("+r+", "+n+", "+o+", "+s+")":(0>e?(e=(100+e)/100,r=(i>>16&255)*e,n=(i>>8&255)*e,o=(255&i)*e):(e/=100,r=i>>16&255,n=i>>8&255,o=255&i,r=Math.min(r+(255-r)*e,255),n=Math.min(n+(255-n)*e,255),o=Math.min(o+(255-o)*e,255)),"rgba("+parseInt(r)+", "+parseInt(n)+", "+parseInt(o)+", "+s+")")},rgb2hsv:function(t){var e=N.color2RgbaArr(t);t=e[0]/255;var i=e[1]/255,s=e[2]/255,e=Math.max(t,i,s),r=e-Math.min(t,i,s);return t=60*(0==r?0:t==e?(6+(i-s)/r)%6:i==e?2+(s-t)/r:s==e?4+(t-i)/r:0),0>t&&(t+=360),{h:t,s:100*(0!=e?r/e:0),v:100*e}},hsv2rgb:function(t){var e,i,s,r,n,o,a;a=t.s/100;var l=t.v/100;switch(n=t.h/60,t=Math.floor(n),r=n-t,n=l*(1-a),o=l*(1-r*a),a=l*(1-(1-r)*a),t%6){case 0:e=l,i=a,s=n;break;case 1:e=o,i=l,s=n;break;case 2:e=n,i=l,s=a;break;case 3:e=n,i=o,s=l;break;case 4:e=a,i=n,s=l;break;case 5:e=l,i=n,s=o}return N.rgbaArr2hex([Math.round(255*e),Math.round(255*i),Math.round(255*s)])}},m={extend:function(t,e,i){t||(t={});for(var s in e)void 0!=t[s]&&i||(t[s]=e[s]);return t},clone:function(t,e){if(t){var i,s=new t.constructor;for(i in t)s[i]=e&&"object"==typeof t[i]?m.clone(t[i],e):t[i];return s}},setCssOfObject:function(t,e){var i,s;t instanceof A&&(t=t.element);for(i in e)(s=Xa(e[i])?m.setPxStyle:m.setStyle)(t,i,e[i])},getCssofObject:function(t,e){var i,s=0,r={};for(t instanceof A&&(t=t.element);s<e.length;)i=m.getStyle(t,e[s]),/%|px|pt/.test(i)&&(i=parseFloat(i.replace(/%|px|pt/,""))),r[e[s]]=i,s++;return r},css:function(t,e){r.ie&&e&&!I(e.opacity)&&(e.filter="alpha(opacity="+100*e.opacity+")"),m.extend(t.style,e)},getHasClass:function(t,e,i){var s=[];for(t=new RegExp(t),i=(i||document).getElementsByTagName(e||"*"),e=0;e<i.length;e++)t.test(i[e].className)&&s.push(i[e]);return s},createElement:function(t,e,i){var s=document.createElement(t);return s.className=e,"div"===t&&(s.style[r.boxSizing]=i||(r.useBorderBox?"border-box":"content-box")),s},getAttr:function(t,e){var i=t.getAttribute(e);return""===i?this.hasAttr(e)?i:void 0:i},setAttr:function(t,e,i){m.setAttr=r.supportSetAttribute?function(t,e,i){t.setAttribute(e,i)}:function(t,e,i){var s=t.getAttributeNode(e);s||t.setAttributeNode(s=t.ownerDocument.createAttribute(e)),s.value=i+""},m.setAttr(t,e,i)},removeAttr:function(t,e){t.removeAttribute(e)},hasAttr:function(t,e){if(t.hasAttribute)return t.hasAttribute(e);if(t.getAttributeNode){var i=t.getAttributeNode(e);return!!i&&i.specified}},addClass:function(t,e){t instanceof A&&(t=t.element);var i=t.className||"";m.hasClass(t,e)||(t.className=i+" "+e)},hasClass:function(t,e){return t instanceof A&&(t=t.element),new RegExp("(\\s|^)"+e+"(\\s|$)").test(t.className)},removeClass:function(t,e){t instanceof A&&(t=t.element),m.hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," "))},getDisplay:function(t){return"none"!=m.getStyleInline(t,"display")},setDisplay:function(t,e,i){return e?void m.setStyle(t,"display",i?i:""):(e=m.getStyleInline(t,"display"),m.setStyle(t,"display","none"),e)},getVisibility:function(t){return"hidden"!=m.getStyleInline(t,"visibility")},setVisibility:function(t,e){m.setStyle(t,"visibility",e?"":"hidden")},setWordWrap:function(t,e){m.setStyle(t,"wordWrap",e?"break-word":"normal"),m.setStyle(t,"whiteSpace",e?"normal":"nowrap")},getStyleInline:function(t,e){return t instanceof A&&(t=t.element),Tb.cssStyleList[e]&&(e=Tb.cssStyleList[e]),t.style[e]},getStyle:function(t,e){return m.getStyle=document.defaultView&&document.defaultView.getComputedStyle?function(t,e){t instanceof A&&(t=t.element),Tb.cssStyleList[e]&&(e=Tb.cssStyleList[e]);var i;return t.style[e]?i=t.style[e]:(i=(i=window.getComputedStyle(t))&&i[e],""==i&&(i=null==i||""===i?void 0:i)),i}:function(t,e){t instanceof A&&(t=t.element),Tb.cssStyleList[e]&&(e=Tb.cssStyleList[e]);var i;return t.style[e]?i=t.style[e]:t.currentStyle&&(i=t.currentStyle[e]),i},m.getStyle(t,e)},getStyle2:function(t,e){return this.getStyle2=document.defaultView&&document.defaultView.getComputedStyle?function(t,e){var i,s;return t.style[e]?i=t.style[e]:(i=(s=window.getComputedStyle(t))&&s[e],""==i&&(i=s&&s[e],i=null==i||""===i?void 0:i)),i}:function(t,e){var i;return t.style[e]?i=t.style[e]:t.currentStyle&&(i=t.currentStyle[e]),i},this.getStyle2(t,e).replace(/px/,"")},getSizeStyle:function(t,e){t instanceof A&&(t=t.element);var i=parseFloat(m.getStyle(t,e));return isNaN(i)?0:i},convertBorderSize:function(t,e){return"none"==t||"hidden"==t?0:"thin"==e?1:"medium"==e?3:"thick"==e?5:(e=Math.round(parseFloat(e)),isNaN(e)?0:e)},convertStyleSize:function(t){return t=parseFloat(t),isNaN(t)?0:t},getSizeStyleBorder:function(t,e){t instanceof A&&(t=t.element);var i=m.getStyle(t,e),s=e.replace("Width","Style"),s=m.getStyle(t,s);return m.convertBorderSize(s,i)},getAlpha:function(t){return m.getAlpha=document.defaultView&&document.defaultView.getComputedStyle?function(t){return parseFloat(m.getStyle(t,"opacity"))}:function(t){t=m.getStyle(t,"filter");var e=t.indexOf("opacity");return 0<=e?(t=t.substring(e).match(/\d+/g))?parseFloat(t[0])/100:void 0:1},m.getAlpha(t)},setStyle:function(t,e,i){t instanceof A&&(t=t.element),Tb.cssStyleList[e]&&(e=Tb.cssStyleList[e]);try{t.style[e]!==i&&(t.style[e]=i)}catch(s){}},setPxStyle:function(t,e,i){t instanceof A&&(t=t.element),m.setStyle(t,e,(isNaN(i)?parseFloat(i):i)+"px")},setPtStyle:function(t,e,i){m.setStyle(t,e,i+"pt")},clearStyle:function(t,e){t.style[e]&&(t.style.removeProperty?t.style.removeProperty(m.convertCamelCaseToDash(e)):t.style.removeAttribute(e))},setAlpha:function(t,e){return m.setAlpha=document.defaultView&&document.defaultView.getComputedStyle?function(t,e){m.setStyle(t,"opacity",e)}:function(t,e){m.setStyle(t,"filter","alpha(opacity="+100*e+")")},m.setAlpha(t,e)},getBorderMetrics:function(t){return m.getBorderMetrics=document.defaultView&&document.defaultView.getComputedStyle?function(t){t instanceof A&&(t=t.element),t=window.getComputedStyle(t);var e=m.convertBorderSize;return new Pc(e(t.borderLeftStyle,t.borderLeftWidth),e(t.borderTopStyle,t.borderTopWidth),e(t.borderRightStyle,t.borderRightWidth),e(t.borderBottomStyle,t.borderBottomWidth))}:function(t){t instanceof A&&(t=t.element),t=t.currentStyle;var e=m.convertBorderSize;return new Pc(e(t.borderLeftStyle,t.borderLeftWidth),e(t.borderTopStyle,t.borderTopWidth),e(t.borderRightStyle,t.borderRightWidth),e(t.borderBottomStyle,t.borderBottomWidth))},m.getBorderMetrics(t)},getPaddingMetrics:function(t){return m.getPaddingMetrics=document.defaultView&&document.defaultView.getComputedStyle?function(t){t instanceof A&&(t=t.element),t=window.getComputedStyle(t);var e=m.convertStyleSize;return new Pc(e(t.paddingLeft),e(t.paddingTop),e(t.paddingRight),e(t.paddingBottom))}:function(t){t instanceof A&&(t=t.element),t=t.currentStyle;var e=m.convertStyleSize;return new Pc(e(t.paddingLeft),e(t.paddingTop),e(t.paddingRight),e(t.paddingBottom))},m.getPaddingMetrics(t)},getBorderPaddingMetrics:function(t){return m.getBorderPaddingMetrics=document.defaultView&&document.defaultView.getComputedStyle?function(t){t instanceof A&&(t=t.element),t=window.getComputedStyle(t);var e=m.convertBorderSize,i=m.convertStyleSize;return new Pc(i(t.paddingLeft)+e(t.borderLeftStyle,t.borderLeftWidth),i(t.paddingTop)+e(t.borderTopStyle,t.borderTopWidth),i(t.paddingRight)+e(t.borderRightStyle,t.borderRightWidth),i(t.paddingBottom)+e(t.borderBottomStyle,t.borderBottomWidth))}:function(t){t instanceof A&&(t=t.element),t=t.currentStyle;var e=m.convertStyleSize,i=m.convertBorderSize;return new Pc(e(t.paddingLeft)+i(t.borderLeftStyle,t.borderLeftWidth),e(t.paddingTop)+i(t.borderTopStyle,t.borderTopWidth),e(t.paddingRight)+i(t.borderRightStyle,t.borderRightWidth),e(t.paddingBottom)+i(t.borderBottomStyle,t.borderBottomWidth))},m.getBorderPaddingMetrics(t)},pageXY:function(t){if(t instanceof A&&(t=t.element),t.getBoundingClientRect){t=t.getBoundingClientRect();var e=document.body,i=document.documentElement,s=t.top+(window.pageYOffset||i.scrollTop||e.scrollTop)-(i.clientTop||e.clientTop||0),e=t.left+(window.pageXOffset||i.scrollLeft||e.scrollLeft)-(i.clientLeft||e.clientLeft||0);return new ra(Math.round(e),Math.round(s))}for(e=s=0;t;)s+=parseInt(t.offsetTop),e+=parseInt(t.offsetLeft),t=t.offsetParent;return new ra(e,s)},getWidth:function(t){var e=m.getStyle(t,"width");if(F(e)){if("auto"===e||0<=e.indexOf("%")||0===e.length)return t=t.clientWidth}else if(O(e))return 0;return parseFloat(e)},getHeight:function(t){var e=m.getStyle(t,"height");if(F(e)){if("auto"===e||0<=e.indexOf("%")||0===e.length)return t=t.clientHeight}else if(O(e))return 0;return parseFloat(e)},getOffsetWidth:function(t){return t.offsetWidth},getOffsetHeight:function(t){return t.offsetHeight},getClientWidth:function(t){return t.clientWidth},getClientHeight:function(t){return t.clientHeight},getWindowSize:function(){var t="";return"number"==typeof window.innerWidth?t="w:window.innerWidth, h:window.innerHeight":document.documentElement&&document.documentElement.clientWidth?t="w:document.documentElement.clientWidth, h:document.documentElement.clientHeight":document.body&&document.body.clientWidth?t="w:document.body.clientWidth, h:document.body.clientHeight":document.width&&(t="w:document.width, h:document.height"),t="number"==typeof document.scrollTop?t+",t:document.scrollTop, l:document.scrollLeft":"number"==typeof window.pageYOffset?t+",t:window.pageYOffset, l:window.pageXOffset":"number"==typeof document.documentElement.scrollTop?t+",t:document.documentElement.scrollTop, l:document.documentElement.scrollLeft":"number"==typeof document.body.scrollTop?t+",t:document.body.scrollTop, l:document.body.scrollLeft":t+",t=0, l=0",Function("return{"+t+"}")()},getRootSize:function(t,e,i){var s,n,o,a=0,l=[],h={width:["Left","Right"],height:["Top","Bottom"]},d=m.getStyle,c=m.getSizeStyle,_=function(t){var e=0,i=m.getPaddingValue(t,["padding"+n,"padding"+o]);return"none"!=d(t,"borderStyle")&&(e=c(t,"border"+n+"Width")+c(t,"border"+o+"Width")),i+e};if(s=d(t,e),n=h[e][0],o=h[e][1],a+=_(t),l.push(i),"none"==d(t,"display")){if(/%/.test(s))for(l.push(s);t.parentNode;){if(s=d(t,e),d(t,r.boxSizing),a+=_(t),"auto"==s&&(s=l[l.length-1]),!/%/.test(s)){s||(s=t["offset"+Mc.lowerToUpper(e)]),s=parseInt(s);break}l.push(s),t=t.parentNode}else s=parseInt(s);for(/%/.test(i)&&"#document"==t.nodeName&&(s=t.body["client"+Mc.lowerToUpper(e)]),t=l.length-1;-1<t;--t)s=m.percent2px(s,l[t])}else s=m.percent2px(t["offset"+Mc.lowerToUpper(e)],i);return Math.round(s-a)},transPx:function(t,e){var i;return i=m.test,i("pt",e)?e=16+(Number(e.replace(/[a-z,A-Z,%]/g,""))-12):i("em",e)?e=16*Number(e.replace(/[a-z,A-Z,%]/g,"")):i("%",e)?(i=e,e=t.parentNode.offsetWidth,e-=m.getPaddingValue(t.parentNode,["paddingLeft","paddingRight"]),e=m.percent2px(e,i)):e=parseInt(e),Math.round(e)},getPaddingValue:function(t,e){var i,s,r,n=0;for(i=0,s=e.length;i<s;i+=1)r=m.getStyle(t,e[i]),m.test("px",r)?r=parseInt(r):"none"!=m.getStyle(t,"display")&&(r=m.transPx(t,r)),n+=parseInt(r);return n},isBold:function(t){return isNaN(t)?"bold"==t:700<=t},getFontFamily:function(t){if(t){var e;for(e=t&&0<t.indexOf(",")?t.split(","):[t],t=0;t<e.length;t++)e[t]=Mc.trim(e[t]),0<=e[t].indexOf("'")&&(e[t]=e[t].replace(/\'/g,"")),0<=e[t].indexOf('"')&&(e[t]=e[t].replace(/\"/g,""));return e}return null},findCSSSheet:function(t){var e=new RegExp("(^|\\s)\\."+t+"(\\s|$)","i");if(document.styleSheets)for(t=0;t<document.styleSheets.length;t++){var i,s=document.styleSheets[t],r=0;do{try{if((i=s.rules?s.rules[r]:s.cssRules?s.cssRules[r]:null)&&i.selectorText&&e.test(i.selectorText))return i}catch(n){}r++}while(i)}return null},findCSSSheetIndex:function(t){var e=new RegExp("(^|\\s)\\."+t+"(\\s|$)","i");if(document.styleSheets)for(t=0;t<document.styleSheets.length;t++){var i,s=document.styleSheets[t],r=0;do{try{if((i=s.rules?s.rules[r]:s.cssRules?s.cssRules[r]:null)&&i.selectorText&&e.test(i.selectorText))return t}catch(n){}r++}while(i)}return-1},findLocalCSSSheetIndex:function(t){var e=new RegExp("(^|\\s)\\."+t+"(\\s|$)","i");if(document.styleSheets)for(t=0;t<document.styleSheets.length;t++){var i,s=document.styleSheets[t],r=0;if(s&&!s.href)do{try{if((i=s.rules?s.rules[r]:s.cssRules?s.cssRules[r]:null)&&i.selectorText&&e.test(i.selectorText))return t}catch(n){}r++}while(i)}return-1},createCSSSheet:function(t){var e=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(e),e=e.sheet?e.sheet:e.styleSheet,e.addRule?e.addRule("."+t,null,0):e.insertRule("."+t+" { }",0);for(var i=0;document.styleSheets.length;i++)if(document.styleSheets[i]==e)return i;return m.findCSSSheetIndex(t)},findCSSRule:function(t,e){var i,s=0,r=new RegExp("(^|\\s)\\."+e+"(\\s|$)","i");do{if((i=t.rules?t.rules[s]:t.cssRules?t.cssRules[s]:null)&&i.selectorText&&r.test(i.selectorText))return i;s++}while(i);return null},getCSSRule:function(t,e){if(document.styleSheets){if(0<=t)return m.findCSSRule(document.styleSheets[t],e);for(var i,s=0;s<document.styleSheets.length;s++)if(i=m.findCSSRule(document.styleSheets[s],e))return i}return null},addCSSRule:function(t,e){if(document.styleSheets){var i=document.styleSheets[t];i&&p(m.findCSSRule(i,e))&&(i.addRule?i.addRule("."+e,null,0):i.insertRule("."+e+" { }",0))}return m.getCSSRule(t,e)},removeCSSRule:function(t,e){var i,s,r=0;if(document.styleSheets){i=document.styleSheets[t];do{if((s=i.rules?i.rules[r]:i.cssRules[r])&&s.selectorText&&s.selectorText==e){i.cssRules?i.deleteRule(r):i.removeRule(r);break}r++}while(s)}},indexOfChild:function(t){try{for(var e=0;t=t.previousSibling;)e++;return e}catch(i){}return-1},getChildAt:function(t,e){try{if(t.children)return t.children[e];if(t.childNodes)return t.childNodes[e]}catch(i){}return null},isParentOf:function(t,e){try{if(document.compareDocumentPosition)return!!(16&t.compareDocumentPosition(e));if(document.body.contains)return t!==e&&(!t.contains||t.contains(e));for(var i=t;i&&i.parentNode;)if(i=i.parentNode,i==e)return!0}catch(s){}return!1},serialization:function(t,e){var i,s=[],r=t;if(e.constructor==Array)for(i=0;i<e.length;i++)s.push(e[i].name+"="+encodeURIComponent(e[i].value));else for(i in e)s.push(i+"="+encodeURIComponent(e[i]));return r=-1<t.indexOf("?")?r+"&":r+"?",r+s.join("&")},percent2px:function(t,e){return/%/.test(e)&&(e=m.percent2num(e)),Math.floor(.01*e*t)},percent2num:function(t){return/%|px/.test(t)&&(t=t.replace(/%|px/,"")),parseFloat(t)},test:function(t,e){return new RegExp(t).test(e)},convertCamelCaseToDash:function(t){return p(t)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},convertDashToCamelCase:function(t){return p(t)?t:t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})},setBackgroundAlpha:function(t,e){if(r.ie8L)m.setStyle(t,"filter","progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*e+")");else{var i=m.getStyle(t,"backgroundColor");i&&m.setStyle(t,"backgroundColor",N.color2rgba(i,e))}},drawBackgroundColor:function(t,e,i){/rgb/.test(e)&&(e=N.rgbaArr2hex(N.color2RgbaArr(e)));var s,n,o=m.test("linear-gradient",e),a=m.setStyle;I(e)&&(e="#FFFFFF"),t instanceof A&&(t=t.element),r.ie8L||r.ie9?(a(t,"background",""),o&&(n=i,o=e,e=o.substring(o.indexOf("#")+1,o.indexOf(",")),s=o.substring(o.lastIndexOf("#"),o.indexOf(")"))),a(t,"filter",m.drawFilterGradient(e,i,s,n))):o?(r.safari&&(e="-webkit-"+e),a(t,"background",e)):a(t,"background",N.color2rgba(e,Number(i)))},drawFilterGradient:function(t,e,i,s){var r,n=N.hex2rgb,o=function(t){return t=Number(Math.round(100*t*2.55)).toString(16),0==t&&(t="00"),t};return t=r=n(t.replace(/#|0x/g,"")),i&&(r=n(i.replace(/#|0x/g,""))),e=i=o(e),s&&(i=o(s)),"progid:DXImageTransform.Microsoft.gradient(startColorstr='#"+e+t+"', endColorstr='#"+i+r+"')"},popUp:function(t,e,i){function s(t,e,i){var s,r;for(s in e)t.style[s]=e[s];for(s in i)r=i[s],I(r)&&(r=e[s]),t.style[s]=r}var r,n;for(r=0,n=t.element.childNodes;r<n;r++)if(t.element.childNodes[r].className==="Kool__"+i)return;r=e.title,n=e.content;var o=e.button,a=e.backgroundAlpha,l=this.createElement,h=m.setStyle,d=m.getSizeStyle,c=m.setPxStyle,_=m.drawBackgroundColor,u=0,p=0;I(a)&&(a=1);var g=l("div","Kool__"+i);i=e.width;var f=e.height;h(g,"overflow","hidden"),h(g,"position","absolute"),h(g,"padding",e.padding||"2px 2px 2px 2px"),h(g,"border",(e.borderStyle||"none")+" "+e.borderWidth+"px "+e.borderColor),_(g,e.backgroundColor||"#ffffff",a);var p=e.height,y=l("div","Button"),h={fontWeight:"normal",fontSize:"12px",fontFamily:"Arial",color:"#000000",textAlign:"center",padding:"2px 0px 0px 0px",cursor:"pointer"};if(s(y,h,o),c(y,"width",o.width||140),c(y,"height",o.height||18),_(y,o.backgroundColor||"#ffffff",a),y.innerHTML=o.text||"",u=0,p=p-d(y,"height")-u,O(e.width)&&(i=Math.max(140,d(y,"width"))),O(e.height)&&(f=d(y,"height")+u),v.addEvent(y,"mouseover",function(){_(y,o.mouseOverColor||"#eeeeee",1)}),v.addEvent(y,"mouseout",function(){_(y,o.backgroundColor||"#ffffff",1)}),v.addEvent(y,"click",function(){g.parentNode.removeChild(g)}),r){a=r.backgroundAlpha,I(a)&&(a=1);var b=l("div","Title"),h={fontWeight:"bold",fontSize:"12px",fontFamily:"Arial",color:"#000000",textAlign:"center",padding:"2px 0px 0px 0px"};s(b,h,r),c(b,"width",r.width||140),c(b,"height",r.height||18),_(b,r.backgroundColor||"#ffffff",a),b.innerHTML=r.text||"",u=d(b,"paddingTop")+d(b,"paddingBottom"),p=p-d(b,"height")-u,O(e.width)&&(i=Math.max(i,d(b,"width"))),O(e.height)&&(f+=d(b,"height")+u)}if(n){a=n.backgroundAlpha,I(a)&&(a=1);var S=l("div","Content"),h={overflowY:"auto",fontWeight:"normal",fontSize:"12px",fontFamily:"Arial",color:"#000000",textAlign:"left",padding:"2px 0px 0px 0px",overflowX:"hidden"};s(S,h,n),p-=6,(O(p)||0>p)&&(p=0),c(S,"width",n.width||140),c(S,"height",p||62),_(S,n.backgroundColor||"#ffffff",a),S.innerHTML=n.text||"",O(e.width)&&(i=Math.max(i,d(S,"width"))),O(e.height)&&(f+=d(S,"height")+d(S,"paddingTop")+d(S,"paddingBottom"))}c(g,"width",i),c(g,"height",f),c(g,"left",Math.round(e.x||.5*(t.getWidth()-i-d(g,"paddingLeft")-d(g,"paddingRight")))),c(g,"top",Math.round(e.y||.5*(t.getHeight()-f-d(g,"paddingTop")-d(g,"paddingBottom")))),b&&g.appendChild(b),S&&g.appendChild(S),y&&g.appendChild(y),t.element.appendChild(g)},getHtmlSize:function(t,e){var i=document.createElement("div");i.style.visibility="hidden",i.style.font=e,i.innerHTML=t,i.style.display="inline",document.body.appendChild(i);var s=i.offsetWidth,r=i.offsetHeight;return document.body.removeChild(i),
{width:s,height:r}},getElementsByClassName:function(t){if(r.ie8L){for(var e,i,s=new RegExp("(?:^|\\s)"+t+"(?:$|\\s)"),n=document.getElementsByTagName("*"),o=[],a=0;i=n[a+=1];)(e=i.className)&&-1!==e.indexOf(t)&&(e===t||s.test(e))&&(o[o.length]=i);t=o}else t=window.document.getElementsByClassName(t);return t},unit2px:function(t,e){var i=m.getSizeStyle(t,"fontSize");return void 0==e?0:Xa(e)?m.getSizeStyle(t,"fontSize")*e:-1<e.indexOf("normal")?m.getSizeStyle(t,"fontSize"):-1<e.indexOf("px")?parseInt(e):-1<e.indexOf("pt")?.75*parseInt(e):-1<e.indexOf("em")||Xa(Number(e))?i*parseInt(e):-1<e.indexOf("%")?.01*i*parseInt(e):void 0},getFontStyle:function(t){var e=this.getStyle;return t instanceof A&&(t=t.element),{color:e(t,"color"),fontSize:e(t,"fontSize"),fontStyle:e(t,"fontStyle"),fontFamily:e(t,"fontFamily"),fontWeight:e(t,"fontWeight"),textDecoration:e(t,"textDecoration"),textAlign:e(t,"textAlign"),textIndent:e(t,"textIndent"),lineHeight:e(t,"lineHeight"),letterSpacing:e(t,"letterSpacing")}}},te=function(){var t,e,i,s,r={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},n=function(e){throw{name:"SyntaxError",message:e,at:t,text:i}},o=function(s){return s&&s!==e&&n("Expected '"+s+"' instead of '"+e+"'"),e=i.charAt(t),t+=1,e},a=function(){var t;for(t="","-"===e&&(t="-",o("-"));"0"<=e&&"9">=e;)t+=e,o();if("."===e)for(t+=".";o()&&"0"<=e&&"9">=e;)t+=e;if("e"===e||"E"===e)for(t+=e,o(),"-"!==e&&"+"!==e||(t+=e,o());"0"<=e&&"9">=e;)t+=e,o();return t=+t,isFinite(t)?t:void n("Bad number")},l=function(){var t,i,s,a="";if('"'===e)for(;o();){if('"'===e)return o(),a;if("\\"===e)if(o(),"u"===e){for(i=s=0;4>i&&(t=parseInt(o(),16),isFinite(t));i+=1)s=16*s+t;a+=String.fromCharCode(s)}else{if("string"!=typeof r[e])break;a+=r[e]}else a+=e}n("Bad string")},h=function(){for(;e&&" ">=e;)o()},d=function(){switch(e){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null}n("Unexpected '"+e+"'")};return s=function(){switch(h(),e){case"{":var t;t:{var i={};if("{"===e){if(o("{"),h(),"}"===e){o("}"),t=i;break t}for(;e;){if(t=l(),h(),o(":"),Object.hasOwnProperty.call(i,t)&&n('Duplicate key "'+t+'"'),i[t]=s(),h(),"}"===e){o("}"),t=i;break t}o(","),h()}}n("Bad object"),t=void 0}return t;case"[":t:{if(t=[],"["===e){if(o("["),h(),"]"===e){o("]");break t}for(;e;){if(t.push(s()),h(),"]"===e){o("]");break t}o(","),h()}}n("Bad array"),t=void 0}return t;case'"':return l();case"-":return a();default:return"0"<=e&&"9">=e?a():d()}},function(r,o){var a;return i=r,t=0,e=" ",a=s(),h(),e&&n("Syntax error"),"function"==typeof o?function l(t,e){var i,s,r=t[e];if(r&&"object"==typeof r)for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s=l(r,i),void 0!==s?r[i]=s:delete r[i]);return o.call(t,e,r)}({"":a},""):a}}(),ua={stringCompare:function(t,e,i){return t||e?t?e?(i&&(t=t.toLowerCase(),e=e.toLowerCase()),t=t==e?0:t>e?1:-1,-1>t?t=-1:1<t&&(t=1),t):-1:1:0},numericCompare:function(t,e){return O(t)&&O(e)?0:O(t)?1:O(e)||t<e?-1:t>e?1:0},dateCompare:function(t,e){if(!dc(t)&&!dc(e))return 0;if(!dc(t))return 1;if(!dc(e))return-1;var i=t.getTime(),s=e.getTime();return i<s?-1:i>s?1:0},guid:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return t()+t(!0)+t(!0)+t()},copy:function(t){if(null==t||"object"!=typeof t)return t;var e,i=t.constructor();for(e in t)t.hasOwnProperty(e)&&(i[e]=ua.copy(t[e]));return i},findFunction:function(t){if(U(t))return t;if(0<=t.indexOf(".")){t=t.split(".");var e,i=window;try{for(e=0;e<t.length;e++)if(i=i[t[e]],void 0==i)return}catch(s){return}return i}return window[t]},toXMLString:function(t){var e,i,s,r,n,o="",a="",l="",h=1<arguments.length?arguments[1]:void 0;if(h&&"Style"==h){o+=">";for(r in t){o+=r+"{";for(n in t[r])o+=n+":"+t[r][n]+";";o+="}"}return o+"</"+h+">"}for(r in t)if(o=r,s=t[r],ha(s)){if(s[0])if(Ea(s[0])){for(a+="<"+o+">",e=0,i=s.length;e<i;e+=1)for(n in s[e])a+="<"+n+" "+ua.toXMLString(s[e][n],n);a+="</"+o+">"}else l+=r+'="['+ua.transXMLInvalidChar(s)+']" '}else Ea(s)?a+="<"+o+" "+ua.toXMLString(s,o):U(s)?((I(this._funcCount)||p(this._funcCount))&&(this._funcCount=0,this._tempFunc={}),this._tempFunc["function_"+this._funcCount]=s,l+=r+'="{function_'+this._funcCount++ +'}"'):l+=r+'="'+s+'" ';return h=h?"</"+h+">":"",""!=a&&""!=l?l+">"+a+h:""!=a?(h&&(a=">"+a),a+=h,!h&&this._tempFunc?(e=ua.copy(this._tempFunc),this._tempFunc=this._funcCount=null,{layout:a,functions:e}):a):(h?"":"<")+l+"/>"},transXMLInvalidChar:function(t){if(!F(t))return t;var e,i,s=['"',"'","<",">","&"],r=["&quot;","&apos;","&lt;","&gt;","&amp;"];for(e=0,i=s.length;e<i;e+=1)-1<t.indexOf(s[e])&&(t=t.replace(r[e],s[e]),t=t.replace(s[e],r[e]));return t},getChildLength:function(t){var e,i=0;for(e in t)i++;return i}};rc.prototype.startTimeout=function(t,e){var i=rc.timer;i(function(){e.call(t)})},rc.prototype.start=function(){var t;this._stopped?this._stopped=!1:(t=rc.timer,this._timer=t(this._frameHandler))},rc.prototype.stop=function(){var t=rc.clearTimer;t(this._timer),this._stopped=!0},rc.prototype.reset=function(){this.stop()};try{rc._init=function(){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;if(t&&t(function(){}),t||e){if(t&&!e){var i,s=t;rc.__animationCache={},t=function(t){return i=s(function(){rc.__animationCache[i]&&t()}),rc.__animationCache[i]=!0,i},e=function(t){rc.__animationCache[t]=null}}}else t=function(t){return window.setTimeout(t,5)},e=window.clearTimeout;rc.timer=t,rc.clearTimer=e,rc._init=t=e=null}()}catch(a){}var Bd=function(){this.buffer=[]};Bd.prototype.append=function(t){this.buffer.push(t)},Bd.prototype.toString=function(){return this.buffer.join("")};var Tb={productCSSSheetIndex:-2,sizeInvalidatingStyles:{border:1,borderStyle:1,borderWidth:1,borderTopStyle:1,borderTopWidth:1,borderBottomStyle:1,borderBottomWidth:1,borderLeftStyle:1,borderLeftWidth:1,borderRightStyle:1,borderRightWidth:1,fontFamily:1,fontSize:1,fontStyle:1,fontVariant:1,fontWeight:1,headerHeight:1,horizontalAlign:1,horizontalGap:1,lineHeight:1,letterSpacing:1,padding:1,paddingBottom:1,paddingLeft:1,paddingRight:1,paddingTop:1,strokeWidth:1,tabHeight:1,tabWidth:1,verticalAlign:1,verticalGap:1},mustHavePxStyles:{padding:1,paddingLeft:1,paddingRight:1,paddingTop:1,paddingBottom:1,borderWidth:1,borderLeftWidth:1,borderRightWidth:1,borderTopWidth:1,borderBottomWidth:1,borderRadius:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderTopLeftRadius:1,borderTopRightRadius:1,margin:1,marginLeft:1,marginRight:1,marginTop:1,marginBottom:1,fontSize:1,letterSpancing:1,lineHeight:1,outlineWidth:1,textIndent:1},cssStyleList:{cornerRadius:"borderRadius",borderThickness:"borderWidth"},changedPropList:{width:"gaugeWidth",height:"gaugeHeight",linearColumnWidth:"cylinderColumnWidth"}},V={ALPHA_CHAR_CODES:[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70],uidDictionary:{},createUID:function(){var t,e,i=Array(36),s=0;for(t=0;8>t;t++)i[s++]=this.ALPHA_CHAR_CODES[Math.floor(16*Math.random())];for(t=0;3>t;t++)for(i[s++]=45,e=0;4>e;e++)i[s++]=this.ALPHA_CHAR_CODES[Math.floor(16*Math.random())];for(i[s++]=45,e=("0000000"+(new Date).getTime().toString(16).toUpperCase()).substr(-8),t=0;8>t;t++)i[s++]=e.charCodeAt(t);for(t=0;4>t;t++)i[s++]=this.ALPHA_CHAR_CODES[Math.floor(16*Math.random())];return String.fromCharCode.apply(null,i)},isUID:function(t){if(null!=t&&36==t.length){for(var e=0;36>e;e++){var i=t.charCodeAt(e);if(8==e||13==e||18==e||23==e){if(45!=i)return!1}else if(48>i||70<i||57<i&&65>i)return!1}return!0}return!1},getUID:function(t){var e=null;if(null==t)return e;if(F(t))return t;try{if(t.uid)return t.uid;if(E(t)){var i=t.nodeType;if(3===i||2===i||8===i)return t.toString();t.hasOwnProperty?e=t.uid=this.createUID():(e=t.getAttribute("rm_internal_uid"),e||(e=this.createUID(),t.setAttribute("rm_internal_uid",e)))}else{if(t.hasOwnProperty("rm_internal_uid"))return t.rm_internal_uid;if(e=t.hasOwnProperty("uno")?this.uidDictionary[t.uno]:this.uidDictionary[t],!e){e=this.createUID();try{t.rm_internal_uid=e}catch(s){this.uidDictionary[t]=e}}}}catch(s){e=t.toString()}return e}},G={elementToString:function(t){return t?window.XMLSerializer?(new window.XMLSerializer).serializeToString(t):t.xml:""},getProperty:function(t,e){return-1!=e.indexOf("@")?G.getAttribute(t,e.split("@")[1]):G.getElementProperty(t,e)},getAttribute:function(t,e){if(t)try{return t.getAttribute(e)}catch(i){try{return t.attributes[e]}catch(s){}}return null},getElementProperty:function(t,e){if(t){var i=t.getElementsByTagName(e);if(i&&0<i.length)return i[0].textContent||i[0].text}return null},getElement:function(t,e){if(t){var i=t.getElementsByTagName(e);if(i&&0<i.length)return i[0]}return null},getElements:function(t,e){if(t){var i=t.getElementsByTagName(e);if(i&&0<i.length)return i}return null},setProperty:function(t,e,i){-1!=e.indexOf("@")?G.setAttribute(t,e.split("@")[1],i):G.setElementProperty(t,e,i)},setAttribute:function(t,e,i){if(t)try{t.setAttribute(e,i)}catch(s){try{return t.attributes[e]=i}catch(r){}}},setElementProperty:function(t,e,i){if(t){var s=t.getElementsByTagName(e);s&&0<s.length?F(s[0].textContent)?s[0].textContent=i:s[0].text=i.toString():(e=9===t.nodeType?t.createElement(e):t.ownerDocument.createElement(e),F(e.textContent)?e.textContent=i:e.text=i.toString(),t.appendChild(e))}},hasElementProperty:function(t,e){if(t){var i=t.getElementsByTagName(e);if(i&&0<i.length)return!0}return!1},getFirstElementChild:function(t){if(t&&0<t.childNodes.length){if(t.firstElementChild)return t.firstElementChild;for(t=t.firstChild;t;t=t.nextSibling)if(1===t.nodeType)return t}return null},escapeXML:function(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):""},parse:function(t){if(""==t||!t)return null;var e,i;try{window.DOMParser?(e=new DOMParser,i=e.parseFromString(t,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t))}catch(s){throw"Invalid XML e:"+s.message}if(!i||""===i.textContent)throw"Invalid XML";if(e=i.documentElement,!e&&i.parseError)throw"Invalid XML line:"+i.parseError.line+" "+i.parseError.reason;if(!e||!e.nodeName||"parsererror"===e.nodeName)throw"Invalid XML :"+(e&&e.innerHTML?e.innerHTML:e);if(e.firstElementChild&&"parsererror"===e.firstElementChild.nodeName)throw"Invalid XML :"+e.firstElementChild.innerHTML;return i},convertToArray:function(t,e){if(t){var i,s,r,n,o,a,l,h,d=[],c=t.getElementsByTagName(e);for(i=0,r=c.length;i<r;i++)if(s=c[i],1==s.nodeType){for(h=s.childNodes,o={},s=0,n=h.length;s<n;s++)1==h[s].nodeType&&(a=h[s].nodeName,l=h[s].textContent||h[s].text,o[a]=O(parseInt(l))?l:parseInt(l));d[i]=o}return d}}},Mb={parseWithFormat:function(t,e){var i,s,r,n,o,a="",l="",h=i="",d="",c="",_=0;if(e&&t&&0<e.length&&e.length==t.length){for(o=e.length,n=0;n<o;n++,_++)if(r=""+t.charAt(_),s=""+e.charAt(n),"M"==s)isNaN(Number(r))||" "==r?_--:l+=r;else if("D"==s)isNaN(Number(r))||" "==r?_--:a+=r;else if("H"==s)isNaN(Number(r))||" "==r?_--:h+=r;else if("N"==s||"m"==s)isNaN(Number(r))||" "==r?_--:d+=r;else if("S"==s)isNaN(Number(r))||" "==r?_--:c+=r;else if("Y"==s)i+=r;else if(!isNaN(Number(r))&&" "!=r)return Mb.parse(t);return r=""+t.charAt(e.length-n+_),""!=r&&" "!=r?NaN:(s=Number(l),a=Number(a),r=Number(i),h=Number(h),d=Number(d),c=Number(c),isNaN(r)||isNaN(s)||isNaN(a)?NaN:(2==i.length&&70>r&&(r+=2e3),i=new Date(r,s-1,a,isNaN(h)?0:h,isNaN(d)?0:d,isNaN(c)?0:c),a!=i.getDate()||s-1!=i.getMonth()?NaN:i.getTime()))}return Mb.parse(t)},parse:function(t){var e,i=Date.parse(t);if(isNaN(i)||0xe677cb1a5fbf<i){var s=t.toString();if(F(t)&&8==t.length||Xa(t)&&8==s.length)try{i=new Date(s.substr(0,4),Number(s.substr(4,2))-1,s.substr(6,2)),i=i.getTime()}catch(r){i=NaN}else if(F(t)&&14==t.length||Xa(t)&&14==s.length)try{i=new Date(s.substr(0,4),Number(s.substr(4,2))-1,s.substr(6,2),s.substr(8,2),s.substr(10,2),s.substr(12,2)),i=i.getTime()}catch(r){i=NaN}else if(0<s.indexOf("-"))try{i=Date.parse(s.replace(/-/g,"/"))}catch(r){i=NaN}else if(0<s.indexOf("."))try{i=Date.parse(s.replace(/\./g,"/"))}catch(r){i=NaN}else if(0>s.indexOf("/")&&(F(t)&&6==t.length||Xa(t)&&6==s.length))try{e=parseInt(s.substr(0,2)),i=new Date(70<e?1900+e:2e3+e,Number(s.substr(2,2))-1,s.substr(4,2)),i=i.getTime()}catch(r){i=NaN}}else if(F(t)&&0<t.indexOf("-"))try{i=Date.parse(t.replace(/-/g,"/"))}catch(r){i=NaN}return i},toISOString:function(t){function e(t){return 10>t?"0"+t:t}return t?t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z":""}},hb=function(t){wa.call(this),this.parsedFieldCount=0,this.parsingDate=!1,this._csvStr=null,this._fdNo=this._resultPnt=this._strPnt=0,this._intReg=/^[-]?\d+$/,this._floatReg=/^[-]?\d*\.\d+$/,this._fieldEnclosureSymbol='"',this._fieldSeperator=t?t:",",this._headerCnt=0,this._recordSeperator="\n",this._recordSeperator2="\r"};z(hb,wa),hb.prototype.getFieldEnclosureSymbol=function(){return this._fieldEnclosureSymbol},hb.prototype.setFieldEnclosureSymbol=function(t){this._fieldEnclosureSymbol=t},hb.prototype.getFieldSeperator=function(){return this._fieldSeperator},hb.prototype.setFieldSeperator=function(t){this._fieldSeperator=t},hb.prototype.getFieldNames=function(){return this._fieldNames},hb.prototype.setFieldNames=function(t){this._fieldNames=t},hb.prototype.getParsedArray=function(){return this._parsedArray},hb.prototype.getParsedHeaders=function(){return this._parsedHeaders},hb.prototype.getHeaderCnt=function(){return this._headerCnt},hb.prototype.setHeaderCnt=function(t){this._headerCnt=t},hb.prototype.getRecordSeperator=function(){return this._recordSeperator},hb.prototype.setRecordSeperator=function(t){this._recordSeperator=t,this._recordSeperator2="\n"==this._recordSeperator?"\r":"\r"==this._recordSeperator?"\n":""},hb.prototype.parse=function(t){var e,i,s,r=this.parseFunction?ua.findFunction(this.parseFunction):null;if(this.parsedFieldCount=0,this._csvStr=t,this._parsedHeaders=[],this._parsedArray=[],this._resultPnt=this._strPnt=0,!this._csvStr)return null;for(t=this._csvStr.length;this._strPnt<t;){if(e=this._lineScan(),this._resultPnt<this._headerCnt){for(i=[],s=0;s<this._fdNo;s++)this._fieldNames?i.push(e[this._fieldNames[s]]):i.push(e["F"+s]);this._parsedHeaders.push(i)}else r&&(e=r(e,this._csvLine,this._resultPnt)),this._parsedArray.push(e);this._resultPnt++}return this._parsedArray},hb.prototype.parseAsync=function(t){this.parsedFieldCount=0,this._csvStr=t,this._parsedHeaders=[],this._parsedArray=[],this._resultPnt=this._strPnt=0,this._csvStr?this.parseLinesAsync():(t=new w(w.COMPLETE,(!1),(!1)),this.dispatchEvent(t))},hb.prototype.parseLinesAsync=function(){for(var t,e,i,s=this._csvStr.length,r=this.parseFunction?ua.findFunction(this.parseFunction):null;this._strPnt<s;){if(i=this._lineScan(),this._resultPnt<this._headerCnt){for(e=[],t=0;t<this._fdNo;t++)this._fieldNames?e.push(i[this._fieldNames[t]]):e.push(i["F"+t]);this._parsedHeaders.push(e)}else r&&(i=r(i,this._csvLine,this._resultPnt)),this._parsedArray.push(i);if(this._resultPnt++,0==this._resultPnt%1e3)return s=new cc(cc.PROGRESS,(!1),(!1),this._strPnt,s),this.dispatchEvent(s),void setTimeout(this.parseLinesAsync,5)}s=new cc(cc.PROGRESS,(!1),(!1),this._strPnt,s),this.dispatchEvent(s),s=new w("complete",(!1),(!1)),this.dispatchEvent(s)},hb.prototype._lineScan=function(){var t,e,i,s=!1,r=this._csvStr.length,n={},o="",a=this._strPnt,l=this._strPnt;for(this._fdNo=0,t=this._strPnt;t<r;t++){if(e=this._csvStr.charAt(t),i=this._csvStr.charAt(t+1),s)e==this._fieldEnclosureSymbol&&i==this._fieldEnclosureSymbol&&(o+=this._csvStr.substring(a,l+1),l=a=t+1),e!=this._fieldEnclosureSymbol&&l++;else if(e!=this._fieldEnclosureSymbol)if(e==this._fieldSeperator)o+=this._csvStr.substring(a,l),this._fieldNames?this._fdNo<this._fieldNames.length&&(n[this._fieldNames[this._fdNo++]]=this._getValue(o)):n["F"+this._fdNo++]=this._getValue(o),o="",l=a=t+1,this.parsedFieldCount=Math.max(this.parsedFieldCount,this._fdNo);else{if(e==this._recordSeperator)return o+=this._csvStr.substring(a,l),this._fieldNames?this._fdNo<this._fieldNames.length&&(n[this._fieldNames[this._fdNo++]]=this._getValue(o)):n["F"+this._fdNo++]=this._getValue(o),this.parseFunction&&(this._csvLine=this._csvStr.substring(this._strPnt,t)),this._strPnt=t+1,this.parsedFieldCount=Math.max(this.parsedFieldCount,this._fdNo),n;e!=this._recordSeperator2&&l++}e==this._fieldEnclosureSymbol&&(s||(l=a=t+1),s=!s)}return o+=this._csvStr.substring(a,l),this._fieldNames?this._fdNo<this._fieldNames.length&&(n[this._fieldNames[this._fdNo++]]=this._getValue(o)):n["F"+this._fdNo++]=this._getValue(o),this.parseFunction&&(this._csvLine=this._csvStr.substring(this._strPnt,t)),this._strPnt=t,this.parsedFieldCount=Math.max(this.parsedFieldCount,this._fdNo),n},hb.prototype._getValue=function(t){var e;if(this._intReg.test(t)&&0!=t.indexOf("0")&&(e=parseInt(t),!isNaN(e))||this._floatReg.test(t)&&(e=parseFloat(t),!isNaN(e)))return e;if(this.parsingDate&&(0<=t.indexOf("/")||0<=t.indexOf("-")||0<=t.indexOf(":")))try{if(e=Mb.parse(t),!isNaN(e))return new Date(e)}catch(i){}return Mc.trim(t)},hb.prototype.fastParse=function(t){var e,i,s,r=this.parseFunction?ua.findFunction(this.parseFunction):null;if(this.parsedFieldCount=0,this._csvStr=t,this._parsedHeaders=[],this._parsedArray=[],this._resultPnt=this._strPnt=0,this._csvLines=this._csvStr.split(this._recordSeperator),this._fieldNames)for(t=0;t<this._csvLines.length;t++)if(i=this._csvLines[t].split(this._fieldSeperator),t<this._headerCnt)this._parsedHeaders.push(i);else{for(s={},this.parsedFieldCount=Math.max(this.parsedFieldCount,i.length),e=0;e<i.length;e++)e<this._fieldNames.length&&(s[this._fieldNames[e]]=i[e]);r&&(s=r(s,this._csvLines[t],t)),this._parsedArray.push(s)}else for(t=0;t<this._csvLines.length;t++)if(i=this._csvLines[t].split(this._fieldSeperator),t<this._headerCnt)this._parsedHeaders.push(i);else{for(s={},this.parsedFieldCount=Math.max(this.parsedFieldCount,i.length),e=0;e<i.length;e++)s["F"+e]=i[e];r&&(s=r(s,this._csvLines[t],t)),this._parsedArray.push(s)}return this._parsedArray},hb.prototype.fastParseAsync=function(t){this.parsedFieldCount=0,this._csvStr=t,this._parsedHeaders=[],this._parsedArray=[],this._resultPnt=this._strPnt=0,this._csvStr?(this._csvLines=this._csvStr.split(this._recordSeperator),this._fastParseLinesAsync()):(t=new w(w.COMPLETE,(!1),(!1)),this.dispatchEvent(t))},hb.prototype._fastParseLinesAsync=function(){var t,e,i,s,r=this._csvLines.length,n=this.parseFunction?ua.findFunction(this.parseFunction):null;for(t=this._resultPnt;t<r;t++){if(i=this._csvLines[t].split(this._fieldSeperator),t<this._headerCnt)this._parsedHeaders.push(i);else{for(s={},this.parsedFieldCount=Math.max(this.parsedFieldCount,i.length),e=0;e<i.length;e++)this._fieldNames?e<this._fieldNames.length&&(s[this._fieldNames[e]]=i[e]):s["F"+e]=i[e];n&&(s=n(s,this._csvLines[t],t)),this._parsedArray.push(s)}if(this._resultPnt++,0==this._resultPnt%1e4)return r=new cc(cc.PROGRESS,(!1),(!1),this._resultPnt,r),this.dispatchEvent(r),void setTimeout(this._fastParseLinesAsync,5)}r=new cc(cc.PROGRESS,(!1),(!1),this._resultPnt,r),this.dispatchEvent(r),r=new w("complete",(!1),(!1)),this.dispatchEvent(r)},hb.encode=function(t,e){return t?0<=t.indexOf("\n")||0<=t.indexOf(e)?'"'+(0<=t.indexOf('"')?t.replace(/\"/g,'""'):t)+'"':0<=t.indexOf('"')?'"'+t.replace(/\"/g,'""')+'"':t:t},sc.REPEAT_DELAY=500,z(sc,wa),sc.prototype.getDelay=function(){return this._delay},sc.prototype.setDelay=function(t){this._delay=t},sc.prototype.getRepeatCount=function(){return this._repeatCount},sc.prototype.setRepeatCount=function(t){this._repeatCount=t,this._running&&t<=this._currentCount&&this.stop()},sc.prototype.getCurrentCount=function(){return this._currentCount},sc.prototype.getRunning=function(){return this._running},sc.prototype.start=function(){var t=this;t._running||(t._running=!0,t._timer=setTimeout(function(){t._timerHandler.call(t)},t._delay))},sc.prototype.stop=function(){this._timer&&clearTimeout(this._timer),this._timer=null,this._running=!1},sc.prototype.reset=function(){this._timer&&clearTimeout(this._timer),this._timer=null,this._running=!1,this._currentCount=0},sc.prototype._timerHandler=function(){var t=this;t._currentCount++,0<t._repeatCount&&t._currentCount==t._repeatCount?(t._running&&t.dispatchEvent(new w("timerComplete")),t._running=!1):(0==t._repeatCount||t._currentCount<t._repeatCount)&&t._running&&(t._timer&&clearTimeout(t._timer),t.dispatchEvent(new w("timer")),t._running&&(t._timer=setTimeout(function(){t._timerHandler.call(t)},t._delay)))};var t=function(t){this.getValue=function(){return t}};t.prototype.getViewIndex=function(){return-1},t.getFIRST=function(){return t._first||(t._first=new t("${F}")),t._first},t.getLAST=function(){return t._last||(t._last=new t("${L}")),t._last},t.getCURRENT=function(){return t._current||(t._current=new t("${C}")),t._current};var xb=function(){wa.call(this)};z(xb,wa),xb.prototype.contains=function(t){throw"must override contains method in "+this.constructor.name},xb.prototype.createCursor=function(t){throw"must override createCursor method in "+this.constructor.name},xb.prototype.disableAutoUpdate=function(){throw"must override disableAutoUpdate method in "+this.constructor.name},xb.prototype.enableAutoUpdate=function(){throw"must override enableAutoUpdate method in "+this.constructor.name},xb.prototype.itemUpdated=function(t,e,i,s){throw"must override itemUpdated method in "+this.constructor.name},xb.prototype.refresh=function(){throw"must override refresh method in "+this.constructor.name};var S=function(t,e,i){this._resultHandler=t,this._faultHandler=e,this._token=i};S.prototype.result=function(t){this._resultHandler(t,this._token)},S.prototype.fault=function(t){this._faultHandler(t,this._token)};var la=function(t){wa.call(this),this._sort=this._list=this._localIndex=this.filterFunction=null,this._autoUpdateCounter=0,this._dispatchResetEvent=!0,this._eventDispatcher=new wa,arguments.length?this.setList(t):this.setList(null)};z(la,xb),la.prototype.getLength=function(){return this._localIndex?this._localIndex.length:this._list?this._list.getLength():0},la.prototype.getList=function(){return this._list},la.prototype.setList=function(t){if(this._list!=t){var e=!1,i=!1;this._list&&(this._list.removeEventListener(y.COLLECTION_CHANGE,this._listChangeHandler,this),e=0<this._list.getLength()),(this._list=t)&&(this._list.addEventListener(y.COLLECTION_CHANGE,this._listChangeHandler,this),i=0<this._list.getLength()),(e||i)&&this.reset(),this.dispatchEvent(new w("listChanged"))}},la.prototype.getSort=function(){return this._sort},la.prototype.setSort=function(t){this._sort=t},la.prototype.addAll=function(t){this.addAllAt(t,this.getLength())},la.prototype.addAllAt=function(t,e){var i,s,r,n;if(ha(t))for(i=0;i<t.length;i++)this._list.addItemAt(t[i],e+i);else{if(E(t)?n=9===t.nodeType?t.documentElement.childNodes:t.childNodes:Uc(t)&&(n=0<t.length&&9===t[0].parentNode.nodeType?t[0].parentNode.documentElement.childNodes:t[0].parentNode.childNodes),!n)throw Error("children not found error in addAllAt "+e);for(s=i=0,r=n.length;i<r;i++)1===n[i].nodeType&&this._list.addItemAt(n[i],e+s++)}},la.prototype.addItem=function(t){this.addItemAt(t,this.getLength())},la.prototype.addItemAt=function(t,e){if(0>e||e>this.getLength())throw new vc("Out of range error "+e);var i=e;this._localIndex&&this._sort?i=this._list.getLength():this._localIndex&&null!=this.filterFunction&&(i=i===this._localIndex.length?this._list.getLength():this._list.getItemIndex(this._localIndex[e])),this._list.addItemAt(t,i)},la.prototype.getItemAt=function(t){if(0>t||t>=this.getLength())throw new vc("Out of range error "+t);return this._localIndex?this._localIndex[t]:this._list?this._list.getItemAt(t):null},la.prototype.getItemIndex=function(t){return this._sort||null!=this.filterFunction?Ra.indexOf(this._localIndex,t):this._list.getItemIndex(t)},la.prototype.getLocalItemIndex=function(t){var e,i;if(this._localIndex)for(i=this._localIndex.length,e=0;e<i;e++)if(this._localIndex[e]==t)return e;return-1},la.prototype.removeItemAt=function(t){if(0>t||t>=this.getLength())throw new vc("Out of range error "+t);var e=t;return this._localIndex&&(e=this._list.getItemIndex(this._localIndex[t])),this._list.removeItemAt(e)},la.prototype.removeAll=function(){var t;if(t=this.getLength(),0<t)if(this._localIndex)for(--t;0<=t;t--)this.removeItemAt(t);else this._list.removeAll()},la.prototype.setItemAt=function(t,e){if(0>e||e>=this.getLength())throw new vc("Out of range error "+e);var i=e;return this._localIndex&&(i=e>this._localIndex.length?this._list.getLength():this._list.getItemIndex(this._localIndex[e])),this._list.setItemAt(t,i)},la.prototype.itemUpdated=function(t,e,i,s){this._list&&this._list.itemUpdated(t,e,i,s)},la.prototype.getProperty=function(t,e){return this._list?this._list.getProperty(t,e):null},la.prototype.setProperty=function(t,e,i){if(this._list)return this._list.setProperty(t,e,i)},la.prototype.getPropertyAt=function(t,e){return this._localIndex?this._list.getProperty(this._localIndex[t],e):this._list?this._list.getPropertyAt(t,e):null},la.prototype.setPropertyAt=function(t,e,i){this._localIndex?this._list.setProperty(this._localIndex[t],e,i):this._list&&this._list.setPropertyAt(t,e,i)},la.prototype.toArray=function(){return this._localIndex?this._localIndex.concat():this._list.toArray()},la.prototype.toString=function(){return this._localIndex?this._localIndex.toString():this._list&&this._list.toString?this._list.toString():this.constructor.name},la.prototype.contains=function(t){return-1!=this.getItemIndex(t)},la.prototype.createCursor=function(t){return new Na(this,t)},la.prototype.disableAutoUpdate=function(){this._autoUpdateCounter++},la.prototype.enableAutoUpdate=function(){0<this._autoUpdateCounter&&(this._autoUpdateCounter--,0===this._autoUpdateCounter&&this._handlePendingUpdates())},la.prototype.itemUpdated=function(t,e,i,s){this._list.itemUpdated(t,e,i,s)},la.prototype.refresh=function(){return this._internalRefresh(!0)},la.prototype.addEventListener=function(t,e,i,s,r){this._eventDispatcher.addEventListener(t,e,i,s,r)},la.prototype.removeEventListener=function(t,e,i,s){this._eventDispatcher.removeEventListener(t,e,i,s)},la.prototype.dispatchEvent=function(t){return this._eventDispatcher.dispatchEvent(t)},la.prototype.hasEventListener=function(t){return this._eventDispatcher.hasEventListener(t)},la.prototype.findItem=function(t,e,i){if(!this._sort)throw Error("itemNotFound");return 0===this._localIndex.length?i?0:-1:this._sort.findItem(this._localIndex,t,e,i)},la.prototype.reset=function(){this._internalRefresh(!1),this._dispatchResetEvent&&this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"reset",(-1),(-1)))},la.prototype.getBookmark=function(t){var e;if(0>t||t>this.getLength())throw Error("invalidIndex");try{e=this.getItemAt(t)}catch(i){e=null}return new ue(e,this,this._revision,t)},la.prototype.getBookmarkIndex=function(t){if(!(t instanceof ue)||t.view!=this)throw Error("bookmarkNotFound");if(t.viewRevision!=this._revision){if(0>t.index||t.index>=this.getLength()||this.getItemAt(t.index)!=t.getValue())try{t.index=this.getItemIndex(t.getValue())}catch(e){t.index=this.getLocalItemIndex(t.getValue())}t.viewRevision=this._revision}return t.index},la.prototype._getFilteredItemIndex=function(t){var e,i;if(t=this._list.getItemIndex(t),0==t)return 0;for(--t;0<=t;t--){var s=this._list.getItemAt(t);if(this.filterFunction(s))for(i=this._localIndex.length,e=0;e<i;e++)if(this._localIndex[e]==s)return e+1}return 0},la.prototype._addItemsToView=function(t,e,i){i=!!I(i)||i;var s=this._localIndex?[]:t,r=!0;if(this._localIndex){var n,o;for(n=0;n<t.length;n++){var a=t[n];if(null==this.filterFunction||this.filterFunction(a)){if(o=this._sort?this.findItem(a,Ac.ANY_INDEX_MODE,!0):this._getFilteredItemIndex(a),r&&(e=o,r=!1),this._sort&&this._sort.unique&&0==this._sort.compareFunction(a,this._localIndex[o]))throw Error("incorrectAddition");this._localIndex.splice(o++,0,a),s.push(a)}else e=-1}}return this._localIndex&&1<s.length&&(e=-1),i&&0<s.length&&(t=new y(y.COLLECTION_CHANGE,(!1),(!1),"add",e,(-1),s),this.dispatchEvent(t)),e},la.prototype._replaceItemsInView=function(t,e,i){if(i=!!I(i)||i,this._localIndex){var s,r=t.length,n=[],o=[];for(s=0;s<r;s++){var a=t[s];n.push(a.oldValue),o.push(a.newValue)}this._removeItemsFromView(n,e,i),this._addItemsToView(o,e,i)}else t=new y(y.COLLECTION_CHANGE,(!1),(!1),"replace",e,(-1),t),this.dispatchEvent(t)},la.prototype._moveItemInView=function(t,e,i){if(e=!!I(e)||e,this._localIndex){var s,r=-1;for(s=0;s<this._localIndex.length;s++)if(this._localIndex[s]===t){r=s;break}if(-1<r&&this._localIndex.splice(r,1),s=this._addItemsToView([t],r,!1),e){var n=new y(y.COLLECTION_CHANGE);n.items.push(t),i&&s==r&&-1<s?i.push(t):(-1<s&&-1<r?(n.kind="move",n.location=s,n.oldLocation=r):-1<s?(n.kind="add",n.location=s):-1<r?(n.kind="remove",n.location=r):e=!1,e&&this.dispatchEvent(n))}}},la.prototype._removeItemsFromView=function(t,e,i){i=!!I(i)||i;var s=this._localIndex?[]:t,r=e;if(this._localIndex)for(e=0;e<t.length;e++){var n=t[e],o=this.getItemIndex(n);-1<o&&(this._localIndex.splice(o,1),s.push(n),r=o)}i&&0<s.length&&(t=new y(y.COLLECTION_CHANGE,(!1),(!1),"remove",this._localIndex&&1!=s.length?-1:r,(-1),s),this.dispatchEvent(t))},la.prototype._listChangeHandler=function(t){if(0<this._autoUpdateCounter)this._pendingUpdates||(this._pendingUpdates=[]),this._pendingUpdates.push(t);else switch(t.kind){case"add":this._addItemsToView(t.items,t.location);break;case"reset":this.reset();break;case"remove":this._removeItemsFromView(t.items,t.location);break;case"replace":this._replaceItemsInView(t.items,t.location);break;case"update":this._handlePropertyChangeEvents(t.items);break;default:this.dispatchEvent(t)}},la.prototype._handlePropertyChangeEvents=function(t){var e=t;if(this._sort||null!=this.filterFunction){var i,s,r=[];for(i=0;i<t.length;i++){var n,e=t[i];e.target?(s=e.target,n=e.target!=e.source):(s=e.source,n=!1);for(var o=0;o<r.length;o++)if(r[o].item===s){var a,l=r[o].events,h=l.length;for(a=0;a<h;a++)if(l[a].property!=e.property){l.push(e);break}break}o<r.length?s=r[o]:(s={item:s,move:n,events:[e]},r.push(s)),s.move=s.move||null!=this.filterFunction||!e.property||this._sort&&this._sort.propertyAffectsSort(e.property)}for(e=[],i=0;i<r.length;i++)s=r[i],s.move?this._moveItemInView(s.item,s.item,e):e.push(s.item);for(s=[],t=0;t<e.length;t++)for(i=0;i<r.length;i++)e[t]===r[i].item&&(s=s.concat(r[i].events));e=s}0<e.length&&(r=new y(y.COLLECTION_CHANGE),r.kind="update",r.items=e,this.dispatchEvent(r))},la.prototype._handlePendingUpdates=function(){var t;if(this._pendingUpdates){t=this._pendingUpdates,this._pendingUpdates=null;var e,i,s;for(e=0;e<t.length;e++){var r=t[e];if("update"===r.kind)if(s)for(i=0;i<r.items.length;i++)s.items.push(r.items[i]);else s=r;else this._listChangeHandler(r)}s&&this._listChangeHandler(s)}},la.prototype._internalRefresh=function(t){if(this._sort||null!=this.filterFunction){var e=this.getList();if(this._localIndex=e?e.toArray():[],null!=this.filterFunction){var i,e=[],s=this._localIndex.length;for(i=0;i<s;i++){var r=this._localIndex[i];this.filterFunction(r)&&e.push(r)}this._localIndex=e}this._sort&&(this._sort.sort(this._localIndex),t=!0)}else this._localIndex&&(this._localIndex=null);return this._revision++,this._pendingUpdates=null,t&&this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"refresh",(-1),(-1))),!0};var ue=function(e,i,s,r){t.call(this,e),this.view=i,this.viewRevision=s,this.index=r};z(ue,t),ue.prototype.getViewIndex=function(){
return this.view.getBookmarkIndex(this)};var Na=function(t,e){if(wa.call(this),this._view=t,e&&this._view.addEventListener(y.COLLECTION_CHANGE,this._collectionEventHandler,this),this._currentIndex=0<this._view.getLength()?0:Na.AFTER_LAST_INDEX,0===this._currentIndex)try{this._setCurrent(this._view.getItemAt(0),!1)}catch(i){this._currentIndex=Na.BEFORE_FIRST_INDEX,this._setCurrent(null,!1)}};z(Na,wa),Na.BEFORE_FIRST_INDEX=-1,Na.AFTER_LAST_INDEX=-2,Na.prototype.getView=function(){return this._checkValid(),this._view},Na.prototype.getCurrent=function(){return this._checkValid(),this._currentValue},Na.prototype.getBookmark=function(){return this._checkValid(),0==this._view.getLength()||this.getBeforeFirst()?t.getFIRST():this.getAfterLast()?t.getLAST():this._view.getBookmark(this._currentIndex)},Na.prototype.getBeforeFirst=function(){return this._checkValid(),this._currentIndex==Na.BEFORE_FIRST_INDEX||0==this._view.getLength()},Na.prototype.getAfterLast=function(){return this._checkValid(),this._currentIndex==Na.AFTER_LAST_INDEX||0==this._view.getLength()},Na.prototype.findAny=function(t){this._checkValid();var e,i=this._view;try{e=i.findItem(t,Ac.ANY_INDEX_MODE)}catch(s){throw new hd(s.message)}return-1<e&&(this._currentIndex=e,this._setCurrent(i.getItemAt(this._currentIndex))),-1<e},Na.prototype.findFirst=function(t){this._checkValid();var e,i=this._view;try{e=i.findItem(t,Ac.FIRST_INDEX_MODE)}catch(s){throw new hd(s.message)}return-1<e&&(this._currentIndex=e,this._setCurrent(i.getItemAt(this._currentIndex))),-1<e},Na.prototype.findLast=function(t){this._checkValid();var e,i=this._view;try{e=i.findItem(t,Ac.LAST_INDEX_MODE)}catch(s){throw new hd(s.message)}return-1<e&&(this._currentIndex=e,this._setCurrent(i.getItemAt(this._currentIndex))),-1<e},Na.prototype.insert=function(t){var e;if(this.getAfterLast())e=this._view.getLength();else if(this.getBeforeFirst()){if(0<this._view.getLength())throw new hd("invalidInsert");e=0}else e=this._currentIndex;this._view.addItemAt(t,e)},Na.prototype.moveNext=function(){if(this.getAfterLast())return!1;var t=this.getBeforeFirst()?0:this._currentIndex+1;return t>=this._view.getLength()?(t=Na.AFTER_LAST_INDEX,this._setCurrent(null)):this._setCurrent(this._view.getItemAt(t)),this._currentIndex=t,!this.getAfterLast()},Na.prototype.movePrevious=function(){if(this.getBeforeFirst())return!1;var t=this.getAfterLast()?this._view.getLength()-1:this._currentIndex-1;return-1==t?(t=Na.BEFORE_FIRST_INDEX,this._setCurrent(null)):this._setCurrent(this._view.getItemAt(t)),this._currentIndex=t,!this.getBeforeFirst()},Na.prototype.remove=function(){if(this.getBeforeFirst()||this.getAfterLast())throw new hd("invalidRemove");var t=this._currentIndex;if(this._currentIndex++,this._currentIndex>=this._view.getLength())this._currentIndex=Na.AFTER_LAST_INDEX,this._setCurrent(null);else try{this._setCurrent(this._view.getItemAt(this._currentIndex))}catch(e){throw this._setCurrent(null,!1),this._view.removeItemAt(t),e}return this._view.removeItemAt(t)},Na.prototype.seek=function(e,i,s){if(isNaN(i)&&(i=0),isNaN(s)&&(s=0),this._checkValid(),0==this._view.getLength())this._currentIndex=Na.AFTER_LAST_INDEX,this._setCurrent(null,!1);else{var r=this._currentIndex;if(e===t.getFIRST())r=0;else if(e===t.getLAST())r=this._view.getLength()-1;else if(e!=t.getCURRENT())try{if(r=this._view.getBookmarkIndex(e),0>r)throw this._setCurrent(null),new hd("bookmarkInvalid")}catch(n){throw new hd("bookmarkInvalid")}r+=i,e=null,r>=this._view.getLength()?this._currentIndex=Na.AFTER_LAST_INDEX:0>r?this._currentIndex=Na.BEFORE_FIRST_INDEX:(e=this._view.getItemAt(r,s),this._currentIndex=r),this._setCurrent(e)}},Na.prototype.removeListener=function(){this._view.removeEventListener(y.COLLECTION_CHANGE,this._collectionEventHandler,this)},Na.prototype._checkValid=function(){if(this._invalid)throw new hd("invalidCursor")},Na.prototype._collectionEventHandler=function(t){switch(t.kind){case"add":t.location<=this._currentIndex&&(this._currentIndex+=t.items.length);break;case"remove":if(t.location<this._currentIndex)this._currentIndex-=t.items.length;else if(t.location==this._currentIndex)if(this._currentIndex<this._view.getLength())try{this._setCurrent(this._view.getItemAt(this._currentIndex))}catch(e){this._setCurrent(null,!1)}else this._currentIndex=Na.AFTER_LAST_INDEX,this._setCurrent(null);break;case"move":t.oldLocation==this._currentIndex?this._currentIndex=t.location:(t.oldLocation<this._currentIndex&&(this._currentIndex-=t.items.length),t.location<=this._currentIndex&&(this._currentIndex+=t.items.length));break;case"refresh":if(!this.getBeforeFirst()&&!this.getAfterLast()){try{this._currentIndex=this._view.getItemIndex(this._currentValue)}catch(e){this._view._sort&&(this._currentIndex=this._view.getLocalItemIndex(this._currentValue))}-1==this._currentIndex&&this._setCurrent(null)}break;case"replace":if(t.location==this._currentIndex)try{this._setCurrent(this._view.getItemAt(this._currentIndex))}catch(e){this._setCurrent(null,!1)}break;case"reset":this._currentIndex=Na.BEFORE_FIRST_INDEX,this._setCurrent(null)}},Na.prototype._setCurrent=function(t,e){e=!!I(e)||e,this._currentValue=t,e&&this.dispatchEvent(new w("cursorUpdate"))};var Ac=function(){var t,e,i=this,s=[],r=[],n=!1;i.unique=!1,i.getFields=function(){return s},i.setFields=function(t){if(s=t,r=[],s){var e;for(t=0;t<s.length;t++)e=s[t]instanceof sb?s[t]:sb(s[t]),r.push(e.name)}},i.getCompareFunction=function(){return n?t:o},i.setCompareFunction=function(e){t=e,n=null!==t};var o=function(t,i,r){var n=0;if(s&&0!=s.length){var o=0;for(r=r?r.length:s.length;0===n&&o<r;)n=s[o],n=n.internalCompare(t,i),o++}else{if(!e){e=new sb;try{e.initCompare(t)}catch(a){throw new de("sort error : "+a)}}n=e.getCompareFunction().call(e,t,i)}return n},a=function(t,e){var i,r=null;for(i=0;i<s.length;i++)s[i].initCompare(t);if(e)for(r={fields:[],options:[]},i=0;i<s.length;i++){var n=s[i],o=n.getArraySortOnOptions();if(-1==o)return null;r.fields.push(n.name),r.options.push(o)}return r},l=function(t){if(0==arguments.length)return null;if(1==arguments.length)return t.sort();var e=1<arguments.length?arguments[1]:null;if(2<arguments.length){var i=arguments[2];return e.length!=i.length?t.sort():t.sort(function(t,s){for(var r=e.slice(),n=r.shift(),o=i.slice(),a=o.shift();(a&sb.CASEINSENSITIVE&&t[n].toLowerCase()==s[n].toLowerCase()||t[n]==s[n])&&r.length;)n=r.shift(),a=o.shift();return r=t[n],n=s[n],null!=r&&"undefined"!=typeof r||null!=n&&"undefined"!=typeof n?null==r||"undefined"==typeof r?n=-1:null==n||"undefined"==typeof n?n=1:(a&sb.CASEINSENSITIVE&&(r=r.toLowerCase(),n=n.toLowerCase()),n=r==n?0:r>n?1:-1):n=0,a&sb.DESCENDING&&(n*=-1),n})}return t.sort(function(t,i){for(var s=e.slice(),r=s.shift();t[r]==i[r]&&s.length;)r=s.shift();return s=t[r],r=i[r],null!=s&&"undefined"!=typeof s||null!=r&&"undefined"!=typeof r?null==s||"undefined"==typeof s?-1:null==r||"undefined"==typeof r?1:s==r?0:s>r?1:-1:0})};i.findItem=function(t,e,i,s,n){var o;if(!t)throw Error("noItems");if(0==t.length)return s?1:-1;if(p(n)&&(n=this.getCompareFunction(),e&&0<r.length)){o=[];var l,h,d=!0,c=r.length;for(h=0;h<c;h++)if(l=r[h]){var _;try{_=E(e)?G.getElementProperty(e,l):!I(e[l])}catch(u){_=!1}if(_){if(!d)throw Error("findCondition:"+l);o.push(l)}else d=!1}else o.push(null);if(0==o.length)throw new de("findRestriction");try{a(t[0])}catch(u){}}l=_=!1,h=d=0;for(var g,c=t.length-1,m=1;!l&&h<=c;)switch(d=Math.round((h+c)/2),g=t[d],m=o?n(e,g,o):n(e,g)){case-1:c=d-1;break;case 0:switch(l=!0,i){case Ac.ANY_INDEX_MODE:_=!0;break;case Ac.FIRST_INDEX_MODE:_=d==h;var f=d-1;for(g=!0;g&&!_&&f>=h;)g=t[f],g=0==(o?n(e,g,o):n(e,g)),(!g||g&&f==h)&&(_=!0,d=f+(g?0:1)),f--;break;case Ac.LAST_INDEX_MODE:for(_=d==c,f=d+1,g=!0;g&&!_&&f<=c;)g=t[f],g=0==(o?n(e,g,o):n(e,g)),(!g||g&&f==c)&&(_=!0,d=f-(g?0:1)),f++;break;default:throw new de("unknownMode")}break;case 1:h=d+1}return _||s?0<m?d+1:d:-1},i.propertyAffectsSort=function(t){if(n||!s||0==s.length)return!0;for(var e=0,i=s.length;e<i;e++){var r=s[e];if(r.name==t||r.usingCustomCompareFunction)return!0}return!1},i.sort=function(t){if(t&&!(1>=t.length))if(n)t.sort(function(t,s){return i.getCompareFunction()(t,s,e)});else{var e=s;if(e&&0<e.length){var r=a(t[0],!0);r?t=l(t,r.fields,r.options):t.sort(o)}else t.sort(o)}}};Ac.FIRST_INDEX_MODE="first",Ac.LAST_INDEX_MODE="last",Ac.ANY_INDEX_MODE="any";var sb=function(t,e,i,s){this.name=0<arguments.length?t:null,this.caseInsensitive=1<arguments.length&&e,this.descending=2<arguments.length&&i,this.numeric=3<arguments.length?s:null,this.usingCustomCompareFunction=!1,this._compareFunction=this._stringCompare};sb.CASEINSENSITIVE=1,sb.DESCENDING=2,sb.NUMERIC=16,sb.prototype.getCompareFunction=function(){return this._compareFunction},sb.prototype.setCompareFunction=function(t){this._compareFunction=t,this.usingCustomCompareFunction=null!=t},sb.prototype.internalCompare=function(t,e){var i=this._compareFunction(t,e);return this.descending&&(i*=-1),i},sb.prototype.initCompare=function(t){if(!this.usingCustomCompareFunction)if(1==this.numeric)this._compareFunction=this._numericCompare;else if(this.caseInsensitive||0==this.numeric)this._compareFunction=this._stringCompare;else{var e;if(this.name)try{e=t[this.name]}catch(i){}switch(null==e&&(e=t),typeof e){case"string":this._compareFunction=this._stringCompare;break;case"object":if(e instanceof Date)this._compareFunction=this._dateCompare;else if(E(e))this._compareFunction=this._xmlCompare;else{this._compareFunction=this._stringCompare;var s;try{s=e.toString()}catch(i){}s&&"[object Object]"!=s||(this._compareFunction=this._nullCompare)}break;case"xml":this._compareFunction=this._xmlCompare;break;case"boolean":case"number":this._compareFunction=this._numericCompare}}},sb.prototype.getArraySortOnOptions=function(){if(this.usingCustomCompareFunction||null==this.name||this._compareFunction==this._xmlCompare||this._compareFunction==this._dateCompare)return-1;var t=0;return this.caseInsensitive&&(t|=sb.CASEINSENSITIVE),this.descending&&(t|=sb.DESCENDING),1!=this.numeric&&this._compareFunction!=this._numericCompare||(t|=sb.NUMERIC),t},sb.prototype._stringCompare=function(t,e){var i;try{i=null===this.name?String(t):String(t[this.name])}catch(s){}var r;try{r=null==this.name?String(e):String(e[this.name])}catch(s){}return ua.stringCompare(i,r,this.caseInsensitive)},sb.prototype._numericCompare=function(t,e){var i;try{i=null==this.name?Number(t):Number(t[this.name])}catch(s){}var r;try{r=null==this.name?Number(e):Number(e[this.name])}catch(s){}return ua.numericCompare(i,r)},sb.prototype._dateCompare=function(t,e){var i;try{i=null==this.name?t:t[this.name]}catch(s){}var r;try{r=null==this.name?e:e[this.name]}catch(s){}return ua.dateCompare(i,r)},sb.prototype._nullCompare=function(t,e){var i,s,r=!1;if(null==t&&null==e)return 0;if(this.name){try{i=t[this.name]}catch(n){}try{s=e[this.name]}catch(n){}}if(null==i&&null==s)return 0;null!=i||this.name||(i=t),null!=s||this.name||(s=e);var o=typeof i,a=typeof s;if("string"==o||"string"==a?(r=!0,this._compareFunction=this._stringCompare):"object"==o||"object"==a?(i instanceof Date||s instanceof Date)&&(r=!0,this._compareFunction=this._dateCompare):"xml"==o||"xml"==a?(r=!0,this._compareFunction=this._xmlCompare):"number"!=o&&"number"!=a&&"boolean"!=o&&"boolean"!=a||(r=!0,this._compareFunction=this._numericCompare),r)return this._compareFunction(i,s);throw new de("noComparatorSortField")},sb.prototype._xmlCompare=function(t,e){var i;try{i=null==this.name?t.toString():G.getProperty(t,this.name)}catch(s){}var r;try{r=null==this.name?e.toString():G.getProperty(e,this.name)}catch(s){}return 1==this.numeric?ua.numericCompare(parseFloat(i),parseFloat(r)):ua.stringCompare(i,r,this.caseInsensitive)};var P=function(t){la.call(this),arguments.length?this.setSource(t):this.setSource(null)};P._defaultProperty="source",z(P,la),P.prototype.getSource=function(){return this._list&&this._list instanceof Gb?this._list.getSource():null},P.prototype.setSource=function(t){this.setList(new Gb(t))};var Gb=function(t){wa.call(this),this._source=null,this._enableEvents=!1,arguments.length?this.setSource(t):this.setSource(null),this._enableEvents=!0};z(Gb,wa),Gb.prototype.getLength=function(){return this._source?this._source.length:0},Gb.prototype.getSource=function(){return this._source},Gb.prototype.setSource=function(t){p(t)?this._source=[]:ha(t)?this._source=t:this._source=[t],this._enableEvents&&this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"reset",(-1),(-1)))},Gb.prototype.addItem=function(t){this.addItemAt(t,this._source.length)},Gb.prototype.addItemAt=function(t,e){if(0>e||e>this._source.length)throw new vc("Out of range error "+e);this._source.splice(e,0,t),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"add",e,(-1),[t]))},Gb.prototype.getItemAt=function(t){if(0>t||t>=this._source.length)throw new vc("Out of range error "+t);return this._source[t]},Gb.prototype.getItemIndex=function(t){return Ra.indexOf(this._source,t)},Gb.prototype.removeItemAt=function(t){if(0>t||t>=this._source.length)throw new vc("Out of range error "+t);var e=this._source.splice(t,1)[0];return this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"remove",t,(-1),[e])),e},Gb.prototype.removeAll=function(){0>=this._source.length||(this._source.splice(0,this._source.length),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"reset",(-1),(-1))))},Gb.prototype.setItemAt=function(t,e){if(0>e||e>=this._source.length)throw new vc("Out of range error "+e);var i=this._source[e];this._source[e]=t,i=new wc(wc.PROPERTY_CHANGE,(!1),(!1),"update",e,i,t),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"replace",e,(-1),[i]))},Gb.prototype.itemUpdated=function(t,e,i,s){t=new wc(wc.PROPERTY_CHANGE,(!1),(!1),"update",e,i,s,t),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"update",(-1),(-1),[t]))},Gb.prototype.getProperty=function(t,e){return null==t?null:t[e]},Gb.prototype.setProperty=function(t,e,i){null!=t&&(t[e]=i)},Gb.prototype.getPropertyAt=function(t,e){var i=this.getItemAt(t);return null==i?null:i[e]},Gb.prototype.setPropertyAt=function(t,e,i){t=this.getItemAt(t),null!=t&&(t[e]=i)},Gb.prototype.toArray=function(){return this._source.concat()},Gb.prototype.toString=function(){return this._source?"object"==typeof JSON?JSON.stringify(this._source):this._source.toString():this.constructor.name};var yb=function(t,e){wa.call(this),this._enableEvents=!1,this._xmlDoc=this._sourceParent=this._source=null,arguments.length?this.setSource(t,e):this.setSource(null,e),this._enableEvents=!0};z(yb,wa),yb.prototype.getLength=function(){return this._source?this._source.length:0},yb.prototype.getSource=function(){return this._source},yb.prototype.setSource=function(t,e){p(t)?(this._xmlDoc=G.parse("<items/>"))&&(this._sourceParent=this._xmlDoc.documentElement,this._source=this._xmlDoc.documentElement.childNodes):Uc(t)?0<t.length?9===t[0].parentNode.nodeType?(this._xmlDoc=t[0].parentNode,this._sourceParent=t[0].parentNode.documentElement):(this._xmlDoc=t[0].parentNode.ownerDocument,this._sourceParent=t[0].parentNode):e?(this._xmlDoc=e.ownerDocument,this._sourceParent=e):(this._xmlDoc=t,this._sourceParent=t.documentElement):9===t.nodeType?(this._xmlDoc=t,this._sourceParent=t.documentElement):(this._xmlDoc=t.ownerDocument,this._sourceParent=t),this._selectSource(),this._enableEvents&&this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"reset",(-1),(-1)))},yb.prototype._clearChildNodes=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},yb.prototype._copyChildNodes=function(t,e){var i,s,r;if(r=t.childNodes,I(this._xmlDoc.importNode))for(i=0,s=r.length;i<s;i++)e.appendChild(r[i].cloneNode(!0));else for(i=0,s=r.length;i<s;i++)e.appendChild(e.ownerDocument.importNode(r[i],!0));if(!p(t.attributes))for(i=0,s=t.attributes.length;i<s;i++)r=t.attributes[i].name,G.setAttribute(e,r,G.getAttribute(t,r));t.hasOwnProperty?t.uid&&(e.uid=t.uid):(r=G.getAttribute(t,"rm_internal_uid"))&&G.setAttribute(e,"rm_internal_uid",r)},yb.prototype._selectSource=function(){if(this._source=[],this._sourceParent){var t,e,i=this._sourceParent.childNodes;for(t=0,e=i.length;t<e;t++)1===i[t].nodeType&&this._source.push(i[t])}},yb.prototype.addItem=function(t){this.addItemAt(t,this.getLength())},yb.prototype.addItemAt=function(t,e){var i;if(0>e||e>this._source.length)throw new vc("Out of range error "+e);if(F(t))(i=G.parse(t))&&(t=this._xmlDoc.createElement(i.documentElement.tagName),this._copyChildNodes(i.documentElement,t));else{if(!E(t))throw Error("invalid XML");t.ownerDocument!=this._xmlDoc&&(i=t.tagName?this._xmlDoc.createElement(t.tagName):this._xmlDoc.createElement(t.documentElement.tagName),this._copyChildNodes(t,i),t=i)}0==this.getLength()?this._sourceParent.appendChild(t):this.getLength()==e?this._sourceParent.appendChild(t):this._sourceParent.insertBefore(t,this._source[e]),this._selectSource(),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"add",e,(-1),[t]))},yb.prototype.getItemAt=function(t){if(0>t||t>=this._source.length)throw new vc("Out of range error "+t);return this._source[t]},yb.prototype.getItemIndex=function(t){return Ra.indexOf(this._source,t)},yb.prototype.removeItemAt=function(t){if(0>t||t>=this._source.length)throw new vc("Out of range error "+t);var e=this._source[t];return this._sourceParent.removeChild(e),this._selectSource(),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"remove",t,(-1),[e])),e},yb.prototype.removeAll=function(){var t;if(!(0>=this._source.length)){for(t=this._source.length-1;0<=t;t--)this._sourceParent.removeChild(this._source[t]),this._source.pop();this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"reset",(-1),(-1)))}},yb.prototype.setItemAt=function(t,e){var i;if(0>e||e>=this._source.length)throw new vc("Out of range error "+e);F(t)?(i=G.parse(t))&&(t=this._xmlDoc.createElement(i.documentElement.tagName),this._copyChildNodes(i.documentElement,t)):E(t)&&t.ownerDocument!=this._xmlDoc&&(i=t.tagName?this._xmlDoc.createElement(t.tagName):this._xmlDoc.createElement(t.documentElement.tagName),this._copyChildNodes(t,i),t=i),i=this._source[e],this._sourceParent.replaceChild(t,this._source[e]),this._selectSource(),i=new wc(wc.PROPERTY_CHANGE,(!1),(!1),"update",e,i,t),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"replace",e,(-1),[i]))},yb.prototype.itemUpdated=function(t,e,i,s){t=new wc(wc.PROPERTY_CHANGE,(!1),(!1),"update",e,i,s,t),this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"update",(-1),(-1),[t]))},yb.prototype.getProperty=function(t,e){return G.getProperty(t,e)},yb.prototype.setProperty=function(t,e,i){if(null!=t)if(-1!=e.indexOf("@"))t.setAttribute(e.split("@")[1],i);else{var s=t.getElementsByTagName(e);s&&0<s.length?I(s[0].textContent)?s[0].text=i:s[0].textContent=i:(e=this._xmlDoc.createElement(e),I(e.textContent)?e.text=i:e.textContent=i,t.appendChild(e))}},yb.prototype.getPropertyAt=function(t,e){var i=this.getItemAt(t);return G.getProperty(i,e)},yb.prototype.setPropertyAt=function(t,e,i){if(t=this.getItemAt(t),null!=t)if(-1!=e.indexOf("@"))t.setAttribute(e.split("@")[1],i);else{var s=t.getElementsByTagName(e);s&&0<s.length?I(s[0].textContent)?s[0].text=i:s[0].textContent=i:(e=this._xmlDoc.createElement(e),I(e.textContent)?e.text=i:e.textContent=i,t.appendChild(e))}},yb.prototype.toArray=function(){return this._source.concat()},yb.prototype.toString=function(){return this._sourceParent?G.elementToString(this._sourceParent):this.constructor.name},yb.prototype.toXMLString=function(){return this.toString()};var Hb=function(t,e){la.call(this),arguments.length?this.setSource(t,e):this.setSource(null,e)};Hb._defaultProperty="source",z(Hb,la),Hb.prototype.getSource=function(){return this._list&&this._list instanceof yb?this._list.getSource():null},Hb.prototype.setSource=function(t,e){this.setList(new yb(t,e))},Hb.prototype.toXMLString=function(){var t=this._list;return t._sourceParent?window.XMLSerializer?(new window.XMLSerializer).serializeToString(t._sourceParent):t._sourceParent.xml:t.constructor.name},Hb.prototype.toString=function(){if(this._localIndex){for(var t="",e=0;e<this._localIndex.length;e++)0<e&&(t+="\n"),t+=this._localIndex[e].toString();return t}try{return this.getSource().toString()}catch(i){return Object.toString()}},z(Pb,u),Pb.prototype.getHeight=function(){return this._height},Pb.prototype.setHeight=function(t){this._height=t,this.invalidateDisplayList()},Pb.prototype.getWidth=function(){return this._width},Pb.prototype.setWidth=function(t){this._width=t,this.invalidateDisplayList()},Pb.prototype.getNestLevel=function(){return this._nestLevel},Pb.prototype.setNestLevel=function(t){this._nestLevel=t,this.invalidateDisplayList()},Pb.prototype.invalidateProperties=function(){},Pb.prototype.invalidateSize=function(){},Pb.prototype.validateProperties=function(){},Pb.prototype.validateSize=function(t){},Pb.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i,s=this.element,n=m,o=n.getSizeStyle,a=n.getSizeStyleBorder;i=!1,this._height!=e&&(this._height=e,i=r.useBorderBox?0:o(s,"paddingTop")+o(s,"paddingBottom")+a(s,"borderTopWidth")+a(s,"borderBottomWidth"),n.setPxStyle(s,"height",0<e-i?e-i:0),i=!0),this._width!=t&&(this._width=t,i=r.useBorderBox?0:o(s,"paddingLeft")+o(s,"paddingRight")+a(s,"borderLeftWidth")+a(s,"borderRightWidth"),n.setPxStyle(s,"width",0<t-i?t-i:0),i=!0),i&&this.invalidateDisplayList()}},Ic._defaultStyles={horizontalGap:6,horizontalAlign:"left",verticalGap:6,verticalAlign:"top"},z(Ic,H),Ic.prototype.getDirection=function(){return this._layoutObject.direction},Ic.prototype.setDirection=function(t){this._layoutObject.direction=t,this.invalidateSize(),this.invalidateDisplayList()},Ic.prototype.measure=function(){Ic._super.measure.call(this),this._layoutObject.measure()},Ic.prototype.updateDisplayList=function(t,e){Ic._super.updateDisplayList.call(this,t,e),this._layoutObject.updateDisplayList(t,e)},Ic.prototype._isVertical=function(){return"vertical"==this.getDirection()},z(Ed,H),Ed.prototype._getUsePadding=function(){return!1},Ed.prototype.measure=function(){Ed._super.measure.call(this),this._layoutObject.measure()},Ed.prototype.updateDisplayList=function(t,e){Ed._super.updateDisplayList.call(this,t,e),this._layoutObject.updateDisplayList(t,e)},cd.prototype.getTarget=function(){return this._target},cd.prototype.setTarget=function(t){t!=this._target&&(this._target=t)},cd.prototype.measure=function(){var t,e=this._isVertical(),i=0,s=0,r=0,n=0,o=this._target.getNumChildren(),a=o;for(t=0;t<o;t++){var l=this._target.getChildAt(t);if(l.getIncludeInLayout()){var h=l.getExplicitOrMeasuredWidth(),d=l.getExplicitOrMeasuredHeight();e?(i=Math.max(O(l.getPercentWidth())?h:l.getMinWidth(),i),r=Math.max(h,r),s+=isNaN(l.getPercentHeight())?d:l.getMinHeight(),n+=d):(i+=O(l.getPercentWidth())?h:l.getMinWidth(),r+=h,s=Math.max(O(l.getPercentHeight())?d:l.getMinHeight(),s),n=Math.max(d,n))}else a--}e=this._widthPadding(a),a=this._heightPadding(a),this._target.measuredMinWidth=i+e,this._target.measuredMinHeight=s+a,this._target.measuredWidth=r+e,this._target.measuredHeight=n+a},cd.prototype.updateDisplayList=function(t,e){var i=this._target.getNumChildren();if(0!=i){var s,n,o,a=this._target.getViewMetricsAndPadding(),l=this._target.getSizeStyle("paddingLeft"),h=this._target.getSizeStyle("paddingTop"),d=this._getHorizontalAlignValue(),c=this._getVerticalAlignValue(),_=this._target.getMinWidth(),u=this._target.getMinHeight(),_=Math.max(t,_)-a.right-a.left,a=Math.max(e,u)-a.bottom-a.top,u=this._target._horizontalScrollBarExist,p=this._target._verticalScrollBarExist,g=0,m=0;if(1==i)i=this._target.getChildAt(0),g=i.getPercentWidth(),s=i.getPercentHeight(),g=g?Math.max(i.getMinWidth(),Math.min(i.getMaxWidth(),100<=g?_:_*g/100)):i.getExplicitOrMeasuredWidth(),s=s?Math.max(i.getMinHeight(),Math.min(i.getMaxHeight(),100<=s?a:a*s/100)):i.getExplicitOrMeasuredHeight(),i.setActualSize(g,s),r.ie7&&i.setActualSize(g,s),(i.getPercentWidth()||i.getPercentHeight())&&i.invalidateDisplayList(),p&&"auto"==this._target.getVerticalScrollPolicy()&&(_+=r.getScrollBarWidth()),u&&"auto"==this._target.getHorizontalScrollPolicy()&&(a+=r.getScrollBarHeight()),p=(_-i.getWidth())*d+l,u=(a-i.getHeight())*c+h,i.move(p,u);else if(this._isVertical()){for(s=this._target.getStyle("verticalGap"),n=i,o=0;o<i;o++)this._target.getChildAt(o).getIncludeInLayout()||n--;if(o=Vd.childHeightsProportionally(this._target,a-(n-1)*s,_),u&&"auto"==this._target.getHorizontalScrollPolicy()&&(o+=r.getScrollBarHeight()),p&&"auto"==this._target.getVerticalScrollPolicy()&&(_+=r.getScrollBarWidth()),u=h+o*c,0<d)for(o=0;o<i;o++)n=this._target.getChildAt(o),p=(_-n.getWidth())*d,m=Math.min(m,p);for(o=0;o<i;o++)n=this._target.getChildAt(o),p=0<d?(_-n.getWidth())*d+l-m:l-m,n.move(p,u),n.getIncludeInLayout()&&(u+=n.getHeight()+s)}else{for(s=this._target.getStyle("horizontalGap"),n=i,o=0;o<i;o++)this._target.getChildAt(o).getIncludeInLayout()||n--;if(o=Vd.childWidthsProportionally(this._target,_-(n-1)*s,a),u&&"auto"==this._target.getHorizontalScrollPolicy()&&(a+=r.getScrollBarHeight()),p&&"auto"==this._target.getVerticalScrollPolicy()&&(o+=r.getScrollBarWidth()),p=l+o*d,0<c)for(o=0;o<i;o++)n=this._target.getChildAt(o),u=(a-n.getHeight())*c,g=Math.min(g,u);for(o=0;o<i;o++)n=this._target.getChildAt(o),u=0<c?(a-n.getHeight())*c+h-g:h-g,n.move(p,u),n.getIncludeInLayout()&&(p+=n.getWidth()+s)}}},cd.prototype._isVertical=function(){return"horizontal"!=this.direction},cd.prototype._widthPadding=function(t){var e=this._target.getViewMetricsAndPadding(),e=e.left+e.right;return 1<t&&0==this._isVertical()&&(e+=this._target.getStyle("horizontalGap")*(t-1)),e},cd.prototype._heightPadding=function(t){var e=this._target.getViewMetricsAndPadding(),e=e.top+e.bottom;return 1<t&&this._isVertical()&&(e+=this._target.getStyle("verticalGap")*(t-1)),e},cd.prototype._getHorizontalAlignValue=function(){var t=this._target.getStyle("horizontalAlign");return"center"==t?.5:"right"==t?1:0},cd.prototype._getVerticalAlignValue=function(){var t=this._target.getStyle("verticalAlign");return"middle"==t?.5:"bottom"==t?1:0},Zd.prototype.getTarget=function(){return this._target},Zd.prototype.setTarget=function(t){t!=this._target&&(this._target=t)},Zd.prototype.measure=function(){var t,e=this._target.getViewMetrics(),i=0,s=0,r=this._target.getNumChildren(),n=r;for(t=0;t<r;t++){var o=this._target.getChildAt(t);if(o.getIncludeInLayout()){var a=o.getX(),l=o.getY(),h=o.getExplicitOrMeasuredWidth(),d=o.getExplicitOrMeasuredHeight();O(o.getPercentWidth())||(h=o.getMinWidth()),O(o.getPercentHeight())||(d=o.getMinHeight()),a+=O(h)?o.getWidth():h,o=l+(O(d)?o.getHeight():d),i=Math.max(i,a),s=Math.max(s,o)}else n--}this._target.measuredWidth=i+e.left+e.right,this._target.measuredHeight=s+e.top+e.bottom},Zd.prototype.updateDisplayList=function(t,e){var i,s=this._target.getNumChildren();if(0!=s){i=this._target.getViewMetricsAndPadding();var r=this._target.getMinWidth(),n=this._target.getMinHeight(),r=Math.max(t,r)-i.right-i.left,n=Math.max(e,n)-i.bottom-i.top;for(i=0;i<s;i++){var o=this._target.getChildAt(i),a=o.getPercentWidth(),l=o.getPercentHeight(),a=a?Math.max(o.getMinWidth(),Math.min(o.getMaxWidth(),100<=a?r:r*a/100)):o.getExplicitOrMeasuredWidth(),l=l?Math.max(o.getMinHeight(),Math.min(o.getMaxHeight(),100<=l?n:n*l/100)):o.getExplicitOrMeasuredHeight();o.setActualSize(a,l),(o.getPercentWidth()||o.getPercentHeight())&&o.invalidateDisplayList()}}};var Vd={childWidthsProportionally:function(t,e,i){var s,r,n,o,a=e,l=0,h=[];for(o=t.getNumChildren(),n=0;n<o;n++){r=t.getChildAt(n);var d=r.getPercentWidth(),c=r.getPercentHeight(),c=!O(c)&&r.getIncludeInLayout()?Math.max(r.getMinHeight(),Math.min(r.getMaxHeight(),100<=c?i:i*c/100)):r.getExplicitOrMeasuredHeight();!O(d)&&r.getIncludeInLayout()?(l+=d,s={},s.percent=d,s.min=r.getMinWidth(),s.max=r.getMaxWidth(),s.height=c,s.child=r,h.push(s)):(d=r.getExplicitOrMeasuredWidth(),r.setActualSize(d,c),r.getIncludeInLayout()&&(a-=r.getWidth())),(r.getPercentWidth()||r.getPercentHeight())&&r.invalidateDisplayList()}if(l){for(a=Vd.childrenProportionally(e,a,l,h),o=h.length,n=0;n<o;n++)s=h[n],r=s.child,r.setActualSize(s.size,s.height);Vd.distributeExtraWidth(t,e)}return a},childHeightsProportionally:function(t,e,i){var s,r,n,o,a=e,l=0,h=[];for(o=t.getNumChildren(),n=0;n<o;n++){r=t.getChildAt(n);var d=r.getPercentWidth(),c=r.getPercentHeight(),d=!O(d)&&r.getIncludeInLayout()?Math.max(r.getMinWidth(),Math.min(r.getMaxWidth(),100<=d?i:i*d/100)):r.getExplicitOrMeasuredWidth();!O(c)&&r.getIncludeInLayout()?(l+=c,s={},s.percent=c,s.min=r.getMinHeight(),s.max=r.getMaxHeight(),s.width=d,s.child=r,h.push(s)):(c=r.getExplicitOrMeasuredHeight(),r.setActualSize(d,c),r.getIncludeInLayout()&&(a-=r.getHeight())),(r.getPercentWidth()||r.getPercentHeight())&&r.invalidateDisplayList()}if(l){for(a=Vd.childrenProportionally(e,a,l,h),o=h.length,n=0;n<o;n++)s=h[n],r=s.child,r.setActualSize(s.width,s.size);Vd.distributeExtraHeight(t,e)}return a},childrenProportionally:function(t,e,i,s){var r,n=s.length;t=e-t*i/100,0<t&&(e-=t);do{t=0,r=!0;for(var o=e/i,a=0;a<n;a++){var l=s[a],h=l.percent*o;if(h<l.min){r=l.min,l.size=r,s[a]=s[--n],s[n]=l,i-=l.percent,e-=r,r=!1;break}if(h>l.max){r=l.max,l.size=r,s[a]=s[--n],s[n]=l,i-=l.percent,e-=r,r=!1;break}l.size=h,t+=h}}while(!r);return Math.max(0,Math.floor(e-t))},distributeExtraHeight:function(t,e){var i,s,r,n,o=t.getNumChildren(),a=!1,l=e,h=0;for(i=0;i<o;i++)r=t.getChildAt(i),r.getIncludeInLayout()&&(n=r.getHeight(),s=r.getPercentHeight(),h+=n,O(s)||(s=Math.ceil(s/100*e),s>n&&(a=!0)));if(a)for(l-=h,a=!0;a&&.5<l;)for(a=!1,i=0;i<o;i++)if(r=t.getChildAt(i),n=r.getHeight(),s=r.getPercentHeight(),!O(s)&&r.getIncludeInLayout()&&n<r.maxHeight&&(s=Math.ceil(s/100*e),s>n&&(1>l?r.setActualSize(r.getWidth(),n+l+1e-4):r.setActualSize(r.getWidth(),n+1),l--,a=!0,0>=l)))return},distributeExtraWidth:function(t,e){var i,s,r,n,o=t.getNumChildren(),a=!1,l=e,h=0;for(i=0;i<o;i++)r=t.getChildAt(i),r.getIncludeInLayout()&&(n=r.getWidth(),s=r.getPercentWidth(),h+=n,O(s)||(s=Math.ceil(s/100*e),s>n&&(a=!0)));if(a)for(l-=h,a=!0;a&&.5<l;)for(a=!1,i=0;i<o;i++)if(r=t.getChildAt(i),n=r.getWidth(),s=r.getPercentWidth(),!O(s)&&r.getIncludeInLayout()&&n<r.getMaxWidth()&&(s=Math.ceil(s/100*e),s>n&&(1>l?r.setActualSize(n+l+1e-4,r.getHeight()):r.setActualSize(n+1,r.getHeight()),l--,a=!0,0>=l)))return}};z(Fd,Ic),Fd.prototype.setDirection=function(t){},z(Qd,Ic),Qd.prototype.setDirection=function(t){},z(qa,u),qa.prototype.getData=function(){return this._data},qa.prototype.setData=function(t){this._data=t},n._defaultStyles={alternatingItemColors:void 0,disabledColor:"#AAAAAA",dropIndicatorSkin:void 0,focusAlpha:.5,focusRoundedCorners:"tl tr bl br",paddingBottom:2,paddingTop:2,paddingLeft:2,paddingRight:2,rollOverColor:"#B2E1FF",selectionColor:"#7FCEFF",selectionDisabledColor:"#DDDDDD",textRollOverColor:"#2B333C",textSelectedColor:"#2B333C",useRollOver:!0},z(n,jb),n._IS_ITEM_STYLE={alternatingItemColors:!0,backgroundColor:!0,backgroundDisabledColor:!0,color:!0,rollOverColor:!0,selectionColor:!0,selectionDisabledColor:!0,styleName:!0,textColor:!0,textRollOverColor:!0,textSelectedColor:!0},n.DRAG_THRESHOLD=4,n.prototype.setEnabled=function(t){n._super.setEnabled.call(this,t);var e=this._border;e&&(e instanceof u&&e.setEnabled(t),U(e.invalidateDisplayList)&&e.invalidateDisplayList()),this._itemsSizeChanged=!0,this.invalidateDisplayList()},n.prototype.setShowInAutomationHierarchy=function(t){},n.prototype.setHorizontalScrollPolicy=function(t){n._super.setHorizontalScrollPolicy.call(this,t),this._itemsSizeChanged=!0,this.invalidateDisplayList()},n.prototype.getHorizontalScrollPosition=function(){return isNaN(this._horizontalScrollPositionPending)?n._super.getHorizontalScrollPosition.call(this):this._horizontalScrollPositionPending},n.prototype.setHorizontalScrollPosition=function(t){if(0!=this._getListItems().length&&this.getDataProvider()&&isNaN(this._horizontalScrollPositionPending)){this._horizontalScrollPositionPending=NaN;var e=n._super.getHorizontalScrollPosition.call(this);
if(n._super.setHorizontalScrollPosition.call(this,t),this._removeClipMask(),e!=t){if(this._itemsSizeChanged)return;var e=t-e,i=0<e,e=Math.abs(e);this._bColumnScrolling&&e>=this._columnCount?(this._clearIndicators(),this._clearVisibleData(),this._makeRowsAndColumnsWithExtraColumns(this._oldUnscaledWidth,this._oldUnscaledHeight),this._drawRowBackgrounds()):this._scrollHorizontally(t,e,i)}this._addClipMask(!1)}else this._horizontalScrollPositionPending=t,this.getDataProvider()&&this.invalidateDisplayList()},n.prototype.$setHorizontalScrollPosition=function(t){n._super.getHorizontalScrollPosition.call(this)!=t&&n._super.setHorizontalScrollPosition.call(this,t)},n.prototype.setVerticalScrollPolicy=function(t){n._super.setVerticalScrollPolicy.call(this,t),this._itemsSizeChanged=!0,this.invalidateDisplayList()},n.prototype.getVerticalScrollPosition=function(){return isNaN(this._verticalScrollPositionPending)?n._super.getVerticalScrollPosition.call(this):this._verticalScrollPositionPending},n.prototype.setVerticalScrollPosition=function(t){if(0!=this._getListItems().length&&this.getDataProvider()&&isNaN(this._verticalScrollPositionPending)){this._verticalScrollPositionPending=NaN;var e=n._super.getVerticalScrollPosition.call(this);n._super.setVerticalScrollPosition.call(this,t),this._removeClipMask();var i=this._offscreenExtraRowsTop,s=this._offscreenExtraRowsBottom;if(e!=t){var e=t-e,r=0<e,e=Math.abs(e);e>=this._getRowInfo().length-this._offscreenExtraRows||!this._iteratorValid?(this._clearIndicators(),this._clearVisibleData(),this._makeRowsAndColumnsWithExtraRows(this._oldUnscaledWidth,this._oldUnscaledHeight)):(this._scrollVertically(t,e,r),this._adjustListContent(this._oldUnscaledWidth,this._oldUnscaledHeight)),this._variableRowHeight&&this._configureScrollBars(),this._drawRowBackgrounds()}this._addClipMask(this._offscreenExtraRowsTop!=i||this._offscreenExtraRowsBottom!=s)}else this._verticalScrollPositionPending=t,this.getDataProvider()&&this.invalidateDisplayList()},n.prototype.$setVerticalScrollPosition=function(t){n._super.getVerticalScrollPosition.call(this)!=t&&n._super.setVerticalScrollPosition.call(this,t)},n.prototype._makeRowsAndColumnsWithExtraRows=function(t,e){var i,s=this._offscreenExtraRows/2;this._offscreenExtraRowsTop=Math.min(this._offscreenExtraRows/2,this.getVerticalScrollPosition());var r=this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop);this._seekPositionSafely(r),r=this._iterator.getBookmark(),0<this._offscreenExtraRowsTop&&this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0,!0,this._offscreenExtraRowsTop);var n=this._offscreenExtraRowsTop?this._getRowInfo()[this._offscreenExtraRowsTop-1].y+this._rowHeight:0;if(i=this._makeRowsAndColumns(0,n,this._listContent.getWidth(),n+this._listContent.getHeightExcludingOffsets(),0,this._offscreenExtraRowsTop),0<s&&!this._iterator.getAfterLast()){var n=0>this._offscreenExtraRowsTop+i.y-1?0:this._getRowInfo()[this._offscreenExtraRowsTop+i.y-1].y+this._getRowInfo()[this._offscreenExtraRowsTop+i.y-1].height,o=this._getListItems().length;if(i=this._makeRowsAndColumns(0,n,this._listContent.getWidth(),n,0,this._offscreenExtraRowsTop+i.y,!0,s),i.y==s)for(;0<i.y&&this._getListItems()[this._getListItems().length-1]&&0==this._getListItems()[this._getListItems().length-1].length;)i.y--,this._getListItems().pop(),this._getRowInfo().pop();else if(i.y<s&&(n=this._getListItems().length-(o+i.y)))for(s=0;s<n;s++)this._getListItems().pop(),this._getRowInfo().pop();this._offscreenExtraRowsBottom=i.y}else this._offscreenExtraRowsBottom=0;i=this._listContent.getHeightExcludingOffsets(),this._listContent.topOffset=-this._offscreenExtraRowsTop*this._rowHeight,this._listContent.bottomOffset=0<this._offscreenExtraRowsBottom?this._getListItems()[this._getListItems().length-1][0].getY()+this._rowHeight-i+this._listContent.topOffset:0,this._iteratorValid&&this._iterator.seek(r,0),this._adjustListContent(t,e)},n.prototype._makeRowsAndColumnsWithExtraColumns=function(t,e){var i=this._offscreenExtraColumns/2,s=this._offscreenExtraColumns/2;this.getHorizontalScrollPosition()>this._collection.getLength()-this._columnCount&&n._super.setHorizontalScrollPosition.call(this,Math.max(0,this._collection.getLength()-this._columnCount)),this._offscreenExtraColumnsLeft=Math.min(i,this.getHorizontalScrollPosition()),i=this._scrollPositionToIndex(this.getHorizontalScrollPosition()-this._offscreenExtraColumnsLeft,this.getVerticalScrollPosition()),this._seekPositionSafely(i),i=this._iterator.getBookmark(),0<this._offscreenExtraColumnsLeft&&this._makeRowsAndColumns(0,0,0,this._listContent.getHeight(),0,0,!0,this._offscreenExtraColumnsLeft);var r=this._offscreenExtraColumnsLeft?this._getListItems()[0][this._offscreenExtraColumnsLeft-1].getX()+this._columnWidth:0,o=this._makeRowsAndColumns(r,0,r+this._listContent.getWidthExcludingOffsets(),this._listContent.getHeight(),this._offscreenExtraColumnsLeft,0);if(0<s&&!this._iterator.getAfterLast()){var r=0>this._offscreenExtraColumnsLeft+o.x-1?0:this._getListItems()[0][this._offscreenExtraColumnsLeft+o.x-1].getX()+this._columnWidth,a=this._getListItems()[0].length,o=this._makeRowsAndColumns(r,0,r,this._listContent.getHeight(),this._offscreenExtraColumnsLeft+o.x,0,!0,s);if(o.x<s&&(a=this._getListItems()[0].length-(a+o.x)))for(s=0;s<this._getListItems().length;s++)for(r=0;r<a;r++)this._getListItems()[s].pop();this._offscreenExtraColumnsRight=o.x}else this._offscreenExtraColumnsRight=0;o=this._listContent.getWidthExcludingOffsets(),this._listContent.leftOffset=-this._offscreenExtraColumnsLeft*this._columnWidth,this._listContent.rightOffset=0<this._offscreenExtraColumnsRight?this._getListItems()[0][this._getListItems()[0].length-1].getX()+this._columnWidth-o+this._listContent.leftOffset:0,this._iterator.seek(i,0),this._adjustListContent(t,e)},n.prototype.getAllowMultipleSelection=function(){return this._allowMultipleSelection},n.prototype.setAllowMultipleSelection=function(t){this._allowMultipleSelection=t},n.prototype.getColumnCount=function(){return this._columnCount},n.prototype.setColumnCount=function(t){this._explicitColumnCount=t,this._columnCount!=t&&(this._setColumnCount(t),this._columnCountChanged=!0,this.invalidateProperties(),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("columnCountChanged")))},n.prototype._setColumnCount=function(t){this._columnCount=t},n.prototype.getColumnWidth=function(){return this._columnWidth},n.prototype.setColumnWidth=function(t){this._explicitColumnWidth=t,this._columnWidth!=t&&(this._setColumnWidth(t),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("columnWidthChanged")))},n.prototype._setColumnWidth=function(t){this._columnWidth=t},n.prototype.getData=function(){return this._data},n.prototype.setData=function(t){this._data=t,this._listData&&this._listData.labelField in this._data?this.setSelectedItem(this._data[this._listData.labelField]):this.setSelectedItem(this._data),this.dispatchEvent(new w("dataChange"))},n.prototype.getDataProvider=function(){return this._actualCollection?this._actualCollection:this._collection},n.prototype.setDataProvider=function(t){if(this._collection&&this._collection.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),ha(t))this._collection=new P(t);else if(E(t))this._collection=new Hb(t);else if(t instanceof xb)this._collection=t;else if(t instanceof la)this._collection=t;else{var e=[];null!=t&&e.push(t),this._collection=new P(e)}this._iterator&&this._iterator.removeListener(),this._iterator=this._collection.createCursor(!0),this._collectionIterator&&this._collectionIterator.removeListener(),this._collectionIterator=this._collection.createCursor(!0),this._collection.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),this._clearSelectionData(),t=new y(y.COLLECTION_CHANGE),t.kind="reset",this._collectionChangeHandler(t),this.dispatchEvent(t),this._itemsNeedMeasurement=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},n.prototype.getDataTipField=function(){return this._dataTipField},n.prototype.setDataTipField=function(t){this._dataTipField=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("dataTipFieldChanged"))},n.prototype.getDataTipFunction=function(){return this._dataTipFunction},n.prototype.setDataTipFunction=function(t){this._dataTipFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("dataTipFunctionChanged"))},n.prototype.getDragEnabled=function(){return this._dragEnabled},n.prototype.setDragEnabled=function(t){this._dragEnabled&&!t&&(this.removeEvent("dragstart",this._dragStartHandler,this),this.removeEvent("dragend",this._dragEndHandler,this)),(this._dragEnabled=t)&&(this.addEvent("dragstart",this._dragStartHandler,this,!1,-50),this.addEvent("dragend",this._dragEndHandler,this,!1,-50))},n.prototype.getDragMoveEnabled=function(){return this._dragMoveEnabled},n.prototype.setDragMoveEnabled=function(t){this._dragMoveEnabled=t},n.prototype.getDropEnabled=function(){return this._dropEnabled},n.prototype.setDropEnabled=function(t){this._dropEnabled&&!t&&(this.removeEvent("dragenter",this._dragEnterHandler,this),this.removeEvent("dragexit",this._dragExitHandler,this),this.removeEvent("dragleave",this._dragExitHandler,this),this.removeEvent("dragover",this._dragOverHandler,this),this.removeEvent("drop",this._dragDropHandler,this)),(this._dropEnabled=t)&&(this.addEvent("dragenter",this._dragEnterHandler,this,!1,-50),this.addEvent("dragexit",this._dragExitHandler,this,!1,-50),this.addEvent("dragleave",this._dragExitHandler,this,!1,-50),this.addEvent("dragover",this._dragOverHandler,this,!1,-50),this.addEvent("drop",this._dragDropHandler,this,!1,-50))},n.prototype.getIconField=function(){return this._iconField},n.prototype.setIconField=function(t){this._iconField=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("iconFieldChanged"))},n.prototype.getIconFunction=function(){return this._iconFunction},n.prototype.setIconFunction=function(t){this._iconFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("iconFunctionChanged"))},n.prototype.getItemRenderer=function(){return this._itemRenderer},n.prototype.setItemRenderer=function(t){this._itemRenderer=t,this.invalidateSize(),this.invalidateDisplayList(),this._rendererChanged=this._itemsSizeChanged=!0,this.dispatchEvent(new w("itemRendererChanged"))},n.prototype.getLabelField=function(){return this._labelField},n.prototype.setLabelField=function(t){this._labelField=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("labelFieldChanged"))},n.prototype.getLabelFunction=function(){return this._labelFunction},n.prototype.setLabelFunction=function(t){this._labelFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("labelFunctionChanged"))},n.prototype.getListData=function(){return this._listData},n.prototype.setListData=function(t){this._listData=t},n.prototype.getOffscreenExtraRowsOrColumns=function(){return this._offscreenExtraRowsOrColumns},n.prototype.setOffscreenExtraRowsOrColumns=function(t){t=Math.max(t,0),t%2&&t++,this._offscreenExtraRowsOrColumns!=t&&(this._offscreenExtraRowsOrColumns=t,this._offscreenExtraRowsOrColumnsChanged=!0,this.invalidateProperties())},n.prototype.getNullItemRenderer=function(){return this._nullItemRenderer},n.prototype.setNullItemRenderer=function(t){this._nullItemRenderer=t,this.invalidateSize(),this.invalidateDisplayList(),this._rendererChanged=this._itemsSizeChanged=!0,this.dispatchEvent(new w("nullItemRendererChanged"))},n.prototype.getRowCount=function(){return this._rowCount},n.prototype.setRowCount=function(t){this._explicitRowCount=t,this._rowCount!=t&&(this._setRowCount(t),this._rowCountChanged=!0,this.invalidateProperties(),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("rowCountChanged")))},n.prototype._setRowCount=function(t){this._rowCount=t},n.prototype.getRowHeight=function(){return this._rowHeight},n.prototype.setRowHeight=function(t){this._explicitRowHeight=t,this._rowHeight!=t&&(this._setRowHeight(t),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("rowHeightChanged")))},n.prototype._setRowHeight=function(t){this._rowHeight=t},n.prototype.getSelectable=function(){return this._selectable},n.prototype.setSelectable=function(t){this._selectable=t},n.prototype.getSelectedIndex=function(){return this._selectedIndex},n.prototype.setSelectedIndex=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedIndex(t):(this._selectedIndex=t,this._bSelectedIndexChanged=this._bSelectionChanged=!0,this.invalidateDisplayList())},n.prototype.getSelectedIndices=function(){return this._bSelectedIndicesChanged?this._selectedIndices:this._copySelectedItems(!1)},n.prototype.setSelectedIndices=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedIndices(t):(this._selectedIndices=t,this._bSelectionChanged=this._bSelectedIndicesChanged=!0,this.invalidateDisplayList())},n.prototype.getSelectedItem=function(){return this._selectedItem},n.prototype.setSelectedItem=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedItem(t):(this._selectedItem=t,this._bSelectionChanged=this._bSelectedItemChanged=!0,this.invalidateDisplayList())},n.prototype.getSelectedItems=function(){return this._bSelectedItemsChanged?this._selectedItems:this._copySelectedItems()},n.prototype.setSelectedItems=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedItems(t):(this._selectedItems=t,this._bSelectionChanged=this._bSelectedItemsChanged=!0,this.invalidateDisplayList())},n.prototype.getSelectedItemsCompareFunction=function(){return this._selectedItemsCompareFunction},n.prototype.setSelectedItemsCompareFunction=function(t){this._selectedItemsCompareFunction=t,this.dispatchEvent(new w("selectedItemsCompareFunctionChanged"))},n.prototype.getShowDataTips=function(){return this._showDataTips},n.prototype.setShowDataTips=function(t){this._showDataTips=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("showDataTipsChanged"))},n.prototype.getTruncateToFit=function(){return this._truncateToFit},n.prototype.setTruncateToFit=function(t){t!=this._truncateToFit&&(this._truncateToFit=t,this._itemsSizeChanged=this._truncateToFitChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("truncateToFitChanged")))},n.prototype.getValue=function(){var t=this.getSelectedItem();return t?"object"!=typeof t?t:null!=t.getData()?t.getData():t.label:null},n.prototype.getVariableRowHeight=function(){return this._variableRowHeight},n.prototype.setVariableRowHeight=function(t){this._variableRowHeight=t,this._itemsSizeChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("variableRowHeightChanged"))},n.prototype.getWordWrap=function(){return this._wordWrap},n.prototype.setWordWrap=function(t){t!=this._wordWrap&&(this._wordWrap=t,this._itemsSizeChanged=this._wordWrapChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("wordWrapChanged")))},n.prototype._getVisibleData=function(){return this._listContent.visibleData},n.prototype._getListContentStyleFilters=function(){return this._listContentStyleFilters},n.prototype._getListItems=function(){return this._listContent?this._listContent.listItems:[]},n.prototype._getRowInfo=function(){return this._listContent.rowInfo},n.prototype._getRendererArray=function(){return this._getListItems()},n.prototype.createChildren=function(){n._super.createChildren.call(this),this._listContent||(this._listContent=new Kb(this),this.addChild(this._listContent)),this._selectionLayer||(this._selectionLayer=this._listContent.selectionLayer)},n.prototype.commitProperties=function(){if(n._super.commitProperties.call(this),this._listContent&&this._listContent.iterator!=this._iterator&&(this._listContent.iterator=this._iterator),this._cachedPaddingTopInvalid&&(this._cachedPaddingTopInvalid=!1,this._cachedPaddingTop=this.getSizeStyle("paddingTop"),this._itemsSizeChanged=!0,this.invalidateDisplayList()),this._cachedPaddingBottomInvalid&&(this._cachedPaddingBottomInvalid=!1,this._cachedPaddingBottom=this.getSizeStyle("paddingBottom"),this._itemsSizeChanged=!0,this.invalidateDisplayList()),this._cachedVerticalAlignInvalid&&(this._cachedVerticalAlignInvalid=!1,this._cachedVerticalAlign=this.getStyle("verticalAlign"),this._itemsSizeChanged=!0,this.invalidateDisplayList()),this._columnCountChanged){if(1>this._columnCount&&(this._columnCount=this._defaultColumnCount),!isNaN(this.getExplicitWidth())&&isNaN(this._explicitColumnWidth)&&0<this._explicitColumnCount){var t=this.getViewMetrics();this._setColumnWidth((this.getExplicitWidth()-t.left-t.right)/this._columnCount)}this._columnCountChanged=!1}if(this._rowCountChanged&&(1>this._rowCount&&(this._rowCount=this._defaultRowCount),!isNaN(this.getExplicitHeight())&&isNaN(this._explicitRowHeight)&&0<this._explicitRowCount&&(t=this.getViewMetrics(),this._setRowHeight((this.getExplicitHeight()-t.top-t.bottom)/this._rowCount)),this._rowCountChanged=!1),this._offscreenExtraRowsOrColumnsChanged){if(this._adjustOffscreenRowsAndColumns(),this._iterator){var t=Math.min(this._offscreenExtraColumns/2,this.getHorizontalScrollPosition()),e=Math.min(this._offscreenExtraRows/2,this.getVerticalScrollPosition()),t=this._scrollPositionToIndex(this.getHorizontalScrollPosition()-t,this.getVerticalScrollPosition()-e);this._seekPositionSafely(t),this.invalidateList()}this._offscreenExtraRowsOrColumnsChanged=!1}},n.prototype.measure=function(){n._super.measure.call(this);var t=this.getViewMetrics(),e=1>this._explicitColumnCount?this._defaultColumnCount:this._explicitColumnCount,i=1>this._explicitRowCount?this._defaultRowCount:this._explicitRowCount;isNaN(this._explicitRowHeight)?(this.measuredHeight=this._rowHeight*i+t.top+t.bottom,this.measuredMinHeight=this._rowHeight*Math.min(i,2)+t.top+t.bottom):(this.measuredHeight=this._explicitRowHeight*i+t.top+t.bottom,this.measuredMinHeight=this._explicitRowHeight*Math.min(i,2)+t.top+t.bottom),isNaN(this._explicitColumnWidth)?(this.measuredWidth=this._columnWidth*e+t.left+t.right,this.measuredMinWidth=this._columnWidth*Math.min(e,1)+t.left+t.right):(this.measuredWidth=this._explicitColumnWidth*e+t.left+t.right,this.measuredMinWidth=this._explicitColumnWidth*Math.min(e,1)+t.left+t.right),"auto"==this.getVerticalScrollPolicy()&&this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this.measuredWidth-=this._verticalScrollBar.getMinWidth(),this.measuredMinWidth-=this._verticalScrollBar.getMinWidth()),"auto"==this.getHorizontalScrollPolicy()&&this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this.measuredHeight-=this._horizontalScrollBar.getMinHeight(),this.measuredMinHeight-=this._horizontalScrollBar.getMinHeight())},n.prototype.removeDataEffectItem=function(e){this._modifiedCollectionView&&(this._modifiedCollectionView.removeItem(this._dataItemWrappersByRenderer[e.uno]),this._iterator.seek(t.getCURRENT()),this._invalidateDisplayListFlag?this.callLater(this.invalidateList):this.invalidateList())},n.prototype.addDataEffectItem=function(e){this._modifiedCollectionView&&this._modifiedCollectionView.addItem(this._dataItemWrappersByRenderer[e.uno]),this._iterator.getAfterLast()?this._iterator.seek(t.getFIRST()):this._iterator.seek(t.getCURRENT()),this._invalidateDisplayListFlag?this.callLater(this.invalidateList):this.invalidateList()},n.prototype.unconstrainRenderer=function(t){this._unconstrainedRenderers[t]=!0},n.prototype.getRendererSemanticValue=function(t,e){return this._modifiedCollectionView.getSemantics(this._dataItemWrappersByRenderer[t.uno])==e},n.prototype._isRendererUnconstrained=function(t){return null!=this._unconstrainedRenderers[t]},n.prototype.updateDisplayList=function(t,e){if(n._super.updateDisplayList.call(this,t,e),this._oldUnscaledWidth!=t||this._oldUnscaledHeight!=e||this._itemsSizeChanged||this._bSelectionChanged||this._scrollAreaChanged){this._oldUnscaledWidth!=t&&(this._itemsSizeChanged=!0);var i;this._removeClipMask(),this._rendererChanged?this._purgeItemRenderers():this._dataEffectCompleted&&this._partialPurgeItemRenderers(),this._adjustListContent(t,e);var s=this._collection&&0<this._collection.getLength();s&&this._adjustScrollPosition(),this._oldUnscaledWidth==t&&!this._scrollAreaChanged&&!this._itemsSizeChanged&&0<this._getListItems().length&&this._iterator&&1==this._columnCount?(i=this._getListItems().length-1,this._oldUnscaledHeight>e?this._reduceRows(i):this._makeAdditionalRows(i)):(this._iterator&&(i=this._iterator.getBookmark()),this._clearIndicators(),this._rendererTrackingSuspended=!0,this._iterator?this._offscreenExtraColumns||this._offscreenExtraColumnsLeft||this._offscreenExtraColumnsRight?this._makeRowsAndColumnsWithExtraColumns(t,e):this._makeRowsAndColumnsWithExtraRows(t,e):this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0),this._rendererTrackingSuspended=!1,this._seekPositionIgnoreError(this._iterator,i)),this._oldUnscaledWidth=t,this._oldUnscaledHeight=e,this._configureScrollBars(),this._addClipMask(!0),this._truncateToFitChanged=this._wordWrapChanged=this._itemsSizeChanged=!1,this._adjustSelectionSettings(s),this._keySelectionPending&&this._iteratorValid&&(this._keySelectionPending=!1,this._finishKeySelection())}},n.prototype._adjustListContent=function(t,e){t=0<arguments.length?t:-1,e=1<arguments.length?e:-1,0>e&&(e=this._oldUnscaledHeight,t=this._oldUnscaledWidth);var i=this.getViewMetrics(),s=i.left+this._listContent.leftOffset,r=i.top+this._listContent.topOffset;this._listContent.move(s,r),this._listContent.setActualSize(t+(Math.max(0,this._listContent.rightOffset)-s-i.right),e+(Math.max(0,this._listContent.bottomOffset)-r-i.bottom))},n.prototype._adjustScrollPosition=function(){var t=!1;if(!isNaN(this._horizontalScrollPositionPending)){this._positionChanged=!0;var e=Math.min(this._horizontalScrollPositionPending,this.getMaxHorizontalScrollPosition());this._horizontalScrollPositionPending=NaN,n._super.setHorizontalScrollPosition.call(this,e)}isNaN(this._verticalScrollPositionPending)||(t=!0,e=Math.min(this._verticalScrollPositionPending,this.getMaxVerticalScrollPosition()),this._verticalScrollPositionPending=NaN,n._super.setVerticalScrollPosition.call(this,e)),t&&(t=this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop),this._seekPositionSafely(t))},n.prototype._adjustOffscreenRowsAndColumns=function(){this._offscreenExtraColumns=0,this._offscreenExtraRows=this._offscreenExtraRowsOrColumns},n.prototype._purgeItemRenderers=function(){for(this._rendererChanged=!1;this._getListItems().length;)for(var t=this._getListItems().pop();t.length;){var e=t.pop();e&&(this._listContent.removeChild(e),this._dataItemWrappersByRenderer[e.uno]?delete this._getVisibleData()[this._itemToUID(this._dataItemWrappersByRenderer[e.uno])]:delete this._getVisibleData()[this._itemToUID(e.getData())])}for(;this._freeItemRenderers.length;)t=this._freeItemRenderers.pop(),t.getParent()&&this._listContent.removeChild(t);var i,s;for(i in this._freeItemRenderersByFactory)for(s in e=this._freeItemRenderersByFactory[i])t=s,delete e[s],t.getParent()&&this._listContent.removeChild(t);this._rowMap={},this._listContent.rowInfo=[]},n.prototype._partialPurgeItemRenderers=function(){for(this._dataEffectCompleted=!1;this._freeItemRenderers.length;){var t=this._freeItemRenderers.pop();t.getParent()&&this._listContent.removeChild(t)}var e,i,s,r;for(e in this._freeItemRenderersByFactory)for(s in i=this._freeItemRenderersByFactory[e])t=s,delete i[s],t.getParent()&&this._listContent.removeChild(t);for(r in this._reservedItemRenderers)t=this._reservedItemRenderers[r],t.getParent()&&this._listContent.removeChild(t);this._reservedItemRenderers={},this._rowMap={},this._clearVisibleData()},n.prototype._reduceRows=function(t){for(;0<=t&&this._getRowInfo()[t].y>=this._listContent.getHeight();){var e,i=this._getListItems()[t].length;for(e=0;e<i;e++)this._addToFreeItemRenderers(this._getListItems()[t][e]);e=this._getRowInfo()[t].uid,delete this._getVisibleData()[e],this._removeIndicators(e),this._getListItems().pop(),this._getRowInfo().pop(),t--}},n.prototype._makeAdditionalRows=function(e){var i;if(this._iterator){i=this._iterator.getBookmark();try{this._iterator.seek(t.getCURRENT(),this._getListItems().length)}catch(s){this._lastSeekPending=new Da(t.getCURRENT(),this._getListItems().length),s.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}}var r=this._getRowInfo()[e].y+this._getRowInfo()[e].height;this._makeRowsAndColumns(0,r,this._listContent.getWidth(),this._listContent.getHeight(),0,e+1),this._seekPositionIgnoreError(this._iterator,i)},n.prototype._adjustSelectionSettings=function(t){this._bSelectionChanged&&(this._bSelectionChanged=!1,this._bSelectedIndicesChanged&&(t||null==this._selectedIndices)&&(this._bSelectedIndexChanged=this._bSelectedIndicesChanged=!1,this._commitSelectedIndices(this._selectedIndices)),this._bSelectedItemChanged&&(t||null==this._selectedItem)&&(this._bSelectedIndexChanged=this._bSelectedItemChanged=!1,this._commitSelectedItem(this._selectedItem)),this._bSelectedItemsChanged&&(t||null==this._selectedItems)&&(this._bSelectedIndexChanged=this._bSelectedItemsChanged=!1,this._commitSelectedItems(this._selectedItems)),this._bSelectedIndexChanged&&(t||-1==this._selectedIndex)&&(this._commitSelectedIndex(this._selectedIndex),this._bSelectedIndexChanged=!1))},n.prototype._seekPositionIgnoreError=function(t,e){if(t)try{t.seek(e,0)}catch(i){}},n.prototype._seekNextSafely=function(e,i){try{e.moveNext()}catch(s){this._lastSeekPending=new Da(t.getFIRST(),i),s.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}return this._iteratorValid},n.prototype._seekPreviousSafely=function(e,i){try{e.movePrevious()}catch(s){this._lastSeekPending=new Da(t.getFIRST(),i),s.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}return this._iteratorValid},n.prototype._seekPositionSafely=function(e){try{this._iterator.seek(t.getFIRST(),e),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(i){this._lastSeekPending=new Da(t.getFIRST(),e),i.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}return this._iteratorValid},n.prototype.styleChanged=function(t){if(n._IS_ITEM_STYLE[t])this._itemsSizeChanged=!0,this.invalidateDisplayList();else if("paddingTop"==t)this._cachedPaddingTopInvalid=!0,this.invalidateProperties();else if("paddingBottom"==t)this._cachedPaddingBottomInvalid=!0,this.invalidateProperties();else if("verticalAlign"==t)this._cachedVerticalAlignInvalid=!0,this.invalidateProperties();else if(this._listContent&&this._getListItems()){var e,i,s,r=this._getListItems().length;for(e=0;e<r;e++)for(s=this._getListItems()[e].length,i=0;i<s;i++)this._getListItems()[e][i]&&this._getListItems()[e][i].styleChanged(t)}n._super.styleChanged.call(this,t),this._invalidateSizeFlag&&(this._itemsNeedMeasurement=!0,this.invalidateProperties()),Tb.sizeInvalidatingStyles[t]&&(this._scrollAreaChanged=!0)},n.prototype.measureWidthOfItems=function(t,e){return NaN},n.prototype.measureHeightOfItems=function(t,e){return NaN},n.prototype.itemToLabel=function(t){var e;if(p(t))return" ";if(!p(this.getLabelFunction()))return this.getLabelFunction()(t);if(E(t))try{e=G.getProperty(t,"@"+this.getLabelField()),p(e)||(t=e)}catch(i){}else if(Ea(t))try{p(t[this.getLabelField()])||(t=t[this.getLabelField()])}catch(i){}if(F(t))return t;try{return t.toString()}catch(i){}return" "},n.prototype.itemToDataTip=function(t){var e;if(p(t))return" ";if(!p(this._dataTipFunction))return this.getDataTipFunction()(t);if(E(t))try{e=G.getProperty(t,"@"+this.getDataTipField()),p(e)||(t=e)}catch(i){}else if(Ea(t))try{p(t[this.getDataTipField()])?p(t.label)||(t=t.label):t=t[this.getDataTipField()]}catch(i){}if(F(t))return t;try{return t.toString()}catch(i){}return" "},n.prototype.itemToIcon=function(t){if(p(t))return null;if(!p(this.getIconFunction()))return this.getIconFunction()(t);var e;if(E(t))try{if(e=G.getProperty(t,"@"+this.getIconField()),!p(e))return e}catch(i){}else if(t instanceof Object)try{if(!p(t[this.getIconField()]))return t[this.getIconField()]}catch(i){}return null},n.prototype._makeRowsAndColumns=function(t,e,i,s,r,n,o,a){return new ra(0,0)},n.prototype.indicesToIndex=function(t,e){return t*this._columnCount+e},n.prototype._indexToRow=function(t){return t},n.prototype._indexToColumn=function(t){return 0},n.prototype._indicesToItemRenderer=function(t,e){return this._getListItems()[t][e]},n.prototype.itemRendererToIndices=function(t){if(!(t&&t.name in this._rowMap))return null;var e,i=this._rowMap[t.name].rowIndex,s=this._getListItems()[i].length;for(e=0;e<s&&this._getListItems()[i][e]!=t;e++);return new ra(e+this.getHorizontalScrollPosition(),i+this.getVerticalScrollPosition()+this._offscreenExtraRowsTop)},n.prototype.indexToItemRenderer=function(t){var e=this.getVerticalScrollPosition()-this._offscreenExtraRowsTop;return t<e||t>=e+this._getListItems().length?null:this._getListItems()[t-e][0]},n.prototype.itemRendererToIndex=function(t){return t.name in this._rowMap?this._rowMap[t.name].rowIndex+this.getVerticalScrollPosition()-this._offscreenExtraRowsTop:Number.MIN_VALUE},n.prototype._itemToUID=function(t){return p(t)?"null":V.getUID(t)},n.prototype._UIDToItemRenderer=function(t){return this._listContent?this._getVisibleData()[t]:null},n.prototype.itemToItemRenderer=function(t){return this._UIDToItemRenderer(this._itemToUID(t))},n.prototype.isItemVisible=function(t){return p(this.itemToItemRenderer(t))},n.prototype._mouseEventToItemRenderer=function(t){return this._mouseEventToItemRendererOrEditor(t)},n.prototype._mouseEventToItemRendererOrEditor=function(t){var e;if(e=t.target.selfUIElement?t.target.selfUIElement:t.target.selfElement,!p(e)){if(e instanceof qa||(e=e.getParent()),e===this._listContent){var i=v.getEventPageXY(t),i=this._listContent.globalToLocal(i),s=0,r=this._getListItems().length;for(t=0;t<r;t++){if(this._getListItems()[t].length&&i.y<s+this._getRowInfo()[t].height)return e=this._getListItems()[t].length,1==e?this._getListItems()[t][0]:(e=Math.floor(i.x/this._columnWidth),this._getListItems()[t][e]);s+=this._getRowInfo()[t].height}}else if(e==this._highlightIndicator)return this._lastHighlightItemRenderer;for(;e&&e!=this;){if(e instanceof qa&&e.getParent()===this._listContent){if(e.getVisible())return e;break}e=e instanceof A?e.owner?e.owner:e.getParent():e.parentNode.selfElement}return null}},n.prototype._hasOnlyTextRenderers=function(){if(0==this._getListItems().length)return!0;var t,e=this._getListItems()[this._getListItems().length-1],i=e.length;for(t=0;t<i;t++)if(!(e[t]instanceof pa))return!1;return!0},n.prototype.itemRendererContains=function(t,e){return!(!e||!t)&&t.owns(e)},n.prototype._addToFreeItemRenderers=function(t){t.setVisible(!1);var e=this._factoryMap[t.uno],i=this._dataItemWrappersByRenderer[t.uno],s=i?this._itemToUID(i):this._itemToUID(t.getData());this._getVisibleData()[s]==t&&delete this._getVisibleData()[s],i?this._reservedItemRenderers[this._itemToUID(i)]=t:(this._freeItemRenderersByFactory||(this._freeItemRenderersByFactory={}),I(this._freeItemRenderersByFactory[e])&&(this._freeItemRenderersByFactory[e]={}),this._freeItemRenderersByFactory[e][t]=1,e==this.getItemRenderer()&&this._freeItemRenderers.push(t)),
delete this._rowMap[t.name]},n.prototype._getReservedOrFreeItemRenderer=function(t){var e,i,s;if(this._runningDataEffect&&(e=this._reservedItemRenderers[i=this._itemToUID(t)]),e)delete this._reservedItemRenderers[i];else if(t=this.getItemRendererFactory(t),this._freeItemRenderersByFactory)if(t==this.getItemRenderer())this._freeItemRenderers.length&&(e=this._freeItemRenderers.pop(),delete this._freeItemRenderersByFactory[t][e]);else if(i=this._freeItemRenderersByFactory[t])for(s in i){e=s,delete this._freeItemRenderersByFactory[t][e];break}return e},n.prototype.getItemRendererFactory=function(t){return null==t?this._nullItemRenderer:this._itemRenderer},n.prototype._drawRowBackgrounds=function(){},n.prototype._drawItem=function(t,e,i,s,r){if(e=1<arguments.length&&e,i=2<arguments.length&&i,s=3<arguments.length&&s,r=4<arguments.length&&r,t){var n;if(n=t.getParent()){var o=n.rowInfo,a=n.selectionLayer,l=this._rowMap[t.name];if(l){if(!i||this._highlightItemRenderer&&this._highlightUID==l.uid?!i&&this._highlightItemRenderer&&l&&this._highlightUID==l.uid&&(this._clearHighlightIndicator(this._highlightIndicator,t),this._highlightUID=this._highlightItemRenderer=null):(this._highlightIndicator?this._highlightIndicator.getParent()!=a?a.addChild(this._highlightIndicator):a.setChildIndex(this._highlightIndicator,a.getNumChildren()-1):(n=new A,a.addChild(n),this._highlightIndicator=n),n=this._highlightIndicator,this._drawHighlightIndicator(n,t.getX(),o[l.rowIndex].y,t.getWidth(),o[l.rowIndex].height,this.getStyle("rollOverColor"),t),this._lastHighlightItemRenderer=this._highlightItemRenderer=t,this._highlightUID=l.uid),e){var h=this._runningDataEffect?t.getY()-this._cachedPaddingTop:o[l.rowIndex].y;this._selectionIndicators[l.uid]?(n=this._selectionIndicators[l.uid],this._drawSelectionIndicator(n,t.getX(),h,t.getWidth(),o[l.rowIndex].height,this.getEnabled()?this.getStyle("selectionColor"):this.getStyle("selectionDisabledColor"),t)):(n=new A,a.addChildAt(n,0),this._selectionIndicators[l.uid]=n,this._drawSelectionIndicator(n,t.getX(),h,t.getWidth(),o[l.rowIndex].height,this.getEnabled()?this.getStyle("selectionColor"):this.getStyle("selectionDisabledColor"),t),r&&this._applySelectionEffect(n,l.uid,t))}else!e&&l&&this._selectionIndicators[l.uid]&&(this._selectionTweens[l.uid]&&(1>this._selectionIndicators[l.uid].getAlpha()&&oa.removeTween(this._selectionTweens[l.uid]),delete this._selectionTweens[l.uid]),a.removeChild(this._selectionIndicators[l.uid]),delete this._selectionIndicators[l.uid]);s?this._showCaret&&(this._caretIndicator?this._caretIndicator.parent!=a?a.addChild(this._caretIndicator):a.setChildIndex(this._caretIndicator,a.getNumChildren()-1):(n=new A,a.addChild(n),this._caretIndicator=n),n=this._caretIndicator,this._drawCaretIndicator(n,t.getX(),o[l.rowIndex].y,t.getWidth(),o[l.rowIndex].height,this.getStyle("selectionColor"),t),this._caretItemRenderer=t,this._caretUID=l.uid):!s&&this._caretItemRenderer&&this._caretUID==l.uid&&(this._clearCaretIndicator(this._caretIndicator,t),this._caretItemRenderer=null,this._caretUID=""),Ea(t)?(t.invalidateDisplayList(),t.validateNow()):t instanceof pa&&t.validateNow()}}}},n.prototype._drawHighlightIndicator=function(t,e,i,s,r,n,o){t.setStyle("backgroundColor",n),t.setWidth(s),t.setHeight(r),t.setX(e),t.setY(i)},n.prototype._clearHighlightIndicator=function(t,e){this._highlightIndicator&&this._highlightIndicator.setStyle("backgroundColor","transparent")},n.prototype._drawSelectionIndicator=function(t,e,i,s,r,n,o){t.setStyle("backgroundColor",n),t.setWidth(s),t.setHeight(r),t.setX(e),t.setY(i)},n.prototype._drawCaretIndicator=function(t,e,i,s,r,n,o){t.setStyle("borderColor",n),t.setStyle("borderWidth",1),t.setStyle("borderStyle","solid"),t.setWidth(s),t.setHeight(r),t.setX(e),t.setY(i)},n.prototype._clearCaretIndicator=function(t,e){this._caretIndicator&&this._caretIndicator.setStyle("borderStyle","none")},n.prototype._clearIndicators=function(){for(var t in this._selectionTweens)this._removeIndicators(t);for(;0<this._selectionLayer.getNumChildren();)this._selectionLayer.removeChildAt(0);this._selectionTweens={},this._selectionIndicators={},this._caretUID=this._caretIndicator=this._highlightUID=this._highlightIndicator=null},n.prototype._removeIndicators=function(t){this._selectionTweens[t]&&(1>this._selectionIndicators[t].getAlpha()&&oa.removeTween(this._selectionTweens[t]),delete this._selectionTweens[t]),this._selectionIndicators[t]&&(this._selectionIndicators[t].getParent().removeChild(this._selectionIndicators[t]),this._selectionIndicators[t]=null),t==this._highlightUID&&(this._highlightUID=this._highlightItemRenderer=null,this._clearHighlightIndicator(this._highlightIndicator,this._UIDToItemRenderer(t))),t==this._caretUID&&(this._caretUID=this._caretItemRenderer=null,this._clearCaretIndicator(this._caretIndicator,this._UIDToItemRenderer(t)))},n.prototype._clearHighlight=function(t){var e=this._itemToUID(t.getData());this._drawItem(this._UIDToItemRenderer(e),this.isItemSelected(t.getData()),!1,e==this._caretUID),this.itemRendererToIndices(t)&&this._lastHighlightItemIndices&&(t=new L(L.ITEM_ROLL_OUT),t.columnIndex=this._lastHighlightItemIndices.x,t.rowIndex=this._lastHighlightItemIndices.y,t.itemRenderer=this._lastHighlightItemRendererAtIndices,this.dispatchEvent(t),this._lastHighlightItemIndices=null)},n.prototype.invalidateList=function(){this._itemsSizeChanged=!0,this.invalidateDisplayList()},n.prototype._updateList=function(){this._removeClipMask();var t=this._iterator?this._iterator.getBookmark():null;this._clearIndicators(),this._clearVisibleData(),this._iterator?(this._offscreenExtraColumns||this._offscreenExtraColumnsLeft||this._offscreenExtraColumnsRight?this._makeRowsAndColumnsWithExtraColumns(this.getWidth(),this.getHeight()):this._makeRowsAndColumnsWithExtraRows(this.getWidth(),this.getHeight()),this._iterator.seek(t,0)):this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0),this._drawRowBackgrounds(),this._configureScrollBars(),this._addClipMask(!0)},n.prototype._clearVisibleData=function(){this._listContent.visibleData={}},n.prototype._reKeyVisibleData=function(){var t,e={};for(t in this._getVisibleData())this._getVisibleData()[t.getData()]&&(e[this._itemToUID(this._getVisibleData()[t.getData()])]=this._getVisibleData()[t]);this._listContent.visibleData=e},n.prototype._setAllowItemSizeChangeNotification=function(t){this._listContent._allowItemSizeChangeNotification=t},n.prototype._addClipMask=function(t){if(t&&(this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()||this._hasOnlyTextRenderers()||this._runningDataEffect||0!=this._listContent.bottomOffset||0!=this._listContent.topOffset||0!=this._listContent.leftOffset||0!=this._listContent.rightOffset?(this._listContent.mask=this._maskShape,this._selectionLayer.mask=null):(this._listContent.mask=null,this._selectionLayer.mask=this._maskShape)),!this._listContent.mask){t=this._getListItems().length-1;var e=this._getRowInfo()[t];if(t=this._getListItems()[t],!(e.y+e.height<=this._listContent.getHeight())){var i=t.length,s=e.y;this._listContent.getWidth();for(var r=this._listContent.getHeight()-e.y,e=0;e<i;e++){var n=t[e],o=n.y-s;n instanceof pa&&n.setHeight(r-o)}}}},n.prototype._createItemMask=function(t,e,i,s,r){var n;if(this._itemMaskFreeList||(this._itemMaskFreeList=[]),0<this._itemMaskFreeList.length)n=this._itemMaskFreeList.pop(),n.width!=i&&(n.width=i),n.height!=s&&(n.height=s);else{n=new A,n.name="mask";var o=n.graphics;o.beginFill(16777215),o.drawRect(0,0,i,s),o.endFill(),n.setVisible(!1),r?r.addChild(n):this._listContent.addChild(n)}return n.getX()!=t&&n.setX(t),n.getY()!=e&&n.setY(e),n},n.prototype._removeClipMask=function(){if(!this._listContent||!this._listContent.mask){var t=this._getListItems().length-1;if(!(0>t)){this._getRowInfo();for(var e=this._getRowInfo()[t],i=this._getListItems()[t],s=i.length,t=0;t<s;t++){var r=i[t];r instanceof pa?r.getHeight()!=this._rowHeight-(r.getY()-e.y)&&r.setHeight(this._rowHeight-(r.getY()-e.y)):r&&r.mask&&(this._itemMaskFreeList.push(r.mask),r.mask=null)}}}},n.prototype.isItemHighlighted=function(t){if(null==t)return!1;var e=this._highlightIndicator&&this._highlightIndicator.getParent().getChildIndex(this._highlightIndicator)!=this._highlightIndicator.getParent().getNumChildren()-1;return F(t)?t==this._highlightUID&&!e:this._itemToUID(t)==this._highlightUID&&!e},n.prototype.isItemSelected=function(t){return null!=t&&(F(t)?!I(this._selectedData[t]):!I(this._selectedData[this._itemToUID(t)]))},n.prototype.isItemSelectable=function(t){return!(!this.getSelectable()||null==t)},n.prototype._calculateSelectedIndexAndItem=function(){var t,e=0;for(t in this._selectedData){e=1;break}e?(this._selectedIndex=this._selectedData[t].index,this._selectedItem=this._selectedData[t].data):(this._selectedIndex=-1,this._selectedItem=null)},n.prototype._selectItem=function(e,i,s,r){if(r=!(3<arguments.length)||r,!e||!this.isItemSelectable(e.getData()))return!1;var n=!1,o=this._iterator.getBookmark(),a=this.itemRendererToIndex(e),l=this._itemToUID(e.getData());if(this._allowMultipleSelection&&(i||s))if(i&&this._allowMultipleSelection){if(this._anchorBookmark){n=this._anchorBookmark,l=this._anchorIndex,d=this._anchorIndex<a,this._clearSelected(!1),this._caretIndex=a,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=l,this._anchorBookmark=n,this._selectedIndex=a,this._selectedItem=e.getData();try{this._iterator.seek(this._anchorBookmark,0)}catch(h){h.addResponder(new S(this._selectionPendingResultHandler,this._selectionPendingFailureHandler,new ve(d,a,e.getData(),r,o,t.getCURRENT(),0))),this._iteratorValid=!1}this._shiftSelectionLoop(d,this._anchorIndex,e.getData(),r,o)}n=!0}else s&&this._allowMultipleSelection&&(this._selectedData[l]?(this._removeSelectionData(l),this._drawItem(this._UIDToItemRenderer(l),!1,l==this._highlightUID,!0,r),e.getData()==this.getSelectedItem()&&this._calculateSelectedIndexAndItem()):(this._insertSelectionDataBefore(l,new Nb(e.getData(),a,this._approximate),this._firstSelectionData),this._drawItem(this._UIDToItemRenderer(l),!0,l==this._highlightUID,!0,r),this._selectedIndex=a,this._selectedItem=e.getData()),this._iterator.seek(t.getCURRENT(),a-this.indicesToIndex(this.getVerticalScrollPosition(),this.getHorizontalScrollPosition())),this._caretIndex=a,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=a,this._anchorBookmark=this._iterator.getBookmark(),this._iterator.seek(o,0),n=!0);else{var d=0;if(this._allowMultipleSelection){var c=this._firstSelectionData;p(c)||(d++,c.nextSelectionData&&d++)}s&&this._selectedData[l]?(n=!0,this._clearSelected(r)):(this._selectedIndex!=a||this._bSelectedIndexChanged||this._allowMultipleSelection&&1!=d)&&(n=!0,this._clearSelected(r),this._insertSelectionDataBefore(l,new Nb(e.getData(),a,this._approximate),this._firstSelectionData),this._drawItem(this._UIDToItemRenderer(l),!0,l==this._highlightUID,!0,r),this._selectedIndex=a,this._selectedItem=e.getData(),this._iterator.seek(t.getCURRENT(),this._selectedIndex-this.indicesToIndex(this.getVerticalScrollPosition()-this._offscreenExtraRowsTop,this.getHorizontalScrollPosition()-this._offscreenExtraColumnsLeft)),this._caretIndex=this._selectedIndex,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=this._selectedIndex,this._anchorBookmark=this._iterator.getBookmark(),this._iterator.seek(o,0))}return n},n.prototype._shiftSelectionLoop=function(e,i,s,r,n){var o,a;try{do{if(o=this._iterator.getCurrent(),a=this._itemToUID(o),this._insertSelectionDataBefore(a,new Nb(o,i,this._approximate),this._firstSelectionData),this._UIDToItemRenderer(a)&&this._drawItem(this._UIDToItemRenderer(a),!0,a==this._highlightUID,!1,r),o===s){this._UIDToItemRenderer(a)&&this._drawItem(this._UIDToItemRenderer(a),!0,a==this._highlightUID,!0,r);break}e?i++:i--}while(e?this._iterator.moveNext():this._iterator.movePrevious())}catch(l){l.addResponder(new S(this._selectionPendingResultHandler,this._selectionPendingFailureHandler,new ve(e,i,s,r,n,t.getCURRENT(),0))),this._iteratorValid=!1}try{this._iterator.seek(n,0),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(l){this._lastSeekPending=new Da(n,0),l.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending))}},n.prototype._clearSelected=function(t){t=0<arguments.length&&t;for(var e in this._selectedData){var i=this._selectedData[e].data;this._removeSelectionData(e),(i=this._UIDToItemRenderer(this._itemToUID(i)))&&this._drawItem(i,!1,e==this._highlightUID,!1,t)}this._clearSelectionData(),this._selectedIndex=-1,this._selectedItem=null,this._anchorIndex=this._caretIndex=-1,this._anchorBookmark=this._caretBookmark=null},n.prototype._moveSelectionHorizontally=function(t,e,i){},n.prototype._moveSelectionVertically=function(t,e,i){var s;this._showCaret=!0;var r=this._getListItems().length,n=this._getListItems().length-this._offscreenExtraRowsTop-this._offscreenExtraRowsBottom,r=this._getRowInfo()[r-this._offscreenExtraRowsBottom-1].y+this._getRowInfo()[r-this._offscreenExtraRowsBottom-1].height>this._listContent.getHeightExcludingOffsets()-this._listContent.topOffset?1:0,o=!1;switch(this._bSelectItem=!1,t){case 38:0<this._caretIndex&&(this._caretIndex--,this._bSelectItem=o=!0);break;case 40:this._caretIndex<this._collection.getLength()-1?(this._caretIndex++,this._bSelectItem=o=!0):this._caretIndex==this._collection.getLength()-1&&r&&this.getVerticalScrollPosition()<this.getMaxVerticalScrollPosition()&&(s=this.getVerticalScrollPosition()+1);break;case 33:this._caretIndex>this.getVerticalScrollPosition()&&this._caretIndex<this.getVerticalScrollPosition()+n?this._caretIndex=this.getVerticalScrollPosition():(this._caretIndex=Math.max(this._caretIndex-Math.max(n-r,1),0),s=Math.max(this._caretIndex,0)),this._bSelectItem=!0;break;case 34:this._caretIndex>=this.getVerticalScrollPosition()&&this._caretIndex<this.getVerticalScrollPosition()+n-r-1||(this._caretIndex==this.getVerticalScrollPosition()&&1>=n-r&&this._caretIndex++,s=Math.max(Math.min(this._caretIndex,this.getMaxVerticalScrollPosition()),0)),this._bSelectItem=!0;break;case 36:0<this._caretIndex&&(this._caretIndex=0,this._bSelectItem=!0,s=0);break;case 35:this._caretIndex<this._collection.getLength()-1&&(this._caretIndex=this._collection.getLength()-1,this._bSelectItem=!0,s=this.getMaxVerticalScrollPosition())}return o&&(this._caretIndex>=this.getVerticalScrollPosition()+n-r?s=0==n-r?Math.min(this.getMaxVerticalScrollPosition(),this._caretIndex):Math.min(this.getMaxVerticalScrollPosition(),this._caretIndex-n+r+1):this._caretIndex<this.getVerticalScrollPosition()&&(s=Math.max(this._caretIndex,0))),isNaN(s)||(this.getVerticalScrollPosition()!=s&&(n=new ma(ma.SCROLL),n.direction="vertical",n.delta=s-this.getVerticalScrollPosition(),n.position=s,this.setVerticalScrollPosition(s),this.dispatchEvent(n)),this._iteratorValid)?(this._bShiftKey=e,this._bCtrlKey=i,this._lastKey=t,void this._finishKeySelection()):void(this._keySelectionPending=!0)},n.prototype._finishKeySelection=function(){var t,e=this._getListItems().length;t=this._getListItems().length-this._offscreenExtraRowsTop-this._offscreenExtraRowsBottom;var i=this._getRowInfo()[e-this._offscreenExtraRowsBottom-1].y+this._getRowInfo()[e-this._offscreenExtraRowsBottom-1].height>this._listContent.getHeightExcludingOffsets()-this._listContent.topOffset?1:0;34==this._lastKey&&(this._caretIndex=0==t-i?Math.min(this.getVerticalScrollPosition()+t-i,this._collection.getLength()-1):Math.min(this.getVerticalScrollPosition()+t-i-1,this._collection.getLength()-1));var s,e=!1;if(this._bSelectItem&&0<=this._caretIndex-this.getVerticalScrollPosition()){if(this._caretIndex-this.getVerticalScrollPosition()>Math.max(t-i-1,0)){if(35==this._lastKey&&this.getMaxVerticalScrollPosition()>this.getVerticalScrollPosition())return--this._caretIndex,void this._moveSelectionVertically(this._lastKey,this._bShiftKey,this._bCtrlKey);this._caretIndex=t-i-1+this.getVerticalScrollPosition()}(s=this._getListItems()[this._caretIndex-this.getVerticalScrollPosition()+this._offscreenExtraRowsTop][0])&&(t=this._itemToUID(s.getData()),s=this._UIDToItemRenderer(t),this._bCtrlKey&&32!=this._lastKey||(this._selectItem(s,this._bShiftKey,this._bCtrlKey),e=!0),this._bCtrlKey&&this._drawItem(s,null!=this._selectedData[t],t==this._highlightUID,!0))}e&&(t=this.itemRendererToIndices(s),e=new L(L.CHANGE),t&&(e.columnIndex=t.x,e.rowIndex=t.y),e.itemRenderer=s,this.dispatchEvent(e))},n.prototype._commitSelectedIndex=function(e){if(-1!=e){e=Math.min(e,this._collection.getLength()-1);var i=this._iterator.getBookmark(),s=e-this._scrollPositionToIndex(this.getHorizontalScrollPosition()-this._offscreenExtraColumnsLeft,this.getVerticalScrollPosition()-this._offscreenExtraRowsTop);try{this._iterator.seek(t.getCURRENT(),s)}catch(r){return this._iterator.seek(i,0),this._bSelectedIndexChanged=!0,void(this._selectedIndex=e)}var s=this._iterator.getCurrent(),n=this._iterator.getBookmark(),o=this._itemToUID(s);this._iterator.seek(i,0),this._selectedData[o]||(this._listContent&&this._UIDToItemRenderer(o)?this._selectItem(this._UIDToItemRenderer(o),!1,!1):(this._clearSelected(),this._insertSelectionDataBefore(o,new Nb(s,e,this._approximate),this._firstSelectionData),this._caretIndex=this._selectedIndex=e,this._caretBookmark=n,this._anchorIndex=e,this._anchorBookmark=n,this._selectedItem=s))}else this._clearSelected();this.dispatchEvent(new w("valueCommit"))},n.prototype._commitSelectedIndices=function(e){this._clearSelected();try{this._collectionIterator.seek(t.getFIRST(),0)}catch(i){return void i.addResponder(new S(this._selectionIndicesPendingResultHandler,this._selectionIndicesPendingFailureHandler,new Xc((!0),0,e,t.getFIRST(),0)))}this._setSelectionIndicesLoop(0,e,!0)},n.prototype._setSelectionIndicesLoop=function(e,i,s){for(s=2<arguments.length&&s;i.length;){if(e!=i[0])try{this._collectionIterator.seek(t.getCURRENT(),i[0]-e)}catch(r){return void r.addResponder(new S(this._selectionIndicesPendingResultHandler,this._selectionIndicesPendingFailureHandler,new Xc(s,e,i,t.getCURRENT(),i[0]-e)))}e=i[0],i.shift();var n=this._collectionIterator.getCurrent();s&&(this._selectedIndex=e,this._selectedItem=n,this._caretIndex=e,this._caretBookmark=this._collectionIterator.getBookmark(),this._anchorIndex=e,this._anchorBookmark=this._collectionIterator.getBookmark(),s=!1);var o=this._itemToUID(n);this._insertSelectionDataAfter(o,new Nb(n,e,(!1)),this._lastSelectionData),this._UIDToItemRenderer(o)&&this._drawItem(this._UIDToItemRenderer(o),!0,o==this._highlightUID,this._caretIndex==e)}this._initialized&&this._updateList(),this.dispatchEvent(new w("valueCommit"))},n.prototype._commitSelectedItem=function(t,e){(e=!(2<arguments.length)||e)&&this._clearSelected(),null!=t&&this._commitSelectedItems([t])},n.prototype._commitSelectedItems=function(e){this._clearSelected(),e=e.slice(0);var i=!p(this._collection.getSort());try{this._collectionIterator.seek(t.getFIRST(),0)}catch(s){return void s.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc(i,0,e,null,0)))}var r,n=e.length;for(this._selectionDataArray=Array(n),this._firstSelectedItem=n?e[0]:null,this._proposedSelectedItemIndexes={},r=0;r<n;r++){var o=this._itemToUID(e[r]);this._proposedSelectedItemIndexes[o]=r}this._setSelectionDataLoop(e,0,i)},n.prototype._setSelectionDataLoop=function(e,i,s){s=!(2<arguments.length)||s;var r;if(s)for(;e.length;){var n=e.pop();r=this._itemToUID(n);try{this._collectionIterator.findAny(n)}catch(o){return e.push(n),void o.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc(s,0,e,null,0)))}var a=this._collectionIterator.getBookmark().getViewIndex();if(!(0<=a)){try{this._collectionIterator.seek(t.getFIRST(),0)}catch(o){return void o.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc((!1),0,e,t.getFIRST(),0)))}return void this._setSelectionDataLoop(e,0,!1)}this._insertSelectionDataBefore(r,new Nb(n,a,(!0)),this._firstSelectionData),0==e.length&&(this._selectedIndex=a,this._selectedItem=n,this._caretIndex=a,this._caretBookmark=this._collectionIterator.getBookmark(),this._anchorIndex=i,this._anchorBookmark=this._collectionIterator.getBookmark())}else{var l=this._selectedItemsCompareFunction;for(p(l)&&(l=this._strictEqualityCompareFunction);e.length&&!this._collectionIterator.getAfterLast();){var h,a=e.length,d=this._collectionIterator.getCurrent();for(h=0;h<a;h++)if(n=e[h],l(d,n)){r=this._itemToUID(d),this._selectionDataArray[this._proposedSelectedItemIndexes[r]]=new Nb(d,i,(!1)),e.splice(h,1),n===this._firstSelectedItem&&(this._selectedIndex=i,this._selectedItem=d,this._caretIndex=i,this._caretBookmark=this._collectionIterator.getBookmark(),this._anchorIndex=i,this._anchorBookmark=this._collectionIterator.getBookmark());break}try{this._collectionIterator.moveNext(),i++}catch(o){return void o.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc((!1),i,e,t.getFIRST(),i)))}}for(a=this._selectionDataArray.length,l=this._firstSelectionData,a&&(n=this._selectionDataArray[0])&&(r=this._itemToUID(n.data),this._insertSelectionDataBefore(r,n,this._firstSelectionData),l=n),h=1;h<a;h++)(n=this._selectionDataArray[h])&&(r=this._itemToUID(n.data),this._insertSelectionDataAfter(r,n,l),l=n);this._firstSelectedItem=this._proposedSelectedItemIndexes=this._selectionDataArray=null}this._initialized&&this._updateList(),this.dispatchEvent(new w("valueCommit"))},n.prototype._clearSelectionData=function(){this._selectedData={},this._lastSelectionData=this._firstSelectionData=null},n.prototype._insertSelectionDataBefore=function(t,e,i){null==i?this._firstSelectionData=this._lastSelectionData=e:(i==this._firstSelectionData&&(this._firstSelectionData=e),e.nextSelectionData=i,e.prevSelectionData=i.prevSelectionData,i.prevSelectionData=e),this._selectedData[t]=e},n.prototype._insertSelectionDataAfter=function(t,e,i){null==i?this._firstSelectionData=this._lastSelectionData=e:(i==this._lastSelectionData&&(this._lastSelectionData=e),e.prevSelectionData=i,e.nextSelectionData=i.nextSelectionData,i.nextSelectionData=e),this._selectedData[t]=e},n.prototype._removeSelectionData=function(t){var e=this._selectedData[t];this._firstSelectionData==e&&(this._firstSelectionData=e.nextSelectionData),this._lastSelectionData==e&&(this._lastSelectionData=e.prevSelectionData),null!=e.prevSelectionData&&(e.prevSelectionData.nextSelectionData=e.nextSelectionData),null!=e.nextSelectionData&&(e.nextSelectionData.prevSelectionData=e.prevSelectionData),delete this._selectedData[t]},n.prototype._applySelectionEffect=function(t,e,i){},n.prototype._onSelectionTweenUpdate=function(t){},n.prototype._copySelectedItems=function(t){t=!(0<arguments.length)||t;for(var e=[],i=this._firstSelectionData;null!=i;)t?e.push(i.data):e.push(i.index),i=i.nextSelectionData;return e},n.prototype._scrollPositionToIndex=function(t,e){return this._iterator?this.getVerticalScrollPosition():-1},n.prototype.scrollToIndex=function(t){return(t>=this.getVerticalScrollPosition()+this._getListItems().length-this._offscreenExtraRowsBottom||t<this.getVerticalScrollPosition())&&(t=Math.min(t,this.getMaxVerticalScrollPosition()),this.setVerticalScrollPosition(t),!0)},n.prototype._scrollVertically=function(e,i,s){var r,n=this._getRowInfo().length;this._getListItems();var o,a=this._listContent.getHeightExcludingOffsets();if(s){var l=i;s=this._offscreenExtraRows/2;var h=Math.min(s,this._offscreenExtraRowsTop+i);for(this._offscreenExtraRowsTop<s&&(l=Math.max(0,i-(s-this._offscreenExtraRowsTop))),r=this._sumRowHeights(0,l-1),s=0;s<l;s++)if(!this._seekNextSafely(this._iterator,e))return;for(s=0;s<n;s++)e=this._getListItems()[s].length,s<l?this._destroyRow(s,e):0<l&&(this._moveRowVertically(s,e,-r),this._moveIndicatorsVertically(this._getRowInfo()[s].uid,-r),this._shiftRow(s,s-l,e,!0),0==this._getListItems()[s].length&&this._getListItems()[s-l].splice(0,this._getListItems()[s-l].length));l&&this._truncateRowArrays(n-l),r=this._getRowInfo()[n-l-1].y+this._getRowInfo()[n-l-1].height,o=this._iterator.getBookmark();try{this._iterator.seek(t.getCURRENT(),n-l),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(d){this._lastSeekPending=new Da(o,0),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}for(e=this._offscreenExtraRows/2,s=i=0;s<h;s++)i-=this._getRowInfo()[s].height;if(i=a-(r+i),0<i)var c=this._makeRowsAndColumns(0,r,this._listContent.getWidth(),r+i,0,n-l),n=n+c.y;else for(s=n-l-1,i+=this._getRowInfo()[s--].height;0>i;)e--,i+=this._getRowInfo()[s--].height;0<e?(c&&(r=this._getRowInfo()[n-l-1].y+this._getRowInfo()[n-l-1].height),c=this._makeRowsAndColumns(0,r,this._listContent.getWidth(),this._listContent.getHeight(),0,n-l,!0,e)):c=new ra(0,0);try{this._iterator.seek(o,0)}catch(d){this._lastSeekPending=new Da(o,0),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}this._offscreenExtraRowsTop=h,this._offscreenExtraRowsBottom=this._offscreenExtraRows/2-e+c.y}else{for(r=0,c=i,n=this._offscreenExtraRows/2,e<n&&(c-=n-e),s=0;s<c;s++)this._addToRowArrays();if(s=new ra(0,0),0<c){try{this._iterator.seek(t.getCURRENT(),-c),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(d){this._lastSeekPending=new Da(t.getCURRENT(),(-c)),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}o=this._iterator.getBookmark(),this._allowRendererStealingDuringLayout=!1,s=this._makeRowsAndColumns(0,r,this._listContent.getWidth(),this._listContent.getHeight(),0,0,!0,c),this._allowRendererStealingDuringLayout=!0;try{this._iterator.seek(o,0)}catch(d){this._lastSeekPending=new Da(o,0),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}}for(0==s.y&&0<c&&(this.setVerticalScrollPosition(0),this._restoreRowArrays(c)),r=this._sumRowHeights(0,s.y-1),c=this._offscreenExtraRows/2,o=0,l=a+this._sumRowHeights(0,Math.min(n,e)-1),s=s.y;s<this._getListItems().length;s++)this._getListItems(),h=this._getRowInfo()[s],this._moveRowVertically(s,this._getListItems()[s].length,r),h.y>=l?(o++,o>c?(this._destroyRow(s,this._getListItems()[s].length),this._removeFromRowArrays(s),s--):(this._shiftRow(s,s+i,this._getListItems()[s].length,!1),this._moveIndicatorsVertically(this._getRowInfo()[s].uid,r))):(this._shiftRow(s,s+i,this._getListItems()[s].length,!1),this._moveIndicatorsVertically(this._getRowInfo()[s].uid,r));this._getListItems(),this._offscreenExtraRowsTop=Math.min(n,e),this._offscreenExtraRowsBottom=Math.min(o,c)}this._listContent.topOffset=-1*this._sumRowHeights(0,this._offscreenExtraRowsTop-1),this._listContent.bottomOffset=this._getRowInfo()[this._getRowInfo().length-1].y+this._getRowInfo()[this._getRowInfo().length-1].height+this._listContent.topOffset-a,this._adjustListContent(this._oldUnscaledWidth,this._oldUnscaledHeight),this._addClipMask(!0)},n.prototype._destroyRow=function(t,e){var i,s,r=this._getRowInfo()[t].uid;for(this._removeIndicators(r),s=0;s<e;s++)i=this._getListItems()[t][s],i.getData()&&delete this._getVisibleData()[r],this._addToFreeItemRenderers(i)},n.prototype._moveRowVertically=function(t,e,i){var s,r;for(r=0;r<e;r++)s=this._getListItems()[t][r],s.move(s.getX(),s.getY()+i);this._getRowInfo()[t].y+=i},n.prototype._shiftRow=function(t,e,i,s){var r,n;for(n=0;n<i;n++)r=this._getListItems()[t][n],s?(this._getListItems()[e][n]=r,this._rowMap[r.name].rowIndex=e):this._rowMap[r.name].rowIndex=t;s&&(this._getRowInfo()[e]=this._getRowInfo()[t])},n.prototype._moveIndicatorsVertically=function(t,e){t&&(this._selectionIndicators[t]&&this._selectionIndicators[t].setY(this._selectionIndicators[t].getY()+e),this._highlightUID==t&&this._highlightIndicator.setY(this._highlightIndicator.getY()+e),this._caretUID==t&&this._caretIndicator.setY(this._caretIndicator.getY()+e))},n.prototype._moveIndicatorsHorizontally=function(t,e){t&&(this._selectionIndicators[t]&&this._selectionIndicators[t].setX(this._selectionIndicators[t].getX()+e),this._highlightUID==t&&this._highlightIndicator.setX(this._highlightIndicator.getX()+e),this._caretUID==t&&this._caretIndicator.setX(this._caretIndicator.getX()+e))},n.prototype._sumRowHeights=function(t,e){var i,s=0;for(i=t;i<=e;i++)s+=this._getRowInfo()[i].height;return s},n.prototype._truncateRowArrays=function(t){this._getListItems().splice(t,this._getListItems().length-t),this._getRowInfo().splice(t,this._getRowInfo().length-t)},n.prototype._addToRowArrays=function(){this._getListItems().splice(0,0,null),this._getRowInfo().splice(0,0,null)},n.prototype._restoreRowArrays=function(t){this._getRowInfo().splice(0,t),this._getListItems().splice(0,t)},n.prototype._removeFromRowArrays=function(t){this._getListItems().splice(t,1),this._getRowInfo().splice(t,1)},n.prototype._scrollHorizontally=function(t,e,i){},n.prototype.createItemRenderer=function(t){return null},n.prototype._configureScrollBars=function(){},n.prototype._dragScroll=function(){var t=this,e=0,i=0,s=0,i=i=0;0!=t._dragScrollingInterval&&(s=t.getVerticalScrollPosition(),Lb.isDragging&&(e=t.getViewMetrics().top+(t._variableRowHeight?t.getSizeStyle("fontSize")/4:t._rowHeight)),clearInterval(t._dragScrollingInterval),t._lastDragEvent&&(i=t.globalToLocal(v.getEventPageXY(t._lastDragEvent)).y),i<e?(t.setVerticalScrollPosition(Math.max(0,s-1)),Lb.isDragging?i=100:(i=Math.min(0-i-30,0),i=.593*i*i+31),t._dragScrollingInterval=setInterval(function(){t._dragScroll()},i),s!=t.getVerticalScrollPosition()&&(e=new ma(ma.SCROLL),e.direction="vertical",e.position=t.getVerticalScrollPosition(),e.delta=t.getVerticalScrollPosition()-s,t.dispatchEvent(e))):i>t._unscaledHeight-e?(t.setVerticalScrollPosition(Math.min(t.getMaxVerticalScrollPosition(),t.getVerticalScrollPosition()+1)),Lb.isDragging?i=100:(i=Math.min(i-t._unscaledHeight-30,0),i=.593*i*i+31),t._dragScrollingInterval=setInterval(function(){t._dragScroll()},i),s!=t.getVerticalScrollPosition()&&(e=new ma(ma.SCROLL),e.direction="vertical",e.position=t.getVerticalScrollPosition(),e.delta=t.getVerticalScrollPosition()-s,t.dispatchEvent(e))):t._dragScrollingInterval=setInterval(function(){t._dragScroll()},15),Lb.isDragging&&t._lastDragEvent&&s!=t.getVerticalScrollPosition()&&t._dragOverHandler(t._lastDragEvent))},n.prototype._resetDragScrolling=function(){0!=this._dragScrollingInterval&&(clearInterval(this._dragScrollingInterval),this._dragScrollingInterval=0)},n.prototype._addDragData=function(t){t.addHandler(this._copySelectedItems,"items",this)},n.prototype.calculateDropIndex=function(t){if(t){var e,i;t=v.getEventPageXY(t),t=this._listContent.globalToLocal(t);var s,r=this._getListItems().length;for(s=0;s<r;s++)if(this._getListItems()[s][0]&&(i=this._getListItems()[s][0]),this._getRowInfo()[s].y<=t.y&&t.y<this._getRowInfo()[s].y+this._getRowInfo()[s].height){e=this._getListItems()[s][0];break}this._lastDropIndex=e?this.itemRendererToIndex(e):i?this.itemRendererToIndex(i)+1:this._collection?this._collection.getLength():0}return this._lastDropIndex},n.prototype._calculateDropIndicatorY=function(t,e){var i,s=0;if(t&&e<t&&this._getListItems()[e].length&&this._getListItems()[e][0])return this._getListItems()[e][0].getY()-1;for(i=0;i<t&&this._getListItems()[i].length;i++)s+=this._getRowInfo()[i].height;return s},n.prototype.showDropFeedback=function(t){var e=this;if(!e._dropIndicator){var i=e.getStyle("dropIndicatorSkin");i||(i=A),e._dropIndicator=new i,e.focus(),e._dropIndicator.setX(2),e._dropIndicator.setWidth(e._listContent.getWidth()-4),e._dropIndicator.setHeight(1),e._dropIndicator.setVisible(!0),e._dropIndicator.setStyle("backgroundColor","#343434"),
e._dropIndicator.setStyle("position","absolute"),e._listContent.addChild(e._dropIndicator),e._collection&&0==e._dragScrollingInterval&&(e._dragScrollingInterval=setInterval(function(){e._dragScroll()},15))}i=e._getListItems().length,i=e._getRowInfo()[i-e._offscreenExtraRowsBottom-1].y+e._getRowInfo()[i-e._offscreenExtraRowsBottom-1].height>e._listContent.getHeightExcludingOffsets()-e._listContent.topOffset?1:0,t=e.calculateDropIndex(t),t-=e.getVerticalScrollPosition();var s=e._getListItems().length;t>=s&&(t=i?s-1:s),0>t&&(t=0),e._dropIndicator.setY(e._calculateDropIndicatorY(s,t+e._offscreenExtraRowsTop)-1)},n.prototype.hideDropFeedback=function(t){this._dropIndicator&&(this._dropIndicator.getParent().removeChild(this._dropIndicator),this._dropIndicator=null,this.blur())},n.prototype._seekPendingFailureHandler=function(t,e){},n.prototype._seekPendingResultHandler=function(t,e){if(e==this._lastSeekPending){this._lastSeekPending=null,this._iteratorValid=!0;try{this._iterator.seek(e.getBookmark(),e.offset)}catch(i){this._lastSeekPending=new Da(e.getBookmark(),e.offset),i.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}this._bSortItemPending&&(this._bSortItemPending=!1,this._adjustAfterSort()),this._itemsSizeChanged=!0,this.invalidateDisplayList()}},n.prototype._findPendingFailureHandler=function(t,e){},n.prototype._findPendingResultHandler=function(t,e){this._iterator.seek(e.getBookmark(),e.offset),this._findStringLoop(e.searchString,e.startingBookmark,e.currentIndex,e.stopIndex)},n.prototype._selectionPendingFailureHandler=function(t,e){},n.prototype._selectionPendingResultHandler=function(t,e){this._iterator.seek(e.getBookmark(),e.offset),this._shiftSelectionLoop(e.incrementing,e.index,e.stopData,e.transition,e.placeHolder)},n.prototype._selectionDataPendingFailureHandler=function(t,e){},n.prototype._selectionDataPendingResultHandler=function(t,e){e.getBookmark()&&this._collectionIterator.seek(e.getBookmark(),e.offset),this._setSelectionDataLoop(e.items,e.index,e.useFind)},n.prototype._selectionIndicesPendingFailureHandler=function(t,e){},n.prototype._selectionIndicesPendingResultHandler=function(t,e){e.getBookmark()&&this._iterator.seek(e.getBookmark(),e.offset),this._setSelectionIndicesLoop(e.index,e.items,e.useFind)},n.prototype.findString=function(e){if(!this._collection||0==this._collection.getLength())return!1;var i=this._iterator.getBookmark(),s=this.getSelectedIndex(),r=s+1;if(-1==this._selectedIndex){try{this._iterator.seek(t.getFIRST(),0)}catch(n){return n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,this._collection.getLength()))),this._iteratorValid=!1}s=this._collection.getLength(),r=0}else{try{this._iterator.seek(t.getFIRST(),s)}catch(n){return this._anchorIndex==this._collection.getLength()-1?n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,this._collection.getLength()))):n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,this._anchorBookmark,1,this._anchorIndex+1,this._anchorIndex))),this._iteratorValid=!1}var o=!1;try{o=this._iterator.moveNext()}catch(n){return n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,this._anchorBookmark,1,this._anchorIndex+1,this._anchorIndex))),this._iteratorValid=!1}if(!o){try{this._iterator.seek(t.getFIRST(),0)}catch(n){return n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,this._collection.getLength()))),this._iteratorValid=!1}s=this._collection.getLength(),r=0}}return this._findStringLoop(e,i,r,s)},n.prototype._findStringLoop=function(e,i,s,r){for(;s!=r;s++){var n=this.itemToLabel(this._iterator.getCurrent()),n=n.substring(0,e.length);if(e==n||e.toUpperCase()==n.toUpperCase())return this._iterator.seek(i,0),this.scrollToIndex(s),this._commitSelectedIndex(s),e=this.indexToItemRenderer(s),i=this.itemRendererToIndices(e),s=new L(L.CHANGE),s.itemRenderer=e,i&&(s.columnIndex=i.x,s.rowIndex=i.y),this.dispatchEvent(s),!0;try{var o=this._iterator.moveNext()}catch(a){return a.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getCURRENT(),1,s+1,r))),this._iteratorValid=!1}if(!o&&r!=this._collection.getLength()){s=-1;try{this._iterator.seek(t.getFIRST(),0)}catch(a){return a.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,r))),this._iteratorValid=!1}}}return this._iterator.seek(i,0),this._iteratorValid=!0,!1},n.prototype._adjustAfterSort=function(){var e,i=0;for(e in this._selectedData)i++;var s=this._anchorBookmark?this._anchorBookmark.getViewIndex():-1;if(0<=s){if(1==i&&(this._selectedIndex=this._anchorIndex=this._caretIndex=s,this._selectedData[e].index=s),e=this._indexToRow(s),-1==e)return;e=Math.min(this.getMaxVerticalScrollPosition(),e);var r=this._indexToColumn(s);if(-1==r)return;var r=Math.min(this.getMaxHorizontalScrollPosition(),r),o=this._scrollPositionToIndex(r,e);try{this._iterator.seek(t.getCURRENT(),o-s),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(a){return this._lastSeekPending=new Da(t.getCURRENT(),o-s),a.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),void(this._iteratorValid=!1)}n._super.setVerticalScrollPosition.call(this,e),"vertical"!=this._listType&&n._super.setHorizontalScrollPosition.call(this,r)}else try{s=this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop),this._iterator.seek(t.getFIRST(),s),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(a){return this._lastSeekPending=new Da(t.getFIRST(),s),a.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),void(this._iteratorValid=!1)}1<i&&this._commitSelectedItems(this._selectedItems)},n.prototype._keyDownHandler=function(t){if(this.getSelectable()&&this._iteratorValid&&this._collection&&0!=this._collection.getLength())switch(t.keyCode){case 38:case 40:this._moveSelectionVertically(t.keyCode,t.shiftKey,t.ctrlKey),t.stopPropagation(),t.preventDefault();break;case 37:case 39:this._moveSelectionHorizontally(t.keyCode,t.shiftKey,t.ctrlKey),t.stopPropagation(),t.preventDefault();break;case 35:case 36:case 33:case 34:this._moveSelectionVertically(t.keyCode,t.shiftKey,t.ctrlKey),t.stopPropagation(),t.preventDefault();break;case 32:if(-1!=this._caretIndex&&0<=this._caretIndex-this.getVerticalScrollPosition()&&this._caretIndex-this.getVerticalScrollPosition()<this._getListItems().length){var e=this._getListItems()[this._caretIndex-this.getVerticalScrollPosition()][0];if(this._selectItem(e,t.shiftKey,t.ctrlKey)){t=this.itemRendererToIndices(e);var i=new L(L.CHANGE);t&&(i.columnIndex=t.x,i.rowIndex=t.y),i.itemRenderer=e,this.dispatchEvent(i)}}}},n.prototype._mouseWheelHandler=function(t){if(this._verticalScrollBar&&this._verticalScrollBar.getVisible()){t.stopPropagation(),t.preventDefault();var e,i=this.getVerticalScrollPosition(),s=this.getVerticalScrollPosition();I(t.wheelDelta)?I(t.detail)||(e=-t.detail):(e=t.wheelDelta/120,e=0<=e?Math.ceil(e):Math.floor(e)),s-=e*this._verticalScrollBar.lineScrollSize,s=Math.max(0,Math.min(s,this._verticalScrollBar.getMaxScrollPosition())),this.setVerticalScrollPosition(s),i!=this.getVerticalScrollPosition()&&(t=new ma(ma.SCROLL),t.direction="vertical",t.position=this.getVerticalScrollPosition(),t.delta=this.getVerticalScrollPosition()-i,this.dispatchEvent(t))}},n.prototype._collectionChangeHandler=function(e){var i,s,r;if(e instanceof y)if("add"==e.kind){if(0==e.location&&0==this.getVerticalScrollPosition())try{this._iterator.seek(t.getFIRST()),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(o){this._lastSeekPending=new Da(t.getFIRST(),0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}else"vertical"==this._listType&&this.getVerticalScrollPosition()>=e.location&&n._super.setVerticalScrollPosition.call(this,this._verticalScrollPosition+e.items.length);(e=this._adjustAfterAdd(e.items,e.location))&&this.dispatchEvent(new w("valueCommit"))}else if("replace"==e.kind)for(r=this.getSelectedItem()?this._itemToUID(this.getSelectedItem()):null,i=e.items.length,s=0;s<i;s++){var a=this._itemToUID(e.items[s].oldValue),l=this._selectedData[a];l&&(l.data=e.items[s].newValue,delete this._selectedData[a],this._selectedData[this._itemToUID(l.data)]=l,r==a&&(this._selectedItem=l.data,this.dispatchEvent(new w("valueCommit"))))}else if("remove"==e.kind){if(a=!1,this._getListItems().length&&this._getListItems()[0].length){for(l=this._rowMap[this._getListItems()[0][0].name].uid,r=this.getSelectedItem()?this._itemToUID(this.getSelectedItem()):null,s=0;s<e.items.length;s++){var h=this._itemToUID(e.items[s]);if(h==l&&0==this.getVerticalScrollPosition())try{this._iterator.seek(t.getFIRST()),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(o){this._lastSeekPending=new Da(t.getFIRST(),0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}this._selectedData[h]&&this._removeSelectionData(h),r==h&&(this._selectedItem=null,this._selectedIndex=-1,a=!0),this._removeIndicators(h)}if("vertical"==this._listType&&this.getVerticalScrollPosition()>=e.location){this.getVerticalScrollPosition()>e.location?n._super.setVerticalScrollPosition.call(this,this.getVerticalScrollPosition()-Math.min(e.items.length,this.getVerticalScrollPosition()-e.location)):this.getVerticalScrollPosition()>=this._collection.getLength()&&n._super.setVerticalScrollPosition.call(this,Math.max(this._collection.getLength()-1,0));try{this._offscreenExtraRowsTop=Math.min(this._offscreenExtraRowsTop,this.getVerticalScrollPosition()),i=this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop),this._iterator.seek(t.getFIRST(),i),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(o){this._lastSeekPending=new Da(t.getFIRST(),i),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}}(e=this._adjustAfterRemove(e.items,e.location,a))&&this.dispatchEvent(new w("valueCommit"))}}else if("move"==e.kind){if(e.oldLocation<e.location){for(s in this._selectedData)r=this._selectedData[s],r.index>e.oldLocation&&r.index<e.location?r.index--:r.index==e.oldLocation&&(r.index=e.location);this._selectedIndex>e.oldLocation&&this._selectedIndex<e.location?this._selectedIndex--:this._selectedIndex==e.oldLocation&&(this._selectedIndex=e.location)}else if(e.location<e.oldLocation){for(s in this._selectedData)r=this._selectedData[s],r.index>e.location&&r.index<e.oldLocation?r.index++:r.index==e.oldLocation&&(r.index=e.location);this._selectedIndex>e.location&&this._selectedIndex<e.oldLocation?this._selectedIndex++:this._selectedIndex==e.oldLocation&&(this._selectedIndex=e.location)}e.oldLocation==this.getVerticalScrollPosition()?(e.location>this.getMaxVerticalScrollPosition()&&this._iterator.seek(t.getCURRENT(),this.getMaxVerticalScrollPosition()-e.location),n._super.setVerticalScrollPosition.call(this,Math.min(e.location,this.getMaxVerticalScrollPosition()))):e.location>=this.getVerticalScrollPosition()&&e.oldLocation<this.getVerticalScrollPosition()?this._seekNextSafely(this._iterator,this.getVerticalScrollPosition()):e.location<=this.getVerticalScrollPosition()&&e.oldLocation>this.getVerticalScrollPosition()&&this._seekPreviousSafely(this._iterator,this.getVerticalScrollPosition())}else if("refresh"==e.kind)if(this._anchorBookmark){try{this._iterator.seek(this._anchorBookmark,0),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(o){this._bSortItemPending=!0,this._lastSeekPending=new Da(this._anchorBookmark,0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1,this._clearSelected()}this._adjustAfterSort()}else try{i=this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition()),this._iterator.seek(t.getFIRST(),i),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(o){this._bSortItemPending=!0,this._lastSeekPending=new Da(t.getFIRST(),i),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}else if("reset"==e.kind){try{this._iterator.seek(t.getFIRST()),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null),this._collectionIterator.seek(t.getFIRST())}catch(o){this._lastSeekPending=new Da(t.getFIRST(),0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}this._bSelectedIndexChanged||this._bSelectedItemChanged||this._bSelectedIndicesChanged||this._bSelectedItemsChanged?this._bSelectionChanged=!0:this._commitSelectedIndex(-1),isNaN(this._verticalScrollPositionPending)&&(this._verticalScrollPositionPending=0,n._super.setVerticalScrollPosition.call(this,0)),isNaN(this._horizontalScrollPositionPending)&&(this._horizontalScrollPositionPending=0,n._super.setHorizontalScrollPosition.call(this,0)),this.invalidateSize()}else if("update"==e.kind)for(r=this.getSelectedItem()?this._itemToUID(this.getSelectedItem()):null,i=e.items.length,s=0;s<i;s++)"uid"==e.items[s].property&&(a=e.items[s].oldValue,l=this._selectedData[a])&&(l.data=e.items[s].target,delete this._selectedData[a],this._selectedData[e.items[s].newValue]=l,r==a&&(this._selectedItem=l.data,this.dispatchEvent(new w("valueCommit"))));this._itemsSizeChanged=!0,this.invalidateDisplayList()},n.prototype._reconstructDataFromListItems=function(){if(!this._getListItems())return[];var t,e,i=[];for(t=0;t<this._getListItems().length;t++)if(this._getListItems()[t]){var s,r=this._getListItems()[t][0];if(r)for(s=r.getData(),i.push(s),e=0;e<this._getListItems()[t].length;e++)(r=this._getListItems()[t][e])&&(r=r.getData(),r!=s&&i.push(r))}return i},n.prototype._adjustAfterAdd=function(e,i){var s,r,n=e.length,o=!1;for(s in this._selectedData)r=this._selectedData[s],r.index>=i&&(r.index+=n);if(this._selectedIndex>=i&&(this._selectedIndex+=n,o=!0),this._anchorIndex>=i){this._anchorIndex+=n,s=this._iterator.getBookmark();try{this._iterator.seek(t.getFIRST(),this._anchorIndex),this._anchorBookmark=this._iterator.getBookmark()}catch(a){a.addResponder(new S(this._setBookmarkPendingResultHandler,this._setBookmarkPendingFailureHandler,{property:"_anchorBookmark",value:this._anchorIndex}))}this._iterator.seek(s)}if(this._caretIndex>=i){this._caretIndex+=n,s=this._iterator.getBookmark();try{this._iterator.seek(t.getFIRST(),this._caretIndex),this._caretBookmark=this._iterator.getBookmark()}catch(a){a.addResponder(new S(this._setBookmarkPendingResultHandler,this._setBookmarkPendingFailureHandler,{property:"_caretBookmark",value:this._caretIndex}))}this._iterator.seek(s)}return o},n.prototype._adjustAfterRemove=function(e,i,s){var r,n=0;e=e.length;for(var o in this._selectedData)n++,r=this._selectedData[o],r.index>i&&(r.index-=e);if(this._selectedIndex>i&&(this._selectedIndex-=e,s=!0),0<n&&-1==this._selectedIndex&&(this._selectedIndex=r.index,this._selectedItem=r.data,s=!0),0==n&&(this._selectedIndex=-1,this._bSelectedIndexChanged=this._bSelectionChanged=!0,this.invalidateDisplayList()),this._anchorIndex>i){this._anchorIndex-=e,r=this._iterator.getBookmark();try{this._iterator.seek(t.getFIRST(),this._anchorIndex),this._anchorBookmark=this._iterator.getBookmark()}catch(a){a.addResponder(new S(this._setBookmarkPendingResultHandler,this._setBookmarkPendingFailureHandler,{property:"_anchorBookmark",value:this._anchorIndex}))}this._iterator.seek(r)}if(this._caretIndex>i){this._caretIndex-=e,r=this._iterator.getBookmark();try{this._iterator.seek(t.getFIRST(),this._caretIndex),this._caretBookmark=this._iterator.getBookmark()}catch(a){a.addResponder(new S(this._setBookmarkPendingResultHandler,this._setBookmarkPendingFailureHandler,{property:"_caretBookmark",value:this._caretIndex}))}this._iterator.seek(r)}return s},n.prototype._setBookmarkPendingFailureHandler=function(t,e){},n.prototype._setBookmarkPendingResultHandler=function(e,i){var s;s=this._iterator.getBookmark();try{this._iterator.seek(t.getFIRST(),i.value),this[i.property]=this._iterator.getBookmark()}catch(r){r.addResponder(new S(this._setBookmarkPendingResultHandler,this._setBookmarkPendingFailureHandler,i))}this._iterator.seek(s)},n.prototype._mouseOverHandler=function(t){var e;if(this.getEnabled()&&this.getSelectable()){0==this._dragScrollingInterval||t.buttonDown||this._mouseIsUp(),this._isPressed=v.getButtonDown(t);var i=this._mouseEventToItemRenderer(t),s=this.itemRendererToIndices(i);if(i)if(e=this._itemToUID(i.getData()),!this._isPressed||this.allowDragSelection){if(t.relatedTarget){var r;if(t=t.relatedTarget.selfElement||t.relatedTarget.selfUIElement,this._lastHighlightItemRenderer&&this._highlightUID&&(r=this._rowMap[i.name].uid),this.itemRendererContains(i,t)||e==r||t==this._highlightIndicator)return}this.getStyle("useRollOver")&&null!=i.getData()&&(this.allowDragSelection&&(this._bSelectOnRelease=!0),this._drawItem(this._UIDToItemRenderer(e),this.isItemSelected(i.getData()),!0,e==this._caretUID),s&&(e=new L(L.ITEM_ROLL_OVER),e.columnIndex=s.x,e.rowIndex=s.y,e.itemRenderer=i,this.dispatchEvent(e),this._lastHighlightItemIndices=s,this._lastHighlightItemRendererAtIndices=i))}else!Lb.isDragging&&(0!=this._dragScrollingInterval&&this.allowDragSelection||this.menuSelectionMode)&&this._selectItem(i,t.shiftKey,t.ctrlKey)&&(e=new L(L.CHANGE),e.itemRenderer=i,s&&(e.columnIndex=s.x,e.rowIndex=s.y),this.dispatchEvent(e))}},n.prototype._mouseOutHandler=function(t){if(this.getEnabled()&&this.getSelectable()){this._isPressed=v.getButtonDown(t);var e=this._mouseEventToItemRenderer(t);if(e){if(!this._isPressed){if(t=t.relatedTarget?t.relatedTarget.selfElement||t.relatedTarget.selfUIElement:null,this.itemRendererContains(e,t)||t==this._listContent||t==this._highlightIndicator||!this._highlightItemRenderer)return;this.getStyle("useRollOver")&&null!=e.getData()&&this._clearHighlight(e)}this._clearHighlightIndicator(this._highlightIndicator,e)}}},n.prototype._mouseMoveHandler=function(t){if(this.getEnabled()&&this.getSelectable()){var e;if(e=t.target.selfUIElement?t.target.selfUIElement:t.target.selfElement,void 0!=e){var i=v.getEventPageXY(t),i=e.localToGlobal(i),i=this.globalToLocal(i);this._isPressed&&this._mouseDownPoint&&(Math.abs(this._mouseDownPoint.x-i.x)>this.DRAG_THRESHOLD||Math.abs(this._mouseDownPoint.y-i.y)>this.DRAG_THRESHOLD)&&this.getDragEnabled()&&!Lb.isDragging&&this._mouseDownPoint&&(e=new DragEvent(DragEvent.DRAG_START),e.dragInitiator=this,e.layerX=this._mouseDownPoint.x,e.layerY=this._mouseDownPoint.y,e.buttonDown=!0,this.dispatchEvent(e)),(e=this._mouseEventToItemRenderer(t))&&this._highlightItemRenderer?(i=this._rowMap[e.name],this._highlightItemRenderer&&this._highlightUID&&i.uid!=this._highlightUID&&(this._isPressed||this.getStyle("useRollOver")&&null!=this._highlightItemRenderer.getData()&&this._clearHighlight(this._highlightItemRenderer))):!e&&this._highlightItemRenderer&&(this._isPressed||this.getStyle("useRollOver")&&this._highlightItemRenderer.getData()&&this._clearHighlight(this._highlightItemRenderer)),e&&!this._highlightItemRenderer&&this._mouseOverHandler(t)}}},n.prototype._mouseDownHandler=function(t){var e=this;if(e.getEnabled()&&e.getSelectable()){e._runningDataEffect&&(e._cachedItemsChangeEffect.end(),e._dataEffectCompleted=!0,e._itemsSizeChanged=!0,e.invalidateList(),e._dataItemWrappersByRenderer={},e.validateDisplayList()),e._isPressed=!0;var i=e._mouseEventToItemRenderer(t);if(i){e._bSelectOnRelease=!1;var s=new ra(t.clientX,t.clientY);e._mouseDownPoint=s,v.documentAddEvent("mouseup",e._mouseUpHandler,e,!0,0,!0),v.windowAddEvent("blur",e._mouseLeaveHandler,e,!1,0,!0),e.getDragEnabled()||(e._dragScrollingInterval=setInterval(function(){e._dragScroll(t)},15)),e.getDragEnabled()&&e._selectedData[e._rowMap[i.name].uid]?e._bSelectOnRelease=!0:e._selectItem(i,t.shiftKey,t.ctrlKey)&&(e._mouseDownItem=i)}}},n.prototype._mouseIsUp=function(){v.documentRemoveEvent("mouseup",this._mouseUpHandler,this,!0),v.windowRemoveEvent("blur",this._mouseLeaveHandler,this,!1),this.getDragEnabled()||0==this._dragScrollingInterval||(clearInterval(this._dragScrollingInterval),this._dragScrollingInterval=0)},n.prototype._mouseLeaveHandler=function(t){if(this._mouseDownPoint=null,this._mouseIsUp(),this.getEnabled()&&this.getSelectable()){if(this._mouseDownItem){t=new L(L.CHANGE),t.itemRenderer=this._mouseDownItem;var e=this.itemRendererToIndices(this._mouseDownItem);e&&(t.columnIndex=e.x,t.rowIndex=e.y),this.dispatchEvent(t),this._mouseDownItem=null}this._isPressed=!1}},n.prototype._mouseUpHandler=function(t){this._mouseDownPoint=null;var e,i=this._mouseEventToItemRenderer(t),s=this.itemRendererToIndices(i);this._mouseIsUp(),this.getEnabled()&&this.getSelectable()&&(this._mouseDownItem&&(e=new L(L.CHANGE),e.itemRenderer=this._mouseDownItem,(s=this.itemRendererToIndices(this._mouseDownItem))&&(e.columnIndex=s.x,e.rowIndex=s.y),this.dispatchEvent(e),this._mouseDownItem=null),i&&this.hitTestPoint(t.pageX,t.pageY)&&this._bSelectOnRelease&&(this._bSelectOnRelease=!1,this._selectItem(i,t.shiftKey,t.ctrlKey)&&(e=new L(L.CHANGE),e.itemRenderer=i,s&&(e.columnIndex=s.x,e.rowIndex=s.y),this.dispatchEvent(e))),this._isPressed=!1)},n.prototype._mouseClickHandler=function(t){if(t=this._mouseEventToItemRenderer(t)){var e=this.itemRendererToIndices(t);if(e){var i=new L(L.ITEM_CLICK);i.columnIndex=e.x,i.rowIndex=e.y,i.itemRenderer=t,this.dispatchEvent(i)}}},n.prototype._mouseDoubleClickHandler=function(t){if(this._doubleClickEnabled&&(t=this._mouseEventToItemRenderer(t))){var e=this.itemRendererToIndices(t);if(e){var i=new L(L.ITEM_DOUBLE_CLICK);i.columnIndex=e.x,i.rowIndex=e.y,i.itemRenderer=t,this.dispatchEvent(i)}}},n.prototype._touchHandler=function(t){var e,i,s,r,n=this;if(1<t.touches.length)n._touchStartPoint=null,n._touchStartTimeStamp=0,n._touchLastPoint=null,n._touchLastScrollEvent=null,n._touchEventsStack=[];else if(n.itemEditorInstance&&n.itemEditorInstance==(t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null))n._touchStartPoint=new ra(e.pageX,e.pageY),n._touchStartTimeStamp=(new Date).getTime(),n._touchLastPoint=new ra(e.pageX,e.pageY),n._touchLastScrollEvent=null;else switch(t.type){case"touchstart":n._tween&&n._tween.endTween(!0),e=t.touches[0],n._touchStartPoint=new ra(e.pageX,e.pageY),n._touchStartTimeStamp=(new Date).getTime(),n._touchLastPoint=new ra(e.pageX,e.pageY),n._touchLastScrollEvent=null,n._doubleClickEnabled&&(n._touchEventsStack.push(t),8<n._touchEventsStack.length&&n._touchEventsStack.shift());break;case"touchmove":if(t.stopImmediatePropagation(),t.preventDefault(),e=t.touches[0],!n._touchLastPoint){n._touchLastPoint=new ra(e.pageX,e.pageY);break}n._doubleClickEnabled&&(t.timeStamp||(t.timeStamp=(new Date).getTime()),n._touchEventsStack.push(t),8<n._touchEventsStack.length&&n._touchEventsStack.shift());var o,a,l;if(t=1,r=Math.abs(e.pageX-n._touchLastPoint.x),t=Math.abs(e.pageY-n._touchLastPoint.y),3>=r&&3>=t)break;if(0==r||t>=r?(e.pageY>n._touchLastPoint.y?(t=1,l="u"):(t=-1,l="d"),r=n._touchLastPoint.y-e.pageY):(e.pageX>n._touchLastPoint.x?(t=1,l="r"):(t=-1,l="l"),r=n._touchLastPoint.x-e.pageX),n._touchLastPoint.x=e.pageX,n._touchLastPoint.y=e.pageY,("d"==l||"u"==l)&&!n._verticalScrollBar||("r"==l||"l"==l)&&!n._horizontalScrollBar)break;switch(l){case"d":case"u":i=n._verticalScrollBar,o=n.getVerticalScrollPosition,a=n.setVerticalScrollPosition;break;case"r":case"l":i=n._horizontalScrollBar,o=n.getHorizontalScrollPosition,a=n.setHorizontalScrollPosition}e=o.call(n);var h=i.getMinScrollPosition(),d=i.getMaxScrollPosition();if(e<=h&&("u"==l||"r"==l)||e>=d&&("d"==l||"l"==l))break;l=e-t*i.lineScrollSize,l=Math.max(0,Math.min(l,d)),n.liveScrolling?(n.itemEditorInstance&&n._endEdit("other"),a.call(n,l),e!=o.call(n)&&(n._touchLastScrollEvent=new ma(ma.SCROLL),n._touchLastScrollEvent.direction=i.getDirection(),n._touchLastScrollEvent.position=o.call(n),n._touchLastScrollEvent.delta=o.call(n)-e,n._touchLastScrollEvent.edelta=t,n.dispatchEvent(n._touchLastScrollEvent))):(i.isScrolling=!0,i._setScrollPosition(r),n._touchLastScrollEvent||(n._touchLastScrollEvent=new ma(ma.SCROLL),n._touchLastScrollEvent.edelta=t),n._touchLastScrollEvent.direction=i.getDirection(),n._touchLastScrollEvent.position=i.getScrollPosition(),n._touchLastScrollEvent.delta=o.call(n)-e);break;case"touchend":if(t.stopImmediatePropagation(),n._touchLastScrollEvent){a=1;var c;o=n.liveScrolling?500:250,(i="vertical"==n._touchLastScrollEvent.direction?n._verticalScrollBar:n._horizontalScrollBar)&&(i.isScrolling=!1,r=I(t.pageY)?t.changedTouches&&0<t.changedTouches.length?new ra(t.changedTouches[0].pageX,t.changedTouches[0].pageY):n._touchLastPoint:new ra(t.pageX,t.pageY),"vertical"==n._touchLastScrollEvent.direction?(c=i.getHeight(),r=Math.abs(n._touchStartPoint.y-r.y),a=n._touchLastScrollEvent.position+-10*n._rowHeight*n._touchLastScrollEvent.edelta):(c=i.getWidth(),r=Math.abs(n._touchStartPoint.x-r.x),a=n._touchLastScrollEvent.position+-10*n._touchLastScrollEvent.edelta),a=0>a?0:a>i.getMaxScrollPosition()?i.getMaxScrollPosition():a,50<r&&(new Date).getTime()-n._touchStartTimeStamp<o?n._tween=new oa(n,n._touchLastScrollEvent.position,a,750,(-1),function(t){i&&(n.liveScrolling?(s=new ma(ma.SCROLL),s.direction=i.getDirection(),s.position=Math.round(t),s.delta=0,i.dispatchEvent(s)):(i.isScrolling=!0,i._setScrollPosition(parseInt((t-i._getScrollPosition())*c/i._correctedPageSize))))},function(t){n._tween=null,i&&(i.isScrolling=!1,s=new ma(ma.SCROLL),s.direction=i.getDirection(),s.position=Math.round(t),s.delta=0,i.dispatchEvent(s))}):n.liveScrolling||i.dispatchEvent(n._touchLastScrollEvent))}if(n._doubleClickEnabled){for(r=o=0;r<n._touchEventsStack.length;r++)"touchstart"==n._touchEventsStack[r].type&&800>t.timeStamp-n._touchEventsStack[r].timeStamp&&o++;2==o&&(n._touchLastPoint&&(t.pageX2=n._touchLastPoint.x,t.pageY2=n._touchLastPoint.y),t.preventDefault(),n._touchEventsStack=[],n._mouseDownHandler(t),n._mouseUpHandler(t),n._mouseDoubleClickHandler(t))}n._touchStartPoint=null,n._touchStartTimeStamp=0,n._touchLastPoint=null,n._touchLastScrollEvent=null;break;case"touchcancel":n._touchStartPoint=null,n._touchStartTimeStamp=0,n._touchLastPoint=null,n._touchLastScrollEvent=null,n._touchEventsStack=[]}},n.prototype._dragStartHandler=function(t){if(!t.defaultPrevented){t.dataTransfer.effectAllowed=t.ctrlKey?"copy":this._dragMoveEnabled?"move":"copy";var e=new Ud;this._addDragData(e),Lb.doDrag(this,e,t,this._dragMoveEnabled)}},n.prototype._dragEnterHandler=function(t){t.defaultPrevented||(t.dataTransfer.getData("Text"),this._lastDragEvent=t,this.getEnabled()&&this._iteratorValid?this.showDropFeedback(t):this.hideDropFeedback(t),t.preventDefault(),t.stopPropagation())},n.prototype._dragOverHandler=function(t){if(!t.defaultPrevented){if(t.dataTransfer.getData("Text"),this._lastDragEvent=t,this.getEnabled()&&this._iteratorValid)return this.showDropFeedback(t),t.preventDefault(),t.stopPropagation(),!1;this.hideDropFeedback(t)}},n.prototype._dragExitHandler=function(t){t.defaultPrevented||(this._lastDragEvent=null,this.hideDropFeedback(t),this._resetDragScrolling())},n.prototype._dragDropHandler=function(e){if(!e.defaultPrevented){var i,s=e.dataTransfer.getData("Text");if(this.hideDropFeedback(e),this._lastDragEvent=null,this._resetDragScrolling(),this.getEnabled()&&!p(s)){i=Lb.getDragSource(s),this.getDataProvider()||this.setDataProvider([]);var s=i.ds.dataForFormat("items"),r=this.calculateDropIndex(e);if("move"==e.dataTransfer.effectAllowed&&this._dragMoveEnabled&&i.uno==this.uno){var n=this.getSelectedIndices();for(n.sort(function(t,e){return t-e}),i=n.length-1;0<=i;i--)this._collectionIterator.seek(t.getFIRST(),n[i]),n[i]<r&&r--,this._collectionIterator.remove();this._clearSelected(!1)}for(this._collectionIterator.seek(t.getFIRST(),r),i=s.length-1;0<=i;i--)"copy"==e.dataTransfer.effectAllowed?this._collectionIterator.insert(this._copyItemWithUID(s[i])):"move"==e.dataTransfer.effectAllowed&&this._collectionIterator.insert(s[i])}this._lastDragEvent=null,e.preventDefault(),e.stopPropagation()}},n.prototype._copyItemWithUID=function(t){return t=ua.copy(t),t.hasOwnProperty("uid")?t.uid=V.createUID():Ea(t)&&t.rm_internal_uid&&(t.rm_internal_uid=V.createUID()),t},n.prototype._dragEndHandler=function(e){if(e.dataTransfer.getData("Text"),this._isPressed=!1,!e.defaultPrevented){if("move"==e.dataTransfer.effectAllowed&&this._dragMoveEnabled){e=this.getSelectedIndices(),e.sort(function(t,e){return t-e});var i;for(i=e.length-1;0<=i;i--)this._collectionIterator.seek(t.getFIRST(),e[i]),this._collectionIterator.remove();this._clearSelected(!1)}Lb.endDrag(this),this._lastDragEvent=null,this._resetDragScrolling()}},n.prototype._strictEqualityCompareFunction=function(t,e){return t===e},n.prototype._getListVisibleData=function(){return this._getVisibleData()},n.prototype._getItemUID=function(t){return this._itemToUID(t)},n.prototype._getItemRendererForMouseEvent=function(t){return this._mouseEventToItemRenderer(t)},n.prototype._getListContentHolder=function(){return this._listContent},n.prototype._convertIndexToRow=function(t){return this._indexToRow(t)},n.prototype._convertIndexToColumn=function(t){return this._indexToColumn(t)},n.prototype._getCaretIndex=function(){return this._caretIndex},n.prototype._getIterator=function(){return this._iterator},z(Kb,u),Kb.prototype.getScrollRect=function(){return this._scrollRect},Kb.prototype.setScrollRect=function(t){var e,i=this.element,s=m,r=i.scrollWidth,n=i.clientWidth;this._scrollRect!=t&&((this._scrollRect=t)?(r-n<t.x?(e=Kb._super.getWidth.call(this),this._scrollOldWidth=p(this._scrollOldWidth)?e:this._scrollOldWidth,s.setPxStyle(i,"width",e-(t.x-(r-n)))):!p(this._scrollOldWidth)&&r-n>t.x&&(s.setPxStyle(i,"width",this._scrollOldWidth),this._scrollOldWidth=null),i.scrollLeft=t.x,r=i.scrollHeight,n=i.clientHeight,r-n<t.y?(e=Kb._super.getHeight.call(this),this._scrollOldHeight=p(this._scrollOldHeight)?e:this._scrollOldHeight,s.setPxStyle(i,"height",e-(t.x-(r-n)))):!p(this._scrollOldHeight)&&r-n>t.y&&(s.setPxStyle(i,"height",this._scrollOldHeight),this._scrollOldHeight=null),i.scrollTop=t.y):(p(this._scrollOldWidth)?this.getParent()&&this.getParent().getWidth()>n&&s.setPxStyle(i,"width",this.getParent().getWidth()):(e=Kb._super.getWidth.call(this),this._scrollOldWidth!=e&&(s.setPxStyle(i,"width",this._scrollOldWidth),this._scrollOldWidth=null)),i.scrollLeft=0,p(this._scrollOldHeight)||(e=Kb._super.getHeight.call(this),this._scrollOldHeight!=e&&(s.setPxStyle(i,"height",this._scrollOldHeight),this._scrollOldHeight=null)),i.scrollTop=0),this.invalidateDisplayList())},Kb.prototype.getWidth=function(){return p(this._scrollOldWidth)?Kb._super.getWidthInline.call(this):this._scrollOldWidth},Kb.prototype.setWidth=function(t){return this._scrollOldWidth=null,Kb._super.setWidthInline.call(this,t)},Kb.prototype.getHeight=function(){return p(this._scrollOldHeight)?Kb._super.getHeightInline.call(this):this._scrollOldHeight},Kb.prototype.setHeight=function(t){return this._scrollOldHeight=null,Kb._super.setHeight.call(this,t)},Kb.prototype._getParentList=function(){return this._parentList},Kb.prototype.invalidateSize=function(){this._allowItemSizeChangeNotification&&this._parentList.invalidateList()},Kb.prototype.updateDisplayList=function(t,e){
Kb._super.updateDisplayList.call(this,t,e),this._maskShape&&(this._maskShape.setWidth(t),this._maskShape.setHeight(e))},Kb.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i=m,s=!1;this.getHeight()!=e&&(i.setPxStyle(this,"height",e),s=!0),this.getWidth()!=t&&(i.setPxStyle(this,"width",t),s=!0),s&&this.invalidateDisplayList(),this._scrollOldHeight=this._scrollOldWidth=null}},Kb.prototype.getHeightExcludingOffsets=function(){return this.getHeight()+this.topOffset-this.bottomOffset},Kb.prototype.getWidthExcludingOffsets=function(){return this.getWidth()+this.leftOffset-this.rightOffset};var Nc=function(t,e,i,s,r,n){this.searchString=t,this.startingBookmark=e,this.bookmark=i,this.offset=s,this.currentIndex=r,this.stopIndex=n},Da=function(t,e){this.bookmark=t,this.offset=e},Nb=function(t,e,i){this.approximate=i,this.data=t,this.index=e},Xc=function(t,e,i,s,r){this.useFind=t,this.index=e,this.items=i,this.bookmark=s,this.offset=r},ve=function(t,e,i,s,r,n,o){this.incrementing=t,this.index=e,this.stopData=i,this.transition=s,this.placeHolder=r,this.bookmark=n,this.offset=o},Ee=function(t,e,i,s,r,n,o){this.label=t,this.icon=e,this.dataField=this.labelField=i,this.uid=s,this.owner=r,this.rowIndex=n,this.columnIndex=o};Cc._defaultStyles={horizontalGap:3},z(Cc,qa),Cc.prototype.getListData=function(){return this._listData},Cc.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties(),this.invalidateSize()},Cc.prototype.createChildren=function(){Cc._super.createChildren.call(this),this._label||(this._label=new pa,this._label.setStyleName(this),this._label.setStyle("position","absolute"),this._label.setStyle("overflow","hidden"),this._label.setVisibility(!1),this.addChild(this._label))},Cc.prototype.commitProperties=function(){if(Cc._super.commitProperties.call(this),this._listDataChanged){if(this._listData){this._listOwner=this._listData.owner;var t,e;(t=this._listData.icon)&&" "!==t?(this._icon||(this._icon=new Ua,this.addChildAt(this._icon,0)),0>t.indexOf("/")&&(t=Ma+"icons/"+t+(0<t.indexOf(".")?"":".png")),t!=this._icon.getSrc()?(this._icon.setWidth(NaN),this._icon.setHeight(NaN),this._icon.setExplicitWidth(NaN),this._icon.setExplicitHeight(NaN),this._icon.setVisibility(!1),this._icon.addEventListener("load",this._iconLoadHandler,this),this._icon.setSrc(t)):(this._icon.setVisibility(!1),this.invalidateDisplayList())):t&&" "!=t||!this._icon||(this._icon.setSrc(null),this._icon.removeEventListener("load",this._iconLoadHandler,this)),this._label.setText(this._listData.label&&" "!=this._listData.label?this._listData.label:""),t=this._listOwner.getWordWrap(),m.setWordWrap(this._label.element,t),this._listOwner.getVariableRowHeight()&&(e=!0),this._visible?m.setStyle(this._label.element,"display",e?"inline-block":"inline"):this._oldDisplay=e?"inline-block":"inline",this._listOwner.getTruncateToFit()&&(e=this._label.getStyle("textOverflow"),"ellipsis"!=e&&this._label.setStyle("textOverflow","ellipsis"));var i;this._listOwner.getShowDataTips()&&(i=this._listOwner.itemToDataTip(this._data))}else this._label.setText("");i?this.element.title!=i&&(this.element.title=i):""!=this.element.title&&(this.element.title=""),i=!!this._listOwner&&this._listOwner.getDragEnabled(),this.element.draggable=i,this.element.style.webkitUserDrag=i?"element":"none",this._listDataChanged=!1}},Cc.prototype.measure=function(){if(Cc._super.measure.call(this),this._listData){var t,e,i=this.getSizeStyle("horizontalGap"),s=0,r=0;this._icon&&this._icon.complete&&!this._icon.isError?(s=this._icon.naturalWidth,r=this._icon.naturalHeight):i=0,e=this._listOwner.getVariableRowHeight()?this._label.getTextHeight():this._label.getHeight(),O(this._explicitWidth)?(t=this.measureText(this._label.getText()).width+pa.TEXT_WIDTH_PADDING,i=t+i+s):i=this._explicitWidth,r=Math.max(e,r),this.measuredMinWidth=this.measuredWidth=i,this.measuredMinHeight=this.measuredHeight=r}},Cc.prototype.updateDisplayList=function(t,e){if(Cc._super.updateDisplayList.call(this,t,e),0!=t){var i=this._icon&&this._icon.complete&&!this._icon.isError,s=i?this._icon.naturalWidth:0,r=i?this._icon.naturalHeight:0;i&&this._icon.setActualSize(s,r);var n=i?this.getSizeStyle("horizontalGap"):0,o=this.measureText(this._label.getText()),a=o.width+1,l=t-s-n;0>l&&(l=0),l<a&&(a=l),o=o.height,e<o&&(o=e),this._label.setActualSize(a,o),this._label.getVisibility()||this._label.setVisibility(!0);var h=this._listOwner?this._listOwner.getStyle("iconPlacement"):"",d=this.getStyle("textAlign"),l="right"==h?"center"==d?(t-a-n-s)/2+n+(this._icon?a:0):"right"==d?t-(this._icon?s:a):this._icon?a+n:0:"center"==d?(t-a-n-s)/2:"right"==d?t-s-n-a:0,l=Math.max(l,0);this._icon?"right"==h?(this._icon.setX(Math.round(l)),"center"==d?this._label.setX(Math.round((t-a-n-s)/2)):"right"==d?this._label.setX(Math.round(t-s-n-a)):this._label.setX(0)):(this._icon.setX(Math.round(l)),this._label.setX(Math.round(l+s+n))):this._label.setX(0),s=this._listOwner?this._listOwner.getStyle("verticalAlign"):"","top"==s?(this._icon&&this._icon.setY(o>r?(o-r)/2:0),this._label.setY(0)):"bottom"==s?(this._icon&&this._icon.setY(e-r),this._label.setY(e-o+2)):(this._icon&&this._icon.setY((e-r)/2),this._label.setY((e-o)/2)),this._icon&&(this._icon.getSrc()?i&&(this._icon.setVisible(!0),this._icon.setVisibility(!0)):p(this._icon.getSrc())&&this._icon.setVisible(!1)),this._data&&this.getParent()&&this._listOwner&&(i=this._enabled?this._listOwner.isItemSelected(this.getListData().uid)?this._listOwner.getStyle("textSelectedColor"):this._listOwner.isItemHighlighted(this.getListData().uid)?this._listOwner.getStyle("textRollOverColor"):this.getStyle("color"):this._listOwner.getStyle("disabledColor"),this._label.setStyle("color",i))}},Cc.prototype._iconLoadHandler=function(t){this._icon.removeEventListener("load",this._iconLoadHandler,this),this._icon.setVisible(!1),this.invalidateDisplayList()},Cc.prototype._getLabel=function(){return this._label};var we=function(t,e,i,s){this.data=3<arguments.length?s:null,this.height=e,this.uid=i,this.y=t};rb._defaultStyles={horizontalGap:2,verticalGap:2,iconPlacement:"left"},z(rb,u),rb.prototype.getIconSrc=function(){return this._iconSrc},rb.prototype.setIconSrc=function(t){this._iconSrc!=t&&(this._iconSrc=t,this._iconSrcChanged=!0,this.invalidateProperties())},rb.prototype.getSelectedIconSrc=function(){return this._selectedIconSrc},rb.prototype.setSelectedIconSrc=function(t){this._selectedIconSrc!=t&&(this._selectedIconSrc=t,this.invalidateDisplayList())},rb.prototype.getLabel=function(){return this._label},rb.prototype.setLabel=function(t){this._label!=t&&(this._label=t,this._labelChanged=!0,this.invalidateProperties())},rb.prototype.getToggle=function(){return this._toggle},rb.prototype.setToggle=function(t){this._toggle!=t&&(this._toggle=t,this._toggleChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},rb.prototype.getSelected=function(){return this._selected},rb.prototype.setSelected=function(t){this._selected!=t&&(this._selected=t,this._setSelected(t,!0))},rb.prototype._setSelected=function(t,e){this._selected!=t&&(this._selected=t,this.invalidateDisplayList(),this.dispatchEvent(new w("valueCommit")))},rb.prototype._imgLoadHandler=function(){this._iconElement.removeEventListener("load",this._imgLoadHandler,this),this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("iconLoaded"))},rb.prototype._changeSkins=function(){},rb.prototype.createChildren=function(){var t;if(rb._super.createChildren.call(this),m.setAttr(this.element,"type",this._type),t=this._tableElement=new Za,t.setRowCount(3),t.setColumnCount(3),this.addChild(t),(r.ie9||r.ie8L)&&this._tableElement.setStyle("verticalAlign","top"),this._iconElement=new Ua,!p(this._iconSrc)){this._iconElement.addEventListener("load",this._imgLoadHandler,this);var e=this._iconSrc;0>e.indexOf("/")&&(e=Ma+e+(0<e.indexOf(".")?"":".png")),this._iconElement.setSrc(e),t.setCellItem(this._iconRowndex,this._iconColumnIndex,this._iconElement),t.setCellStyle(this._iconRowndex,this._iconColumnIndex,"paddingRight",this.getStyle("horizontalGap")+"px"),this._iconElement.setStyle("position","static"),this._iconSrcChanged=!1}this._labelElement=new mc,t.setCellItem(1,1,this._labelElement),p(this._label)||this._labelElement.setText(this._label)},rb.prototype.commitProperties=function(){var t=this._tableElement;if(rb._super.commitProperties.call(this),!this._labelChanged&&!this._iconSrcChanged||this._label||p(this._iconSrc)||(this._iconElement.setStyle("display","block"),t.setCellStyle(this._iconRowndex,this._iconColumnIndex,"padding","0px")),this._labelChanged&&(this._labelElement.setText(this._label),this._labelChanged=!1),this._iconSrcChanged){var e=this._iconSrc;e&&0>e.indexOf("/")&&(e=Ma+e+(0<e.indexOf(".")?"":".png")),this._iconElement.setSrc(e),p(e)?(t&&t.removeCellItem(this._iconRowndex,this._iconColumnIndex),t.setCellStyle(this._iconRowndex,this._iconColumnIndex,"padding","0px")):(this._iconElement.addEventListener("load",this._imgLoadHandler,this),this._checkAndAddIcon(),this._iconElement.setStyle("position","static")),this._iconSrcChanged=!1}this._toggleChanged&&(this.getToggle()||this.setSelected(!1),this._toggleChanged=!1)},rb.prototype.measure=function(){var t,e,i;rb._super.measure.call(this),t=this._labelElement.getExplicitOrMeasuredWidth(),e=this._labelElement.getExplicitOrMeasuredHeight(),this._iconSrc&&""!=this._iconSrc&&this._iconElement.complete&&(t+=isNaN(this._iconElement.naturalWidth)?0:this._iconElement.naturalWidth,e=Math.max(this._labelElement.getExplicitOrMeasuredHeight(),isNaN(this._iconElement.naturalHeight)?0:this._iconElement.naturalHeight)),i=m.getBorderPaddingMetrics(this),t+=i.left+i.right,e+=i.top+i.bottom,r.quirks&&(e+=4),this.measuredWidth=t,this.measuredHeight=e},rb.prototype.updateDisplayList=function(t,e){Ua._super.updateDisplayList.call(this,t,e),this._checkAndAddIcon()},rb.prototype._getCurrentIconSrc=function(){var t;return(t=this.getSelected()&&this.getSelectedIconSrc()?this.getSelectedIconSrc():this.getIconSrc())&&0>t.indexOf("/")&&(t=Ma+t+(0<t.indexOf(".")?"":".png")),t},rb.prototype._checkAndAddIcon=function(){var t,e,i,s;t=this.getStyle("iconPlacement");var r=this._getCurrentIconSrc(),n=this._tableElement;r&&n&&("right"==t?(i=2,s=1,t="paddingLeft",e=this.getStyle("horizontalGap")):"top"==t?(i=1,s=0,t="paddingBottom",e=this.getStyle("verticalGap")):"bottom"==t?(i=1,s=2,t="paddingTop",e=this.getStyle("verticalGap")):(i=0,s=1,t="paddingRight",e=this.getStyle("horizontalGap")),i==this._iconColumnIndex&&s==this._iconRowndex&&this._iconElement.getParent()||(n.removeCellItem(this._iconRowndex,this._iconColumnIndex),n.setCellStyle(this._iconRowndex,this._iconColumnIndex,"padding",0),n.setCellItem(s,i,this._iconElement),n.setCellStyle(s,i,t,e+"px")),this._iconColumnIndex=i,this._iconRowndex=s,this._iconElement.getSrc()!=r&&this._iconElement.setSrc(r))},z(Gd,u),Gd.prototype.getType=function(){return this._type},Gd.prototype.setType=function(t){this._type!=t&&("input"==t&&r.safari&&(this.element.style.webkitUserSelect="text"),this._type=t,this._typeChanged=!0,this.invalidateProperties())},Gd.prototype.commitProperties=function(){Gd._super.commitProperties.call(this),this._typeChanged&&(this.element.type=this._type,this._typeChanged=!1)},z(Ka,u),Ka.prototype.getSkin=function(){return this._skin},Ka.prototype.setSkin=function(t){this._skin=t,this._skinChanged=!0,this.invalidateProperties()},Ka.prototype.getSelected=function(){return this._convertToValue(this._selected)},Ka.prototype.setSelected=function(t){this._selected=this._convertToBool(t),this._selectedChanged=!0,this.invalidateProperties()},Ka.prototype.getData=function(){return this._data},Ka.prototype.setData=function(t){var e;this._data=t,this._listData?(t=this._data[this._listData.dataField],e="true"==t.toString().toLowerCase()||this._convertToBool(t)):I(this._data)||(e="true"==this._data.toString().toLowerCase()||this._convertToBool(this._data)),I(e)||(this._selected=e,this._selectedChanged=!0),this.invalidateProperties()},Ka.prototype.getListData=function(){return this._listData},Ka.prototype.setListData=function(t){this._listData=t},Ka.prototype.getLabel=function(){return this._label},Ka.prototype.setLabel=function(t){this._label!=t&&(this._label=t,this._labelChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},Ka.prototype.getValue=function(){return this._chkBoxElm.element.value},Ka.prototype.setValue=function(t){this._chkBoxElm.element.value=t},Ka.prototype.getNumChildren=function(){return this._chkBoxElm&&this.contains(this._chkBoxElm)?1:0},Ka.prototype.setEnabled=function(t){Ka._super.setEnabled.call(this,t),this._chkBoxElm&&this._chkBoxElm.setEnabled(t)},Ka.prototype.setTabIndex=function(t){this._chkBoxElm.element.tabIndex=t},Ka.prototype._convertToValue=function(t){return p(t)?!p(this.falseValue)&&this.falseValue:t?p(this.trueValue)?t:this.trueValue:p(this.falseValue)?t:this.falseValue},Ka.prototype._convertToBool=function(t){return bb(t)?t:p(this.trueValue)?p(this.falseValue)?!!t:t!=this.falseValue&&!!t:(p(this.falseValue),t==this.trueValue)},Ka.prototype.createChildren=function(){Ka._super.createChildren.call(this);var t="Kool__"+this.name;this._chkBoxElm=new Gd,this._chkBoxElm.setAttr("type",this._type),this._chkBoxElm.setAttr("id",t),this._chkBoxElm.setStyle("verticalAlign","middle"),this._chkBoxElm.addEvent("click",this._checkBoxClickHandler,this),this._chkBoxElm.addEvent("change",this._checkBoxChangeHandler,this),this.addChild(this._chkBoxElm),this._lbElm=document.createElement("label"),m.setAttr(this._lbElm,"for",t),m.setAttr(this._lbElm,"htmlFor",t),this._lbElm.selfUIElement=this,this._lbElm.innerHTML=this._label,this.element.appendChild(this._lbElm)},Ka.prototype.commitProperties=function(){Ka._super.commitProperties.call(this),this._selectedChanged&&(this._selected?(this._chkBoxElm.setAttr("checked",this._selected),this._chkBoxElm.element.checked=this._selected):(this._chkBoxElm.setAttr("checked",this._selected),this._chkBoxElm.element.checked=this._selected,this._chkBoxElm.removeAttr("checked")),this._selectedChanged=!1),this._labelChanged&&(this._lbElm.innerHTML=this._label,this._labelChanged=!1,this.invalidateSize()),this._skinChanged&&(this._skin=new this._skin(this,[this._chkBoxElm,this._lbElm]),this.addChild(this._skin),this._skinChanged=!1)},Ka.prototype.measure=function(){Ka._super.measure.call(this);var t=0,e=0;this._label&&(e=this.measureText(this._label),t=e.height,e=e.width+pa.TEXT_WIDTH_PADDING);var i=this._chkBoxElm.element.size,s=this._chkBoxElm.element.size,t="left"==this._labelPlacement||"right"==this._labelPlacement?Math.max(t,i):t+i,e="top"==this._labelPlacement||"bottom"==this._labelPlacement?Math.max(e,s):e+s;this.measuredMinHeight=this.measuredHeight=Math.max(t,19),this.measuredMinWidth=this.measuredWidth=Math.max(e,20)},Ka.prototype.updateDisplayList=function(t,e){Ka._super.updateDisplayList.call(this,t,e),this._skin&&(this._skin.move(0,0),this._skin.setActualSize(t,e))},Ka.prototype.focus=function(){this.getEnabled()&&(this._chkBoxElm?this._chkBoxElm.focus():Ka._super.focus.call(this))},Ka.prototype._checkBoxClickHandler=function(t){var e=new w("click");r.ie8L&&(this._chkBoxElm.element.blur(),this._chkBoxElm.element.focus()),e.htmlEvent=t,this.dispatchEvent(e)},Ka.prototype._checkBoxChangeHandler=function(t){var e=new w("change");this._selected=t.currentTarget.checked,e.htmlEvent=t,this.dispatchEvent(e)},Ca._defaultStyles={downArrowButtonStyleName:void 0,textInputStyleName:"KoolComboTextInput"},z(Ca,u),Ca.prototype.getBorderMetrics=function(){return this._border?this._border.getBorderMetrics():m.getBorderMetrics(this)},Ca.prototype.getDataProvider=function(){return this._collection},Ca.prototype.setDataProvider=function(t){this._collection&&this._collection.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),ha(t)?this._collection=new P(t):E(t)?this._collection=new Hb(t):this._collection=t instanceof xb?t:t instanceof la?t:new P([t]),this._iterator&&this._iterator.removeListener(),this._iterator=this._collection.createCursor(),this._collectionIterator&&this._collectionIterator.removeListener(),this._collectionIterator=this._collection.createCursor(),this._collection.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),t=new y(y.COLLECTION_CHANGE),t.kind="reset",this._collectionChangeHandler(t),this.dispatchEvent(t),this.invalidateSize(),this.invalidateDisplayList()},Ca.prototype.getEditable=function(){return this._editable},Ca.prototype.setEditable=function(t){t!=this._editable&&(this._editable=t,this._editableChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("editableChanged")))},Ca.prototype.setEnabled=function(t){Ca._super.setEnabled.call(this,t),this._enabled=t,this._enabledChanged=!0,this.invalidateProperties()},Ca.prototype.getImeMode=function(){return this._imeMode},Ca.prototype.setImeMode=function(t){this._imeMode=t,this._textInput&&this._textInput.setImeMode(t)},Ca.prototype.getRestrict=function(){return this._restrict},Ca.prototype.setRestrict=function(t){t&&F(t)&&(t=new RegExp(t)),t!=this._restrict&&(this._restrict=t,this._restrictChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("restrictChanged")))},Ca.prototype.getSelectedIndex=function(){return this._selectedIndex},Ca.prototype.setSelectedIndex=function(e){if(this._selectedIndex=e,-1==e&&(this._selectedUID=this._selectedItem=null),this._collection&&0!=this._collection.getLength()){if(-1!=e){e=Math.min(e,this._collection.getLength()-1);var i=this._iterator.getBookmark(),s=e;this._iterator.seek(t.getFIRST(),s);var s=this._iterator.getCurrent(),r=this._itemToUID(s);this._iterator.seek(i,0),this._selectedIndex=e,this._selectedItem=s,this._selectedUID=r}}else this._selectedIndexChanged=!0;this._selectionChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("valueCommit"))},Ca.prototype.getSelectedItem=function(){return this._selectedItem},Ca.prototype.setSelectedItem=function(t){this._setSelectedItem(t)},Ca.prototype._setSelectedItem=function(t,e){if(this._collection&&0!=this._collection.getLength()){var i=!1,s=this._collection.createCursor(),r=0;do{if(t==s.getCurrent()){this._selectedIndex=r,this._selectedItem=t,this._selectedUID=this._itemToUID(t),i=this._selectionChanged=!0;break}r++}while(s.moveNext());i||(this.setSelectedIndex(-1),this._selectedUID=this._selectedItem=null)}else this._selectedItem=t,this._selectedItemChanged=!0;this.invalidateDisplayList()},Ca.prototype.getText=function(){return this._text},Ca.prototype.setText=function(t){this._text=t,this._textChanged=!0,this.invalidateProperties()},Ca.prototype.getValue=function(){if(this._editable)return this._text;var t=this.getSelectedItem();return null!=t&&Ea(t)?null!=t.data?t.data:t.label:t},Ca.prototype.styleChanged=function(t){var e,i=null==t||"styleName"==t;Ca._super.styleChanged.call(this,t),("downArrowButtonStyleName"==t||i)&&(e=this.getStyle("downArrowButtonStyleName"),this._downArrowButton&&e&&this._downArrowButton.setStyleName(e)),("textInputStyleName"==t||i)&&(e=this.getStyle("textInputStyleName"),this._downArrowButton&&e&&this._downArrowButton.setStyleName(e))},Ca.prototype.createChildren=function(){if(Ca._super.createChildren.call(this),!this._downArrowButton){this._downArrowButton=new rb,this._downArrowButton.setStyle("horizontalGap",0),this._downArrowButton.setStyle("iconPlacement","right"),this._downArrowButton.setTabIndex(-1),this._downArrowButton.addEvent("mousedown",this._downArrowButton_mouseDownHandler,this),this.addChild(this._downArrowButton);var t=this.getStyle("downArrowButtonStyleName");t&&this._downArrowButton.setStyleName(t),this._downArrowButton.setVisibility(!1)}this._textInput||(this._textInput=new Y,this._textInput.setEditable(this._editable),this._editableChanged=!0,this._textInput.setImeMode(this._imeMode),this._textInput.setAttr("spellcheck",!1),(t=this.getStyle("textInputStyleName"))&&this._textInput.setStyleName(t),this._textInput.addEventListener("input",this._textInput_inputHandler,this),this._textInput.addEvent("blur",this._blurHandler,this),this._textInput.addEventListener("valueCommit",this._textInput_valueCommitHandler,this),this._textInput.setVisibility(!1),this.addChild(this._textInput),this._textInput.move(0,0))},Ca.prototype.commitProperties=function(){if(Ca._super.commitProperties.call(this),this._textChanged&&(this._textInput.setText(this._text),this._editable||this._downArrowButton.setLabel(this._text),this._textChanged=!1),this._restrictChanged&&(this._textInput.setRestrict(this._restrict),this._restrictChanged=!1),this._enabledChanged&&(this._editableChanged=!0,this._textInput.setEnabled(this._enabled),this._downArrowButton.setEnabled(this._enabled),this._enabledChanged=!1),this._editableChanged){this._downArrowButton.setVisibility(!0),this._textInput.setVisibility(!0),this._editableChanged=!1;var t=this._editable;0==this._wrapDownArrowButton&&(t?this._oldBorderStyle&&this.setStyle("borderStyle",this._oldBorderStyle):(this._oldBorderStyle=this.getStyle("borderStyle"),this.setStyle("borderStyle","comboNonEdit"))),this._useFullDropdownSkin&&this._downArrowButton.invalidateDisplayList(),this._textInput&&(this._textInput.setEditable(t),t?(this._textInput.removeEvent("mousedown",this._textInput_mouseEventHandler,this),this._textInput.removeEvent("mouseup",this._textInput_mouseEventHandler,this),this._textInput.removeEvent("mouseover",this._textInput_mouseEventHandler,this),this._textInput.removeEvent("mouseout",this._textInput_mouseEventHandler,this),this._textInput.addEvent("keydown",this._keyDownHandler,this),this._downArrowButton.setLabel(""),this._downArrowButton._tableElement.setCellStyle(1,1,"paddingLeft","0px"),this._downArrowButton.setStyle("borderTopLeftRadius","0px"),this._downArrowButton.setStyle("borderBottomLeftRadius","0px")):(this._textInput.addEvent("mousedown",this._textInput_mouseEventHandler,this),this._textInput.addEvent("mouseup",this._textInput_mouseEventHandler,this),this._textInput.addEvent("mouseover",this._textInput_mouseEventHandler,this),this._textInput.addEvent("mouseout",this._textInput_mouseEventHandler,this),this._textInput.removeEvent("keydown",this._keyDownHandler,this),this._downArrowButton.setLabel(this._textInput.getText()),this._downArrowButton._tableElement.setCellStyle(1,1,"paddingLeft","5px"),this._downArrowButton.setStyle("borderTopLeftRadius",this._downArrowButton.getStyle("borderTopRightRadius")),this._downArrowButton.setStyle("borderBottomLeftRadius",this._downArrowButton.getStyle("borderBottomRightRadius"))))}this._downArrowButton._tableElement.setCellStyle(0,2,"width",this.getStyle("arrowButtonWidth")+"px"),this._downArrowButton._tableElement.setCellStyle(1,2,"width",this.getStyle("arrowButtonWidth")+"px"),this._downArrowButton._tableElement.setCellStyle(2,2,"width",this.getStyle("arrowButtonWidth")+"px"),this._downArrowButton._tableElement.setCellStyle(1,1,"textAlign","left"),this._downArrowButton._tableElement.setCellStyle(1,2,"textAlign","middle")},Ca.prototype.measure=function(){Ca._super.measure.call(this);var t=this.getStyle("arrowButtonWidth"),e=this._downArrowButton.getExplicitOrMeasuredHeight();if(this._collection&&0<this._collection.getLength()){var i=this._calculatePreferredSizeFromData(this._collection.getLength()),s=this.getBorderMetrics(),r=i.height+s.top+s.bottom+pa.TEXT_HEIGHT_PADDING;this.measuredMinWidth=this.measuredWidth=i.width+s.left+s.right+8+t,this.measuredMinHeight=this.measuredHeight=Math.max(r,e)}else this.measuredMinWidth=40,this.measuredWidth=160,this.measuredHeight=this.measuredMinHeight=20;t=this.getSizeStyle("paddingTop")+this.getSizeStyle("paddingBottom"),this.measuredMinHeight+=t,this.measuredHeight+=t},Ca.prototype.updateDisplayList=function(t,e){Ca._super.updateDisplayList.call(this,t,e);var i=t,s=e,r=this.getStyle("arrowButtonWidth"),n=this._textInput.getExplicitOrMeasuredHeight(),o=m.getBorderPaddingMetrics(this);isNaN(r)&&(r=0),this._wrapDownArrowButton?(s=s-o.top-o.bottom,this._downArrowButton.setActualSize(s,s),this._downArrowButton.move(i-r-o.right,o.top),this._textInput.setActualSize(i-r,n)):!this._editable&&this._useFullDropdownSkin?(i=i-o.left-o.right,s=s-o.top-o.bottom,this._downArrowButton.move(o.left,o.top),this._textInput.setActualSize(i-r,n),this._textInput.move(o.left,(s-n)/2+o.top),this._downArrowButton.setActualSize(i,s),this._downArrowButton._tableElement.setActualSize(i,s)):(this._downArrowButton.move(i-r,o.top),this._textInput.setActualSize(i-r,s),this._downArrowButton.setActualSize(r,s)),this._selectedItemChanged&&(this.setSelectedItem(this.getSelectedItem()),this._selectedIndexChanged=this._selectedItemChanged=!1),this._selectedIndexChanged&&(this.setSelectedIndex(this.getSelectedIndex()),this._selectedIndexChanged=!1)},Ca.prototype.focus=function(){this._textInput&&this._editable?this._textInput.focus():Ca._super.focus.call(this)},Ca.prototype.blur=function(){this._textInput&&this._editable?this._textInput.blur():Ca._super.blur.call(this)},Ca.prototype.getTextInput=function(){return this._textInput},Ca.prototype._calculatePreferredSizeFromData=function(t){return this._calculatePreferredSize=null},Ca.prototype._itemToUID=function(t){return p(t)?"null":V.getUID(t)},Ca.prototype._getComboDownArrowButton=function(){return this._downArrowButton},Ca.prototype._blurHandler=function(t){this._editable&&this.dispatchEvent(new w("valueCommit"))},Ca.prototype._collectionChangeHandler=function(t){if(t instanceof y){var e,i=!1;if("add"==t.kind&&this.getSelectedIndex()>=t.location&&this._selectedIndex++,"remove"==t.kind){for(e=0;e<t.items.length;e++){var s=this._itemToUID(t.items[e]);this._selectedUID==s&&(this._selectionChanged=!0)}this._selectionChanged?(this._selectedIndex>=this._collection.getLength()&&(this._selectedIndex=this._collection.getLength()-1),i=this._selectedIndexChanged=!0,this.invalidateDisplayList()):this.getSelectedIndex()>=t.location&&(this._selectedIndex--,i=this._selectedIndexChanged=!0,this.invalidateDisplayList())}"refresh"==t.kind&&(i=this._selectedItemChanged=!0),this.invalidateDisplayList(),i&&this.dispatchEvent(new w("valueCommit")),this._calculatePreferredSize=null}},Ca.prototype._textInput_mouseEventHandler=function(t){"mousedown"==t.type?this._downArrowButton_mouseDownHandler(t):this._downArrowButton.dispatchEvent(t)},Ca.prototype._textInput_inputHandler=function(t){this._text=this._textInput.getText(),-1!=this._selectedIndex&&(this._selectedIndex=-1,this._selectedUID=this._selectedItem=null)},Ca.prototype._textInput_valueCommitHandler=function(t){this._text=this._textInput.getText(),this.dispatchEvent(t)},Ca.prototype._downArrowButton_mouseDownHandler=function(t){},z(za,u),za.prototype.getData=function(){return this._data},za.prototype.setData=function(t){this._data=t,t=this._listData&&this._listData instanceof nd?this._data[this._listData.dataField]:this._listData instanceof Ee&&this._listData.labelField in this._data?this._data[this._listData.labelField]:this._data,void 0===t||this._selectedItemSet||(this.setSelectedItem(t),this._selectedItemSet=!1),this.invalidateProperties()},za.prototype.getListData=function(){return this._listData},za.prototype.setListData=function(t){this._listData=t},za.prototype.getDataProvider=function(){return this._collection},za.prototype.setDataProvider=function(t){this._iterator&&this._iterator.removeListener(),ha(t)?this._collection=new P(t):t instanceof xb?this._collection=t:E(t)?this._collection=new Hb(t):this._collection=new P([t]),this._iterator=this._collection.createCursor(!0),this._collection.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),t=new y(y.COLLECTION_CHANGE),t.kind="reset",this._collectionChangeHandler(t),this.dispatchEvent(t),this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},za.prototype.getSelectedIndex=function(){return this._selectedIndex},za.prototype.setSelectedIndex=function(e){if(this._selectedIndex!=e){if(this._selectedIndex=e,-1==e&&(this._selectedUID=this._selectedItem=null),this._selectedIndexChanged=!0,this._collection&&0!=this._collection.getLength()){if(-1!=e){e=Math.min(e,this._collection.getLength()-1);var i=this._iterator.getBookmark(),s=e;this._iterator.seek(t.getFIRST(),s);var s=this._iterator.getCurrent(),r=this._itemToUID(s);this._iterator.seek(i,0),this._selectedIndex=e,this._selectedItem=s,this._selectedUID=r}}else this._selectedIndex=-1,this._selectedUID=this._selectedItem=null,this._selectedIndexChanged=!0;this._implicitSelectedIndex=!1,this.invalidateDisplayList()}},za.prototype.getSelectedItem=function(){return this._selectedItem},za.prototype.setSelectedItem=function(t){this._selectedItemSet=!0,this._implicitSelectedIndex=!1,this._superSetSelectedItem(t)},za.prototype._superSetSelectedItem=function(t){if(this._selectedItem!=t){if(this._collection&&0!=this._collection.getLength()){var e=!1,i=this._collection.createCursor(),s=0;do{try{if(i.getCurrent()==t){this.setSelectedIndex(s),this._selectedItem=t,this._selectedUID=this._itemToUID(t),e=!0;break}}catch(r){}s++}while(i.moveNext());e||(this.setSelectedIndex(-1),this._selectedUID=this._selectedItem=null)}else this._selectedItem=t,this._selectedItemChanged=!0;this.invalidateDisplayList()}},za.prototype.getLabelField=function(){return this._labelField},za.prototype.setLabelField=function(t){this._labelField!=t&&(this._labelField=t,this._labelFieldChanged=!0,this.invalidateDisplayList())},za.prototype.getLabelFunction=function(){return this._labelFunction},za.prototype.setLabelFunction=function(t){this._labelFunction!=t&&(this._labelFunction=t,this._labelFunctionChanged=!0,this.invalidateDisplayList())},za.prototype.getMultiple=function(){return this._multiple},za.prototype.setMutiple=function(t){this._multiple!=t&&(this._multiple=t,this._multipleChanged=!0,this.invalidateProperties())},za.prototype.getSize=function(){return this._size},za.prototype.setSize=function(t){this._size=t,this._sizeChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},za.prototype.getSelectedLabel=function(){return this.itemToLabel(this._selectedItem)},za.prototype.getNumChildren=function(){return 0},za.prototype.createChildren=function(){this.setStyle("paddingRight","0px"),this.addEvent("click",this._comboBoxClickHandler,this),this.addEvent("change",this._comboBoxChangeHandler,this),this.addEvent("keyup",this._comboBoxKeyUpHandler,this)},za.prototype.commitProperties=function(){za._super.commitProperties.call(this),this._multipleChanged&&(this.element.multiple=this._multiple,this._multipleChanged=!1),this._sizeChanged&&(this.element.size=this._size,this._sizeChanged=!1)},za.prototype.measure=function(){var t,e=this.element,i=e.style;za._super.measure.call(this),isNaN(this._explicitWidth)?i.width&&"auto"!=i.width?(t=i.width,i.width="auto",this.measuredWidth=e.offsetWidth,i.width=t):this.measuredWidth=e.offsetWidth:this.measuredWidth=this._explicitWidth,this.measuredHeight=this.getHeight()},za.prototype.updateDisplayList=function(t,e){za._super.updateDisplayList.call(this,t,e),this._labelFieldChanged&&(this._createComboBoxOptions(),this._selectedIndexChanged=!0,this._labelFieldChanged=!1),this._labelFunctionChanged&&(this._createComboBoxOptions(),this._selectedIndexChanged=!0,this._labelFunctionChanged=!1),this._selectedItemChanged&&(this.setSelectedItem(this._selectedItem),this._selectedIndexChanged=this._selectedItemChanged=!1),this._selectedIndexChanged&&(this.element.selectedIndex=this._selectedIndex,0<=this._selectedIndex&&this._collection&&0<this._collection.getLength()?this._selectedItem=this._collection.getItemAt(this._selectedIndex):this._selectedItem=null,this._selectedIndexChanged=!1)},za.prototype._createComboBoxOptions=function(){var t,e,i,s;if(0<this.element.length)for(t=this.element.length,e=0;e<t;e++)this.element.remove(0);if(this._collection&&0<this._collection.getLength())for(e=0,t=this._collection.getLength();e<t;e++)i=this._collection.getItemAt(e),s=this.itemToLabel(i),
i=new Option(s,i),i.selfUIElement=this,this.element.options.add(i)},za.prototype.itemToLabel=function(t){if(null==t)return"";if(null!=this._labelFunction)return this._labelFunction(t);if(E(t))try{t=G.getProperty(t,this._labelField)}catch(e){}else if(Ea(t))try{null!=t[this._labelField]&&(t=t[this._labelField])}catch(e){}else if(F(t))return t;try{return t.toString()}catch(e){}return" "},za.prototype._itemToUID=function(t){return t?V.getUID(t):"null"},za.prototype._comboBoxClickHandler=function(t){var e=new w("click");e.htmlEvent=t,this.dispatchEvent(e)},za.prototype._comboBoxChangeHandler=function(t){var e=new w("change");this.setSelectedIndex(this.element.selectedIndex),e.htmlEvent=t,this.dispatchEvent(e)},za.prototype._comboBoxKeyUpHandler=function(t){this._selectedIndex!=this.element.selectedIndex&&this._comboBoxChangeHandler(t)},za.prototype._collectionChangeHandler=function(t){if(t instanceof y){if(0==this._collection.getLength()?this._selectedIndexChanged||this._selectedItemChanged||(-1!=this._selectedIndex&&(this._selectedIndex=-1),this._selectedIndexChanged=this._implicitSelectedIndex=!0):"add"==t.kind&&(this._collection.getLength()==t.items.length?-1==this._selectedIndex&&(this._selectedIndex=0):this._selectedIndex>=t.location&&this._selectedIndex++,this._selectedIndexChanged=!0),"remove"==t.kind){for(var e=!1,i=0;i<t.items.length;i++){var s=this._itemToUID(t.items[i]);this._selectedUID==s&&(e=!0)}e?this._selectedIndex>=this._collection.getLength()&&(this._selectedIndex=this._collection.getLength()-1,this._selectedItemChanged=!0):this._selectedIndex>=t.location&&this._selectedIndex--,this._selectedIndexChanged=!0}else"update"==t.kind?this._selectedIndexChanged=!0:"refresh"==t.kind?this._selectedItemChanged=!0:"replace"==t.kind?this._selectedIndexChanged=!0:"reset"!=t.kind||this._selectedIndexChanged||this._selectedItemChanged||(this._selectedIndex=0,this._selectedIndexChanged=!0);this._createComboBoxOptions(),this.invalidateDisplayList()}},za.prototype._mouseWheelHandler=function(t){t.stopPropagation()},Dc._defaultStyles={separatorColor:"#CCCCCC"},Dc._defaultProperty="items",Dc._propertyType={items:Array},z(Dc,u),Dc.prototype.getItems=function(){return this._items},Dc.prototype.setItems=function(t){this._items!=t&&(this._items=t,this._itemsChanged=!0,this.invalidateProperties(),this.invalidateSize())},Dc.prototype.commitProperties=function(){var t,e;if(Dc._super.commitProperties.call(this),this._itemsChanged){for(;this.getNumChildren();)e=this.getChildAt(this.getNumChildren()-1),e instanceof pa&&(e.removeEvent("mouseover",this._itemMouseOverHandler,this),e.removeEvent("mouseout",this._itemMouseOutHandler,this)),this.removeChild(e);if(this._items)for(t=0;t<this._items.length;t++){if(e=this._items[t],e.separatorBefore&&!r.ie7L){var i=new A("hr","MenuHr");this.addChild(i),i.parentElement=this}i=new pa,i.setText(e.caption),this.addChild(i),i.setVisible(e.visible),i.setEnabled(e.enabled),e.visible&&i.setStyle("display","block"),i.addEvent("mouseover",this._itemMouseOverHandler,this),i.addEvent("mouseout",this._itemMouseOutHandler,this)}this._itemsChanged=!1}},Dc.prototype._itemMouseOverHandler=function(t){t.currentTarget.style.backgroundColor="#FFFFFF"},Dc.prototype._itemMouseOutHandler=function(t){t.currentTarget.style.backgroundColor=""},Dc.prototype._mouseClickHandler=function(t){var e=t.target.selfElement||t.target.parentNode.selfElement;if(e&&e instanceof pa&&e.getEnabled()){e.element.style.backgroundColor="";var i=new Ad(Ad.MENU_ITEM_SELECT);i.menuItemCaption=e.getText(),t.currentTarget.selfElement.dispatchEvent(i)}},Dc.prototype.measure=function(){Dc._super.measure.call(this);var t=0,e=0;if(this._items){var i,s=this.getNumChildren();for(i=0;i<s;i++){var r=this.getChildAt(i);r instanceof pa&&(t=Math.max(t,r.getTextWidth())),e+=r.getHeight()}}this.measuredMinWidth=this.measuredWidth=0==t?this.getWidth():t+this.getSizeStyle("paddingLeft")+this.getSizeStyle("paddingRight"),this.measuredMinHeight=this.measuredHeight=0==e?this.getHeight():e+this.getSizeStyle("paddingTop")+this.getSizeStyle("paddingBottom")},z(Db,u),Db.prototype.setScrollPosition=function(t){if(this._scrollThumb){var e=this.maxScrollPosition-this.minScrollPosition;if(this.inverted&&(t=e-t),t!=this.scrollPosition){t=Math.min(t,this.maxScrollPosition),t=Math.max(t,this.minScrollPosition);var i,s=this.arrowSize,r=this.scrollPosition;this.scrollPosition=t,"horizontal"==this.direction?(i=this.getWidth()-2*s-this.thumbSize,t=this.inverted?0==e||O(e)?0:i+2*s-(i/e*(t-this.minScrollPosition)+s):0==e||O(e)?0:i/e*(t-this.minScrollPosition)+s,e=this._scrollThumb.getY()):(i=this.getHeight()-2*s-this.thumbSize,e=this.inverted?0==e||O(e)?0:i+2*s-(i/e*(t-this.minScrollPosition)+s):0==e||O(e)?0:i/e*(t-this.minScrollPosition)+s,t=this._scrollThumb.getX()),this._scrollThumb.move(Math.round(t),Math.round(e)),this._dispatchScrollEvent(r)}}},Db.prototype.createChildren=function(){var t,e=m.setStyle,i=m.setPxStyle,s=r.boxSizing,n=r.supportTouch?"touchstart":"mousedown";this._childrenCreated||(this._childrenCreated=!0,t="horizontal"==this.direction?"H":"V",e(this,"position","absolute"),this._scrollTrack=new u("div",t+"ScrollTrack"),this._scrollTrack.owner=this,this.addChild(this._scrollTrack),e(this._scrollTrack,"position","absolute"),r.useBorderBox||e(this._scrollTrack,s,"content-box"),i(this._scrollTrack,"fontSize",1),this._upArrow=new u("div",t+"ScrollUpArrow"),this._upArrow.owner=this,this.addChild(this._upArrow),e(this._upArrow,"position","absolute"),r.useBorderBox||e(this._upArrow,s,"content-box"),i(this._upArrow,"fontSize",1),this._downArrow=new u("div",t+"ScrollDownArrow"),this._downArrow.owner=this,this.addChild(this._downArrow),e(this._downArrow,"position","absolute"),r.useBorderBox||e(this._downArrow,s,"content-box"),i(this._downArrow,"fontSize",1),this._scrollThumb=new u("div",t+"ScrollThumb"),this._scrollThumb.owner=this,this.addChild(this._scrollThumb),e(this._scrollThumb,"position","absolute"),r.useBorderBox||e(this._scrollThumb,s,"content-box"),i(this._scrollThumb,"fontSize",1),this._scrollTrack.addEvent(n,this._scrollTrackDownHandler,this),this._upArrow.addEvent(n,this._scrollUpArrowDownHandler,this),this._downArrow.addEvent(n,this._scrollDownArrowDownHandler,this),this._scrollThumb.addEvent(n,this._scrollThumbDownHandler,this),this.invalidateProperties())},Db.prototype.updateDisplayList=function(t,e){if(this._childrenCreated&&!this._isScrolling&&this._upArrow.getVisible()){var i,s,r,n=this.thumbSize,o=this.thumbHeight,a=this.arrowSize,l=this.maxScrollPosition-this.minScrollPosition;"horizontal"==this.direction?(i=t-2*a-this.thumbSize,i=this.inverted?0==l||O(l)?0:i+2*a-(i/l*(this.scrollPosition-this.minScrollPosition)+a):0==l||O(l)?0:i/l*(this.scrollPosition-this.minScrollPosition)+a,s=0):(i=e-2*a-this.thumbSize,s=this.inverted?0==l||O(l)?0:i+2*a-(i/l*(this.scrollPosition-this.minScrollPosition)+a):0==l||O(l)?0:i/l*(this.scrollPosition-this.minScrollPosition)+a,i=0),"horizontal"==this.direction?(this._scrollTrack&&(r=O(this.trackHeight)?e:this.trackHeight,this._scrollTrack.move(0,.5*(e-r)),this._scrollTrack.setActualSize(t,r)),this._scrollThumb&&(0==l||O(l)?this._scrollThumb.setVisible(!1):this._scrollThumb.getVisible()||this._scrollThumb.setVisible(!0),this._scrollThumb.move(i,.5*(e-o)),this._scrollThumb.setActualSize(n,o)),this._upArrow&&(this._upArrow.move(0,.5*(e-r)),this._upArrow.setActualSize(a,r||e)),this._downArrow&&(this._downArrow.move(t-a,.5*(e-r)),this._downArrow.setActualSize(a,r||e))):(this._scrollTrack&&(r=O(this.unscaledWidth)?t:this.trackHeight,this._scrollTrack.move(0,0),this._scrollTrack.setActualSize(r,e)),this._scrollThumb&&(0==l||O(l)?this._scrollThumb.setVisible(!1):this._scrollThumb.getVisible()||this._scrollThumb.setVisible(!0),this._scrollThumb.move(.5*(t-o),s),this._scrollThumb.setActualSize(o,n)),this._upArrow&&(this._upArrow.move(.5*(t-r),0),this._upArrow.setActualSize(r||t,a)),this._downArrow&&(this._downArrow.move(.5*(t-r),e-a),this._downArrow.setActualSize(r||t,a)))}},Db.prototype.setScrollProperties=function(t,e,i,s,r,n){this._pageScrollSize=e,0<s-i?(this.trackScrollSize=0<r?r:e,this.arrowScrollSize=n,this.minScrollPosition=Math.max(i,0),this.maxScrollPosition=Math.max(s,0),this.scrollPosition=t,this.scrollPosition=Math.max(this.minScrollPosition,this.scrollPosition),this.scrollPosition=Math.min(this.maxScrollPosition,this.scrollPosition),t=("horizontal"==this.direction?this.getWidth():this.getHeight())-2*this.arrowSize,this.thumbSize=Math.max(Math.round(e/(this.maxScrollPosition-this.minScrollPosition+e)*t),this.thumbMinSize),this._upArrow.getVisible()||(this._upArrow.setVisible(!0),this._downArrow.setVisible(!0),this._scrollTrack.setVisible(!0),this._scrollThumb.setVisible(!0))):(this.scrollPosition=this.maxScrollPosition=this.minScrollPosition=0,this._upArrow.setVisible(!1),this._downArrow.setVisible(!1),this._scrollTrack.setVisible(!1),this._scrollThumb.setVisible(!1)),this.invalidateDisplayList(),this.validateNow()},Db.prototype._dispatchScrollEvent=function(t){var e=new w("onScroll",this);e.position=this.scrollPosition,e.delta=this.scrollPosition-t,e.direction=this.direction,this.dispatchEvent(e)},Db.prototype._pageScroll=function(t){var e=this.scrollPosition+t*this._pageScrollSize;e>this.maxScrollPosition?e=this.maxScrollPosition:e<this.minScrollPosition&&(e=this.minScrollPosition),e!=this.scrollPosition&&(this.inverted&&(e=this.maxScrollPosition-this.scrollPosition+this.trackScrollSize,0>t&&(e-=2*this.trackScrollSize)),this.setScrollPosition(e))},Db.prototype._createTimer=function(t,e){var i=new sc(100);return i.addEventListener("timer",e,t),i},Db.prototype._changeTimerProp=function(){this._scrollTimer&&1==this._scrollTimer.getRepeatCount()&&(this._scrollTimer.setDelay(sc.REPEAT_INTERVAL),this._scrollTimer.setRepeatCount(0))},Db.prototype._scrollTrackDownHandler=function(t){var e,i=this.trackScrollSize,s=m.pageXY(t.currentTarget),n=t.pageX;e=t.pageY;var o="mouseup",a="mousemove";return r.supportTouch&&(o="touchend",a="touchmove"),t.touches&&(e=t.touches[0],n=e.pageX,e=e.pageY),n-=s.x,e-=s.y,this._isScrolling=!0,this._trackScrollRepeatDirection=1,"horizontal"==this.direction?n<this._scrollThumb.getX()&&(i*=-1,this._trackScrollRepeatDirection=-1):e<this._scrollThumb.getY()&&(i*=-1,this._trackScrollRepeatDirection=-1),this._scrollTrack.addEvent(o,this._scrollTrackUpHandler,this),this._scrollTrack.addEvent(a,this._scrollTrackMoveHandler,this),v.documentAddEvent(o,this._mouseLeaveHandler,this),this._trackPosition="horizontal"==this.direction?n:e,this.setScrollPosition(this.inverted?this.maxScrollPosition-this.scrollPosition+i:this.scrollPosition+i),this._scrollTimer||(this._scrollTimer=this._createTimer(this,this._scrollTimerHandler)),this._scrollTimer.start(),t.preventDefault(),t.stopPropagation(),!1},Db.prototype._scrollTimerHandler=function(){var t=this._scrollThumb,e=t.getX(),i=t.getY(),s=this._trackPosition,r="horizontal"==this.direction,n=this._trackScrollRepeatDirection;if(1==n)if(r){if(e+t.getWidth()>s)return}else if(i+t.getHeight()>s)return;if(-1==n)if(r){if(e<this._trackPosition)return}else if(i<this._trackPosition)return;this._pageScroll(n),this._changeTimerProp()},Db.prototype._scrollTrackUpHandler=function(t){this._mouseLeaveHandler(t)},Db.prototype._mouseLeaveHandler=function(){var t="mouseup",e="mousemove";this._isScrolling=!1,r.supportTouch&&(t="touchend",e="touchmove"),this._scrollTrack.removeEvent(t,this._scrollTrackUpHandler,this),this._scrollTrack.removeEvent(e,this._scrollTrackMoveHandler,this),v.documentRemoveEvent(t,this._mouseLeaveHandler,this._scrollTrack),this._scrollTimer&&(this._scrollTimer.reset(),this._scrollTimer=null)},Db.prototype._scrollUpArrowDownHandler=function(t){var e=this.scrollPosition-this.arrowScrollSize;return this.inverted&&(e=this.maxScrollPosition-this.scrollPosition-this.arrowScrollSize),this._upArrow.addEvent(r.supportTouch?"touchend":"mouseup",this._scrollArrowUpHandler,this._upArrow),this._scrollTimer?this._scrollTimer.stop():this._scrollTimer=this._createTimer(this._upArrow,this._scrollArrowTimerHandler),this._scrollTimer.start(),this.setScrollPosition(e),t.preventDefault(),t.stopPropagation(),!1},Db.prototype._scrollDownArrowDownHandler=function(t){var e=this.scrollPosition+this.arrowScrollSize;return this.inverted&&(e=this.maxScrollPosition-this.scrollPosition+this.arrowScrollSize),this._downArrow.addEvent(r.supportTouch?"touchend":"mouseup",this._scrollArrowUpHandler,this._downArrow),this._scrollTimer?this._scrollTimer.stop():this._scrollTimer=this._createTimer(this._downArrow,this._scrollArrowTimerHandler),this._scrollTimer.start(),this.setScrollPosition(e),t.preventDefault(),t.stopPropagation(),!1},Db.prototype._scrollArrowUpHandler=function(t){t=this.owner,this.removeEvent("mouseup",this._scrollArrowUpHandler),t._scrollTimer&&(t._scrollTimer.stop(),t._scrollTimer=null)},Db.prototype._scrollArrowTimerHandler=function(t){var e=this.owner;-1<this.className.indexOf("Up")?e._scrollUpArrowDownHandler(t):e._scrollDownArrowDownHandler(t),e._changeTimerProp()},Db.prototype._scrollTrackMouseOverHandler=function(t){(t.target==this||t.taret==this._scrollTrack)&&this._isScrolling&&this._scrollTimer.start()},Db.prototype._scrollTrackMouseOutHandler=function(t){this._isScrolling&&this._scrollTimer.stop()},Db.prototype._scrollThumbDownHandler=function(t){var e,i=t.pageX;e=t.pageY,"horizontal"==this.direction?this.getWidth():this.getHeight(),"mousedown"!=t.type&&"touchstart"!=t.type||(t.preventDefault(),t.stopPropagation(),this._isScrolling=this._thumbDown=!0,t.touches&&(e=t.touches[0],i=e.pageX,e=e.pageY),t=m.pageXY(t.currentTarget),this._thumbDownPoint=new ra(i-t.x,e-t.y),v.documentAddEvent(r.supportTouch?"touchmove":"mousemove",this._tempGlobalEventHandler,this),v.documentAddEvent(r.supportTouch?"touchend":"mouseup",this._tempGlobalEventHandler,this))},Db.prototype._scrollTrackMoveHandler=function(t){this._isScrolling&&(this._trackPosition=t.touches?"horizontal"==this.direction?t.touches[0].pageX:t.touches[0].pageY:"horizontal"==this.direction?t.offsetX:t.offsetY)},Db.prototype._tempGlobalEventHandler=function(t){if("mouseup"==t.type||"touchend"==t.type)v.documentRemoveEvent(r.supportTouch?"touchmove":"mousemove",this._tempGlobalEventHandler,this),v.documentRemoveEvent(r.supportTouch?"touchend":"mouseup",this._tempGlobalEventHandler,this),this._isScrolling=this._thumbDown=!1;else if(("mousemove"==t.type||"touchmove"==t.type)&&this._thumbDown){var e,i=m.pageXY(this._scrollThumb.element);e="horizontal"==this.direction?this.getWidth()-this.arrowSize-this.thumbSize:this.getHeight()-this.arrowSize-this.thumbSize,"horizontal"==this.direction?(t=t.pageX-i.x,e=Math.round((this.maxScrollPosition-this.minScrollPosition)*(this._scrollThumb.getX()+t-this._thumbDownPoint.x-this.arrowSize)/(e-this.arrowSize))+this.minScrollPosition):(t=t.pageY-i.y,e=Math.round((this.maxScrollPosition-this.minScrollPosition)*(this._scrollThumb.getY()+t-this._thumbDownPoint.y-this.arrowSize)/(e-this.arrowSize))+this.minScrollPosition),this.scrollPosition==e||O(e)||this.setScrollPosition(e)}},z(Ta,u),Ta.prototype.getDirection=function(){return this._direction},Ta.prototype.setDirection=function(t){this._direction!=t.toLowerCase&&(this._direction=t.toLowerCase(),this.invalidateDisplayList())},Ta.prototype.getMaxScrollPosition=function(){return this._maxScrollPosition},Ta.prototype.setMaxScrollPosition=function(t){this._maxScrollPosition=t,this.invalidateDisplayList()},Ta.prototype.getMinScrollPosition=function(){return this._minScrollPosition},Ta.prototype.setMinScrollPosition=function(t){this._minScrollPosition=t,this.invalidateDisplayList()},Ta.prototype.getPageScrollSize=function(){return this._pageScrollSize},Ta.prototype.setPageScrollSize=function(t){this._pageScrollSize=t,this.invalidateDisplayList()},Ta.prototype.getPageSize=function(){return this._pageSize},Ta.prototype.setPageSize=function(t){this._pageSize=t,this.invalidateDisplayList()},Ta.prototype.getScrollPosition=function(){return this._scrollPosition},Ta.prototype.setScrollPosition=function(t){this._scrollPosition=t,t=Math.min(t,this._maxScrollPosition),t=Math.max(t,this._minScrollPosition);var e=this._maxScrollPosition-this._minScrollPosition,i="vertical"===this._direction?this.getHeight():this.getWidth();t=0==e||isNaN(e)?0:(t-this._minScrollPosition)*i/this._correctedPageSize,i=Math.round(this.element["vertical"==this._direction?"scrollTop":"scrollLeft"]/(i/this._correctedPageSize)),isNaN(i)||i==this._scrollPosition||this.isScrolling||(this._scrollByProgram&&(this._scrollByProgram=!1),this.element["vertical"===this._direction?"scrollTop":"scrollLeft"]=t)},Ta.prototype._getScrollPosition=function(){return Math.round(this.element["vertical"===this._direction?"scrollTop":"scrollLeft"]/(("vertical"===this._direction?this.getHeight():this.getWidth())/this._correctedPageSize))},Ta.prototype._setScrollPosition=function(t){var e="vertical"===this._direction?"scrollTop":"scrollLeft",i=this.element[e];this._scrollByProgram&&(this._scrollByProgram=!1),this.element[e]=i+t},Ta.prototype.getNumChildren=function(){return 0},Ta.prototype.setScrollProperties=function(t,e,i,s){if(s=3<arguments.length?s:0,this._pageSize=t,this._pageScrollSize=0<s?s:t,this._minScrollPosition=Math.max(e,0),this._maxScrollPosition=Math.max(i,0),this._scrollPosition=Math.max(this._minScrollPosition,this._scrollPosition),this._scrollPosition=Math.min(this._maxScrollPosition,this._scrollPosition),0<t&&"vertical"!=this._direction&&1==this._maxScrollPosition-this._scrollPosition&&1==Math.abs(this._correctedPageSize-t)||(this._correctedPageSize=t),0<this._maxScrollPosition-this._minScrollPosition&&this._enabled){var n,o="vertical"===this._direction?this.getHeight():this.getWidth();(this._maxScrollPosition-this._minScrollPosition+this._pageSize)*o/this._pageSize>=r.divMaxSize&&(this._correctedPageSize=o),n=this._scrollPosition*o/this._correctedPageSize,"vertical"===this._direction?(m.setPxStyle(this._divElement,"height",(this._maxScrollPosition-this._minScrollPosition+this._correctedPageSize)*o/this._correctedPageSize),this.element.scrollTop!=n&&(this.element.scrollTop=n,this._scrollByProgram=!0)):(m.setPxStyle(this._divElement,"width",(this._maxScrollPosition-this._minScrollPosition+this._correctedPageSize)*o/this._correctedPageSize),this.element.scrollLeft!=n&&(this.element.scrollLeft=n,this._scrollByProgram=!0))}else"vertical"===this._direction?m.setPxStyle(this._divElement,"height",o):m.setPxStyle(this._divElement,"width",o)},Ta.prototype.createChildren=function(){var t;Ta._super.createChildren.call(this),this._divElement||(this._divElement=document.createElement("div"),m.setStyle(this._divElement,"overflow","hidden"),this.element.appendChild(this._divElement),this._divElement.className="Kool__BrowserScrollBarSub","vertical"==this._direction?(t=r.getScrollBarWidth(),this.setWidth(t+1)):(t=r.getScrollBarHeight(),this.setHeight(t+1)),this.addEvent("scroll",this._scrollHandler,this),r.ie||r.safari?(this.addEvent("mousedown",this._mouseDownHandler2,this),this.addEvent("mousemove",this._mouseMoveHandler,this)):(this.addEvent("mousedown",this._mouseDownHandler,this),this.addEvent("mouseup",this._mouseUpHandler,this))),0==t&&m.addClass(this.element,"Kool__"+this.className+"_Auto"),r.ie9&&this.setStyle(r.boxSizing,"content-box")},Ta.prototype.updateDisplayList=function(t,e){Ta._super.updateDisplayList.call(this,t,e),this._divElement&&("vertical"==this._direction?(this.setStyle("overflowY","scroll"),m.setPxStyle(this._divElement,"width",1)):(this.setStyle("overflowX","scroll"),m.setPxStyle(this._divElement,"height",1)),this.setScrollProperties(this._pageSize,this._minScrollPosition,this._maxScrollPosition,this._pageScrollSize),this.setScrollPosition(this._scrollPosition))},Ta.prototype._scrollHandler=function(t){if(this._scrollByProgram)this._scrollByProgram=!1;else{var e=this.element["vertical"==this._direction?"scrollTop":"scrollLeft"]/(("vertical"==this._direction?this.getHeight():this.getWidth())/this._correctedPageSize),e=Math.round(e);e!=this._scrollPosition&&(this._scrollPosition=e>this._maxScrollPosition?this._maxScrollPosition:e,t=new ma(ma.SCROLL,(!1),(!1),this.isScrolling,e,this._direction,t.delta,t),this.dispatchEvent(t))}},Ta.prototype._mouseDownHandler=function(t){this.isScrolling=!0},Ta.prototype._mouseUpHandler=function(t){this.isScrolling&&(this.isScrolling=!1,t=new ma(ma.SCROLL,(!1),(!1),this.isScrolling,this._scrollPosition,this._direction,t.delta,t),this.dispatchEvent(t))},Ta.prototype._mouseDownHandler2=function(t){this.isScrolling=!0,v.documentAddEvent("mousemove",this._mouseMoveHandler,this),v.documentAddEvent("mouseout",this._mouseMoveHandler,this)},Ta.prototype._mouseMoveHandler=function(t){this.isScrolling&&(v.documentRemoveEvent("mousemove",this._mouseMoveHandler,this),v.documentRemoveEvent("mouseout",this._mouseMoveHandler,this),this.isScrolling=!1,t=new ma(ma.SCROLL,(!1),(!1),this.isScrolling,this._scrollPosition,this._direction,t.delta,t),this.dispatchEvent(t))},z(ka,u),ka.prototype.setEnabled=function(t){t!=this._enabled&&(this._enabled=t,this._enabledChanged=!0,this.invalidateProperties())},ka.prototype.getDayNames=function(){return this._dayNames},ka.prototype.setDayNames=function(t){this._dayNames=(this._dayNames=t?t:B.getString("controls","dayNamesShortest").split(","))?this._dayNames.slice(0):null,this._dayNamesChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},ka.prototype.getDisabledDays=function(){var t,e,i=[];for(e=t=0;t<this._disabledDays.length;t++)0<=this._disabledDays[t]&&6>=this._disabledDays[t]&&(i[e]=this._disabledDays[t],e++);return i},ka.prototype.setDisabledDays=function(t){t&&(this._disabledDays=t.slice(0),this._selectedMonthYearChanged=!0,this.invalidateProperties(),this.getSelectedRanges())},ka.prototype.getDisabledRanges=function(){return this._disabledRanges.slice(0)},ka.prototype.setDisabledRanges=function(t){if(t&&ha(t)){this._disabledRanges=t.slice(0),this._disabledRangeMode=[];for(var e=0;e<this._disabledRanges.length;e++)dc(this._disabledRanges[e])?(this._disabledRangeMode[e]=4,this._disabledRanges[e]=new Date(t[e].getFullYear(),t[e].getMonth(),t[e].getDate())):Ea(this._disabledRanges[e])&&(this._disabledRanges[e]={},this._disabledRanges[e]=t[e],!this._disabledRanges[e].rangeStart&&this._disabledRanges[e].rangeEnd?this._disabledRangeMode[e]=3:this._disabledRanges[e].rangeStart&&!this._disabledRanges[e].rangeEnd?this._disabledRangeMode[e]=2:this._disabledRanges[e].rangeStart&&this._disabledRanges[e].rangeEnd&&(this._disabledRangeMode[e]=1));this._selectedMonthYearChanged=!0,this.invalidateProperties(),this.getSelectedRanges()}},ka.prototype.getDisplayedMonth=function(){return-1==this._proposedDisplayedMonth?this._displayedMonth:this._proposedDisplayedMonth},ka.prototype.setDisplayedMonth=function(t){isNaN(t)||0>t||11<t||this._displayedMonth==t||(this._proposedDisplayedMonth=t,this._selectedMonthYearChanged=!0,this.invalidateProperties())},ka.prototype.getDisplayedYear=function(){return-1==this._proposedDisplayedYear?this._displayedYear:this._proposedDisplayedYear},ka.prototype.setDisplayedYear=function(t){isNaN(t)||this._displayedYear==t||(this._proposedDisplayedYear=t,this._selectedMonthYearChanged=!0,this.invalidateProperties())},ka.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},ka.prototype.setFirstDayOfWeek=function(t){0>t||6<t||t==this._firstDayOfWeek||(this._firstDayOfWeek=t,this._selectedMonthYearChanged=this._dayNamesChanged=!0,this.invalidateProperties())},ka.prototype.getSelectableRange=function(){return this._selectableRange},ka.prototype.setSelectableRange=function(t){if(t){var e,i,s=new Date,r=s.getMonth(),n=s.getFullYear();dc(t)?(this._selRangeMode=4,this._selectableRange=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e=t.getMonth(),i=t.getFullYear()):Ea(t)&&(this._selectableRange={},!t.rangeStart&&t.rangeEnd?(this._selRangeMode=3,this._selectableRange.rangeEnd=t.rangeEnd,n<=this._selectableRange.rangeEnd.getFullYear()?r>=this._selectableRange.rangeEnd.getMonth()?(e=this._selectableRange.rangeEnd.getMonth(),i=this._selectableRange.rangeEnd.getFullYear()):r<=this._selectableRange.rangeEnd.getMonth()&&(e=r,i=n):n>this._selectableRange.rangeEnd.getFullYear()&&(e=this._selectableRange.rangeEnd.getMonth(),i=this._selectableRange.rangeEnd.getFullYear())):!t.rangeEnd&&t.rangeStart?(this._selRangeMode=2,this._selectableRange.rangeStart=t.rangeStart,n>=this._selectableRange.rangeStart.getFullYear()?r<=this._selectableRange.rangeStart.getMonth()?(e=this._selectableRange.rangeStart.getMonth(),i=this._selectableRange.rangeStart.getFullYear()):r>=this._selectableRange.rangeStart.getMonth()&&(e=r,i=n):n<this._selectableRange.rangeStart.getFullYear()&&(e=this._selectableRange.rangeStart.getMonth(),i=this._selectableRange.rangeStart.getFullYear())):t.rangeStart&&t.rangeEnd&&(this._selRangeMode=1,this._selectableRange.rangeStart=t.rangeStart,this._selectableRange.rangeEnd=t.rangeEnd,s>=this._selectableRange.rangeStart&&s<=this._selectableRange.rangeEnd?(e=r,i=n):s<this._selectableRange.rangeStart?(e=this._selectableRange.rangeStart.getMonth(),i=this._selectableRange.rangeStart.getFullYear()):s>this._selectableRange.rangeEnd&&(e=this._selectableRange.rangeEnd.getMonth(),i=this._selectableRange.rangeEnd.getFullYear()))),this._displayedMonth=e,this._displayedYear=i,this._selectedMonthYearChanged=!0,this.invalidateProperties(),this.getSelectedRanges()}else this._selectableRange=null,this._selectedMonthYearChanged=!0,this.invalidateProperties()},ka.prototype.getSelectedDate=function(){return this._selectedRangeCount?this._selectedRanges[0].rangeStart:null},ka.prototype.setSelectedDate=function(t){this._selectedRangeCount=0,t&&!this._checkDateIsDisabled(t)?(this._addToSelected(t),this._displayedMonth=t.getMonth(),this._displayedYear=t.getFullYear(),this._selectedMonthYearChanged=!0,this.invalidateProperties()):this._setSelectedIndicators()},ka.prototype.getSelectedRanges=function(){var t;if(this._selectableRange)switch(this._selRangeMode){case 1:this._removeRangeFromSelection(null,this._selectableRange.rangeStart),this._removeRangeFromSelection(this._selectableRange.rangeEnd,null);break;case 2:case 3:this._removeRangeFromSelection(this._selectableRange.rangeEnd,this._selectableRange.rangeStart);break;case 4:this._removeRangeFromSelection(null,this._selectableRange),this._removeRangeFromSelection(this._selectableRange,null)}for(t=0;t<this._disabledRanges.length;t++)switch(this._disabledRangeMode[t]){case 1:case 2:case 3:this._removeRangeFromSelection(this._disabledRanges[t].rangeStart,this._disabledRanges[t].rangeEnd);break;case 4:this._removeRangeFromSelection(this._disabledRanges[t],this._disabledRanges[t])}if(0<this._disabledDays.length&&this._selectedRangeCount){var e=this._selectedRanges[0].rangeStart,i=this._selectedRanges[0].rangeEnd;for(t=1;t<this._selectedRangeCount;t++)e>this._selectedRanges[t].rangeStart&&(e=this._selectedRanges[t].rangeStart),i<this._selectedRanges[t].rangeEnd&&(i=this._selectedRanges[t].rangeEnd);for(t=0;t<this._disabledDays.length;t++){var s=e,r=this._disabledDays[t]-s.getDay();for(0>r&&(r+=7),s=this._incrementDate(s,r);s<i;)this._removeRangeFromSelection(s,s),s=this._incrementDate(s,7)}}return this._selectedRanges.length=this._selectedRangeCount,this._selectedRanges},ka.prototype.setSelectedRanges=function(t){this._selectedRanges=t,this._selectedRangeCount=this._selectedRanges.length,this._setSelectedIndicators()},ka.prototype.getShowToday=function(){return this._showToday},ka.prototype.setShowToday=function(t){this._showToday=t,this._selectedMonthYearChanged=!0,this.invalidateProperties()},ka.prototype._createDayLabels=function(t){t=this.element;var e,i,s,r,n;if(0<t.childNodes.length)for(;t.firstChild;)t.removeChild(t.firstChild);var o=this.measureText("W").width+.5;for(this._trNodes=[],this._tdNodes=[],this._dayBlocksArray=[],e=document.createElement("tbody"),r=0;7>r;r++){for(i=document.createElement("tr"),i.selfElement=this,this._trNodes[r]=i,this._tdNodes[r]=[],n=0;7>n;n++)s=document.createElement("td"),s.style.minWidth=o+"px",s.selfElement=this,i.appendChild(s),this._tdNodes[r][n]=s;0==r&&m.addClass(i,"Kool__"+this.className+"_WeekDay"),e.appendChild(i)}for(t.appendChild(e),n=0;7>n;n++){for(this._dayBlocksArray[n]=[],this._selectionIndicator[n]=[],r=0;7>r;r++)this._dayBlocksArray[n][r]=this._tdNodes[r][n];this._disabledArrays[n]=Array(7)}},ka.prototype._drawDayNames=function(){for(var t=0;7>t;t++){var e=(t+this._firstDayOfWeek)%7;this._dayBlocksArray[t][0].innerHTML=this._dayNames?this._dayNames[e]:""}},ka.prototype._isDateInRange=function(t,e,i,s){s=3<arguments.length&&s;var r=!0;if(e){if(s){var n={};if(e.rangeStart){var o=e.rangeStart;n.rangeStart=new Date(o.fullYear,o.month,1)}e.rangeEnd&&(o=e.rangeEnd,n.rangeEnd=new Date(o.fullYear,o.month,this._getNumberOfDaysInMonth(o.fullYear,o.month))),e=n}switch(i){case 1:(t<e.rangeStart||t>e.rangeEnd)&&(r=!1);break;case 2:t<e.rangeStart&&(r=!1);break;case 3:t>e.rangeEnd&&(r=!1);break;case 4:(t>e||t<e)&&(r=!1)}}return r},ka.prototype._setSelectedMonthAndYear=function(t,e){t=0<arguments.length?t:-1,e=1<arguments.length?e:-1;var i,s,r,n,o=!1,a=-1==t?this.getDisplayedMonth():t,l=-1==e?this.getDisplayedYear():e,h=this._getOffsetOfMonth(l,a),d=this._getNumberOfDaysInMonth(l,a),c=new Date,_=c.getFullYear()==l&&c.getMonth()==a;for(this._todayIndicator&&m.removeClass(this._todayIndicator,"Kool__"+this.className+"_Today"),i=new Date(l,Math.max(a-1,0),1),this._getNumberOfDaysInMonth(i.getFullYear(),i.getMonth()),r=1,s=0;s<h;s++)this._dayBlocksArray[s][r].innerHTML="",this._disabledArrays[s][r]=!0,this._removeSelectionIndicator(s,r);for(i=1;i<=d;i++){var u=new Date(l,a,i);if(n=h+i-1,s=n%7,r=1+Math.floor(n/7),n=this._dayBlocksArray[s][r],n.innerHTML=i.toString(),this._enabled&&(this._disabledArrays[s][r]=!1,m.removeClass(n,"Kool__"+this.className+"_Disabled"),this._todayIndicator&&o&&m.removeClass(this._todayIndicator,"Kool__"+this.className+"_Disabled")),_&&u.getDate()==c.getDate()&&this._showToday?(this._todayRow=r,this._todayColumn=s,o=!0,this._todayIndicator=n,m.addClass(this._todayIndicator,"Kool__"+this.className+"_Today")):o||this._todayIndicator&&m.removeClass(this._todayIndicator,"Kool__"+this.className+"_Today"),this._selectableRange&&!this._isDateInRange(u,this._selectableRange,this._selRangeMode)&&(m.addClass(n,"Kool__"+this.className+"_Disabled"),this._disabledArrays[s][r]=!0),0<this._disabledRanges.length)for(var p=0;p<this._disabledRanges.length;p++)this._isDateInRange(u,this._disabledRanges[p],this._disabledRangeMode[p])&&(m.addClass(n,"Kool__"+this.className+"_Disabled"),this._disabledArrays[s][r]=!0)}for(n=h+d;42>n;n++)s=n%7,r=1+Math.floor(n/7),this._dayBlocksArray[s][r].innerHTML="",this._disabledArrays[s][r]=!0,this._removeSelectionIndicator(s,r);if(0<this._disabledDays.length)for(n=0;n<this._disabledDays.length;n++)if(0<=this._disabledDays[n]&&6>=this._disabledDays[n]&&-1!=this._disabledDays[n])for(s=(7+this._disabledDays[n]-this._firstDayOfWeek)%7,r=1;7>r;r++)this._disabledArrays[s][r]=!0,isNaN(Number(this._dayBlocksArray[s][r].innerHTML)),m.addClass(this._dayBlocksArray[s][r],"Kool__"+this.className+"_Disabled");this._displayedMonth=a,this._displayedYear=l,this._setSelectedIndicators(),this.invalidateDisplayList()},ka.prototype._getOffsetOfMonth=function(t,e){var i=new Date(t,e,1).getDay()-this._firstDayOfWeek;return 0>i?i+7:i},ka.prototype._getNumberOfDaysInMonth=function(t,e){return 1==e?0==t%4&&0!=t%100||0==t%400?29:28:3==e||5==e||8==e||10==e?30:31},ka.prototype._setSelectedIndicators=function(){var t,e,i,s=this._getOffsetOfMonth(this.getDisplayedYear(),this.getDisplayedMonth()),r=this._getNumberOfDaysInMonth(this.getDisplayedYear(),this.getDisplayedMonth());for(i=1;i<=r;i++){var n=new Date(this.getDisplayedYear(),this.getDisplayedMonth(),i);e=s+i-1,t=e%7,e=1+Math.floor(e/7),this._isSelected(n)&&0==this._disabledArrays[t][e]?this._addSelectionIndicator(t,e):this._removeSelectionIndicator(t,e);
}},ka.prototype._stepDate=function(t,e,i){var s=this.getDisplayedYear(),r=this.getDisplayedMonth();e=this._getNewIncrementDate(s,r,t,e),t=e.year,this._displayedMonth=e=e.month,this._displayedYear=t,this._selectedMonthYearChanged=!0,this.invalidateProperties();var n=new od(od.SCROLL);n.triggerEvent=i,t>s?n.detail="nextYear":t<s?n.detail="previousYear":e>r?n.detail="nextMonth":e<r&&(n.detail="previousMonth"),this.dispatchEvent(n)},ka.prototype._getNewIncrementDate=function(t,e,i,s){for(t+=i,e+=s;0>e;)t--,e+=12;for(;11<e;)t++,e-=12;return{month:e,year:t}},ka.prototype._dispatchChangeEvent=function(t){var e=new Ib(Ib.CHANGE);e.newDate=this._lastSelectedDate,e.triggerEvent=t,this.dispatchEvent(e)},ka.prototype._checkDateIsDisabled=function(t){if(!t)return!1;var e,i=!1;if(this._selectableRange&&(this._isDateInRange(t,this._selectableRange,this._selRangeMode)||(i=!0)),0<this._disabledRanges.length)for(e=0;e<this._disabledRanges.length;e++)this._isDateInRange(t,this._disabledRanges[e],this._disabledRangeMode[e])&&(i=!0);if(0<this._disabledDays.length)for(e=0;e<this._disabledDays.length;e++)t.getDay()==this._disabledDays[e]&&(i=!0);return i},ka.prototype._addToSelected=function(t,e){if(e=1<arguments.length&&e,this._selectedRangeCount||(this._rangeStartDate=null),this._lastSelectedDate=t,0==e)this._selectedRanges[this._selectedRangeCount]={},this._selectedRanges[this._selectedRangeCount].rangeStart=new Date(t),this._selectedRanges[this._selectedRangeCount].rangeEnd=this._selectedRanges[this._selectedRangeCount].rangeStart,this._selectedRangeCount++;else{if(0==this._selectedRangeCount)this._selectedRanges[0]={},this._selectedRanges[0].rangeStart=new Date(t);else if(this._selectedRangeCount=1,this._rangeStartDate||(this._rangeStartDate=this._selectedRanges[0].rangeStart),this._selectedRanges[0].rangeStart=new Date(this._rangeStartDate),t<this._selectedRanges[0].rangeStart)return this._selectedRanges[0].rangeEnd=this._selectedRanges[0].rangeStart,void(this._selectedRanges[0].rangeStart=new Date(t));this._selectedRanges[0].rangeEnd=new Date(t)}},ka.prototype._incrementDate=function(t,e){e=1<arguments.length?e:1;var i=new Date(t),s=i.getTime();return i.setTime(s+864e5*e),i},ka.prototype._isSelected=function(t){var e;for(e=0;e<this._selectedRangeCount;e++)if(t>=this._selectedRanges[e].rangeStart&&t<=this._selectedRanges[e].rangeEnd)return!0;return!1},ka.prototype._removeRangeFromSelection=function(t,e){var i,s;for(i=0;i<this._selectedRangeCount;i++)switch(!t||t<=this._selectedRanges[i].rangeStart?s=1:t<=this._selectedRanges[i].rangeEnd?s=2:t>this._selectedRanges[i].rangeEnd&&(s=3),e<this._selectedRanges[i].rangeStart?s*=5:e<this._selectedRanges[i].rangeEnd?s*=7:(!e||e>=this._selectedRanges[i].rangeEnd)&&(s*=11),s){case 14:var r=this._selectedRanges[i].rangeEnd;this._selectedRanges[i].rangeEnd=this._incrementDate(t,-1),this._selectedRanges[this._selectedRangeCount]={},this._selectedRanges[this._selectedRangeCount].rangeStart=this._incrementDate(e),this._selectedRanges[this._selectedRangeCount].rangeEnd=r,this._selectedRangeCount+=1;break;case 7:this._selectedRanges[i].rangeStart=this._incrementDate(e);break;case 22:this._selectedRanges[i].rangeEnd=this._incrementDate(t,-1);break;case 11:this._selectedRanges[i]=this._selectedRanges[this._selectedRangeCount-1],this._selectedRanges[this._selectedRangeCount-1]=null,--this._selectedRangeCount}},ka.prototype._addSelectionIndicator=function(t,e){if(!this._selectionIndicator[t][e]){var i=this._dayBlocksArray[t][e];i&&(this._selectionIndicator[t][e]=i)}m.addClass(this._selectionIndicator[t][e],"Kool__"+this.className+"_Selected")},ka.prototype._removeSelectionIndicator=function(t,e){this._selectionIndicator[t][e]&&(m.removeClass(this._selectionIndicator[t][e],"Kool__"+this.className+"_Selected"),this._selectionIndicator[t][e]=null)},ka.prototype._removeSelectionIndicators=function(){for(var t=0;7>t;t++)for(var e=0;7>e;e++)this._removeSelectionIndicator(t,e)},ka.prototype.createChildren=function(){ka._super.createChildren.call(this),this._dayNames=B.getString("controls","dayNamesShortest").split(","),this._createDayLabels(-1),this._selectedMonthYearChanged=this._dayNamesChanged=!0,this.element.tabIndex=0,this.addEvent("mouseup",this._mouseUpHandler,this),this.addEvent("mouseover",this._mouseOverHandler,this),this.addEvent("mouseout",this._mouseOutHandler,this),this.addEvent("keydown",this._keyDownHandler,this)},ka.prototype.commitProperties=function(){if(ka._super.commitProperties.call(this),this._enabledChanged){for(var t=0;7>t;t++)for(var e=0;7>e;e++)this._enabled?m.removeClass(this._dayBlocksArray[t][e],"Kool__"+this.className+"_Disabled"):m.addClass(this._dayBlocksArray[t][e],"Kool__"+this.className+"_Disabled"),this._disabledArrays[t][e]=this._enabled;this._enabled?(this._selectedMonthYearChanged=!0,this.addEvent("mouseup",this._mouseUpHandler,this),this.addEvent("mouseover",this._mouseOverHandler,this),this.addEvent("mouseout",this._mouseOutHandler,this),this.addEvent("mousemove",this._mouseMoveHandler,this)):(this.removeEvent("mouseup",this._mouseUpHandler,this),this.removeEvent("mouseover",this._mouseOverHandler,this),this.removeEvent("mouseout",this._mouseOutHandler,this),this.removeEvent("mousemove",this._mouseMoveHandler,this)),this._enabledChanged=!1}this._dayNamesChanged&&(this._dayNamesChanged=!1,this._drawDayNames()),this._selectedMonthYearChanged&&(this._selectedMonthYearChanged=!1,this._isDateInRange(new Date(-1==this._proposedDisplayedYear?this._displayedYear:this._proposedDisplayedYear,-1==this._proposedDisplayedMonth?this._displayedMonth:this._proposedDisplayedMonth),this._selectableRange,this._selRangeMode,!0)&&this._setSelectedMonthAndYear(),this._proposedDisplayedMonth=this._proposedDisplayedYear=-1)},ka.prototype.measure=function(){ka._super.measure.call(this);var t=m.getOffsetWidth(this.element),e=m.getOffsetHeight(this.element);this.measuredWidth=this.measuredMinWidth=t,this.measuredHeight=this.measuredMinHeight=e},ka.prototype._keyDownHandler=function(t){var e,i=!1,s=this._lastSelectedDate?this._lastSelectedDate.getDate():1,r=this._getNumberOfDaysInMonth(this.getDisplayedYear(),this.getDisplayedMonth());for(e=0;31>e;e++){if(37==t.keyCode){if(!(1<s))break;s--,i=!0}else if(39==t.keyCode){if(!(s<r))break;s++,i=!0}else if(38==t.keyCode){if(!(7<s))break;s-=7,i=!0}else if(40==t.keyCode){if(!(s+7<=r))break;s+=7,i=!0}else 36==t.keyCode?(0==e?s=1:s++,i=!0):35==t.keyCode?(0==e?s=r:s--,i=!0):!this._lastSelectedDate||33!=t.keyCode&&34!=t.keyCode?!this._lastSelectedDate||189!=t.keyCode&&187!=t.keyCode&&109!=t.keyCode&&107!=t.keyCode||(i=!0):i=!0;if(33<=t.keyCode&&40>=t.keyCode&&(t.stopPropagation(),t.preventDefault()),i){var n=new Date(this.getDisplayedYear(),this.getDisplayedMonth(),s);if(!this._checkDateIsDisabled(n)||t.shiftKey){t.shiftKey&&this.allowMultipleSelection||(this._selectedRangeCount=0),this._addToSelected(n,t.shiftKey&&this.allowMultipleSelection),this._setSelectedIndicators(),this._dispatchChangeEvent(t);break}}}},ka.prototype._mouseOverHandler=function(t){(t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null)==this?this.addEvent("mousemove",this._mouseMoveHandler,this):(t.stopImmediatePropagation(),t.preventDefault())},ka.prototype._mouseOutHandler=function(t){(t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null)==this?(this.removeEvent("mousemove",this._mouseMoveHandler,this),this._rollOverIndicator&&m.removeClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver")):(t.stopImmediatePropagation(),t.preventDefault())},ka.prototype._mouseMoveHandler=function(t){var e=m.getPaddingMetrics(this),i=this.getWidth(),s=this.getHeight(),r=Math.max((i-(e.left+e.right))/7,4),s=Math.max((s-e.bottom)/(5>this._trNodes[6].offsetHeight?6:7),4),n=e.left,i=i-e.right-r,o=e.top+s,a=new ra(t.pageX,t.pageY),a=this.globalToLocal(a);t=a.y,a=a.x,a<n||a>i+r||t<o||(s=Math.floor((t-e.top)/s),e=Math.floor((a-e.left)/r),e=Math.min(e,6),s=Math.min(s,6),r=this._dayBlocksArray[e][s],!this._disabledArrays[e][s]&&0!=s&&r&&(this._rollOverIndicator&&m.removeClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver"),this._rollOverIndicator=r,this._selectionIndicator[e][s]||m.addClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver")))},ka.prototype._mouseUpHandler=function(t){var e=m.getPaddingMetrics(this),i=this.getWidth(),s=this.getHeight(),r=Math.max((i-(e.left+e.right))/7,4),s=Math.max((s-e.bottom)/(5>this._trNodes[6].offsetHeight?6:7),4),n=e.left,i=i-e.right-r,o=e.top+s,a=new ra(t.pageX,t.pageY),a=this.globalToLocal(a),l=a.y,a=a.x;a<n||a>i+r||l<o||(s=Math.floor((l-e.top)/s),e=Math.floor((a-e.left)/r),e=Math.min(e,6),s=Math.min(s,6),r=this._dayBlocksArray[e][s],!this._disabledArrays[e][s]&&0!=s&&r&&(r=new Date(this.getDisplayedYear(),this.getDisplayedMonth(),Number(r.innerHTML)),t.shiftKey&&this.allowMultipleSelection?(this._addToSelected(r,!0),this._setSelectedIndicators()):(n=!!this._selectionIndicator[e][s],t.ctrlKey&&this.allowMultipleSelection&&this.allowDisjointSelection?n?(this._removeSelectionIndicator(e,s),this._removeRangeFromSelection(r,r)):(this._addSelectionIndicator(e,s),this._addToSelected(r)):(this._rangeStartDate=null,n?1<this._selectedRangeCount||1==this._selectedRangeCount&&this._selectedRanges[0].rangeStart!=this._selectedRanges[0].rangeEnd?(this._selectedRangeCount=0,this._addSelectionIndicator(e,s),this._addToSelected(r),this._setSelectedIndicators()):t.ctrlKey&&(this._removeSelectionIndicator(e,s),this._removeRangeFromSelection(r,r)):(this._selectedRangeCount=0,this._addSelectionIndicator(e,s),this._addToSelected(r),this._setSelectedIndicators()))),this._dispatchChangeEvent(t),this._selectionIndicator[e][s]&&m.removeClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver")))},z(ba,u),ba.prototype.setEnabled=ka.prototype.setEnabled,ba.prototype.getAllowDisjointSelection=function(){return this._allowDisjointSelection},ba.prototype.setAllowDisjointSelection=function(t){this._allowDisjointSelection!=t&&(this._allowDisjointSelection=t,this._allowDisjointSelectionChanged=!0,this.invalidateProperties())},ba.prototype.getAllowMultipleSelection=function(){return this._allowMultipleSelection},ba.prototype.setAllowMultipleSelection=function(t){this._allowMultipleSelection!=t&&(this._allowMultipleSelection=t,this._allowMultipleSelectionChanged=!0,this.invalidateProperties())},ba.prototype.getDayNames=function(){return this._dayNames},ba.prototype.setDayNames=function(t){this._dayNames=(this._dayNames=t?t:B.getString("controls","dayNamesShortest").split(","))?this._dayNames.slice(0):null,this._dayNamesChanged=!0,this.invalidateProperties()},ba.prototype.getDisabledDays=function(){return this._disabledDays},ba.prototype.setDisabledDays=function(t){this._disabledDays=t,this._disabledDaysChanged=!0,this.invalidateProperties()},ba.prototype.getDisabledRanges=function(){return this._disabledRanges},ba.prototype.setDisabledRanges=function(t){this._disabledRanges=this._scrubTimeValues(t),this._disabledRangesChanged=!0,this.invalidateProperties()},ba.prototype.getDisplayedMonth=function(){return this._dateGrid&&this._displayedMonth!=this._dateGrid.getDisplayedMonth()?this._dateGrid.getDisplayedMonth():this._displayedMonth},ba.prototype.setDisplayedMonth=function(t){isNaN(t)||this.getDisplayedMonth()==t||(this._displayedMonth=t,this._displayedMonthChanged=!0,this.invalidateProperties(),this._dateGrid&&this._dateGrid.setDisplayedMonth(t))},ba.prototype.getDisplayedYear=function(){return this._dateGrid?this._dateGrid.getDisplayedYear():this._displayedYear},ba.prototype.setDisplayedYear=function(t){isNaN(t)||this.getDisplayedYear()==t||(this._displayedYear=t,this._displayedYearChanged=!0,this.invalidateProperties(),this._dateGrid&&this._dateGrid.setDisplayedYear(t))},ba.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},ba.prototype.setFirstDayOfWeek=function(t){0>t||6<t||t==this._firstDayOfWeek||(this._firstDayOfWeek=null!=t?Number(t):B.getNumber("controls","firstDayOfWeek"),this._firstDayOfWeekChanged=!0,this.invalidateProperties())},ba.prototype.getMaxYear=function(){return this._maxYear},ba.prototype.setMaxYear=function(t){isNaN(t)||this._maxYear==t||(this._maxYear=t)},ba.prototype.getMinYear=function(){return this._minYear},ba.prototype.setMinYear=function(t){isNaN(t)||this._minYear==t||(this._minYear=t)},ba.prototype.getMonthNames=function(){return this._monthNames},ba.prototype.setMonthNames=function(t){this._monthNames=(this._monthNames=t?t:B.getString("formatters","monthNamesShort").split(","))?this._monthNames.slice(0):null,this._monthNamesChanged=!0,this.invalidateProperties(),this.invalidateSize()},ba.prototype.getMonthSymbol=function(){return this._monthSymbol},ba.prototype.setMonthSymbol=function(t){this._monthSymbol=null!=t?t:B.getString("shared","monthSymbol"),this.invalidateSize(),this.invalidateDisplayList()},ba.prototype.getSelectableRange=function(){return this._selectableRange},ba.prototype.setSelectableRange=function(t){this._selectableRange=this._scrubTimeValue(t),this._selectableRangeChanged=!0,this.invalidateProperties()},ba.prototype.getSelectedDate=function(){return this._selectedDate=this._dateGrid?this._dateGrid.getSelectedDate():this._selectedDate},ba.prototype.setSelectedDate=function(t){this._selectedDate=this._scrubTimeValue(t),this._selectedDateChanged=!0,this.invalidateProperties()},ba.prototype.getSelectedRanges=function(){return this._selectedRanges=this._dateGrid.getSelectedRanges()},ba.prototype.setSelectedRanges=function(t){this._selectedRanges=this._scrubTimeValues(t),this._selectedRangesChanged=!0,this.invalidateProperties()},ba.prototype.getShowToday=function(){return this._showToday},ba.prototype.setShowToday=function(t){this._showToday=t,this._showTodayChanged=!0,this.invalidateProperties()},ba.prototype.getYearNavigationEnabled=function(){return this._yearNavigationEnabled},ba.prototype.setYearNavigationEnabled=function(t){this._yearNavigationEnabled=t,this._yearNavigationEnabledChanged=!0,this.invalidateProperties()},ba.prototype.getYearSymbol=function(){return this._yearSymbol},ba.prototype.setYearSymbol=function(t){this._yearSymbol=null!=t?t:B.getString("shared","yearSymbol"),this.invalidateSize(),this.invalidateDisplayList()},ba.prototype._yearBeforeMonth=function(t){var e,i=t?t.length:0;for(e=0;e<i&&"M"!=t.charAt(e);e++)if("Y"==t.charAt(e))return!0;return!1},ba.prototype._scrubTimeValue=function(t){if(dc(t))return new Date(t.getFullYear(),t.getMonth(),t.getDate());if(Ea(t)){var e={};return t.rangeStart&&(e.rangeStart=new Date(t.rangeStart.getFullYear(),t.rangeStart.getMonth(),t.rangeStart.getDate())),t.rangeEnd&&(e.rangeEnd=new Date(t.rangeEnd.getFullYear(),t.rangeEnd.getMonth(),t.rangeEnd.getDate())),e}return null},ba.prototype._scrubTimeValues=function(t){var e,i=[];for(e=0;e<t.length;e++)i[e]=this._scrubTimeValue(t[e]);return i},ba.prototype._updateDateDisplay=function(){var t=B.getString("shared","dateFormat"),t=this._yearBeforeMonth(t),e=this._monthNames?this._monthNames[this._dateGrid.getDisplayedMonth()]:"";this._tdNodes[0][t?1:2].innerHTML="<div class='Kool__"+this.className+"_Year'>"+this.getDisplayedYear()+this.getYearSymbol()+"</div>",this._tdNodes[0][t?2:1].innerHTML="<div class='Kool__"+this.className+"_Month'>"+e+this.getMonthSymbol()+"</div>"},ba.prototype.createChildren=function(){var t,e,i,s;for(ba._super.createChildren.call(this),this._dayNames=B.getString("controls","dayNamesShortest").split(","),this._monthNames=B.getString("formatters","monthNamesShort").split(","),this._firstDayOfWeek=B.getNumber("controls","firstDayOfWeek"),this._monthSymbol=B.getString("shared","monthSymbol"),this._yearSymbol=B.getString("shared","yearSymbol"),this._trNodes=[],this._tdNodes=[],t=document.createElement("tbody"),e=document.createElement("tr"),e.selfElement=this,this._trNodes[0]=e,this._tdNodes[0]=[],s=0;5>s;s++)i=document.createElement("td"),i.selfElement=this,e.appendChild(i),this._tdNodes[0][s]=i;m.addClass(e,"Kool__"+this.className+"_Header"),t.appendChild(e),e=document.createElement("tr"),e.selfElement=this,this._trNodes[1]=e,this._tdNodes[1]=[],i=document.createElement("td"),i.selfElement=this,i.colSpan=5,e.appendChild(i),this._tdNodes[1][0]=i,i.innerHTML="<div class='Kool__"+this.className+"_Line'></div>",t.appendChild(e),e=document.createElement("tr"),e.selfElement=this,this._trNodes[2]=e,this._tdNodes[2]=[],i=document.createElement("td"),i.selfElement=this,i.colSpan=5,e.appendChild(i),this._tdNodes[2][0]=i,t.appendChild(e),this.element.appendChild(t),this._tdNodes[0][0].innerHTML="<img id='"+this.name+"_BackMonth' src='"+Ma+"left.png'>",this._tdNodes[0][4].innerHTML="<img id='"+this.name+"_FwdMonth' src='"+Ma+"right.png'>",this._yearNavigationEnabled&&(this._tdNodes[0][3].innerHTML="<table style='font-size:3px' cellpadding='0' cellspacing='0'><tr><td><img id='"+this.name+"_UpYear' src='"+Ma+"arrow_up.png'></td></tr><tr><td><img id='"+this.name+"_DownYear' src='"+Ma+"arrow_down.png'></td></tr></table>"),this._dateGrid||(this._dateGrid=new ka,this._tdNodes[2][0].appendChild(this._dateGrid.element),this._dateGrid.parentElement=this,this._dateGrid._parent=this,this._dateGrid.setNestLevel(this._nestLevel+1),this._dateGrid.initialize(),this._dateGrid.addEventListener(Ib.CHANGE,this._dateGrid_changeHandler,this),this._dateGrid.addEventListener(od.SCROLL,this._dateGrid_scrollHandler,this)),this.addEvent("mouseup",this._mouseUpHandler,this),this.addEvent("mousedown",this._mouseEventHandler,this),this.addEvent("mousemove",this._mouseEventHandler,this),this.addEvent("keydown",this._keyDownHandler,this)},ba.prototype.commitProperties=function(){ba._super.commitProperties.call(this),this._showTodayChanged&&(this._showTodayChanged=!1,this._dateGrid.setShowToday(this._showToday)),this._enabledChanged&&(this._enabledChanged=!1,this._dateGrid.setEnabled(this._enabled)),this._firstDayOfWeekChanged&&(this._firstDayOfWeekChanged=!1,this._dateGrid.setFirstDayOfWeek(Number(this._firstDayOfWeek))),this._displayedMonthChanged&&(this._displayedMonthChanged=!1,this._dateGrid.setDisplayedMonth(this._displayedMonth),this.invalidateDisplayList()),this._displayedYearChanged&&(this._displayedYearChanged=!1,this._dateGrid.setDisplayedYear(this._displayedYear),this.invalidateDisplayList()),this._dayNamesChanged&&(this._dayNamesChanged=!1,this._dateGrid.setDayNames(this._dayNames?this._dayNames.slice(0):null)),this._disabledDaysChanged&&(this._disabledDaysChanged=!1,this._dateGrid.setDisabledDays(this._disabledDays.slice(0))),this._selectableRangeChanged&&(this._selectableRangeChanged=!1,this._dateGrid.setSelectableRange(ha(this._selectableRange)?this._selectableRange.slice(0):this._selectableRange),this.invalidateDisplayList()),this._disabledRangesChanged&&(this._disabledRangesChanged=!1,this._dateGrid.setDisabledRanges(this._disabledRanges.slice(0))),this._selectedDateChanged&&(this._selectedDateChanged=!1,this._dateGrid.setSelectedDate(this._selectedDate),this.invalidateDisplayList()),this._selectedRangesChanged&&(this._selectedRangesChanged=!1,this._dateGrid.setSelectedRanges(this._selectedRanges),this.invalidateDisplayList()),this._allowMultipleSelectionChanged&&(this._allowMultipleSelectionChanged=!1,this._dateGrid.allowMultipleSelection=this._allowMultipleSelection,this.invalidateDisplayList()),this._allowDisjointSelectionChanged&&(this._allowDisjointSelectionChanged=!1,this._dateGrid.allowDisjointSelection=this._allowDisjointSelection,this.invalidateDisplayList()),this._monthNamesChanged&&(this._monthNamesChanged=!1,this._tdNodes[0][2].innerHTML="<div class='Kool__"+this.className+"_Month'>"+this.getDisplayedMonth()+this.getMonthSymbol()+"</div>",this.invalidateDisplayList()),this._yearNavigationEnabledChanged&&(this._tdNodes[0][3].innerHTML=this._yearNavigationEnabled?"<table style='font-size:3px' cellpadding='0' cellspacing='0'><tr><td><img src='"+Ma+"arrow_up.png'></td></tr><tr><td><img src='"+Ma+"arrow_down.png'></td></tr></table>":"",this._yearNavigationEnabledChanged=!1,this.invalidateSize(),this.invalidateDisplayList())},ba.prototype.measure=function(){ba._super.measure.call(this),this._updateDateDisplay();var t=m.getOffsetWidth(this.element),e=m.getOffsetHeight(this.element);this.measuredWidth=this.measuredMinWidth=t,this.measuredHeight=this.measuredMinHeight=e},ba.prototype.updateDisplayList=function(t,e){ba._super.updateDisplayList.call(this,t,e),this._updateDateDisplay()},ba.prototype._upYearButton_buttonDownHandler=function(t){if(!(this._maxYear<this.getDisplayedYear()+1))if(!this._selectableRange||1!=this._dateGrid._selRangeMode&&3!=this._dateGrid._selRangeMode)4==this._dateGrid._selRangeMode&&this._selectableRange||(this._dateGrid._stepDate(1,0,t),this.invalidateDisplayList());else{var e=ka.prototype._getNewIncrementDate(this.getDisplayedYear(),this.getDisplayedMonth(),0,1),e=new Date(e.year,e.month,this._selectableRange.rangeEnd.getDate());this._selectableRange.rangeEnd>=e&&(this._dateGrid._stepDate(1,0,t),this.invalidateDisplayList())}},ba.prototype._downYearButton_buttonDownHandler=function(t){if(!(this._minYear>this.getDisplayedYear()-1))if(!this._selectableRange||1!=this._dateGrid._selRangeMode&&2!=this._dateGrid._selRangeMode)4==this._dateGrid._selRangeMode&&this._selectableRange||(this._dateGrid._stepDate(-1,0,t),this.invalidateDisplayList());else{var e=ka.prototype._getNewIncrementDate(this.getDisplayedYear(),this.getDisplayedMonth(),-1,0),e=new Date(e.year,e.month,this._selectableRange.rangeStart.getDate());this._selectableRange.rangeStart<=e&&(this._dateGrid._stepDate(-1,0,t),this.invalidateDisplayList())}},ba.prototype._fwdMonthButton_buttonDownHandler=function(t){if(!(this._maxYear<this.getDisplayedYear()+1&&11==this.getDisplayedMonth()))if(!this._selectableRange||1!=this._dateGrid._selRangeMode&&3!=this._dateGrid._selRangeMode)4==this._dateGrid._selRangeMode&&this._selectableRange||(this._dateGrid._stepDate(0,1,t),this.invalidateDisplayList());else{var e=ka.prototype._getNewIncrementDate(this.getDisplayedYear(),this.getDisplayedMonth(),0,1),e=new Date(e.year,e.month,this._selectableRange.rangeEnd.getDate());this._selectableRange.rangeEnd>=e&&(this._dateGrid._stepDate(0,1,t),this.invalidateDisplayList())}},ba.prototype._backMonthButton_buttonDownHandler=function(t){if(!(this._minYear>this.getDisplayedYear()-1&&0==this.getDisplayedMonth()))if(!this._selectableRange||1!=this._dateGrid._selRangeMode&&2!=this._dateGrid._selRangeMode)4==this._dateGrid._selRangeMode&&this._selectableRange||(this._dateGrid._stepDate(0,-1,t),this.invalidateDisplayList());else{var e=ka.prototype._getNewIncrementDate(this.getDisplayedYear(),this.getDisplayedMonth(),0,1),e=new Date(e.year,e.month,this._selectableRange.rangeStart.getDate());this._selectableRange.rangeStart<=e&&(this._dateGrid._stepDate(0,-1,t),this.invalidateDisplayList())}},ba.prototype._keyDownHandler=function(t){9!=t.keyCode&&(33==t.keyCode?this._backMonthButton_buttonDownHandler(t):34==t.keyCode?this._fwdMonthButton_buttonDownHandler(t):189==t.keyCode||109==t.keyCode?this._yearNavigationEnabled&&this._downYearButton_buttonDownHandler(t):(187==t.keyCode||107==t.keyCode)&&this._yearNavigationEnabled&&this._upYearButton_buttonDownHandler(t),this._dateGrid._keyDownHandler(t),t.stopPropagation(),t.preventDefault())},ba.prototype._mouseEventHandler=function(t){t.stopPropagation(),t.preventDefault()},ba.prototype._mouseUpHandler=function(t){if(t.target&&t.target.id){var e=t.target.id;0<e.indexOf("_UpYear")?this._upYearButton_buttonDownHandler(t):0<e.indexOf("_DownYear")?this._downYearButton_buttonDownHandler(t):0<e.indexOf("_BackMonth")?this._backMonthButton_buttonDownHandler(t):0<e.indexOf("_FwdMonth")&&this._fwdMonthButton_buttonDownHandler(t),t.stopPropagation(),t.preventDefault()}},ba.prototype._dateGrid_scrollHandler=function(t){this.dispatchEvent(t)},ba.prototype._dateGrid_changeHandler=function(t){this._selectedDate=t.target.selfElement.getSelectedDate();var e=new Ib(Ib.CHANGE);e.newDate=t.newDate,e.triggerEvent=t.triggerEvent,this.dispatchEvent(e)},z(X,u),X.prototype.setEnabled=ba.prototype.setEnabled,X.prototype.getData=function(){return this._data},X.prototype.setData=function(t){var e;(this._data=t)&&(e=this._listData?E(this._data)?G.getProperty(this._data,this._listData.dataField):this._data[this._listData.dataField]:F(this._data)?this._parseFunction(this._data):this._data),F(e)&&(e=this._parseFunction(e)),!this._selectedDateSet&&dc(e)&&(this.setSelectedDate(e),this._selectedDateSet=!1)},X.prototype.getDataText=function(){return this.dataFormatString?this.dateToString(this._parseFunction(this._text,this._formatString),this.dataFormatString):this._text},X.prototype.getText=function(){return this._text},X.prototype.setText=function(t){this._text=t,this._textInput.setText(t)},X.prototype.getListData=function(){return this._listData},X.prototype.setListData=function(t){var e,i;this._listData=t,this._data&&(e=this._listData?E(this._data)?G.getProperty(this._data,this._listData.dataField):this._data[this._listData.dataField]:F(this._data)?this._parseFunction(this._data):this._data),F(e)&&(i=this._parseFunction(e,this.dataFormatString?this.dataFormatString:this._formatString)),this._selectedDateSet||(this.setSelectedDate(p(i)?e:i),this._selectedDateSet=!1)},X.prototype.getDayNames=function(){return this._dayNames},X.prototype.setDayNames=ba.prototype.setDayNames,X.prototype.getDisabledDays=function(){return this._disabledDays},X.prototype.setDisabledDays=function(t){this._disabledDays=t,this._updateDateFiller=this._disabledDaysChanged=!0,this.invalidateProperties()},X.prototype.getDisabledRanges=function(){return this._disabledRanges},X.prototype.setDisabledRanges=function(t){this._disabledRanges=this._scrubTimeValues(t),this._updateDateFiller=this._disabledRangesChanged=!0,this.invalidateProperties()},X.prototype.getDisplayedMonth=function(){return this._dropdown&&this._displayedMonth!=this._dropdown.getDisplayedMonth()?this._dropdown.getDisplayedMonth():this._displayedMonth},X.prototype.setDisplayedMonth=function(t){isNaN(t)||this.getDisplayedMonth()==t||(this._displayedMonth=t,this._displayedMonthChanged=!0,this.invalidateProperties())},X.prototype.getDisplayedYear=function(){return this._dropdown&&this._dropdown.getDisplayedYear()!=this._displayedYear?this._dropdown.getDisplayedYear():this._displayedYear},X.prototype.setDisplayedYear=function(t){isNaN(t)||this.getDisplayedYear()==t||(this._displayedYear=t,this._displayedYearChanged=!0,this.invalidateProperties())},X.prototype.getEditable=function(){return this._editable},X.prototype.setEditable=function(t){t!=this._editable&&(this._editable=t,this._editableChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("editableChanged")))},X.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},X.prototype.setFirstDayOfWeek=ba.prototype.setFirstDayOfWeek,X.prototype.getFormatString=function(){return this._formatString},X.prototype.setFormatString=function(t){this._formatString=null!=t?t:B.getNumber("shared","dateFormat"),this._updateDateFiller=!0,this.invalidateProperties(),this.invalidateSize()},X.prototype.getMaxYear=function(){return this._maxYear},X.prototype.setMaxYear=function(t){isNaN(t)||this._maxYear==t||(this._maxYear=t,this._maxYearChanged=!0,this.invalidateProperties())},X.prototype.getMinYear=function(){return this._minYear},X.prototype.setMinYear=function(t){isNaN(t)||this._minYear==t||(this._minYear=t,this._minYearChanged=!0,this.invalidateProperties())},X.prototype.getMonthNames=function(){return this._monthNames},X.prototype.setMonthNames=ba.prototype.setMonthNames,X.prototype.getMonthSymbol=function(){return this._monthSymbol},X.prototype.setMonthSymbol=function(t){this._monthSymbol=null!=t?t:B.getString("shared","monthSymbol"),this._monthSymbolChanged=!0,this.invalidateProperties()},X.prototype.getParseFunction=function(){return this._parseFunction},X.prototype.setParseFunction=function(t){this._parseFunction=t},X.prototype.getSelectableRange=function(){return this._selectableRange},X.prototype.setSelectableRange=function(t){this._selectableRange=this._scrubTimeValue(t),this._updateDateFiller=this._selectableRangeChanged=!0,this.invalidateProperties()},X.prototype.getSelectedDate=function(){return this._selectedDate=this._dropdown?this._dropdown.getSelectedDate():this._selectedDate},X.prototype.setSelectedDate=function(t){0!=ua.dateCompare(this._selectedDate,t)&&(this._selectedDate=this._scrubTimeValue(t),this._updateDateFiller=this._selectedDateSet=this._selectedDateChanged=!0,this.invalidateProperties())},X.prototype.getShowToday=function(){return this._showToday},X.prototype.setShowToday=ba.prototype.setShowToday,X.prototype.getYearNavigationEnabled=function(){return this._yearNavigationEnabled},X.prototype.setYearNavigationEnabled=ba.prototype.setYearNavigationEnabled,X.prototype.getYearSymbol=function(){return this._yearSymbol},X.prototype.setYearSymbol=function(t){this._yearSymbol=null!=t?t:B.getString("shared","yearSymbol"),this._yearSymbolChanged=!0,this.invalidateProperties()},X.prototype._createDropdown=function(){this._dropdown=new ba;var t=new Date;this._dropdown.setOwner(this),this._dropdown.setDisplayedMonth(t.getMonth()),this._dropdown.setDisplayedYear(t.getFullYear()),this._dropdown.setVisible(!1),this._dropdown.setStyle("position","absolute"),this._dropdown.setStyle("zIndex",Sa.zIndex++),this._dropdown.addEventListener(Ib.CHANGE,this._dropdown_changeHandler,this),this._dropdown.addEventListener(od.SCROLL,this._dropdown_scrollHandler,this)},X.prototype._dateFiller=function(t){this._text=this.dateToString(t,this._formatString),this._textInput.setText(this._text)},X.prototype._displayDropdown=function(t,e){if(this._enabled&&t!=this._showingDropdown){if(t){null!=this._parseFunction&&(this._selectedDate=this._parseFunction(this._text,this._formatString)),this._lastSelectedDate=this._selectedDate,this._selectedDate_changeHandler(e),this._dropdown.setVisible(t),v.documentAddEvent("mousedown",this._dropdown_mouseOutsideHandler,this),r.ie8L||v.windowAddEvent("blur",this._dropdown_mouseOutsideHandler,this),this._addedToPopupManager?Ob.bringToFront(this._dropdown):(this._addedToPopupManager=!0,Ob.addPopUp(this._dropdown,this));var i=new ra(this._unscaledWidth-16-5,this._unscaledHeight),s=m.getWindowSize(),i=this.localToGlobal(i);this._dropdown.getSelectedDate()&&(this._dropdown.setDisplayedMonth(this._dropdown.getSelectedDate().getMonth()),this._dropdown.setDisplayedYear(this._dropdown.getSelectedDate().getFullYear())),i.x+this._dropdown.getWidth()>s.w&&i.x>s.l+this._dropdown.getWidth()&&(i.x-=this._dropdown.getWidth()-16-5),i.y+this._dropdown.getHeight()>s.h&&i.y>s.t+this._dropdown.getHeight()&&(i.y-=this._unscaledHeight+this._dropdown.getHeight()),i=this._dropdown.getParent().globalToLocal(i),Ob.movePopUp(this._dropdown,i.x,i.y),X._super.focus.call(this)}else v.documentRemoveEvent("mousedown",this._dropdown_mouseOutsideHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._dropdown_mouseOutsideHandler,this),this._addedToPopupManager=!1,Ob.removePopUp(this._dropdown),this._dropdown.setVisible(!1),this.getEditable()?this._textInput.focus():X._super.focus.call(this);this._showingDropdown=t}},X.prototype._scrubTimeValue=ba.prototype._scrubTimeValue,X.prototype._scrubTimeValues=ba.prototype._scrubTimeValues,X.prototype.createChildren=function(){X._super.createChildren.call(this),this._dayNames=B.getString("controls","dayNamesShortest").split(","),this._monthNames=B.getString("formatters","monthNamesShort").split(","),this._firstDayOfWeek=B.getNumber("controls","firstDayOfWeek"),this._formatString=B.getString("shared","dateFormat"),this._monthSymbol=B.getString("shared","monthSymbol"),this._yearSymbol=B.getString("shared","yearSymbol"),this._textInput||(this._textInput=new Y,this._textInput.setEditable(!1),this._editableChanged=!0,this.addChild(this._textInput),this._textInput.addEventListener("input",this._textInput_inputHandler,this)),
this._downArrowButton||(this._downArrowButton=new Ua,this._downArrowButton.setSrc(Ma+"calendar.png"),this._downArrowButton.addEvent("mousedown",this._downArrowButton_mouseDownHandler,this),this.addChild(this._downArrowButton)),this._createDropdown(),this.addEvent("keydown",this._keyDownHandler,this)},X.prototype.commitProperties=function(){X._super.commitProperties.call(this),this._enabledChanged&&(this._enabledChanged=!1,this._editableChanged=!0,this._textInput.setEnabled(this._enabled),this._downArrowButton.setEnabled(this._enabled)),this._dayNamesChanged&&(this._dayNamesChanged=!1,this._dropdown.setDayNames(this._dayNames?this._dayNames.slice(0):null)),this._disabledDaysChanged&&(this._disabledDaysChanged=!1,this._dropdown.setDisabledDays(this._disabledDays.slice(0))),this._disabledRangesChanged&&(this._disabledRangesChanged=!1,this._dropdown.setDisabledRanges(this._disabledRanges.slice(0))),this._displayedMonthChanged&&(this._displayedMonthChanged=!1,this._dropdown.setDisplayedMonth(this._displayedMonth)),this._displayedYearChanged&&(this._displayedYearChanged=!1,this._dropdown.setDisplayedYear(this._displayedYear)),this._firstDayOfWeekChanged&&(this._firstDayOfWeekChanged=!1,this._dropdown.setFirstDayOfWeek(this._firstDayOfWeek)),this._maxYearChanged&&(this._maxYearChanged=!1,this._dropdown.setMaxYear(this._maxYear)),this._minYearChanged&&(this._minYearChanged=!1,this._dropdown.setMinYear(this._minYear)),this._monthNamesChanged&&(this._monthNamesChanged=!1,this._dropdown.setMonthNames(this._monthNames?this._monthNames.slice(0):null)),this._selectableRangeChanged&&(this._selectableRangeChanged=!1,this._dropdown.setSelectableRange(ha(this._selectableRange)?this._selectableRange.slice(0):this._selectableRange)),this._selectedDateChanged&&(this._selectedDateChanged=!1,this._dropdown.setSelectedDate(this._selectedDate)),this._showTodayChanged&&(this._showTodayChanged=!1,this._dropdown.setShowToday(this._showToday)),this._updateDateFiller&&(this._updateDateFiller=!1,this._dateFiller(this._selectedDate)),this._yearNavigationEnabledChanged&&(this._yearNavigationEnabledChanged=!1,this._dropdown.setYearNavigationEnabled(this._yearNavigationEnabled)),this._yearSymbolChanged&&(this._yearSymbolChanged=!1,this._dropdown.setYearSymbol(this._yearSymbol)),this._monthSymbolChanged&&(this._monthSymbolChanged=!1,this._dropdown.setMonthSymbol(this._monthSymbol)),this._editableChanged&&(this._editableChanged=!1,this._textInput&&(this._textInput.setEditable(this._editable),this._editable?(this._textInput.removeEvent("mousedown",this._textInput_mouseEventHandler,this),this._textInput.addEvent("keydown",this._keyDownHandler,this)):(this._textInput.addEvent("mousedown",this._textInput_mouseEventHandler,this),this._textInput.removeEvent("keydown",this._keyDownHandler,this))))},X.prototype.measure=function(){X._super.measure.call(this);var t=this.dateToString(new Date(2004,5,30),this._formatString);this.measuredMinWidth=this.measuredWidth=this.measureText(t).width+8+3+16,this.measuredMinHeight=this.measuredHeight=this._textInput.getExplicitOrMeasuredHeight()},X.prototype.updateDisplayList=function(t,e){X._super.updateDisplayList.call(this,t,e),this._downArrowButton.setActualSize(16,16),this._downArrowButton.move(t-16-2,Math.round((e-16)/2)),this._textInput.setActualSize(t-16-5,e),this._textInput.setX(0)},X.prototype.open=function(){this._displayDropdown(!0)},X.prototype.close=function(t){this._showingDropdown&&(this._dropdown&&this.getSelectedDate()!=this._dropdown.getSelectedDate()&&this.setSelectedDate(this._dropdown.getSelectedDate()),this._displayDropdown(!1,t))},X.prototype.dateToString=function(t,e){var i=new id;return i.formatString=e,i.format(t)},X.prototype.stringToDate=function(t,e){var i=Mb.parseWithFormat(t,e);return ze(i)?null:new Date(i)},X.prototype.parentChanged=function(t){X._super.parentChanged.call(this,t),p(t)&&this._displayDropdown(!1)},X.prototype.getTextInput=function(){return this._textInput},X.prototype._keyDownHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;9!=t.keyCode&&(!t.altKey||38!=t.keyCode&&40!=t.keyCode?32==t.keyCode?this._showingDropdown||e==this._textInput||(this._displayDropdown(!0,t),t.stopImmediatePropagation(),t.preventDefault()):27==t.keyCode?(this._showingDropdown&&(this.setSelectedDate(this._lastSelectedDate),e!=this._textInput&&t.stopImmediatePropagation()),this._displayDropdown(!1,t)):13==t.keyCode?(this.getEditable()?(null!=this._parseFunction&&(this._selectedDate=this._parseFunction(this._text,this._formatString)),this._showingDropdown&&(this._displayDropdown(!1,t),t.stopImmediatePropagation())):this._showingDropdown&&this.close(t),this._selectedDate_changeHandler(t)):38!=t.keyCode&&40!=t.keyCode&&37!=t.keyCode&&39!=t.keyCode&&33!=t.keyCode&&34!=t.keyCode&&189!=t.keyCode&&109!=t.keyCode&&187!=t.keyCode&&107!=t.keyCode&&36!=t.keyCode&&35!=t.keyCode||!this._showingDropdown||e==this._textInput||(!this._yearNavigationEnabled||189!=t.keyCode&&187!=t.keyCode&&109!=t.keyCode&&107!=t.keyCode||(this._yearChangedWithKeys=!0),this._inKeyDown=!0,this._dropdown._keyDownHandler(t),this._inKeyDown=!1,t.stopImmediatePropagation()):(this._showingDropdown?this.close(t):this._displayDropdown(!0,t),t.stopImmediatePropagation()),Xb&&(this.setAttr("aria-label",this.getText()),this.blur(),this.focus()))},X.prototype._selectedDate_changeHandler=function(t){if((this._dropdown.getSelectedDate()||this._selectedDate)&&(this._selectedDate&&this._dateFiller(this._selectedDate),!this._dropdown.getSelectedDate()||!this._selectedDate||this._dropdown.getSelectedDate().getFullYear()!=this._selectedDate.getFullYear()||this._dropdown.getSelectedDate().getMonth()!=this._selectedDate.getMonth()||this._dropdown.getSelectedDate().getDate()!=this._selectedDate.getDate())){this._dropdown.setSelectedDate(this._selectedDate);var e=new Ib(Ib.CHANGE);e.newDate=this._selectedDate,e.triggerEvent=t,this.dispatchEvent(e)}},X.prototype._textInput_mouseEventHandler=function(t){this._downArrowButton_mouseDownHandler(t)},X.prototype._textInput_inputHandler=function(t){this._text=this._textInput.getText();var e=this._parseFunction(this._text,this._formatString);e&&(this._selectedDate=e),this._yearChangedWithKeys&&(t.preventDefault(),this._yearChangedWithKeys=!1)},X.prototype._downArrowButton_mouseDownHandler=function(t){this.callLater(this._displayDropdown,[!this._showingDropdown,t])},X.prototype._dropdown_scrollHandler=function(t){this.dispatchEvent(t)},X.prototype._dropdown_changeHandler=function(t){if(this._inKeyDown||this._displayDropdown(!1),0!=ua.dateCompare(this._selectedDate,this._dropdown.getSelectedDate())){(this._selectedDate=this._dropdown.getSelectedDate())?this._dateFiller(this._selectedDate):this._textInput.setText("");var e=new Ib(Ib.CHANGE);e.newDate=t.newDate,e.triggerEvent=t.triggerEvent,this.dispatchEvent(e)}},X.prototype._dropdown_mouseOutsideHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t.target!=document&&e&&(this.owns(e)||this._dropdown&&this._dropdown.owns(e))||this.close(t)},Z._defaultStyles={arrowButtonWidth:22,closeDuration:250,downArrowButtonStyleName:"KoolComboDownArrowButton",dropDownStyleName:void 0,openDuration:250},z(Z,Ca),Z.prototype.getData=function(){return this._data},Z.prototype.setData=function(t){this._data=t,t=this._listData&&this._listData instanceof nd?this._data[this._listData.dataField]:this._listData instanceof Ee&&this._listData.labelField in this._data?this._data[this._listData.labelField]:this._data,I(t)||this._selectedItemSet||(this.setSelectedItem(t),this._selectedItemSet=!1),this.dispatchEvent(new w("dataChange"))},Z.prototype.getListData=function(){return this._listData},Z.prototype.setListData=function(t){this._listData=t},Z.prototype.setDataProvider=function(t){this._selectionChanged=!0,Z._super.setDataProvider.call(this,t),this._destroyDropdown(),this.invalidateProperties(),this.invalidateSize()},Z.prototype.getItemRenderer=function(){return this._itemRenderer},Z.prototype.setItemRenderer=function(t){this._itemRenderer=t,this._dropdown&&this._dropdown.setItemRenderer(t),this.invalidateSize(),this.invalidateDisplayList()},Z.prototype.setSelectedIndex=function(t){Z._super.setSelectedIndex.call(this,t),0<=t&&(this._selectionChanged=!0),this._implicitSelectedIndex=!1,this.invalidateDisplayList(),this._textInput&&!this._textChanged&&0<=t?(this._textInput.setText(this.getSelectedLabel()),this._editable||this._downArrowButton.setLabel(this.getSelectedLabel())):this._textInput&&this._prompt&&(this._textInput.setText(this.getPrompt()),this._editable||this._downArrowButton.setLabel(this.getPrompt()))},Z.prototype.setSelectedItem=function(t){this._selectedItemSet=!0,this._implicitSelectedIndex=!1,Z._super.setSelectedItem.call(this,t)},Z.prototype.getDropdown=function(){return this._getDropdown()},Z.prototype.getDropdownFactory=function(){return this._dropdownFactory},Z.prototype.setDropdownFactory=function(t){this._dropdownFactory=t},Z.prototype.getDropdownWidth=function(){return this._dropdownWidth},Z.prototype.setDropdownWidth=function(t){this._preferredDropdownWidth=this._dropdownWidth=t,this._dropdown&&this._dropdown.setActualSize(t,this._dropdown.getHeight())},Z.prototype.getLabelField=function(){return this._labelField},Z.prototype.setLabelField=function(t){this._labelField=t,this._labelFieldChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("labelFieldChanged"))},Z.prototype.getLabelFunction=function(){return this._labelFunction},Z.prototype.setLabelFunction=function(t){this._labelFunction=t,this._labelFunctionChanged=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("labelFunctionChanged"))},Z.prototype.getPrompt=function(){return this._prompt},Z.prototype.setPrompt=function(t){this._prompt=t,this._promptChanged=!0,this.invalidateProperties()},Z.prototype.getRowCount=function(){return Math.max(1,Math.min(this._collection.getLength(),this._rowCount))},Z.prototype.setRowCount=function(t){this._rowCount=t,this._dropdown&&this._dropdown.setRowCount(t)},Z.prototype.getSelectedLabel=function(){var t=this.getSelectedItem();return this.itemToLabel(t)},Z.prototype.styleChanged=function(t){this._destroyDropdown(),Z._super.styleChanged.call(this,t)},Z.prototype.createChildren=function(){Z._super.createChildren.call(this),this._downArrowButton.setIconSrc("combo_down_arrow")},Z.prototype.commitProperties=function(){this._explicitText=this._textChanged,Z._super.commitProperties.call(this),this._collectionChanged&&(-1==this.getSelectedIndex()&&this._implicitSelectedIndex&&p(this._prompt)&&this.setSelectedIndex(0),this._selectedIndexChanged=!0,this._collectionChanged=!1),this._promptChanged&&!p(this._prompt)&&-1==this.getSelectedIndex()&&(this._promptChanged=!1,this._textInput.setText(this.getPrompt()),this._editable||this._downArrowButton.setLabel(this.getPrompt())),this._textInput.getVisible()!=this._editable&&this._textInput.setVisible(this._editable)},Z.prototype.measure=function(){Z._super.measure.call(this),this.measuredMinWidth=Math.max(this.measuredWidth,40);var t=this.measureText("M").height+6,e=this.getBorderMetrics();this.measuredMinHeight=this.measuredHeight=Math.max(t+e.top+e.bottom,20),this.measuredMinHeight=this.measuredHeight+=this.getSizeStyle("paddingTop")+this.getSizeStyle("paddingBottom")},Z.prototype.updateDisplayList=function(t,e){Z._super.updateDisplayList.call(this,t,e),this._dropdown&&!this._inTween?this._showingDropdown||this._destroyDropdown():this._showingDropdown&&(this._bRemoveDropdown=!1),isNaN(this._preferredDropdownWidth)&&(this._dropdownWidth=t),this._labelFieldChanged&&(this._dropdown&&this._dropdown.setLabelField(this._labelField),this._selectionChanged=!0,this._explicitText||(this._textInput.setText(this.getSelectedLabel()),this._editable||this._downArrowButton.setLabel(this.getSelectedLabel())),this._labelFieldChanged=!1),this._labelFunctionChanged&&(this._selectionChanged=!0,this._explicitText||(this._textInput.setText(this.getSelectedLabel()),this._editable||this._downArrowButton.setLabel(this.getSelectedLabel())),this._labelFunctionChanged=!1),this._selectionChanged&&(this._textChanged||(-1==this._selectedIndex&&this._prompt?(this._textInput.setText(this.getPrompt()),this._editable||this._downArrowButton.setLabel(this.getPrompt())):this._explicitText||(this._textInput.setText(this.getSelectedLabel()),this._editable||this._downArrowButton.setLabel(this.getSelectedLabel()))),this._textInput.invalidateDisplayList(),this._textInput.validateNow(),this._dropdown&&this._dropdown.setSelectedIndex(this.getSelectedIndex()),this._selectionChanged=!1),this._dropdown&&this._dropdown.getRowCount()!=this._rowCount&&this._dropdown.setRowCount(this._rowCount)},Z.prototype.itemToLabel=function(t){var e;if(p(t))return"";if(!p(this.getLabelFunction()))return this.getLabelFunction()(t);if(E(t))try{(e=G.getProperty(t,this.getLabelField()))&&(t=e)}catch(i){}else if(Ea(t))try{p(t[this.getLabelField()])||(t=t[this.getLabelField()])}catch(i){}if(F(t))return t;try{return t.toString()}catch(i){}return" "},Z.prototype.open=function(){this._displayDropdown(!0)},Z.prototype.close=function(t){this._showingDropdown&&(this._dropdown&&this.getSelectedIndex()!=this._dropdown.getSelectedIndex()&&this.setSelectedIndex(this._dropdown.getSelectedIndex()),this._displayDropdown(!1,t),this._dispatchChangeEvent(new w("dummy"),this._selectedIndexOnDropdown,this.getSelectedIndex()))},Z.prototype._hasDropdown=function(){return null!=this._dropdown},Z.prototype._getDropdown=function(){if(!this._initialized)return null;if(!this._hasDropdown()){this._dropdown=this._dropdownFactory.newInstance(),this._dropdown.setVisible(!1),this._dropdown.owner=this,this._itemRenderer&&this._dropdown.setItemRenderer(this.getItemRenderer());var t=this.getStyle("dropDownStyleName");t&&this._dropdown.setStyleName(t),Ob.addPopUp(this._dropdown,this,!1),this.getDataProvider()||this.setDataProvider(new P),this._dropdown.setDataProvider(this.getDataProvider()),this._dropdown.setRowCount(this.getRowCount()),this._dropdown.setWidth(this._dropdownWidth),this._dropdown.setSelectedIndex(this.getSelectedIndex()),this._oldIndex=this.getSelectedIndex(),this._dropdown.setVerticalScrollPolicy("auto"),this._dropdown.setLabelField(this._labelField),this._dropdown.allowDragSelection=!0,this._dropdown.addEventListener("change",this._dropdown_changeHandler,this),this._dropdown.addEventListener(ma.SCROLL,this._dropdown_scrollHandler,this),this._dropdown.addEventListener(L.ITEM_ROLL_OVER,this._dropdown_itemRollOverHandler,this),this._dropdown.addEventListener(L.ITEM_ROLL_OUT,this._dropdown_itemRollOutHandler,this),this._dropdown.addEventListener(L.ITEM_CLICK,this._dropdown_itemClickHandler,this),Ba.getInstance().validateClient(this._dropdown,!0),this._dropdown.setActualSize(this._dropdownWidth,this._dropdown.getExplicitOrMeasuredHeight()),this._dropdown.validateDisplayList(),v.documentAddEvent("resize",this._stage_resizeHandler,this)}return this._dropdown},Z.prototype._displayDropdown=function(t,e,i){if(i=!(2<arguments.length)||i,this._initialized&&t!=this._showingDropdown){this._inTween&&this._tween.endTween();var s,n,o,a,l=new ra(0,this._unscaledHeight),h=m.getWindowSize(),l=this.localToGlobal(l);t?(this._selectedIndexOnDropdown=this.getSelectedIndex(),this._getDropdown(),v.documentAddEvent("mousedown",this._dropdown_mouseOutsideHandler,this),r.ie8L||v.windowAddEvent("blur",this._dropdown_mouseOutsideHandler,this),null==this._dropdown.getParent()?Ob.addPopUp(this._dropdown,this):Ob.bringToFront(this._dropdown),l.y+this._dropdown.getHeight()>h.h&&l.y>h.t+this._dropdown.getHeight()?(l.y-=this._unscaledHeight+this._dropdown.getHeight(),n=-this._dropdown.getHeight(),this._tweenUp=!0):(n=this._dropdown.getHeight(),this._tweenUp=!1),l=this._dropdown.getParent().globalToLocal(l),s=this._dropdown.getSelectedIndex(),-1==s&&(s=0),this._dropdown.getVerticalScrollPosition(),s=Math.min(Math.max(s-1,0),this._dropdown.getMaxVerticalScrollPosition()),this._dropdown.setVerticalScrollPosition(s),Ob.movePopUp(this._dropdown,l.x,l.y),this._dropdown.getVisible()||this._dropdown.setVisible(!0),this._bRemoveDropdown=!1,this._showingDropdown=t,o=this.getStyle("openDuration"),s=0,a=this.getStyle("openEasingFunction"),this._dropdown.element.style.opacity=0):this._dropdown&&(s=l.y+this._dropdown.getHeight()>h.h||this._tweenUp?-this._dropdown.getHeight():this._dropdown.getHeight(),this._showingDropdown=t,n=0,o=this.getStyle("closeDuration"),a=this.getStyle("closeEasingFunction"),this._dropdown._resetDragScrolling()),this._inTween=!0,Ba.getInstance().validateNow(),this._dropdown&&this._dropdown.setEnabled(!1),o=Math.max(1,o),i||(o=1),this._tween=new oa(this,s,n,o),!p(a)&&this._tween&&(this._tween.easingFunction=a),this._triggerEvent=e}},Z.prototype._dispatchChangeEvent=function(t,e,i){e!=i&&(t=t instanceof L?t:new L("change"),this.dispatchEvent(t))},Z.prototype._destroyDropdown=function(){this._inTween&&this._tween.endTween(),this._displayDropdown(!1,null,!1)},Z.prototype._calculatePreferredSizeFromData=function(e){if(this._calculatePreferredSize)return this._calculatePreferredSize;var i=0,s=0,r=this._iterator?this._iterator.getBookmark():null;this._iterator.seek(t.getFIRST(),0);var n,o,a=!p(this._iterator);for(n=0;n<e;n++)o=a&&this._iterator?this._iterator.getCurrent():null,o=this.itemToLabel(o),o=this.measureText(o),i=Math.max(i,o.width),s=Math.max(s,o.height),this._iterator&&this._iterator.moveNext();return this._prompt&&(o=this.measureText(this.prompt),i=Math.max(i,o.width),s=Math.max(s,o.height)),i+=this.getSizeStyle("paddingLeft")+this.getSizeStyle("paddingRight"),this._iterator&&this._iterator.seek(r,0),this._calculatePreferredSize={width:i,height:s}},Z.prototype._getIsShowingDropdown=function(){return this._showingDropdown},Z.prototype._collectionChangeHandler=function(t){if(this.getSelectedIndex(),Z._super._collectionChangeHandler.call(this,t),t instanceof y){if(0==this._collection.getLength())this._selectedIndexChanged||this._selectedItemChanged||(-1!=Z._super.getSelectedIndex.call(this)&&Z._super.setSelectedIndex.call(this,-1),this._implicitSelectedIndex=!0,this.invalidateDisplayList()),this._textInput&&!this._editable&&(this._textInput.setText(""),this._editable||this._downArrowButton.setLabel(""));else if("add"==t.kind){if(this._collection.getLength()!=t.items.length)return;-1==this.getSelectedIndex()&&p(this._prompt)&&this.setSelectedIndex(0)}else if("update"==t.kind)t.location!=this.getSelectedIndex()&&t.items[0].source!=this.getSelectedItem()||(this._selectionChanged=!0);else{if("replace"==t.kind)return;"reset"==t.kind&&(this._collectionChanged=!0,this._selectedIndexChanged||this._selectedItemChanged||this.setSelectedIndex(this._prompt?-1:0),this.invalidateProperties())}this.invalidateDisplayList(),this._destroyDropdown()}},Z.prototype._textInput_inputHandler=function(t){Z._super._textInput_inputHandler.call(this,t),this._dispatchChangeEvent(t,-1,-2)},Z.prototype._downArrowButton_mouseDownHandler=function(t){this._showingDropdown?this.close(t):this._displayDropdown(!0,t)},Z.prototype._dropdown_mouseOutsideHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t.target!=document&&e&&(this.owns(e)||this._dropdown&&this._dropdown.owns(e))||this.close(t)},Z.prototype._dropdown_itemClickHandler=function(t){this._showingDropdown&&this.close()},Z.prototype._blurHandler=function(t){this._showingDropdown&&this._dropdown&&t.relatedTarget&&t.relatedTarget.selfElement!=this&&t.relatedTarget.selfElement!=this._downArrowButton&&!this._dropdown.contains(t.relatedTarget.selfElement)&&this.close(),Z._super._blurHandler.call(this,t)},Z.prototype._stage_resizeHandler=function(t){this.destroyDropdown()},Z.prototype._dropdown_scrollHandler=function(t){t instanceof ma&&this.dispatchEvent(t)},Z.prototype._dropdown_itemRollOverHandler=function(t){this.dispatchEvent(t)},Z.prototype._dropdown_itemRollOutHandler=function(t){this.dispatchEvent(t)},Z.prototype._dropdown_changeHandler=function(t){var e=this.getSelectedIndex();this._dropdown&&this.setSelectedIndex(this._dropdown.getSelectedIndex()),this._showingDropdown?this._bInKeyDown||this.close():this._dispatchChangeEvent(t,e,this.getSelectedIndex())},Z.prototype._keyDownHandler=function(t){this._enabled&&9!=t.keyCode&&(!t.altKey||38!=t.keyCode&&40!=t.keyCode?32==t.keyCode?this._showingDropdown||(t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null)==this._textInput||(this._displayDropdown(!0,t),t.stopPropagation(),t.preventDefault()):27==t.keyCode?this._showingDropdown&&(this._oldIndex!=this._dropdown.getSelectedIndex()&&this.setSelectedIndex(this._oldIndex),this._displayDropdown(!1),t.stopPropagation()):13==t.keyCode?this._showingDropdown&&(this.close(t),t.stopPropagation()):38!=t.keyCode&&40!=t.keyCode&&33!=t.keyCode&&34!=t.keyCode||(this.getSelectedIndex(),this._bInKeyDown=this._showingDropdown,this.getDropdown(),this._dropdown._keyDownHandler&&this._dropdown._keyDownHandler.call(this._dropdown,t),t.stopPropagation(),this._bInKeyDown=!1):(this._showingDropdown?this.close(t):this._displayDropdown(!0,t),t.stopPropagation()),Xb&&(this.setAttr("aria-label",this.getText()),this.blur(),this.focus()))},Z.prototype.parentChanged=function(t){Z._super.parentChanged.call(this,t),p(t)&&this.callLater(this._destroyDropdown)},Z.prototype.onTweenUpdate=function(t){this._dropdown&&(this._dropdown.element.style.opacity=t/100)},Z.prototype.onTweenEnd=function(t){this._dropdown&&(this._dropdown.element.style.opacity="",this._inTween=!1,this._dropdown.setEnabled(!0),this._dropdown.setVisible(this._showingDropdown),this._bRemoveDropdown&&(v.documentRemoveEvent("mousedown",this._dropdown_mouseOutsideHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._dropdown_mouseOutsideHandler,this),v.documentRemoveEvent("resize",this._stage_resizeHandler,this),Ob.removePopUp(this._dropdown),this._dropdown=null,this._parent&&this.focus())),this._bRemoveDropdown=!0},z(Ec,Ta),Ec.prototype.setDirection=function(t){},Ec.prototype.getMinHeight=function(t){return r.getScrollBarHeight()+1},Ec.prototype.getMinWidth=function(t){return 2*r.getScrollBarWidth()+1},Ec.prototype.getColumnArray=function(){return this._columnArray},Ec.prototype.setColumnArray=function(t){if(this._columnArray!==t){if(this._columnArray&&t&&this._columnArray.length==t.length){for(var e=0;e<t.length&&this._columnArray[e]==t[e];e++);if(e==t.length)return}this._columnArray=t,this.invalidateDisplayList()}},Ec.prototype.getLockedColumnCount=function(){return this._lockedColumnCount},Ec.prototype.setLockedColumnCount=function(t){this._lockedColumnCount!=t&&(this._lockedColumnCount=t,this.invalidateDisplayList())},Ec.prototype.setScrollPosition=function(t){if(this._columnArray){this._scrollPosition=t,t=Math.min(t,this._maxScrollPosition),t=Math.max(t,this._minScrollPosition);var e,i=this.element.scrollLeft,s=0,r=this._columnArray[this._lockedColumnCount];for(e=this._lockedColumnCount;e<this._columnArray.length&&!(i<this._columnArray[e]-r);e++)s=e-this._lockedColumnCount;t=this._columnArray[t+this._lockedColumnCount]-r,isNaN(s)||s!=this._scrollPosition&&(this.isScrolling||(this.element.scrollLeft=t))}else Ec._super.setScrollPosition.call(this,t)},Ec.prototype.setScrollProperties=function(t,e,i,s){if(s=3<arguments.length?s:0,this._columnArray&&0!=this._columnArray.length){var r=this.getWidth(),n=this._columnArray[this._columnArray.length-1],o=this._columnArray[this._lockedColumnCount];this._pageSize=t,this._pageScrollSize=0<s?s:t,this._minScrollPosition=Math.max(e,0);for(var a=this._maxScrollPosition=0;a<this._columnArray.length&&(this._maxScrollPosition=a,!(n-this._columnArray[a]<=r-o));a++);this._maxScrollPosition=Math.min(this._maxScrollPosition,this._columnArray.length-2),this._maxScrollPosition-=this._lockedColumnCount,this._scrollPosition=Math.max(this._minScrollPosition,this._scrollPosition),this._scrollPosition=Math.min(this._maxScrollPosition,this._scrollPosition),0<this._maxScrollPosition-this._minScrollPosition&&this._enabled?1<this._columnArray.length?m.setPxStyle(this._divElement,"width",r+this._columnArray[this._maxScrollPosition+this._lockedColumnCount]-o+1):m.setPxStyle(this._divElement,"width",n-o):m.setPxStyle(this._divElement,"width",r)}else Ec._super.setScrollProperties.call(this,t,e,i,s)},Ec.prototype._scrollHandler=function(t){if(this._columnArray){for(var e=this.element.scrollLeft,i=0,s=this._columnArray[this._lockedColumnCount],r=this._lockedColumnCount;r<this._columnArray.length&&!(e<this._columnArray[r]-s);r++)i=r-this._lockedColumnCount;i!=this._scrollPosition&&(this._scrollPosition=i>this._maxScrollPosition?this._maxScrollPosition:i,t=new ma(ma.SCROLL,(!1),(!1),this.isScrolling,i,this._direction,t.delta,t),this.dispatchEvent(t))}else Ec._super._scrollHandler.call(this,t)},z(Ua,u),Ua.prototype.getAlt=function(){return this._alt},Ua.prototype.setAlt=function(t){this._alt!=t&&(this._alt=t,this._altChanged=!0,this.invalidateProperties())},Ua.prototype.getMaintainAspectRatio=function(){return this._maintainAspectRatio},Ua.prototype.setMaintainAspectRatio=function(t){this._maintainAspectRatio!=t&&(this._maintainAspectRatio=t,this.invalidateDisplayList())},Ua.prototype.getSrc=function(){return this._src},Ua.prototype.setSrc=function(t){this._src!=t&&(this._src=t,this._srcChanged=!0,this.invalidateProperties())},Ua.prototype.setWidth=function(t){Ua._super.setWidth.call(this,t),this.invalidateDisplayList()},Ua.prototype.setHeight=function(t){Ua._super.setHeight.call(this,t),this.invalidateDisplayList()},Ua.prototype.getNumChildren=function(){return 0},Ua.prototype._getImageElement=function(){return this._imgElm},Ua.prototype.createChildren=function(){Ua._super.createChildren.call(this),this._imgElm||(this._imgElm=document.createElement("img"),this._imgElm.selfUIElement=this,this._alt&&(this._imgElm.alt=this._alt),this._altChanged=!1,m.setStyle(this._imgElm,"position","relative"),this.element.appendChild(this._imgElm))},Ua.prototype.commitProperties=function(){Ua._super.commitProperties.call(this),this._srcChanged&&(this.naturalHeight=this.naturalWidth=NaN,this.complete=this.isError=!1,this._scale=-1,m.setStyle(this._imgElm,"width","auto"),m.setStyle(this._imgElm,"height","auto"),I(this._imgElm.naturalWidth)||(this._imgElm.naturalWidth=null,this._imgElm.naturalHeight=null),this._src?(this._imgElm.src&&m.removeAttr(this._imgElm,"src"),v.addEvent(this._imgElm,"load",this._imageLoadHandler,this),v.addEvent(this._imgElm,"error",this._imageErrorHandler,this),this._imgElm.src=this._src):this._imgElm.src&&m.removeAttr(this._imgElm,"src"),this._tryCount=0,this._srcChanged=!1),this._altChanged&&(this._imgElm.alt=this._alt,this._altChanged=!1)},Ua.prototype.updateDisplayList=function(t,e){if(Ua._super.updateDisplayList.call(this,t,e),this.complete&&!this.isError&&0!=t&&0!=e){var i=m.getStyleInline(this.element,"width"),s=m.getStyleInline(this.element,"height");if(i||s){var r=m.getPaddingMetrics(this),s=m.getOffsetWidth(this._imgElm),i=m.getOffsetHeight(this._imgElm),n=t-r.left-r.right,r=e-r.top-r.bottom;this._maintainAspectRatio?(s=0==s?1:n/this.naturalWidth,i=0==i?1:r/this.naturalHeight,i=s>i?i:s,this._scale!=i&&(s=this.naturalHeight*i,m.setPxStyle(this._imgElm,"width",this.naturalWidth*i),m.setPxStyle(this._imgElm,"height",s),this._scale=i)):(s!=n&&m.setPxStyle(this._imgElm,"width",n),i!=r&&m.setPxStyle(this._imgElm,"height",r))}}},Ua.prototype._imageLoadHandler=function(t){var e=this,i=e._imgElm;if(v.removeEvent(e._imgElm,"load",e._imageLoadHandler,e),v.removeEvent(e._imgElm,"error",e._imageErrorHandler,e),i.complete)if(I(i.naturalWidth)){var s=document.createElement("img");s.src=i.src,s.complete?(e.naturalWidth=s.width,e.naturalHeight=s.height,e.isError=!1,e.complete=!0,e.invalidateDisplayList(),e.dispatchEvent(new w("load"))):s.onload=function(){e.naturalWidth=s.width,e.naturalHeight=s.height,e.isError=!1,e.complete=!0,e.invalidateDisplayList(),e.dispatchEvent(new w("load")),s=null}}else e.measuredWidth=e.naturalWidth=i.naturalWidth,e.measuredHeight=e.naturalHeight=i.naturalHeight,e.isError=!1,e.complete=!0,e.invalidateDisplayList(),e.dispatchEvent(new w("load"));else 5>e._tryCount?e.callLater(e._imageLoadHandler,[t]):(e.isError=!0,e.complete=!0,e.invalidateDisplayList(),e.dispatchEvent(new w("error"))),e._tryCount++},Ua.prototype._imageErrorHandler=function(t){v.removeEvent(this._imgElm,"load",this._imageLoadHandler,this),v.removeEvent(this._imgElm,"error",this._imageErrorHandler,this),this.complete=this.isError=!0,this.invalidateDisplayList(),this.dispatchEvent(new w("error"))},z(mc,u),mc.prototype.getText=function(){return this._text},mc.prototype.setText=function(t){this._text!==t&&(this._cachedTextFormat=null,this._text=t,this._textChanged=!0,this._explicitWidth=this._explicitHeight=NaN,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("valueCommit")))},mc.prototype._textFieldChange=function(t){var e;t||(e=this._text!=this.element.innerHTML),e&&this.dispatchEvent(new w("valueCommit"))},mc.prototype._getMinimumText=function(t){return(!t||2>t.length)&&(t="Wj"),t},mc.prototype.commitProperties=function(){mc._super.commitProperties.call(this),this._textChanged&&(this.element.innerHTML=this._text,this._text=this.element.innerHTML,this._textFieldChange(!1),this._textChanged=!1)},mc.prototype.measure=function(){var t=m.getBorderPaddingMetrics(this),e=this._explicitWidth,i=this._explicitHeight,s=this.measureText(this._getMinimumText(this._text));mc._super.measure.call(this),!O(e)&&e||(e=s.width+pa.TEXT_WIDTH_PADDING),!O(i)&&i||(i=s.height+pa.TEXT_HEIGHT_PADDING),this.measuredWidth=e+t.left+t.right,this.measuredHeight=i+t.top+t.bottom},Q._defaultStyles={alternatingItemColors:void 0,iconPlacement:void 0,selectionColor:"#A8C6EE",rollOverColor:"#CEDBEF"},z(Q,n),Q.prototype._defaultProperty="dataProvider",Q.prototype.setMaxHorizontalScrollPosition=function(t){Q._super.setMaxHorizontalScrollPosition.call(this,t),this._scrollAreaChanged=!0,this.invalidateDisplayList()},Q.prototype.setEnabled=function(t){Q._super.setEnabled.call(this,t),this.temEditorInstance&&this._endEdit("other"),this.invalidateDisplayList()},Q.prototype.getEditedItemPosition=function(){return this._editedItemPosition?{rowIndex:this._editedItemPosition.rowIndex,columnIndex:0}:this._editedItemPosition},Q.prototype.setEditedItemPosition=function(t){this._setEditedItemPosition({rowIndex:t.rowIndex,columnIndex:0})},Q.prototype.getEditedItemRenderer=function(){return this.itemEditorInstance?this._getListItems()[this._actualRowIndex][this._actualColIndex]:null},Q.prototype.getLockedRowCount=function(){return this._lockedRowCount},Q.prototype.setLockedRowCount=function(t){this._lockedRowCount=t,this.invalidateDisplayList()},Q.prototype.getImeMode=function(){return this._imeMode},Q.prototype.setImeMode=function(t){this._imeMode=t,this.setStyle("imeMode",t)},Q.prototype.setDataProvider=function(t){this.temEditorInstance&&this._endEdit("other"),Q._super.setDataProvider.call(this,t)},Q.prototype.commitProperties=function(){if(Q._super.commitProperties.call(this),this._itemsNeedMeasurement){if(this._itemsNeedMeasurement=!1,isNaN(this._explicitRowHeight))if(this._iterator){var t=this.getSizeStyle("paddingTop"),e=this.getSizeStyle("paddingBottom"),i=this._getMeasuringRenderer(this._iterator.getCurrent()),s=200;this._listContent.getWidth()&&(s=this._listContent.getWidth()),i.setExplicitWidth(s),this._setupRendererFromData(i,this._iterator.getCurrent()),t=i.getExplicitOrMeasuredHeight()+t+e,this.setRowHeight(Math.max(t,20))}else this.setRowHeight(20);isNaN(this._explicitColumnWidth)&&this._setColumnWidth(this.measureWidthOfItems(0,1>this._explicitRowCount?this._defaultRowCount:this._explicitRowCount))}},Q.prototype.measure=function(){
Q._super.measure.call(this),this.getViewMetrics(),this.measuredMinWidth=40,this._initialized&&this._variableRowHeight&&1>this._explicitRowCount&&isNaN(this._explicitRowHeight)&&(this.measuredHeight=this.getHeight())},Q.prototype._configureScrollBars=function(){var t=this._getListItems().length;if(0!=t){var e,i;for(e=this._getListItems().length;1<t&&this._getRowInfo()[e-1].y+this._getRowInfo()[e-1].height>this._listContent.getHeight()-this._listContent.bottomOffset;)t--,e--;for(e=this.getVerticalScrollPosition()-this.getLockedRowCount()-1,i=0;t&&0==this._getListItems()[t-1].length&&(this._collection&&t+e>=this._collection.getLength());)t--,++i;if(!(0<this.getVerticalScrollPosition()&&0<i&&!this._runningDataEffect&&this._adjustVerticalScrollPositionDownward(Math.max(t,1)))){if(this._listContent.topOffset)for(e=Math.abs(this._listContent.topOffset),i=0;this._getRowInfo()[i].y+this._getRowInfo()[i].height<=e&&(t--,i++,i!=t););this._getListItems(),e=Math.round(this._unscaledWidth),i=this._collection?this._collection.getLength()-this.getLockedRowCount():0,t-=this.getLockedRowCount(),this._setScrollBarProperties(isNaN(this._maxHorizontalScrollPosition)?Math.round(this._listContent.getWidth()):Math.round(this._maxHorizontalScrollPosition+e),e,i,t),this.setMaxVerticalScrollPosition(Math.max(i-t,0))}}},Q.prototype._adjustVerticalScrollPositionDownward=function(e){var i=this._iterator.getBookmark(),s=0,r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this.getSizeStyle("paddingLeft"),a=this.getSizeStyle("paddingRight");e=this._getRowInfo()[e-1].y+this._getRowInfo()[e-1].height,e=this._listContent.heightExcludingOffsets-this._listContent.topOffset-e;var l=0;try{if(this._iterator.getAfterLast())this._iterator.seek(t.getLAST(),0);else var h=this._iterator.movePrevious()}catch(d){h=!1}if(!h){Q._super.setVerticalScrollPosition.call(this,0);try{this._iterator.seek(t.getFIRST(),0),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(d){return this._lastSeekPending=new Da(t.getFIRST(),0),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1,this.invalidateList(),!0}return this._updateList(),!0}var c=this._getMeasuringRenderer(this._iterator.getCurrent());for(c.explicitWidth=this._listContent.getWidth()-o-a;0<e&&h;){h&&(s=this._iterator.getCurrent(),this._setupRendererFromData(c,s),s=this._variableRowHeight?c.getExplicitOrMeasuredHeight()+n+r:this._rowHeight),e-=s;try{h=this._iterator.movePrevious(),l++}catch(d){h=!1}}return 0>e&&l--,this._iterator.seek(i,0),this.setVerticalScrollPosition(Math.max(0,this.getVerticalScrollPosition()-l)),0<l&&!this._variableRowHeight&&this._configureScrollBars(),0<l},Q.prototype.updateDisplayList=function(t,e){Q._super.updateDisplayList.call(this,t,e),this.setRowCount(this._getListItems().length),this._bEditedItemPositionChanged&&!this._editingTemporarilyPrevented(this._proposedEditedItemPosition)&&(this._bEditedItemPositionChanged=!1,this._commitEditedItemPosition(this._proposedEditedItemPosition),this._proposedEditedItemPosition=void 0),this._drawRowBackgrounds()},Q.prototype._adjustListContent=function(t,e){t=0<arguments.length?t:-1,e=1<arguments.length?e:-1;var i=this.getViewMetrics(),s=i.left+Math.max(this._listContent.leftOffset,0),r=i.top+this._listContent.topOffset;this._listContent.move(s,r),r=Math.max(0,this._listContent.bottomOffset)-r-i.bottom,i=t+(Math.max(0,this._listContent.rightOffset)-s-i.right),("on"==this._horizontalScrollPolicy||"auto"==this._horizontalScrollPolicy&&!isNaN(this._maxHorizontalScrollPosition))&&(i=isNaN(this._maxHorizontalScrollPosition)?2*i:i+this._maxHorizontalScrollPosition),this._listContent.setActualSize(i,e+r)},Q.prototype._drawRowBackgrounds=function(){var t=this._listContent.getChildByName("rowBGs");t||(t=new A,t.name="rowBGs",this._listContent.addChildAt(t,0));var e=this.getStyle("alternatingItemColors");if(e&&0!=e.length){t.setVisible(!1);for(var i=0,s=this.getVerticalScrollPosition(),r=0,n=this._getListItems().length;i<n;)this._drawRowBackground(t,r++,this._getRowInfo()[i].y,this._getRowInfo()[i].height,e[s%e.length],s),i++,s++;for(;t.getNumChildren()>n;)t.removeChildAt(t.getNumChildren()-1);t.setVisible(!0)}else for(;t.getNumChildren()>n;)t.removeChildAt(t.getNumChildren()-1)},Q.prototype._drawRowBackground=function(t,e,i,s,r,n){e<t.numChildren?i=t.getChildAt(e):(i=new A("div","ListBackground"),i.name="rowBackground",t.addChild(i)),t=Math.min(this._getRowInfo()[e].height,this._listContent.getHeight()-this._getRowInfo()[e].y),i.setY(this._getRowInfo()[e].y),i.setStyle("backgroundColor",r),i.setWidth(this._listContent.getWidth()),i.setHeight(t)},Q.prototype._makeRowsAndColumns=function(e,i,s,r,n,o,a,l){a=6<arguments.length&&a,l=7<arguments.length?l:0,this._listContent._allowItemSizeChangeNotification=!1;var h,d,c,_,u,p=this.getStyle("paddingLeft"),g=this.getStyle("paddingRight"),m=e+p-this.getHorizontalScrollPosition(),f=s-p-g;this.getLockedRowCount();var y,b,v,C,I,p=0;for(h=i,g=o,C=null!=this._iterator&&!this._iterator.getAfterLast()&&this._iteratorValid;!a&&h<r||a&&0<l;)if(a&&l--,b=_=(I=C)?this._iterator.getCurrent():null,v=null,this._getListItems()[g]||(this._getListItems()[g]=[]),I?(y=this._getListItems()[g][0],v=this._itemToUID(_),y&&(this._runningDataEffect&&this._dataItemWrappersByRenderer[y.uno]?this._dataItemWrappersByRenderer[y.uno]==_:y.data==b)||(this._allowRendererStealingDuringLayout&&((y=this._getVisibleData()[v])||_==b||(y=this._getVisibleData()[this._itemToUID(b)])),y&&((d=this._rowMap[y.name])&&d.rowIndex>g?this._getListItems()[d.rowIndex]=[]:y=null),y||(y=this._getReservedOrFreeItemRenderer(_)),y||(y=this.createItemRenderer(b),y.owner=this,y.setStyleName(this._listContent),this._listContent.addChild(y)),(c=this._getListItems()[g][0])&&this._addToFreeItemRenderers(c),this._getListItems()[g][0]=y),d=this._makeListData(b,v,g),this._rowMap[y.name]=d,y.setData(b),U(y.setListData)&&(null!=b?y.setListData(d):y.setListData(null)),y.setEnabled(this._enabled),y.setVisible(!0),null!=v&&(this._getVisibleData()[v]=y),_!=b&&(this._dataItemWrappersByRenderer[y.uno]=_),y.setExplicitWidth(f),U(y.invalidateSize)&&(this._wordWrapChanged||this._variableRowHeight)&&y.invalidateSize(),Ba.getInstance().validateClient(y,!0),d=Math.ceil(this._variableRowHeight?y.getExplicitOrMeasuredHeight()+this._cachedPaddingTop+this._cachedPaddingBottom:this._rowHeight),c=y.getExplicitOrMeasuredHeight(),y.setActualSize(f,this._variableRowHeight?c:this._rowHeight-this._cachedPaddingTop-this._cachedPaddingBottom),y.move(m,h+this._cachedPaddingTop)):(d=0<g?this._getRowInfo()[g-1].height:this._rowHeight,0==d&&(d=this._rowHeight),(c=this._getListItems()[g][0])&&(this._addToFreeItemRenderers(c),this._getListItems()[g].splice(0,1))),c=null!=this._selectedData[v],_!=b&&(c=(c=c||this._selectedData[this._itemToUID(b)])&&!this.getRendererSemanticValue(y,"replacement")&&!this.getRendererSemanticValue(y,"added")),_=this._highlightUID==v,u=this._caretUID==v,this._getRowInfo()[g]=new we(h,d,v,b),I&&this._drawItem(y,c,_,u),h+=d,g++,p++,this._iterator&&C)try{C=this._iterator.moveNext()}catch(w){this._lastSeekPending=new Da(t.getCURRENT(),0),w.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=C=!1}if(!a)for(;g<this._getListItems().length;)for(m=this._getListItems().pop(),this._getRowInfo().pop();m.length;)y=m.pop(),this._addToFreeItemRenderers(y);return this.itemEditorInstance&&(this._listContent.setChildIndex(this.itemEditorInstance,this._listContent.getNumChildren()-1),y=this._getListItems()[this._actualRowIndex][this._actualColIndex],m=this._getRowInfo()[this._actualRowIndex],y&&!this.rendererIsEditor&&(g=this.editorWidthOffset,f=this.editorHeightOffset,this._layoutEditor(y.x+this.editorXOffset,m.y+this.editorYOffset,Math.min(y.getWidth()+g,this._listContent.getWidth()-this._listContent.getX()-this.itemEditorInstance.getX()),Math.min(m.height+f,this._listContent.getHeight()-this._listContent.getY()-this.itemEditorInstance.getY())))),this._listContent._allowItemSizeChangeNotification=this._variableRowHeight,new ra(0,p)},Q.prototype._layoutEditor=function(t,e,i,s){this.itemEditorInstance.move(t,e),this.itemEditorInstance.setActualSize(i,s)},Q.prototype._scrollHandler=function(e){if(e instanceof ma&&(this.itemEditorInstance&&this._endEdit("other"),this.liveScrolling&&(!e.target.selfElement||e.target.selfElement instanceof Ta))){var i=e.target.selfElement,s=i.getScrollPosition();if(this._removeClipMask(),i==this._verticalScrollBar){if(i=s-this.getVerticalScrollPosition(),Q._super._scrollHandler.call(this,e),Math.abs(i)>=this._getListItems().length-this.getLockedRowCount()||!this._iteratorValid){try{this._iteratorValid?this._iterator.seek(t.getCURRENT(),i):this._iterator.seek(t.getFIRST(),s),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(r){this._lastSeekPending=new Da(t.getFIRST(),s),r.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}e=this._iterator.getBookmark(),this._clearIndicators(),this._clearVisibleData(),this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0),this._iterator.seek(e,0)}else 0!=i&&this._scrollVertically(s,Math.abs(i),0<i);this._variableRowHeight&&this._configureScrollBars(),this._drawRowBackgrounds()}else i=s-this._horizontalScrollPosition,Q._super._scrollHandler.call(this,e),this._scrollHorizontally(s,Math.abs(i),0<i);this._addClipMask(!1)}},Q.prototype._scrollHorizontally=function(t,e,i){i=this._getListItems().length;var s=this.getStyle("paddingLeft");for(e=0;e<i;e++)this._getListItems()[e].length&&this._getListItems()[e][0].setX(-t+s)},Q.prototype._makeListData=function(t,e,i){return new Ee(this.itemToLabel(t),this.itemToIcon(t),this.getLabelField(),e,this,i)},Q.prototype._setupRendererFromData=function(t,e){t.setData(e),U(t.setListData)&&(null!=e?t.setListData(this._makeListData(e,this._itemToUID(e),0)):t.setListData(null)),U(t.invalidateSize)&&t.invalidateSize(),Ba.getInstance().validateClient(t,!0)},Q.prototype.measureWidthOfItems=function(e,i){e=0<arguments.length?e:-1,i=1<arguments.length?i:0,0==i&&(i=this._collection?this._collection.getLength():0),this._collection&&0==this._collection.getLength()&&(i=0);var s,r=0,n=this._iterator?this._iterator.getBookmark():null;if(-1!=e&&this._iterator)try{this._iterator.seek(t.getFIRST(),e)}catch(o){return 0}var a,l,h=null!=this._iterator;for(a=0;a<i;a++)if(h){l=this._iterator.getCurrent(),s=this.getItemRendererFactory(l),(s=this._measuringObjects[s.uno])||(s=this._getMeasuringRenderer(l)),s.setExplicitWidth(NaN),this._setupRendererFromData(s,l),l=s.measuredWidth,r=Math.max(r,l);try{h=this._iterator.moveNext()}catch(o){h=!1}}return this._iterator&&this._iterator.seek(n,0),0==r?this._explicitWidth?this._explicitWidth:40:(n=this.getStyle("paddingLeft"),a=this.getStyle("paddingRight"),r+(n+a))},Q.prototype.measureHeightOfItems=function(e,i){e=0<arguments.length?e:-1,i=1<arguments.length?i:0,0==i&&(i=this._collection?this._collection.getLength():0);var s=this.getStyle("paddingTop"),r=this.getStyle("paddingBottom"),n=200;this._listContent.getWidth()&&(n=this._listContent.getWidth());var o=0,a=this._iterator?this._iterator.getBookmark():null;-1!=e&&this._iterator&&this._iterator.seek(t.getFIRST(),e);var l,h,d=this._rowHeight,c=null!=this._iterator;for(l=0;l<i;l++){if(c){d=this._rowHeight,h=this._iterator.getCurrent();var _=this._getMeasuringRenderer(h);_.setExplicitWidth(n),this._setupRendererFromData(_,h),this._variableRowHeight&&(d=_.getExplicitOrMeasuredHeight()+s+r)}if(o+=d,c)try{c=this._iterator.moveNext()}catch(u){c=!1}}return this._iterator&&this._iterator.seek(a,0),o},Q.prototype._mouseEventToItemRenderer=function(t){return t=Q._super._mouseEventToItemRenderer.call(this,t),t==this.itemEditorInstance?null:t},Q.prototype._getMeasuringRenderer=function(t){var e;this._measuringObjects||(this._measuringObjects={});var i=(e=this.getItemRendererFactory(t))?e.uno:0;return e=this._measuringObjects[i],e||(e=this.createItemRenderer(t),e.owner=this,e.name="hiddenItem",e.setVisibility(!1),e.setStyleName(this._listContent),this._listContent.addChild(e),this._measuringObjects[i]=e),e},Q.prototype._purgeMeasuringRenderers=function(){var t,e;for(t in this._measuringObjects)e=this._measuringObjects[t],e.getParent()&&e.getParent().removeChild(e);this._measuringObjects||(this._measuringObjects={})},Q.prototype.setItemRenderer=function(t){Q._super.setItemRenderer.call(this,t),this._purgeMeasuringRenderers()},Q.prototype.createItemRenderer=function(t){var e;e=this.getItemRendererFactory(t),e||(null==t&&(e=this._nullItemRenderer),e||(e=this._itemRenderer));var i;if(e==this._itemRenderer)this._freeItemRenderers&&this._freeItemRenderers.length&&(i=this._freeItemRenderers.pop(),delete this._freeItemRenderersByFactory[e][i]);else if(this._freeItemRenderersByFactory){var s;if(t=this._freeItemRenderersByFactory[e])for(s in t){i=s,delete t[s];break}}return i||(i=e.newInstance(),i.setStyleName(this),this._factoryMap[i.uno]=e),i.owner=this,i},Q.prototype._editingTemporarilyPrevented=function(t){if(this._runningDataEffect&&t){if(t=t.rowIndex-this.getVerticalScrollPosition()+this._offscreenExtraRowsTop,0>t||t>=this._getListItems().length)return!1;if((t=this._getListItems()[t][0])&&(this.getRendererSemanticValue(t,"replaced")||this.getRendererSemanticValue(t,"removed")))return!0}return!1},Q.prototype._setEditedItemPosition=function(t){this._bEditedItemPositionChanged=!0,this._proposedEditedItemPosition=t,this.invalidateDisplayList()},Q.prototype._commitEditedItemPosition=function(t){if(this._enabled&&this.editable)if(this.itemEditorInstance&&t&&this.itemEditorInstance instanceof A&&this.editedItemPosition.rowIndex==t.rowIndex)this.itemEditorInstance.focus();else{if(this.itemEditorInstance){var e;if(e=t?"newRow":"other",!this._endEdit(e)&&"other"!=e)return}if((this._editedItemPosition=t)&&!this._dontEdit){e=t.rowIndex;var i=t.columnIndex;this._selectedIndex!=t.rowIndex&&this._commitSelectedIndex(t.rowIndex),t=this.getLockedRowCount();var s=this.getVerticalScrollPosition()+this._getListItems().length-this._offscreenExtraRowsTop-this._offscreenExtraRowsBottom-1,r=this._getRowInfo()[this._getListItems().length-this._offscreenExtraRowsBottom-1].y+this._getRowInfo()[this._getListItems().length-this._offscreenExtraRowsBottom-1].height>this._listContent.getHeight()?1:0;if(e>t){if(e<this.getVerticalScrollPosition()+t)this.setVerticalScrollPosition(e-t);else for(;(e>s||e==s&&e>this.getVerticalScrollPosition()+t&&r)&&this.getVerticalScrollPosition()!=this._maxVerticalScrollPosition;)this.setVerticalScrollPosition(Math.min(this.getVerticalScrollPosition()+(e>s?e-s:r),this._maxVerticalScrollPosition)),s=this.getVerticalScrollPosition()+this._getListItems().length-this._offscreenExtraRowsTop-this._offscreenExtraRowsBottom-1,r=this._getRowInfo()[this._getListItems().length-this._offscreenExtraRowsBottom-1].y+this._getRowInfo()[this._getListItems().length-this._offscreenExtraRowsBottom-1].height>this._listContent.getHeight()?1:0;this._actualRowIndex=e-this.getVerticalScrollPosition()}else e==t&&this.setVerticalScrollPosition(0),this._actualRowIndex=e;this.getBorderMetrics(),this._actualColIndex=i,(e=this._getListItems()[this._actualRowIndex][this._actualColIndex])&&this.isItemEditable(e.getData())?(i=new L(L.ITEM_EDIT_BEGIN,(!1),(!0)),i.rowIndex=this._editedItemPosition.rowIndex,i.itemRenderer=e,this.dispatchEvent(i),this._lastEditedItemPosition=this._editedItemPosition,this._bEditedItemPositionChanged&&(this._bEditedItemPositionChanged=!1,this._commitEditedItemPosition(this._proposedEditedItemPosition),this._proposedEditedItemPosition=void 0),this.itemEditorInstance||this._commitEditedItemPosition(null)):this._commitEditedItemPosition(null)}}},Q.prototype.createItemEditor=function(t,e){t=0,e>this.getLockedRowCount()&&(e-=this.getVerticalScrollPosition());var i=this._getListItems()[e][t],s=this._getRowInfo()[e];if(this.rendererIsEditor)this.itemEditorInstance=i;else{var n=0,o=-2,a=0,l=4;this.itemEditorInstance||(n=this.editorXOffset,o=this.editorYOffset,a=this.editorWidthOffset,l=this.editorHeightOffset,this.itemEditorInstance=this.itemEditor.newInstance(),this.itemEditorInstance.owner=this,this.itemEditorInstance.setStyleName(this),this._listContent.addChild(this.itemEditorInstance)),this._listContent.setChildIndex(this.itemEditorInstance,this._listContent.getNumChildren()-1),this.itemEditorInstance.setVisible(!0),this._layoutEditor(i.getX()+n,s.y+o,Math.min(i.getWidth()+a,this._listContent.getWidth()-this._listContent.getX()-this.itemEditorInstance.getX()),Math.min(s.height+l,this._listContent.getHeight()-this._listContent.getY()-this.itemEditorInstance.getY())),this.itemEditorInstance.addEvent("blur",this._itemEditorBlurHandler,this)}this.itemEditorInstance.addEvent("keydown",this._editorKeyDownHandler,this),v.documentAddEvent("mousedown",this._editorMouseDownHandler,this),r.ie8L||v.windowAddEvent("blur",this._editorBlurHandler,this)},Q.prototype._findNextItemRenderer=function(t){if(!this._lastEditedItemPosition)return!1;if(void 0!==this._proposedEditedItemPosition)return!0;this._editedItemPosition=this._lastEditedItemPosition;var e=this._editedItemPosition.columnIndex;if(t=this._editedItemPosition.rowIndex+(t?-1:1),!(t<this._collection.getLength()&&0<=t))return this.setEditedItemPosition(null),this._losingFocus=!0,this.focus(),!1;var i=new L(L.ITEM_EDIT_BEGINNING,(!1),(!0));return i.rowIndex=t,i.columnIndex=e,this.dispatchEvent(i),!0},Q.prototype.destroyItemEditor=function(){if(this.itemEditorInstance){this.itemEditorInstance.removeEvent("keydown",this._editorKeyDownHandler,this),v.documentRemoveEvent("mousedown",this._editorMouseDownHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._editorBlurHandler,this);var t=new L(L.ITEM_FOCUS_OUT);t.rowIndex=this._editedItemPosition.rowIndex,t.itemRenderer=this.getEditedItemRenderer(),this.dispatchEvent(t),this.rendererIsEditor||(this.itemEditorInstance.removeEvent("blur",this._itemEditorBlurHandler,this),this.itemEditorInstance&&this.itemEditorInstance instanceof A&&this.itemEditorInstance.blur(),this._listContent.removeChild(this.itemEditorInstance)),(t=this.itemEditorInstance.getListData())&&t.item&&t.dataField&&E(t.item)&&0<=t.dataField.indexOf("@")&&(t.dataField=t.dataField.replace("@","")),this._editedItemPosition=this.itemEditorInstance=null}},Q.prototype._endEdit=function(t){if(!this.getEditedItemRenderer())return!0;this._inEndEdit=!0;var e=new L(L.ITEM_EDIT_END,(!1),(!0));return e.rowIndex=this._editedItemPosition.rowIndex,e.itemRenderer=this.getEditedItemRenderer(),e.reason=t,this.dispatchEvent(e),this._dontEdit=null!=this.itemEditorInstance,this._dontEdit||"cancelled"!=t||(this._losingFocus=!0,this.focus()),this._inEndEdit=!1,!e.defaultPrevented},Q.prototype.isItemEditable=function(t){return!(!this.editable||null==t)},Q.prototype._mouseDownHandler=function(t){var e;if(e=this._mouseEventToItemRenderer(t),!this.itemRendererContains(this.itemEditorInstance,t.target.selfElement||t.target.selfUIElement)){if(e&&e.getData()){if(this.itemRendererToIndices(e),e=!0,this.itemEditorInstance&&(e=this._endEdit("newRow")),!e)return}else this.itemEditorInstance&&this._endEdit("other");Q._super._mouseDownHandler.call(this,t)}},Q.prototype._mouseUpHandler=function(t){var e;if(e=this._mouseEventToItemRenderer(t),Q._super._mouseUpHandler.call(this,t),e&&e.getData()&&e!=this.itemEditorInstance&&(!this._doubleClickEnabled||"dblclick"==t.type||"touchend"==t.type)){var i=this.itemRendererToIndices(e);this.editable&&!this._dontEdit&&(t=new L(L.ITEM_EDIT_BEGINNING,(!1),(!0)),t.rowIndex=i.y,t.columnIndex=0,t.itemRenderer=e,this.dispatchEvent(t))}},Q.prototype._mouseDoubleClickHandler=function(t){var e;Q._super._mouseDoubleClickHandler.call(this,t),this._doubleClickEnabled&&(e=this._mouseEventToItemRenderer(t),this.editable&&e&&this._mouseUpHandler(t))},Q.prototype._focusInHandler=function(t){t.target==this&&(this._losingFocus?this._losingFocus=!1:(Q._super._focusInHandler.call(this,t),this.editable&&!this._isPressed&&(this._editedItemPosition=this._lastEditedItemPosition,t=null!=this._editedItemPosition,this._editedItemPosition||(this._editedItemPosition={rowIndex:0,columnIndex:0},t=this._getListItems().length&&0<this._getListItems()[0].length),t&&this._setEditedItemPosition(this._editedItemPosition)),this.editable&&this.addEvent("mousedown",this._mouseFocusChangeHandler,this)))},Q.prototype._focusOutHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t=t.relatedTarget?t.relatedTarget.selfElement||t.relatedTarget.selfUIElement:null,t==this&&this.itemRendererContains(this.itemEditorInstance,e)||null==t&&this.itemRendererContains(this.getEditedItemRenderer(),e)||null==t&&this.itemRendererContains(this.itemEditorInstance,e)||!this.itemEditorInstance||t&&this.itemRendererContains(this.itemEditorInstance,t)||(this._endEdit("other"),this.removeEvent("mousedown",this._mouseFocusChangeHandler,this))},Q.prototype._keyDownHandler=function(t){this.itemEditorInstance||Q._super._keyDownHandler.call(this,t)},Q.prototype._editorMouseDownHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t.target!=document&&e&&this.owns(e)||this._endEdit("other")},Q.prototype._editorBlurHandler=function(t){this._endEdit("other")},Q.prototype._editorKeyDownHandler=function(t){27==t.keyCode?this._endEdit("cancelled"):13!=t.keyCode||this.editorUsesEnterKey||this._endEdit("newRow")&&!this._dontEdit&&this._findNextEnterItemRenderer(t)},Q.prototype._findNextEnterItemRenderer=function(t){if(void 0===this._proposedEditedItemPosition){this._editedItemPosition=this._lastEditedItemPosition;var e=this._editedItemPosition.rowIndex;t=this._editedItemPosition.rowIndex+(t.shiftKey?-1:1),t<this._collection.getLength()&&0<=t&&(e=t),t=new L(L.ITEM_EDIT_BEGINNING,(!1),(!0)),t.rowIndex=e,t.columnIndex=0,this.dispatchEvent(t)}},Q.prototype._mouseFocusChangeHandler=function(t){this.itemEditorInstance&&!t.defaultPrevented&&this.itemRendererContains(this.itemEditorInstance,t.target.selfElement||t.target.selfUIElement)&&t.preventDefault()},Q.prototype._itemEditorBlurHandler=function(t){t.relatedTarget&&this.contains(t.relatedTarget.serlfElement)||this.itemEditorInstance&&this._endEdit("other")},Q.prototype._itemEditorItemEditBeginningHandler=function(t){t.defaultPrevented?this.itemEditorInstance||(this._editedItemPosition=null,this.editable=!1,this.focus(),this.editable=!0):this.setEditedItemPosition({columnIndex:t.columnIndex,rowIndex:t.rowIndex})},Q.prototype._itemEditorItemEditBeginHandler=function(t){t.defaultPrevented||null==this._getListItems()[this._actualRowIndex][this._actualColIndex].getData()||(this.createItemEditor(t.columnIndex,t.rowIndex),this.rendererIsEditor||this.itemEditorInstance.setData(this.getEditedItemRenderer().getData()),U(this.getEditedItemRenderer().getListData)&&U(this.itemEditorInstance.setListData)&&((t=this.getEditedItemRenderer().getListData())&&t.item&&t.dataField&&E(t.item)&&0>t.dataField.indexOf("@")&&(t.dataField="@"+t.dataField),this.itemEditorInstance.setListData(t)),U(this.itemEditorInstance.validateNow)&&this.itemEditorInstance.validateNow(),U(this.itemEditorInstance.setImeMode)&&this.itemEditorInstance.setImeMode(this._imeMode),this.itemEditorInstance instanceof A&&this.itemEditorInstance.focus(),t=new L(L.ITEM_FOCUS_IN),t.rowIndex=this._editedItemPosition.rowIndex,t.itemRenderer=this.itemEditorInstance,this.dispatchEvent(t))},Q.prototype._itemEditorItemEditEndHandler=function(t){if(t.defaultPrevented)"other"!=t.reason&&this.itemEditorInstance&&this._editedItemPosition&&(this._selectedIndex!=this._editedItemPosition.rowIndex&&this.setSelectedIndex(this._editedItemPosition.rowIndex),this.itemEditorInstance.focus());else{var e,i=!1,s=!1,r=t.itemRenderer.getData();if(this.itemEditorInstance&&"cancelled"!=t.reason){if(e=bd(this.itemEditorInstance,this.editorDataField),F(r))F(e)||(e=e.toString());else if(Xa(r))Xa(e)||(e=Number(e));else{s=!0;try{E(r)?G.setProperty(r,"@"+this.getLabelField(),e):r[this.getLabelField()]=e,this._actualCollection?this._actualCollection.itemUpdated(r,this.getLabelField()):this._collection.itemUpdated(r,this.getLabelField())}catch(n){console.log("attempt to write to",this.getLabelField(),"failed.  You may need a custom ITEM_EDIT_END handler")}}s||(r!==e&&(i=!0,r=e),i&&((i=this._actualCollection?this._actualCollection:this._collection)?i.setItemAt(r,t.rowIndex):console.log("attempt to update collection failed.  You may need a custom ITEM_EDIT_END handler"))),delete this._getVisibleData()[this._itemToUID(t.itemRenderer.getData())],t.itemRenderer.setData(r),U(t.itemRenderer.setListData)&&(i=t.itemRenderer.getListData(),i.label=this.itemToLabel(r),t.itemRenderer.setListData(i)),this._getVisibleData()[this._itemToUID(r)]=t.itemRenderer}}"other"!=t.reason&&t.defaultPrevented||this.destroyItemEditor()},Q.prototype._drawHighlightIndicator=function(t,e,i,s,r,n,o){e=this.getViewMetrics(),Q._super._drawHighlightIndicator.call(this,t,0,i,this._unscaledWidth-e.left-e.right,r,n,o)},Q.prototype._drawCaretIndicator=function(t,e,i,s,r,n,o){e=this.getViewMetrics(),Q._super._drawCaretIndicator.call(this,t,0,i,this._unscaledWidth-e.left-e.right,r,n,o)},Q.prototype._drawSelectionIndicator=function(t,e,i,s,r,n,o){e=this.getViewMetrics(),Q._super._drawSelectionIndicator.call(this,t,0,i,this._unscaledWidth-e.left-e.right,r,n,o)},Q.prototype._mouseWheelHandler=function(t){this.itemEditorInstance&&this._endEdit("other"),Q._super._mouseWheelHandler.call(this,t)},Q.prototype._collectionChangeHandler=function(t){t instanceof y&&"remove"==t.kind&&this._editedItemPosition&&(0==this._collection.getLength()?(this.itemEditorInstance&&this._endEdit("cancelled"),this.setEditedItemPosition(null)):t.location<=this.editedItemPosition.rowIndex&&(this._inEndEdit?this._editedItemPosition={columnIndex:this._editedItemPosition.columnIndex,rowIndex:Math.max(0,this._editedItemPosition.rowIndex-t.items.length)}:this.setEditedItemPosition({columnIndex:this._editedItemPosition.columnIndex,rowIndex:Math.max(0,this._editedItemPosition.rowIndex-t.items.length)}))),Q._super._collectionChangeHandler.call(this,t)},Q.prototype._callSetupRendererFromData=function(t,e){this._setupRendererFromData(t,e)},Q.prototype._callMakeListData=function(t,e,i){return this._makeListData(t,e,i)},z(ia,u),ia.prototype.setEnabled=ka.prototype.setEnabled,ia.prototype.getDisabledRanges=function(){return this._disabledRanges},ia.prototype.setDisabledRanges=function(t){if(t&&ha(t)){this._disabledRanges=t.slice(0),this._disabledRangeMode=[];for(var e=0;e<this._disabledRanges.length;e++)dc(this._disabledRanges[e])?(this._disabledRangeMode[e]=4,this._disabledRanges[e]=new Date(t[e].getFullYear(),t[e].getMonth(),1)):Ea(this._disabledRanges[e])&&(this._disabledRanges[e]={},this._disabledRanges[e]=t[e],!this._disabledRanges[e].rangeStart&&this._disabledRanges[e].rangeEnd?(this._disabledRangeMode[e]=3,this._disabledRanges[e].rangeEnd=new Date(t[e].rangeEnd.getFullYear(),t[e].rangeEnd.getMonth(),1)):this._disabledRanges[e].rangeStart&&!this._disabledRanges[e].rangeEnd?(this._disabledRangeMode[e]=2,this._disabledRanges[e].rangeStart=new Date(t[e].rangeStart.getFullYear(),t[e].rangeStart.getMonth(),1)):this._disabledRanges[e].rangeStart&&this._disabledRanges[e].rangeEnd&&(this._disabledRangeMode[e]=1,this._disabledRanges[e].rangeStart=new Date(t[e].rangeStart.getFullYear(),t[e].rangeStart.getMonth(),1),this._disabledRanges[e].rangeEnd=new Date(t[e].rangeEnd.getFullYear(),t[e].rangeEnd.getMonth(),1)));this._selectedYearChanged=!0,this.invalidateProperties(),this.getSelectedRanges()}},ia.prototype.getDisplayedYear=function(){return-1==this._proposedDisplayedYear?this._displayedYear:this._proposedDisplayedYear},ia.prototype.setDisplayedYear=function(t){isNaN(t)||this._displayedYear==t||(this._proposedDisplayedYear=t,this._selectedYearChanged=!0,this.invalidateProperties())},ia.prototype.getMaxYear=function(){return this._maxYear},ia.prototype.setMaxYear=function(t){isNaN(t)||this._maxYear==t||(this._maxYear=t)},ia.prototype.getMinYear=function(){return this._minYear},ia.prototype.setMinYear=function(t){isNaN(t)||this._minYear==t||(this._minYear=t)},ia.prototype.getMonthNames=function(){return this._monthNames},ia.prototype.setMonthNames=function(t){this._monthNames=(this._monthNames=t?t:B.getString("formatters","monthNamesShort").split(","))?this._monthNames.slice(0):null,this._monthNamesChanged=!0,this.invalidateProperties(),this.invalidateSize()},ia.prototype.getMonthSymbol=function(){return this._monthSymbol},ia.prototype.setMonthSymbol=function(t){this._monthSymbol=null!=t?t:B.getString("shared","monthSymbol"),this.invalidateSize(),this.invalidateDisplayList()},ia.prototype.getSelectableRange=function(){return this._selectableRange},ia.prototype.setSelectableRange=function(t){if(t){var e,i=new Date,s=i.getMonth(),r=i.getFullYear();dc(t)?(this._selRangeMode=4,this._selectableRange=new Date(t.getFullYear(),t.getMonth(),1),e=t.getFullYear()):Ea(t)&&(this._selectableRange={},!t.rangeStart&&t.rangeEnd?(this._selRangeMode=3,this._selectableRange.rangeEnd=t.rangeEnd,r<=this._selectableRange.rangeEnd.getFullYear()?s>=this._selectableRange.rangeEnd.getMonth()?e=this._selectableRange.rangeEnd.getFullYear():s<=this._selectableRange.rangeEnd.getMonth()&&(e=r):r>this._selectableRange.rangeEnd.getFullYear()&&(e=this._selectableRange.rangeEnd.getFullYear())):!t.rangeEnd&&t.rangeStart?(this._selRangeMode=2,this._selectableRange.rangeStart=t.rangeStart,r>=this._selectableRange.rangeStart.getFullYear()?s<=this._selectableRange.rangeStart.getMonth()?e=this._selectableRange.rangeStart.getFullYear():s>=this._selectableRange.rangeStart.getMonth()&&(e=r):r<this._selectableRange.rangeStart.getFullYear()&&(e=this._selectableRange.rangeStart.getFullYear())):t.rangeStart&&t.rangeEnd&&(this._selRangeMode=1,this._selectableRange.rangeStart=t.rangeStart,this._selectableRange.rangeEnd=t.rangeEnd,i>=this._selectableRange.rangeStart&&i<=this._selectableRange.rangeEnd?e=r:i<this._selectableRange.rangeStart?e=this._selectableRange.rangeStart.getFullYear():i>this._selectableRange.rangeEnd&&(e=this._selectableRange.rangeEnd.getFullYear()))),this._displayedYear=e,this._selectedYearChanged=!0,this.invalidateProperties(),this.getSelectedRanges()}else this._selectableRange=null,this._selectedYearChanged=!0,this.invalidateProperties()},ia.prototype.getSelectedMonth=function(){return this._selectedRangeCount?this._selectedRanges[0].rangeStart:null},ia.prototype.setSelectedMonth=function(t){var e,i;this._selectedRangeCount=0,F(t)&&(t.length==this._monthFormatString.length?(e=parseInt(t.substring(this._monthFormatString.indexOf("Y"),this._monthFormatString.lastIndexOf("Y")+1)),i=parseInt(t.substring(this._monthFormatString.indexOf("M"),this._monthFormatString.lastIndexOf("M")+1)),t=!isNaN(e)&&!isNaN(i)&&3e3>e&&13>i?new Date(e,i-1,1):new Date(Mb.parse(t+"/01"))):t.length==this._dateFormatString.length?(e=parseInt(t.substring(this._dateFormatString.indexOf("Y"),this._dateFormatString.lastIndexOf("Y")+1)),i=parseInt(t.substring(this._dateFormatString.indexOf("M"),this._dateFormatString.lastIndexOf("M")+1)),t=!isNaN(e)&&!isNaN(i)&&3e3>e&&13>i?new Date(e,i-1,1):new Date(Mb.parse(t))):t=t.length>this._dateFormatString.length?new Date(Mb.parse(t)):new Date(Mb.parse(t+"01"))),t&&dc(t)&&!this._checkDateIsDisabled(t)?(this._addToSelected(t),this._displayedYear=t.getFullYear(),this._selectedYearChanged=!0,this.invalidateProperties()):this._setSelectedIndicators()},ia.prototype.getSelectedRanges=function(){var t;if(this._selectableRange)switch(this._selRangeMode){case 1:this._removeRangeFromSelection(null,this._selectableRange.rangeStart),
this._removeRangeFromSelection(this._selectableRange.rangeEnd,null);break;case 2:case 3:this._removeRangeFromSelection(this._selectableRange.rangeEnd,this._selectableRange.rangeStart);break;case 4:this._removeRangeFromSelection(null,this._selectableRange),this._removeRangeFromSelection(this._selectableRange,null)}for(t=0;t<this._disabledRanges.length;t++)switch(this._disabledRangeMode[t]){case 1:case 2:case 3:this._removeRangeFromSelection(this._disabledRanges[t].rangeStart,this._disabledRanges[t].rangeEnd);break;case 4:this._removeRangeFromSelection(this._disabledRanges[t],this._disabledRanges[t])}return this._selectedRanges.length=this._selectedRangeCount,this._selectedRanges},ia.prototype.setSelectedRanges=function(t){this._selectedRanges=t,this._selectedRangeCount=this._selectedRanges.length,this._setSelectedIndicators()},ia.prototype.getShowThisMonth=function(){return this._showThisMonth},ia.prototype.setShowThisMonth=function(t){this._showThisMonth=t,this._selectedYearChanged=!0,this.invalidateProperties()},ia.prototype.getYearSymbol=function(){return this._yearSymbol},ia.prototype.setYearSymbol=function(t){this._yearSymbol=null!=t?t:B.getString("shared","yearSymbol"),this.invalidateSize(),this.invalidateDisplayList()},ia.prototype._createMonthLabels=function(t){t=this.measureText("WWW").width+8,this._monthBlocksArray=[];for(var e=0;3>e;e++){this._monthBlocksArray[e]=[],this._selectionIndicator[e]=[];for(var i=0;4>i;i++)this._dateGrid.setCellText(i,e,(this._monthNames?this._monthNames[3*i+e]:"")+this.getMonthSymbol()),this._dateGrid.setCellStyle(i,e,"minWidth",t+"px"),this._monthBlocksArray[e][i]=this._dateGrid.getCell(i,e),this._disabledArrays[e]=Array(4)}},ia.prototype._updateDateDisplay=function(){B.getString("shared","dateFormat"),this._tdNodes[0][1].innerHTML="<div class='Kool__"+this.className+"_Year'>"+this.getDisplayedYear()+this.getYearSymbol()+"</div>"},ia.prototype._stepDate=function(t,e){var i=this.getDisplayedYear(),s=i+t;this._displayedYear=s,this._selectedYearChanged=!0,this.invalidateProperties();var r=new Od(Od.SCROLL);r.triggerEvent=e,s>i?r.detail="nextYear":s<i&&(r.detail="previousYear"),this.dispatchEvent(r)},ia.prototype._dispatchChangeEvent=function(t){var e=new Ib(Ib.CHANGE);e.newDate=this._lastSelectedMonth,e.triggerEvent=t,this.dispatchEvent(e)},ia.prototype._checkDateIsDisabled=function(t){if(!t)return!1;var e=!1;if(this._selectableRange&&(this._isMonthInRange(t,this._selectableRange,this._selRangeMode)||(e=!0)),0<this._disabledRanges.length)for(var i=0;i<this._disabledRanges.length;i++)this._isMonthInRange(t,this._disabledRanges[i],this._disabledRangeMode[i])&&(e=!0);return e},ia.prototype._getNumberOfDaysInMonth=ka.prototype._getNumberOfDaysInMonth,ia.prototype._setSelectedIndicators=function(){var t,e,i;for(i=1;12>=i;i++){var s=new Date(this.getDisplayedYear(),i-1,1);e=i-1,t=e%3,e=Math.floor(e/3),this._isSelected(s)&&0==this._disabledArrays[t][e]?this._addSelectionIndicator(t,e):this._removeSelectionIndicator(t,e)}},ia.prototype._isMonthInRange=function(t,e,i,s){s=3<arguments.length&&s;var r=!0;if(e){if(s){var n={};e.rangeStart&&(n.rangeStart=new Date(e.rangeStart.fullYear,0,1)),e.rangeEnd&&(n.rangeEnd=new Date(e.rangeEnd.fullYear,11,31,23,59,59)),e=n}switch(i){case 1:(t<e.rangeStart||t>e.rangeEnd)&&(r=!1);break;case 2:t<e.rangeStart&&(r=!1);break;case 3:t>e.rangeEnd&&(r=!1);break;case 4:(t>e||t<e)&&(r=!1)}}return r},ia.prototype._setSelectedYear=function(t){t=1<arguments.length?t:-1;var e,i,s,r=!1,n=-1==t?this.getDisplayedYear():t,o=new Date,a=o.getFullYear()==n;for(this._thisMonthIndicator&&m.removeClass(this._thisMonthIndicator,"Kool__"+this.className+"_ThisMonth"),e=1;12>=e;e++){s=e-1;var l=new Date(n,s,1);i=s%3,s=Math.floor(s/3);var h=this._monthBlocksArray[i][s];if(this._enabled&&(this._disabledArrays[i][s]=!1,m.removeClass(h,"Kool__"+this.className+"_Disabled"),this._thisMonthIndicator&&r&&m.removeClass(this._thisMonthIndicator,"Kool__"+this.className+"_Disabled")),a&&l.getMonth()==o.getMonth()&&this._showThisMonth?(this._thisMonthRow=s,this._thisMonthColumn=i,r=!0,this._thisMonthIndicator=h,m.addClass(this._thisMonthIndicator,"Kool__"+this.className+"_ThisMonth")):r||this._thisMonthIndicator&&m.removeClass(this._thisMonthIndicator,"Kool__"+this.className+"_ThisMonth"),this._selectableRange&&!this._isMonthInRange(l,this._selectableRange,this._selRangeMode)&&(m.addClass(h,"Kool__"+this.className+"_Disabled"),this._disabledArrays[i][s]=!0),0<this._disabledRanges.length)for(var d=0;d<this._disabledRanges.length;d++)this._isMonthInRange(l,this._disabledRanges[d],this._disabledRangeMode[d])&&(m.addClass(h,"Kool__"+this.className+"_Disabled"),this._disabledArrays[i][s]=!0)}this._displayedYear=n,this._setSelectedIndicators(),this.invalidateDisplayList()},ia.prototype._addToSelected=function(t,e){if(e=1<arguments.length&&e,this._selectedRangeCount||(this._rangeStartDate=null),this._lastSelectedMonth=t,0==e)this._selectedRanges[this._selectedRangeCount]={},this._selectedRanges[this._selectedRangeCount].rangeStart=new Date(t.getFullYear(),t.getMonth(),1),this._selectedRanges[this._selectedRangeCount].rangeEnd=this._selectedRanges[this._selectedRangeCount].rangeStart,this._selectedRangeCount++;else{if(0==this._selectedRangeCount)this._selectedRanges[0]={},this._selectedRanges[0].rangeStart=new Date(t.getFullYear(),t.getMonth(),1);else if(this._selectedRangeCount=1,this._rangeStartDate||(this._rangeStartDate=this._selectedRanges[0].rangeStart),this._selectedRanges[0].rangeStart=new Date(this._rangeStartDate),t<this._selectedRanges[0].rangeStart)return this._selectedRanges[0].rangeEnd=this._selectedRanges[0].rangeStart,void(this._selectedRanges[0].rangeStart=new Date(t));this._selectedRanges[0].rangeEnd=new Date(t)}},ia.prototype._incrementMonth=function(t,e){e=1<arguments.length?e:1;var i=new Date(t.getFullYear(),t.getMonth(),1);return i.setMonth(i.getMonth()+e),i},ia.prototype._isSelected=ka.prototype._isSelected,ia.prototype._removeRangeFromSelection=function(t,e){var i,s;for(i=0;i<this._selectedRangeCount;i++)switch(!t||t<=this._selectedRanges[i].rangeStart?s=1:t<=this._selectedRanges[i].rangeEnd?s=2:t>this._selectedRanges[i].rangeEnd&&(s=3),e<this._selectedRanges[i].rangeStart?s*=5:e<this._selectedRanges[i].rangeEnd?s*=7:(!e||e>=this._selectedRanges[i].rangeEnd)&&(s*=11),s){case 14:var r=this._selectedRanges[i].rangeEnd;this._selectedRanges[i].rangeEnd=this._incrementMonth(t,-1),this._selectedRanges[this._selectedRangeCount]={},this._selectedRanges[this._selectedRangeCount].rangeStart=this._incrementMonth(e),this._selectedRanges[this._selectedRangeCount].rangeEnd=r,this._selectedRangeCount+=1;break;case 7:this._selectedRanges[i].rangeStart=this._incrementMonth(e);break;case 22:this._selectedRanges[i].rangeEnd=this._incrementMonth(t,-1);break;case 11:this._selectedRanges[i]=this._selectedRanges[this._selectedRangeCount-1],this._selectedRanges[this._selectedRangeCount-1]=null,--this._selectedRangeCount}},ia.prototype._addSelectionIndicator=function(t,e){if(!this._selectionIndicator[t][e]){var i=this._monthBlocksArray[t][e];i&&(this._selectionIndicator[t][e]=i)}m.addClass(this._selectionIndicator[t][e],"Kool__"+this.className+"_Selected")},ia.prototype._removeSelectionIndicator=ka.prototype._removeSelectionIndicator,ia.prototype._removeSelectionIndicators=function(){for(var t=0;3>t;t++)for(var e=0;4>e;e++)this._removeSelectionIndicator(t,e)},ia.prototype.createChildren=function(){var t,e,i,s;for(ia._super.createChildren.call(this),this._dateFormatString=B.getString("shared","dateFormat"),this._monthFormatString=B.getString("shared","monthFormat"),this._monthNames=B.getString("formatters","monthNamesShort").split(","),this._monthSymbol=B.getString("shared","monthSymbol"),this._yearSymbol=B.getString("shared","yearSymbol"),this._trNodes=[],this._tdNodes=[],t=document.createElement("tbody"),e=document.createElement("tr"),e.selfElement=this,this._trNodes[0]=e,this._tdNodes[0]=[],s=0;3>s;s++)i=document.createElement("td"),i.selfElement=this,e.appendChild(i),this._tdNodes[0][s]=i;m.addClass(e,"Kool__"+this.className+"_Header"),t.appendChild(e),e=document.createElement("tr"),e.selfElement=this,this._trNodes[1]=e,this._tdNodes[1]=[],i=document.createElement("td"),i.selfElement=this,i.colSpan=3,e.appendChild(i),this._tdNodes[1][0]=i,i.innerHTML="<div class='Kool__"+this.className+"_Line'></div>",t.appendChild(e),e=document.createElement("tr"),e.selfElement=this,this._trNodes[2]=e,this._tdNodes[2]=[],i=document.createElement("td"),i.selfElement=this,i.colSpan=3,e.appendChild(i),this._tdNodes[2][0]=i,t.appendChild(e),this.element.appendChild(t),this._tdNodes[0][0].innerHTML="<img id='"+this.name+"_BackYear' src='"+Ma+"left.png'>",this._tdNodes[0][2].innerHTML="<img id='"+this.name+"_FwdYear' src='"+Ma+"right.png'>",this._dateGrid||(this._dateGrid=new Za,this._tdNodes[2][0].appendChild(this._dateGrid.element),this._dateGrid.parentElement=this,this._dateGrid._parent=this,this._dateGrid.setNestLevel(this._nestLevel+1),this._dateGrid.setRowCount(4),this._dateGrid.setColumnCount(3),this._dateGrid.setPercentWidth(100),this._dateGrid.initialize(),this._createMonthLabels(-1),this._dateGrid.addEventListener(Ib.CHANGE,this._dateGrid_changeHandler,this),this._dateGrid.addEventListener(od.SCROLL,this._dateGrid_scrollHandler,this),this._dateGrid.addEvent("mouseup",this._dateGrid_mouseUpHandler,this),this._dateGrid.addEvent("mouseover",this._dateGrid_mouseOverHandler,this),this._dateGrid.addEvent("mouseout",this._dateGrid_mouseOutHandler,this)),this._selectedYearChanged=!0,this.addEvent("mouseup",this._mouseUpHandler,this),this.addEvent("mousedown",this._mouseEventHandler,this),this.addEvent("mousemove",this._mouseEventHandler,this),this.addEvent("keydown",this._keyDownHandler,this)},ia.prototype.commitProperties=function(){if(ia._super.commitProperties.call(this),this._enabledChanged){for(var t=0;3>t;t++)for(var e=0;4>e;e++)this._enabled?m.removeClass(this._monthBlocksArray[t][e],"Kool__"+this.className+"_Disabled"):m.addClass(this._monthBlocksArray[t][e],"Kool__"+this.className+"_Disabled"),this._disabledArrays[t][e]=this._enabled;this._enabled?(this._selectedYearChanged=!0,this._dateGrid.addEvent("mouseup",this._dateGrid_mouseUpHandler,this),this._dateGrid.addEvent("mouseover",this._dateGrid_mouseOverHandler,this),this._dateGrid.addEvent("mouseout",this._dateGrid_mouseOutHandler,this),this._dateGrid.addEvent("mousemove",this._dateGrid_mouseMoveHandler,this)):(this._dateGrid.removeEvent("mouseup",this._dateGrid_mouseUpHandler,this),this._dateGrid.removeEvent("mouseover",this._dateGrid_mouseOverHandler,this),this._dateGrid.removeEvent("mouseout",this._dateGrid_mouseOutHandler,this),this._dateGrid.removeEvent("mousemove",this._dateGrid_mouseMoveHandler,this)),this._enabledChanged=!1}this._disabledDaysChanged&&(this._disabledDaysChanged=!1,this._dateGrid.setDisabledDays(this._disabledDays.slice(0))),this._selectableRangeChanged&&(this._selectableRangeChanged=!1,this._dateGrid.setSelectableRange(ha(this._selectableRange)?this._selectableRange.slice(0):this._selectableRange),this.invalidateDisplayList()),this._monthNamesChanged&&(this._monthNamesChanged=!1,this._tdNodes[0][1].innerHTML="<div class='Kool__"+this.className+"_Month'>"+this.getDisplayedMonth()+this.getMonthSymbol()+"</div>",this.invalidateDisplayList()),this._selectedYearChanged&&(this._selectedYearChanged=!1,this._isMonthInRange(new Date(-1==this._proposedDisplayedYear?this._displayedYear:this._proposedDisplayedYear),this._selectableRange,this._selRangeMode,!0)&&this._setSelectedYear(),this._proposedDisplayedYear=-1)},ia.prototype.measure=function(){ia._super.measure.call(this),this._updateDateDisplay();var t=m.getOffsetWidth(this.element),e=m.getOffsetHeight(this.element);this.measuredWidth=this.measuredMinWidth=t,this.measuredHeight=this.measuredMinHeight=e},ia.prototype.updateDisplayList=function(t,e){ia._super.updateDisplayList.call(this,t,e),this._updateDateDisplay()},ia.prototype._fwdYearButton_buttonDownHandler=function(t){if(!(this._maxYear<this.getDisplayedYear()+1))if(!this._selectableRange||1!=this._selRangeMode&&3!=this._selRangeMode)4==this._selRangeMode&&this._selectableRange||(this._stepDate(1,t),this.invalidateDisplayList());else{var e=this.getDisplayedYear()+1,e=new Date(e,this._selectableRange.rangeEnd.getMonth(),this._selectableRange.rangeEnd.getDate());this._selectableRange.rangeEnd>=e&&(this._stepDate(1,t),this.invalidateDisplayList())}},ia.prototype._backYearButton_buttonDownHandler=function(t){if(!(this._minYear>this.getDisplayedYear()-1))if(!this._selectableRange||1!=this._selRangeMode&&2!=this._selRangeMode)4==this._selRangeMode&&this._selectableRange||(this._stepDate(-1,t),this.invalidateDisplayList());else{var e=this.getDisplayedYear()-1,e=new Date(e,this._selectableRange.rangeStart.getMonth(),this._selectableRange.rangeStart.getDate());this._selectableRange.rangeStart<=e&&(this._stepDate(-1,t),this.invalidateDisplayList())}},ia.prototype._keyDownHandler=function(t){if(9!=t.keyCode){var e=!1,i=this._lastSelectedMonth?this._lastSelectedMonth.getMonth()+1:1;if(33==t.keyCode||189==t.keyCode||109==t.keyCode?(this._backYearButton_buttonDownHandler(t),e=!0):34==t.keyCode||187==t.keyCode||107==t.keyCode?(this._fwdYearButton_buttonDownHandler(t),e=!0):37==t.keyCode?1<i&&(i--,e=!0):39==t.keyCode?12>i&&(i++,e=!0):38==t.keyCode?3<i&&(i-=3,e=!0):40==t.keyCode?12>=i+3&&(i+=3,e=!0):36==t.keyCode?(i=1,e=!0):35==t.keyCode&&(i=12,e=!0),e){if(e=new Date(this.getDisplayedYear(),i-1,1),this._checkDateIsDisabled(e)&&!t.shiftKey)return;t.shiftKey&&this.allowMultipleSelection||(this._selectedRangeCount=0),this._addToSelected(e,t.shiftKey&&this.allowMultipleSelection),this._setSelectedIndicators(),this._dispatchChangeEvent(t)}t.stopPropagation(),t.preventDefault()}},ia.prototype._mouseEventHandler=function(t){t.stopPropagation(),t.preventDefault()},ia.prototype._mouseUpHandler=function(t){if(t.target&&t.target.id){var e=t.target.id;0<e.indexOf("_BackYear")?this._backYearButton_buttonDownHandler(t):0<e.indexOf("_FwdYear")&&this._fwdYearButton_buttonDownHandler(t),t.stopPropagation(),t.preventDefault()}},ia.prototype._dateGrid_mouseOverHandler=function(t){(t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null)==this._dateGrid?this._dateGrid.addEvent("mousemove",this._dateGrid_mouseMoveHandler,this):(t.stopImmediatePropagation(),t.preventDefault())},ia.prototype._dateGrid_mouseOutHandler=function(t){(t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null)==this._dateGrid?(this._dateGrid.removeEvent("mousemove",this._dateGrid_mouseMoveHandler,this),this._rollOverIndicator&&m.removeClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver")):(t.stopImmediatePropagation(),t.preventDefault())},ia.prototype._dateGrid_mouseMoveHandler=function(t){var e=m.getPaddingMetrics(this),i=this.getWidth(),s=this.getHeight(),r=this._trNodes[2].offsetTop,n=Math.max((i-(e.left+e.right))/3,4),s=Math.max((s-r-e.bottom)/4,4),o=e.left,i=i-e.right-n,a=new ra(t.pageX,t.pageY),a=this.globalToLocal(a);t=a.y,a=a.x,a<o||a>i+n||t<r||(r=Math.floor((t-r)/s),e=Math.floor((a-e.left)/n),e=Math.min(e,2),r=Math.min(r,3),n=this._monthBlocksArray[e][r],!this._disabledArrays[e][r]&&n&&(this._rollOverIndicator&&m.removeClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver"),this._rollOverIndicator=n,this._selectionIndicator[e][r]||m.addClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver")))},ia.prototype._dateGrid_mouseUpHandler=function(t){var e=m.getPaddingMetrics(this),i=this.getWidth(),s=this.getHeight(),r=this._trNodes[2].offsetTop,n=Math.max((i-(e.left+e.right))/3,4),s=Math.max((s-r-e.bottom)/4,4),o=e.left,i=i-e.right-n,a=new ra(t.pageX,t.pageY),a=this.globalToLocal(a),l=a.y,a=a.x;a<o||a>i+n||l<r||(r=Math.floor((l-r)/s),e=Math.floor((a-e.left)/n),e=Math.min(e,2),r=Math.min(r,3),!this._disabledArrays[e][r]&&this._monthBlocksArray[e][r]&&(n=new Date(this.getDisplayedYear(),3*r+e,1),t.shiftKey&&this.allowMultipleSelection?(this._addToSelected(n,!0),this._setSelectedIndicators()):(s=!!this._selectionIndicator[e][r],t.ctrlKey&&this.allowMultipleSelection&&this.allowDisjointSelection?s?(this._removeSelectionIndicator(e,r),this._removeRangeFromSelection(n,n)):(this._addSelectionIndicator(e,r),this._addToSelected(n)):(this._rangeStartDate=null,s?1<this._selectedRangeCount||1==this._selectedRangeCount&&this._selectedRanges[0].rangeStart!=this._selectedRanges[0].rangeEnd?(this._selectedRangeCount=0,this._addSelectionIndicator(e,r),this._addToSelected(n),this._setSelectedIndicators()):t.ctrlKey&&(this._removeSelectionIndicator(e,r),this._removeRangeFromSelection(n,n)):(this._selectedRangeCount=0,this._addSelectionIndicator(e,r),this._addToSelected(n),this._setSelectedIndicators()))),this._dispatchChangeEvent(t),this._selectionIndicator[e][r]&&m.removeClass(this._rollOverIndicator,"Kool__"+this.className+"_RollOver")))},ia.prototype._dateGrid_scrollHandler=function(t){this.dispatchEvent(t)},ia.prototype._dateGrid_changeHandler=function(t){this._selectedDate=t.target.selfElement.getSelectedDate();var e=new Ib(Ib.CHANGE);e.newDate=t.newDate,e.triggerEvent=t.triggerEvent,this.dispatchEvent(e)},z(da,u),da.prototype.setEnabled=ia.prototype.setEnabled,da.prototype.getData=function(){return this._data},da.prototype.setData=function(t){var e;(this._data=t)&&(e=this._listData?E(this._data)?G.getProperty(this._data,this._listData.dataField):this._data[this._listData.dataField]:F(this._data)?this._parseFunction(this._data):this._data),F(e)&&(e=this._parseFunction(e)),this._selectedMonthSet||p(e)||(this.setSelectedMonth(e),this._selectedMonthSet=!1)},da.prototype.getDataText=function(){return this.dataFormatString?this.dateToString(this._parseFunction(this._text,this._formatString),this.dataFormatString):this._text},da.prototype.getText=function(){return this._text},da.prototype.setText=function(t){this._text=t,this._textInput.setText(t)},da.prototype.getListData=function(){return this._listData},da.prototype.setListData=function(t){var e,i;this._listData=t,this._data&&(e=this._listData?E(this._data)?G.getProperty(this._data,this._listData.dataField):this._data[this._listData.dataField]:F(this._data)?this._parseFunction(this._data):this._data),F(e)&&(i=this._parseFunction(e,this.dataFormatString?this.dataFormatString:this._formatString)),this._selectedMonthSet||(this.setSelectedMonth(p(i)?e:i),this._selectedMonthSet=!1)},da.prototype.getDisabledRanges=function(){return this._disabledRanges},da.prototype.setDisabledRanges=function(t){this._disabledRanges=this._scrubTimeValues(t),this._updateDateFiller=this._disabledRangesChanged=!0,this.invalidateProperties()},da.prototype.getDisplayedYear=function(){return this._dropdown&&this._dropdown.getDisplayedYear()!=this._displayedYear?this._dropdown.getDisplayedYear():this._displayedYear},da.prototype.setDisplayedYear=function(t){isNaN(t)||this.getDisplayedYear()==t||(this._displayedYear=t,this._displayedYearChanged=!0,this.invalidateProperties())},da.prototype.getEditable=function(){return this._editable},da.prototype.setEditable=function(t){t!=this._editable&&(this._editable=t,this._editableChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("editableChanged")))},da.prototype.getFormatString=function(){return this._formatString},da.prototype.setFormatString=function(t){this._formatString=null!=t?t:B.getNumber("shared","monthFormat"),this._updateDateFiller=!0,this.invalidateProperties(),this.invalidateSize()},da.prototype.getMaxYear=function(){return this._maxYear},da.prototype.setMaxYear=function(t){isNaN(t)||this._maxYear==t||(this._maxYear=t,this._maxYearChanged=!0,this.invalidateProperties())},da.prototype.getMinYear=function(){return this._minYear},da.prototype.setMinYear=function(t){isNaN(t)||this._minYear==t||(this._minYear=t,this._minYearChanged=!0,this.invalidateProperties())},da.prototype.getMonthNames=function(){return this._monthNames},da.prototype.setMonthNames=ia.prototype.setMonthNames,da.prototype.getMonthSymbol=function(){return this._monthSymbol},da.prototype.setMonthSymbol=function(t){this._monthSymbol=null!=t?t:B.getString("shared","monthSymbol"),this._monthSymbolChanged=!0,this.invalidateProperties()},da.prototype.getParseFunction=function(){return this._parseFunction},da.prototype.setParseFunction=function(t){this._parseFunction=t},da.prototype.getSelectableRange=function(){return this._selectableRange},da.prototype.setSelectableRange=function(t){this._selectableRange=this._scrubTimeValue(t),this._updateDateFiller=this._selectableRangeChanged=!0,this.invalidateProperties()},da.prototype.getSelectedMonth=function(){return this._selectedMonth=this._dropdown?this._dropdown.getSelectedMonth():this._selectedMonth},da.prototype.setSelectedMonth=function(t){F(t)&&(t=this._parseFunction(t,this._formatString)),t&&dc(t)&&0!=ua.dateCompare(this._selectedMonth,t)&&(this._selectedMonth=this._scrubTimeValue(t),this._updateDateFiller=this._selectedMonthSet=this._selectedMonthChanged=!0,this.invalidateProperties())},da.prototype.getShowThisMonth=function(){return this._showThisMonth},da.prototype.setShowThisMonth=function(t){this._showThisMonth=t,this._showThisMonthChanged=!0,this.invalidateProperties()},da.prototype.getYearSymbol=function(){return this._yearSymbol},da.prototype.setYearSymbol=function(t){this._yearSymbol=null!=t?t:B.getString("shared","yearSymbol"),this._yearSymbolChanged=!0,this.invalidateProperties()},da.prototype._createDropdown=function(){this._dropdown=new ia;var t=new Date;this._dropdown.setOwner(this),this._dropdown.setDisplayedYear(t.getFullYear()),this._dropdown.setVisible(!1),this._dropdown.setStyle("position","absolute"),this._dropdown.setStyle("zIndex",Sa.zIndex++),this._dropdown.addEventListener(Ib.CHANGE,this._dropdown_changeHandler,this),this._dropdown.addEventListener(Od.SCROLL,this._dropdown_scrollHandler,this)},da.prototype._dateFiller=function(t){this._text=this.dateToString(t,this._formatString),this._textInput.setText(this._text)},da.prototype._displayDropdown=function(t,e){if(this._enabled&&t!=this._showingDropdown){if(t){null!=this._parseFunction&&(this._selectedMonth=this._parseFunction(this._text,this._formatString)),this._lastSelectedMonth=this._selectedMonth,this._selectedMonth_changeHandler(e),this._dropdown.setVisible(t),v.documentAddEvent("mousedown",this._dropdown_mouseOutsideHandler,this),r.ie8L||v.windowAddEvent("blur",this._dropdown_mouseOutsideHandler,this),this._addedToPopupManager?Ob.bringToFront(this._dropdown):(this._addedToPopupManager=!0,Ob.addPopUp(this._dropdown,this));var i=new ra(this._unscaledWidth-16-5,this._unscaledHeight),s=m.getWindowSize(),i=this.localToGlobal(i);this._dropdown.getSelectedMonth()&&this._dropdown.setDisplayedYear(this._dropdown.getSelectedMonth().getFullYear()),i.x+this._dropdown.getWidth()>s.w&&i.x>s.l+this._dropdown.getWidth()&&(i.x-=this._dropdown.getWidth()-16-5),i.y+this._dropdown.getHeight()>s.h&&i.y>s.t+this._dropdown.getHeight()&&(i.y-=this._unscaledHeight+this._dropdown.getHeight()),i=this._dropdown.getParent().globalToLocal(i),Ob.movePopUp(this._dropdown,i.x,i.y),da._super.focus.call(this)}else v.documentRemoveEvent("mousedown",this._dropdown_mouseOutsideHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._dropdown_mouseOutsideHandler,this),this._addedToPopupManager=!1,Ob.removePopUp(this._dropdown),this._dropdown.setVisible(!1),this.getEditable()?this._textInput.focus():da._super.focus.call(this);this._showingDropdown=t}},da.prototype._scrubTimeValue=ba.prototype._scrubTimeValue,da.prototype._scrubTimeValues=ba.prototype._scrubTimeValues,da.prototype.createChildren=function(){da._super.createChildren.call(this),this._dateFormatString=B.getString("shared","dateFormat"),this._monthNames=B.getString("formatters","monthNamesShort").split(","),this._formatString=B.getString("shared","monthFormat"),this._monthSymbol=B.getString("shared","monthSymbol"),this._yearSymbol=B.getString("shared","yearSymbol"),this._textInput||(this._textInput=new Y,this._textInput.setEditable(!1),this._editableChanged=!0,this.addChild(this._textInput),this._textInput.addEventListener("input",this._textInput_inputHandler,this)),this._downArrowButton||(this._downArrowButton=new Ua,this._downArrowButton.setSrc(Ma+"calendar.png"),this._downArrowButton.addEvent("mousedown",this._downArrowButton_mouseDownHandler,this),this.addChild(this._downArrowButton)),this._createDropdown(),this.addEvent("keydown",this._keyDownHandler,this)},da.prototype.commitProperties=function(){da._super.commitProperties.call(this),this._enabledChanged&&(this._enabledChanged=!1,this._editableChanged=!0,this._textInput.setEnabled(this._enabled),this._downArrowButton.setEnabled(this._enabled)),this._disabledDaysChanged&&(this._disabledDaysChanged=!1,this._dropdown.setDisabledDays(this._disabledDays.slice(0))),this._disabledRangesChanged&&(this._disabledRangesChanged=!1,this._dropdown.setDisabledRanges(this._disabledRanges.slice(0))),this._displayedYearChanged&&(this._displayedYearChanged=!1,this._dropdown.setDisplayedYear(this._displayedYear)),this._maxYearChanged&&(this._maxYearChanged=!1,this._dropdown.setMaxYear(this._maxYear)),this._minYearChanged&&(this._minYearChanged=!1,this._dropdown.setMinYear(this._minYear)),this._monthNamesChanged&&(this._monthNamesChanged=!1,this._dropdown.setMonthNames(this._monthNames?this._monthNames.slice(0):null)),this._selectableRangeChanged&&(this._selectableRangeChanged=!1,this._dropdown.setSelectableRange(ha(this._selectableRange)?this._selectableRange.slice(0):this._selectableRange)),this._selectedMonthChanged&&(this._selectedMonthChanged=!1,this._dropdown.setSelectedMonth(this._selectedMonth)),this._showThisMonthChanged&&(this._showThisMonthChanged=!1,this._dropdown.setShowThisMonth(this._showThisMonth)),this._updateDateFiller&&(this._updateDateFiller=!1,this._dateFiller(this._selectedMonth)),this._yearSymbolChanged&&(this._yearSymbolChanged=!1,this._dropdown.setYearSymbol(this._yearSymbol)),this._monthSymbolChanged&&(this._monthSymbolChanged=!1,this._dropdown.setMonthSymbol(this._monthSymbol)),this._editableChanged&&(this._editableChanged=!1,this._textInput&&(this._textInput.setEditable(this._editable),this._editable?(this._textInput.removeEvent("mousedown",this._textInput_mouseEventHandler,this),this._textInput.addEvent("keydown",this._keyDownHandler,this)):(this._textInput.addEvent("mousedown",this._textInput_mouseEventHandler,this),this._textInput.removeEvent("keydown",this._keyDownHandler,this))))},da.prototype.measure=function(){da._super.measure.call(this);var t=this.dateToString(new Date(2004,5,30),this._formatString);this.measuredMinWidth=this.measuredWidth=this.measureText(t).width+8+3+16,this.measuredMinHeight=this.measuredHeight=this._textInput.getExplicitOrMeasuredHeight()},da.prototype.updateDisplayList=function(t,e){da._super.updateDisplayList.call(this,t,e),this._downArrowButton.setActualSize(16,16),this._downArrowButton.move(t-16-2,Math.round((e-16)/2)),this._textInput.setActualSize(t-16-5,e),this._textInput.setX(0)},da.prototype.open=function(){this._displayDropdown(!0)},da.prototype.close=function(t){this._showingDropdown&&(this._dropdown&&this.getSelectedMonth()!=this._dropdown.getSelectedMonth()&&this.setSelectedMonth(this._dropdown.getSelectedMonth()),this._displayDropdown(!1,t))},da.prototype.dateToString=function(t,e){var i=new id;return i.formatString=e,i.format(t)},da.prototype.stringToDate=function(t,e){var i,s;return t?(t.length==e.length?(i=parseInt(t.substring(e.indexOf("Y"),e.lastIndexOf("Y")+1)),s=parseInt(t.substring(e.indexOf("M"),e.lastIndexOf("M")+1)),i=!isNaN(i)&&!isNaN(s)&&3e3>i&&13>s?new Date(i,s-1,1):new Date(Mb.parse(t+"/01"))):t.length==this._dateFormatString.length?(i=parseInt(t.substring(this._dateFormatString.indexOf("Y"),this._dateFormatString.lastIndexOf("Y")+1)),s=parseInt(t.substring(this._dateFormatString.indexOf("M"),this._dateFormatString.lastIndexOf("M")+1)),i=!isNaN(i)&&!isNaN(s)&&3e3>i&&13>s?new Date(i,s-1,1):new Date(Mb.parse(t))):i=t.length>this._dateFormatString.length?new Date(Mb.parse(t)):new Date(Mb.parse(t+"01")),i?i:null):null},da.prototype.parentChanged=function(t){da._super.parentChanged.call(this,t),p(t)&&this._displayDropdown(!1)},da.prototype.getTextInput=function(){return this._textInput},da.prototype._keyDownHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;9!=t.keyCode&&(!t.altKey||38!=t.keyCode&&40!=t.keyCode?32==t.keyCode?this._showingDropdown||e==this._textInput||(this._displayDropdown(!0,t),t.stopImmediatePropagation(),t.preventDefault()):27==t.keyCode?(this._showingDropdown&&(this.setSelectedMonth(this._lastSelectedMonth),e!=this._textInput&&t.stopImmediatePropagation()),this._displayDropdown(!1,t)):13==t.keyCode?(this.getEditable()?(null!=this._parseFunction&&(this._selectedMonth=this._parseFunction(this._text,this._formatString)),this._showingDropdown&&(this._displayDropdown(!1,t),t.stopImmediatePropagation())):this._showingDropdown&&this.close(t),this._selectedMonth_changeHandler(t)):38!=t.keyCode&&40!=t.keyCode&&37!=t.keyCode&&39!=t.keyCode&&33!=t.keyCode&&34!=t.keyCode&&189!=t.keyCode&&109!=t.keyCode&&187!=t.keyCode&&107!=t.keyCode&&36!=t.keyCode&&35!=t.keyCode||!this._showingDropdown||e==this._textInput||(189!=t.keyCode&&187!=t.keyCode&&109!=t.keyCode&&107!=t.keyCode||(this._yearChangedWithKeys=!0),this._inKeyDown=!0,this._dropdown._keyDownHandler(t),this._inKeyDown=!1,t.stopImmediatePropagation()):(this._showingDropdown?this.close(t):this._displayDropdown(!0,t),t.stopImmediatePropagation()),Xb&&(this.setAttr("aria-label",this.getText()),this.blur(),this.focus()))},da.prototype._selectedMonth_changeHandler=function(t){if((this._dropdown.getSelectedMonth()||this._selectedMonth)&&(this._selectedMonth&&this._dateFiller(this._selectedMonth),!this._dropdown.getSelectedMonth()||!this._selectedMonth||this._dropdown.getSelectedMonth().getFullYear()!=this._selectedMonth.getFullYear()||this._dropdown.getSelectedMonth().getMonth()!=this._selectedMonth.getMonth())){this._dropdown.setSelectedMonth(this._selectedMonth);var e=new Ib(Ib.CHANGE);e.newDate=this._selectedMonth,e.triggerEvent=t,this.dispatchEvent(e)}},da.prototype._textInput_mouseEventHandler=function(t){this._downArrowButton_mouseDownHandler(t)},da.prototype._textInput_inputHandler=function(t){this._text=this._textInput.getText();var e=this._parseFunction(this._text,this._formatString);e&&(this._selectedMonth=e),this._yearChangedWithKeys&&(t.preventDefault(),this._yearChangedWithKeys=!1)},da.prototype._downArrowButton_mouseDownHandler=function(t){this.callLater(this._displayDropdown,[!this._showingDropdown,t])},da.prototype._dropdown_scrollHandler=function(t){this.dispatchEvent(t)},da.prototype._dropdown_changeHandler=function(t){if(this._inKeyDown||this._displayDropdown(!1),0!=ua.dateCompare(this._selectedMonth,this._dropdown.getSelectedMonth())){(this._selectedMonth=this._dropdown.getSelectedMonth())?this._dateFiller(this._selectedMonth):this._textInput.setText("");var e=new Ib(Ib.CHANGE);e.newDate=t.newDate,e.triggerEvent=t.triggerEvent,this.dispatchEvent(e)}},da.prototype._dropdown_mouseOutsideHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t.target!=document&&e&&(this.owns(e)||this._dropdown&&this._dropdown.owns(e))||this.close(t)},ya._defaultStyles={repeatDelay:500,repeatInterval:50},z(ya,u),ya.prototype.setEnabled=function(t){ya._super.setEnabled.call(this),this._enabled=t,this._enabledChanged=!0,this.invalidateProperties()},ya.prototype.getTabIndex=function(){return this._tabIndex},ya.prototype.setTabIndex=function(t){t!=this.getTabIndex()&&(this._tabIndex=t,this._tabIndexChanged=!0,this.invalidateProperties())},ya.prototype.getData=function(){return this._listData||this.setData(this.getValue()),
this._data},ya.prototype.setData=function(t){this._data=t,this._valueSet||(this.setValue(this._listData?parseFloat(this._listData.label):Number(this._data)),this._valueSet=!1),this.dispatchEvent(new w("dataChange"))},ya.prototype.getImeMode=function(){return this._imeMode},ya.prototype.setImeMode=function(t){this._imeMode=t,this._inputField&&this._inputField.setImeMode(t)},ya.prototype.getListData=function(){return this._listData},ya.prototype.setListData=function(t){var e=NaN;if(this._listData=t,null!=this._data)if(this._listData)if(E(this._data))try{e=G.getProperty(this._data,this._listData.dataField)}catch(i){e=NaN}else e=this._data.hasOwnProperty(this._listData.dataField)?this._data[this._listData.dataField]:NaN;else e=Xa(this._data)?this._data:Number(this._data);this._valueSet||(this.setValue(isNaN(e)||p(e)?0:e),this._valueSet=!1)},ya.prototype.getMaxChars=function(){return this._maxChars},ya.prototype.setMaxChars=function(t){t!=this._maxChars&&(this._maxChars=t,this._maxCharsChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("maxCharsChanged")))},ya.prototype.getMaximum=function(){return this._maximum},ya.prototype.setMaximum=function(t){this._maximum=t,this._valueChanged||(this.setValue(this.getValue()),this._valueSet=!1),this.dispatchEvent(new w("maximumChanged"))},ya.prototype.getMinimum=function(){return this._minimum},ya.prototype.setMinimum=function(t){this._minimum=t,this._valueChanged||(this.setValue(this.getValue()),this._valueSet=!1),this.dispatchEvent(new w("minimumChanged"))},ya.prototype.getNextValue=function(){return this._checkRange(this.getValue()+this.getStepSize())&&(this._nextValue=this.getValue()+this.getStepSize()),this._nextValue},ya.prototype.getPreviousValue=function(){return this._checkRange(this._value-this.getStepSize())&&(this._previousValue=this.getValue()-this.getStepSize()),this._previousValue},ya.prototype.getStepSize=function(){return this._stepSize},ya.prototype.setStepSize=function(t){this._stepSize=t,this._valueChanged||(this.setValue(this.getValue()),this._valueSet=!1),this.dispatchEvent(new w("stepSizeChanged"))},ya.prototype.getValue=function(){return this._valueChanged?this._proposedValue:this._value},ya.prototype.setValue=function(t){this._valueSet=!0,this._proposedValue=t,this._valueChanged=!0,this.invalidateProperties(),this.invalidateSize()},ya.prototype.createChildren=function(){ya._super.createChildren.call(this),null==this.getValue()&&this.setValue(this.getMinimum()),this._inputField||(this._inputField=new Y,this._inputField.setRestrict(/^[0-9-.,]+$/g),this._inputField.setMaxChars(this.getMaxChars()),this._inputField.setText(this._value.toString()),this._inputField.parentDrawsFocus=!0,this._inputField.setImeMode(this.getImeMode()),this._inputField.addEvent("keydown",this._keyDownHandler,this),this._inputField.addEventListener("input",this._inputFieldInputHandler,this),r.firefox?this._inputField.addEvent("blur",this._inputFieldFocusOutHandler,this):this._inputField.addEvent("focusout",this._inputFieldFocusOutHandler,this),this.addChild(this._inputField),this._inputField.move(0,0)),this._nextButton||(this._nextButton=new u("div","UpButton"),this._uparrow=new u("span","UpArrow"),this._nextButton.addChild(this._uparrow),this._nextButton.addEvent("click",this._buttonClickHandler,this),this._nextButton.addEvent("mousedown",this._buttonDownHandler,this),this._nextButton.addEvent("mouseup",this._buttonUpHandler,this),this._nextButton.addEvent("mouseleave",this._buttonUpHandler,this),this.addChild(this._nextButton)),this._prevButton||(this._prevButton=new u("div","DownButton"),this._downarrow=new u("span","DownArrow"),this._prevButton.addChild(this._downarrow),this._prevButton.addEvent("click",this._buttonClickHandler,this),this._prevButton.addEvent("mousedown",this._buttonDownHandler,this),this._prevButton.addEvent("mouseup",this._buttonUpHandler,this),this._prevButton.addEvent("mouseleave",this._buttonUpHandler,this),this.addChild(this._prevButton))},ya.prototype.commitProperties=function(){ya._super.commitProperties.call(this),this._maxCharsChanged&&(this._maxCharsChanged=!1,this._inputField.setMaxChars(this._maxChars)),this._valueChanged&&(this._valueChanged=!1,this._setValue(isNaN(this._proposedValue)?0:this._proposedValue,!1)),this._enabledChanged&&(this._enabledChanged=!1,this._prevButton.setEnabled(this.getEnabled()),this._nextButton.setEnabled(this.getEnabled()),this._inputField.setEnabled(this.getEnabled())),this._tabIndexChanged&&(this._inputField.setTabIndex(this.getTabIndex()),this._tabIndexChanged=!1)},ya.prototype.measure=function(){ya._super.measure.call(this);var t=this.getMinimum().toString().length>this.getMaximum().toString().length?this.getMinimum():this.getMaximum(),t=t+this.getStepSize(),e=this.measureText(this._checkValidValue(t).toString()),t=Math.max(e.height,this._inputField.getExplicitOrMeasuredHeight()),i=this._prevButton.getExplicitOrMeasuredHeight()+this._nextButton.getExplicitOrMeasuredHeight(),t=Math.max(t,i),t=Math.max(22,t),e=e.width+pa.TEXT_WIDTH_PADDING+5,i=Math.max(this._prevButton.getExplicitOrMeasuredWidth(),this._nextButton.getExplicitOrMeasuredWidth()),e=Math.max(50,e+i+20);this.measuredMinWidth=40,this.measuredMinHeight=20,this.measuredWidth=e,this.measuredHeight=t},ya.prototype.updateDisplayList=function(t,e){ya._super.updateDisplayList.call(this,t,e);var i=Math.round(e/2),s=e-i;this._nextButton.move(t-20,0),this._nextButton.setActualSize(20,s),this._prevButton.move(t-20,e-s-(0==e%2?0:1)),this._prevButton.setActualSize(20,i),this._uparrow.move(5,i/2-7),this._downarrow.move(5,i/2-3),this._inputField.setActualSize(t-20,e)},ya.prototype.focus=function(){this._inputField?this._inputField.focus():ya._super.focus.call(this)},ya.prototype.blur=function(){this._inputField?this._inputField.blur():ya._super.blur.call(this)},ya.prototype.getTextInput=function(){return this._inputField},ya.prototype._setValue=function(t,e,i){t=this._checkValidValue(t),t!=this._lastValue&&(this._lastValue=this._value=t,this._inputField&&this._inputField.setText(t.toString()),e&&(e=new w("numericStepperChange"),e.value=this.getValue(),e.triggerEvent=i,this.dispatchEvent(e)),this.dispatchEvent(new w("VALUE_COMMIT")))},ya.prototype._checkRange=function(t){return t>=this.getMinimum()&&t<=this.getMaximum()},ya.prototype._checkValidValue=function(t){if(isNaN(t))return this.getValue();t=this.getStepSize()*Math.round(t/this.getStepSize());var e=(1+this.getStepSize()).toString().split(".");return 2==e.length&&(e=Math.pow(10,e[1].length),t=Math.round(t*e)/e),t>this.getMaximum()?this.getMaximum():t<this.getMinimum()?this.getMinimum():t},ya.prototype._takeValueFromTextField=function(t){var e=Number(this._inputField.getText());(e!=this._lastValue&&(1e-6<=Math.abs(e-this._lastValue)||isNaN(e))||""==this._inputField.getText())&&(e=this._checkValidValue(Number(this._inputField.getText())),this._inputField.setText(e.toString()),this._setValue(e,null!=t,t))},ya.prototype._buttonPress=function(t,e){this.getEnabled()&&(this._takeValueFromTextField(),this._setValue(t==this._nextButton.element?this._lastValue+this.getStepSize():this._lastValue-this.getStepSize(),!0,e))},ya.prototype._buttonDownHandler=function(t){var e=this;e._temp=t.currentTarget,e._buttonPress(e._temp,t),e.autoRepeat&&(e._time=setInterval(function(){clearInterval(e._time),e._buttonPress(e._temp,t),e._time=setInterval(function(){e._buttonPress(e._temp,t)},e.getStyle("repeatInterval"))},e.getStyle("repeatDelay")))},ya.prototype._buttonUpHandler=function(t){this._time&&clearInterval(this._time)},ya.prototype._buttonClickHandler=function(t){this._inputField.focus()},ya.prototype._keyDownHandler=function(t){var e;switch(t.keyCode){case 40:e=this._lastValue-this.getStepSize(),this._setValue(e,!0),t.stopPropagation();break;case 38:e=this._lastValue+this.getStepSize(),this._setValue(e,!0),t.stopPropagation();break;case 36:this._inputField.setText(this.getMinimum().toString()),this._setValue(this.getMinimum(),!0),t.stopPropagation();break;case 35:this._inputField.setText(this.getMaximum().toString()),this._setValue(this.getMaximum(),!0),t.stopPropagation();break;case 13:case 9:e=Number(this._inputField.getText()),e!=this._lastValue&&(1e-6<=Math.abs(e-this._lastValue)||isNaN(e))&&(e=this._checkValidValue(Number(this._inputField.getText())),this._inputField.setText(e.toString()),this._setValue(e,!0))}this.dispatchEvent(t)},ya.prototype._inputFieldInputHandler=function(t){t.stopImmediatePropagation(),t=Number(this._inputField.getText()),(t!=this.getValue()&&(1e-6<=Math.abs(t-this.getValue())||isNaN(t))||""==this._inputField.getText())&&(this._value=this._checkValidValue(t))},ya.prototype._inputFieldFocusOutHandler=function(t){this._takeValueFromTextField(t)},Fa._defaultStyles={barColor:["#FF4A5C","#FF1842"],trackColor:["#2A2E32","#2A2E32"],trackRadius:"4px"},z(Fa,u),Fa.LEFT_TOP="left_top",Fa.LEFT="left",Fa.LEFT_BOTTOM="left_bottom",Fa.TOP="top",Fa.CENTER="center",Fa.BOTTOM="bottom",Fa.RIGHT_TOP="right_top",Fa.RIGHT="right",Fa.RIGHT_BOTTOM="right_bottom",Fa.prototype.getLabel=function(){return this._label.getText()},Fa.prototype.setLabel=function(t){this._label.setText(t),this.invalidateDisplayList()},Fa.prototype.getLabelPlacement=function(){return this._labelPlacement},Fa.prototype.setLabelPlacement=function(t){this._labelPlacement=t,this.invalidateDisplayList()},Fa.prototype.getMaximum=function(){return this._maximum},Fa.prototype.setMaximum=function(t){this._maximum=Number(t)},Fa.prototype.getMinimum=function(){return this._minimum},Fa.prototype.setMinimum=function(t){this._minimum=Number(t)},Fa.prototype.getPercentComplete=function(){return this._percentComplete},Fa.prototype.getValue=function(){return this._gaugeValue},Fa.prototype.setStyle=function(t,e){0==t.indexOf("border")?this._barDiv.setStyle(t,e):"barColor"==t?(e&&(r.ie8L?(this._gaugeDiv.setStyle("background","linear-gradient(180deg,"+e[0]+","+e[1]+")"),this._gaugeDiv.setStyle("background","-webkit-linear-gradient(180deg,"+e[0]+","+e[1]+")"),this._gaugeDiv.setStyle("filter","progid:DXImageTransform.Microsoft.Gradient(StartColorStr='"+e[0]+"', EndColorStr='"+e[1]+"')")):(this._gaugeDiv.setStyle("background","linear-gradient(180deg,"+e[0]+","+e[1]+")"),this._gaugeDiv.setStyle("background","-webkit-linear-gradient(180deg,"+e[0]+","+e[1]+")"))),this._styles.barColor=e):"trackColor"==t?(e&&(r.ie8L?(this._barDiv.setStyle("background","linear-gradient(180deg,"+e[0]+","+e[1]+")"),this._barDiv.setStyle("background","-webkit-linear-gradient(180deg,"+e[0]+","+e[1]+")"),this._barDiv.setStyle("filter","progid:DXImageTransform.Microsoft.Gradient(StartColorStr='"+e[0]+"', EndColorStr='"+e[1]+"')")):(this._barDiv.setStyle("background","linear-gradient(180deg,"+e[0]+","+e[1]+")"),this._barDiv.setStyle("background","-webkit-linear-gradient(180deg,"+e[0]+","+e[1]+")"))),this._styles.trackColor=e):"trackRadius"==t?(this._gaugeDiv.setStyle("borderRadius",e),this._styles.trackRadius=e):Fa._super.setStyle.call(this,t,e)},Fa.prototype.getStyle=function(t){return 0==t.indexOf("border")?this._barDiv.getStyle(t):Fa._super.getStyle.call(this,t)},Fa.prototype.reset=function(){this._gaugeDivWidth=this._percentComplete=0,this._gaugeDiv.setWidth(this._gaugeDivWidth-this._gaugeDivHeight)},Fa.prototype.setProgress=function(t,e){t=Number(t),this._minimum>t&&(t=this._minimum),this._maximum=e,this._maximum<t&&(t=this._maximum),this.dispatchEvent(new w("change"));var i=this._barDiv.getWidth(),s=this._barDiv.getSizeStyle("borderTopWidth"),r=this._barDiv.getSizeStyle("borderBottomWidth"),n=this._barDiv.getSizeStyle("borderLeftWidth"),o=this._barDiv.getSizeStyle("borderRightWidth"),a=Math.abs(this._minimum-t)/Math.abs(this._minimum-e)*100;this._gaugeValue=t,this._gaugeDivWidth=a/100*(i-n-o),this._percentComplete=a,this._gaugeDiv.setWidth(this._gaugeDivWidth-n-o),this._gaugeDiv.setHeight(this._gaugeDivHeight-s-r),i=new cc(cc.PROGRESS),i.bytesLoaded=t,i.bytesTotal=this._maximum,this.dispatchEvent(i),t&&t==this._maximum&&this.dispatchEvent(new w("complete")),this.invalidateDisplayList()},Fa.prototype.createChildren=function(){this._barDiv=new u("div","BarDiv"),this._gaugeDiv=new u("div","GaugeDiv"),this._label=new pa,this.addChild(this._barDiv),this._barDiv.addChild(this._gaugeDiv),this.addChild(this._label),this._label.setMultiline(!1),this._label.setWordWrap(!1)},Fa.prototype.updateDisplayList=function(t,e){if(0!=t||0!=e){var i=this._barDiv.getSizeStyle("borderTopWidth"),s=this._barDiv.getSizeStyle("borderBottomWidth");this._gaugeDiv.setActualSize(this._gaugeDivWidth,this._gaugeDiv.getHeight());var r,n,o,a,l,h;switch(o=this._label.getTextWidth()+pa.TEXT_WIDTH_PADDING,this._labelPlacement){case Fa.LEFT_TOP:r=0,n=this._label.getTextHeight(),a=o=0,l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight();break;case Fa.LEFT:o=n=r=0,a=this.getHeight()/2-this._label.getTextHeight()/2,l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight();break;case Fa.LEFT_BOTTOM:o=n=r=0,a=this.getHeight()-this._label.getTextHeight(),l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight();break;case Fa.TOP:r=0,n=this._label.getTextHeight(),o=this.getWidth()/2-o/2,a=0,l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight();break;case Fa.CENTER:n=r=0,o=this.getWidth()/2-o/2,a=this.getHeight()/2-this._label.getTextHeight()/2,l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight();break;case Fa.BOTTOM:n=r=0,o=this.getWidth()/2-o/2,a=this.getHeight()-this._label.getTextHeight(),l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight();break;case Fa.RIGHT_TOP:r=0,n=this._label.getTextHeight(),o=this.getWidth()-o,a=0,l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight();break;case Fa.RIGHT:n=r=0,o=this.getWidth()-o,a=this.getHeight()/2-this._label.getTextHeight()/2,l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight();break;case Fa.RIGHT_BOTTOM:n=r=0,o=this.getWidth()-o,a=this.getHeight()-this._label.getTextHeight(),l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight();break;default:n=r=0,o=this.getWidth()-o,a=this.getHeight()-this._label.getTextHeight(),l=this.getWidth(),this._gaugeDivHeight=h=this.getHeight()-this._label.getTextHeight()}this._barDiv.move(r,n),this._barDiv.setActualSize(l,h),this._label.move(o,a),this._gaugeDiv.setActualSize(this._gaugeDiv.getWidth(),this._gaugeDivHeight-i-s)}},z(qb,u),qb.prototype.getSelected=function(){return this._selected},qb.prototype.setSelected=function(t){this._selected=t,this._selectedChanged=!0,this.invalidateProperties()},qb.prototype.getData=function(){return this._data},qb.prototype.setData=function(t){var e;this._data=t,this._listData?e=this._data[this._listData.dataField]:I(this._data)||(e="boolean"==typeof this._data?this._data:"true"==this._data.toString().toLowerCase()),I(e)||(this._selected=e,this._selectedChanged=!0),this.invalidateProperties()},qb.prototype.getListData=function(){return this._listData},qb.prototype.setListData=function(t){this._listData=t},qb.prototype.getGroupName=function(){return this._groupName},qb.prototype.setGroupName=function(t){this._groupName!=t&&(this._groupName=t,this._groupNameChanged=!0,this.invalidateProperties())},qb.prototype.getLabel=function(){return this._label},qb.prototype.setLabel=function(t){this._label!=t&&(this._label=t,this._labelChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},qb.prototype.getValue=function(){return this._radioElm.element.value},qb.prototype.setValue=function(t){this._radioElm.element.value=t},qb.prototype.getNumChildren=function(){return 0},qb.prototype.setEnabled=function(t){qb._super.setEnabled.call(this,t),this._radioElm&&this._radioElm.setEnabled(t)},qb.prototype.setTabIndex=function(t){this._radioElm.element.tabIndex=t},qb.prototype.createChildren=function(){qb._super.createChildren.call(this);var t="Kool__"+this.name;this._radioElm=new Gd,this._radioElm.setAttr("type",this._type),this._radioElm.setAttr("id",t),this._radioElm.setAttr("name",this._groupName?this._groupName:t),this._radioElm.addEvent("click",this._radioButtonClickHandler,this),this._radioElm.addEvent("change",this._radioButtonChangeHandler,this),this.addChild(this._radioElm),this._lbElm=document.createElement("label"),m.setAttr(this._lbElm,"for",t),m.setAttr(this._lbElm,"htmlFor",t),this._lbElm.selfUIElement=this,this._lbElm.appendChild(document.createTextNode(this._label)),this.element.appendChild(this._lbElm)},qb.prototype.commitProperties=function(){qb._super.commitProperties.call(this),this._selectedChanged&&(this._selected?(this._radioElm.setAttr("checked",this._selected),this._radioElm.element.checked=this._selected):(this._radioElm.setAttr("checked",this._selected),this._radioElm.element.checked=this._selected,this._radioElm.removeAttr("checked")),this._selectedChanged=!1),this._labelChanged&&(this._lbElm.removeChild(this._lbElm.childNodes[0]),this._lbElm.appendChild(document.createTextNode(this._label)),this._labelChanged=!1),this._groupNameChanged&&(this._radioElm.setAttr("name",this._groupName),this._groupNameChanged=!1)},qb.prototype.measure=function(){qb._super.measure.call(this);var t=0,e=0;this._label&&(t=m.getOffsetHeight(this._lbElm),e=m.getOffsetWidth(this._lbElm));var i=this._radioElm.element.size,s=this._radioElm.element.size,t="left"==this._labelPlacement||"right"==this._labelPlacement?Math.max(t,i):t+i,e="top"==this._labelPlacement||"bottom"==this._labelPlacement?Math.max(e,s):e+s;this.measuredMinHeight=this.measuredHeight=Math.max(t,19),this.measuredMinWidth=this.measuredWidth=Math.max(e,19)},qb.prototype.focus=function(){this._radioElm?this._radioElm.focus():qb._super.focus.call(this)},qb.prototype._radioButtonClickHandler=function(t){r.ie8L&&(this._radioElm.element.blur(),this._radioElm.element.focus()),this.dispatchEvent(new w("click"))},qb.prototype._radioButtonChangeHandler=function(t){this._selected=t.currentTarget.checked,this.dispatchEvent(new w("change"))},z(Za,u),Za.prototype.getCellPadding=function(){return this._cellPadding},Za.prototype.setCellPadding=function(t){this._cellPadding!=t&&(this._cellPadding=t,this._cellPaddingChanged=!0,this.invalidateProperties())},Za.prototype.getCellSpacing=function(){return this._cellSpacing},Za.prototype.setCellSpacing=function(t){this._cellSpacing!=t&&(this._cellSpacing=t,this._cellSpacingChanged=!0,this.invalidateProperties())},Za.prototype.getBorder=function(){return this._border},Za.prototype.setBorder=function(t){this._border!=t&&(this._border=t,this._borderChanged=!0,this.invalidateProperties())},Za.prototype.getRowCount=function(){return this._rowCount},Za.prototype.setRowCount=function(t){this._rowCount!=t&&(this._rowCount=t,this._rowCountChanged=!0,this.invalidateProperties())},Za.prototype.getColumnCount=function(){return this._columnCount},Za.prototype.setColumnCount=function(t){this._columnCount!=t&&(this._columnCount=t,this._columnCountChanged=!0,this.invalidateProperties())},Za.prototype._makeCells=function(){var t,e,i,s,r,n=this.element;if(0<n.childNodes.length)for(;n.firstChild;)n.removeChild(n.firstChild);for(this._trNodes=[],this._tdNodes=[],this._cellElements=[],t=document.createElement("tbody"),s=0;s<this._rowCount;s++){for(e=document.createElement("tr"),e.selfElement=this,this._trNodes[s]=e,this._tdNodes[s]=[],this._cellElements[s]=[],r=0;r<this._columnCount;r++)i=document.createElement("td"),i.selfElement=this,i.colIndex=r,e.appendChild(i),this._tdNodes[s][r]=i,this._cellElements[s][r]=null;t.appendChild(e)}n.appendChild(t)},Za.prototype._appendTd=function(t,e){var i,s,r;if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount)&&(i=this._trNodes[t])&&(s=this._tdNodes[t][e])&&!i.contains(s)){for(r=e+1;r<this._columnCount;r++)if(i.contains(this._tdNodes[t][r]))return void i.insertBefore(s,this._tdNodes[t][r]);i.appendChild(s)}},Za.prototype.createChildren=function(){var t=this.element;Za._super.createChildren.call(this),t.cellPadding=this._cellPadding,t.cellSpacing=this._cellSpacing,t.border=this._border,this._makeCells()},Za.prototype.commitProperties=function(){var t=this.element;Za._super.commitProperties.call(this),this._cellPaddingChanged&&(t.cellPadding=this._cellPadding,this._cellPaddingChanged=!1),this._cellSpacingChanged&&(t.cellSpacing=this._cellSpacing,this._cellSpacingChanged=!1),this._borderChanged&&(t.border=this._border,this._borderChanged=!1),(this._rowCountChanged||this._columnCountChanged)&&(this._makeCells(),this._columnCountChanged=this._rowCountChanged=!1)},Za.prototype.setAttr=function(t,e){m.setAttr(this.element,t,e)},Za.prototype.getAttr=function(t){return m.getAttr(this.element,t)},Za.prototype.setCellText=function(t,e,i){0>t||t>=this._rowCount||0>e||e>this._columnCount||(this._cellElements[t][e]&&this.removeCellItem(t,e),this._tdNodes[t][e].innerHTML=i)},Za.prototype.getCellText=function(t,e){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount))return this._tdNodes[t][e].innerHTML},Za.prototype.setCellItem=function(t,e,i){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount)){if(!(i instanceof A))throw Error("seted element is not an instance of LayoutManagerClient");this._cellElements[t][e]&&this.removeCellItem(t,e),i.parentElement=this,this._tdNodes[t][e].appendChild(i.element),i instanceof R&&(i._parent=this,i.setNestLevel(this._nestLevel+1),i.initialize()),this._cellElements[t][e]=i}},Za.prototype.getCellItem=function(t,e){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount))return this._cellElements[t][e]},Za.prototype.removeCellItem=function(t,e){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount)){var i=this._cellElements[t][e];i&&i instanceof A&&(i.parentElement=null,i._parent=null,this._tdNodes[t][e].removeChild(i.element),this._cellElements[t][e]=null)}},Za.prototype.setCellAttr=function(t,e,i,s){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount)){if(!this._tdNodes[t][e])throw Error("set td attribute error");m.setAttr(this._tdNodes[t][e],i,s)}},Za.prototype.getCellAttr=function(t,e,i){if(0>t||t>=this._rowCount||0>e||e>this._columnCount)return null;if(this._tdNodes[t][e])return m.getAttr(this._tdNodes[t][e],i);throw Error("get td attribute error")},Za.prototype.setCellStyle=function(t,e,i,s){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount)){if(!this._tdNodes[t][e])throw Error("set td style error");m.setStyle(this._tdNodes[t][e],i,s)}},Za.prototype.getCellStyle=function(t,e,i){if(0>t||t>=this._rowCount||0>e||e>this._columnCount)return null;if(this._tdNodes[t][e])return m.getStyle(this._tdNodes[t][e],i);throw Error("get td style error")},Za.prototype.getCellStyleInline=function(t,e,i){if(0>t||t>=this._rowCount||0>e||e>this._columnCount)return null;if(this._tdNodes[t][e])return m.getStyleInline(this._tdNodes[t][e],i);throw Error("get td style error")},Za.prototype.getRow=function(t){if(!(0>t||t>=this._rowCount))return this._trNodes[t]},Za.prototype.getCell=function(t,e){if(!(0>t||t>=this._rowCount||0>e||e>this._columnCount))return this._tdNodes[t][e]},Za.prototype.resetSpanAttr=function(t,e){var i,s,r,n,o,a;if(0>t||t>=this._rowCount||0>e||e>=this._columnCount)return!1;if(o=parseInt(m.getAttr(this._tdNodes[t][e],"rowSpan")),a=parseInt(m.getAttr(this._tdNodes[t][e],"colSpan")),1>o&&1>a)return!0;for(i=t;i<t+o;i++)for(r=this._trNodes[i],s=e;s<e+a;s++){if(n=this._tdNodes[i][s],r.contains(n)){if(i==t&&s==e)continue}else this._appendTd(i,s);this.resetSpanAttr(i,s)}return m.setAttr(this._tdNodes[t][e],"rowSpan",1),m.setAttr(this._tdNodes[t][e],"colSpan",1),!0},Za.prototype.setSpanAttr=function(t,e,i,s){var r,n,o,a;if(i=0<i?i:1,s=0<s?s:1,0>t||1>i||t+i-1>=this._rowCount||0>e||1>s||e+s-1>=this._columnCount)return!1;if(a=this._tdNodes[t][e],!a||!this.element.contains(a))return!1;if(r=m.getAttr(a,"rowSpan"),a=m.getAttr(a,"colSpan"),i==r&&s==a)return!0;for((1<i||1<s)&&this.resetSpanAttr(t,e),r=t;r<t+i;r++)for(o=this._trNodes[r],n=e;n<e+s;n++)r==t&&n==e||(a=this._tdNodes[r][n],o.contains(a)&&(this.resetSpanAttr(r,n),o.removeChild(a)));return m.setAttr(this._tdNodes[t][e],"rowSpan",i),m.setAttr(this._tdNodes[t][e],"colSpan",s),!0},Za.prototype.validateSpanAttr=function(t,e,i,s){var r,n,o,a,l;i=0<i?i:1;var h=0<s?s:1;if(0>t||1>i||t+i-1>=this._rowCount||0>e||1>h||e+h-1>=this._columnCount)return!1;if(o=this._tdNodes[t][e],!o||!this.element.contains(o))return!1;for(a=m.getAttr(o,"rowSpan"),o=m.getAttr(o,"colSpan"),l=(a?a:1)*(o?o:1),s=t;s<t+i;s++)for(n=this._trNodes[s],r=e;r<e+h;r++)s==t&&r==e||(o=this._tdNodes[s][r],n.contains(o)&&(a=m.getAttr(o,"rowSpan"),o=m.getAttr(o,"colSpan"),l+=(a?a:1)*(o?o:1)));return l>=i*h},z(Oa,u),Oa.prototype.setEnabled=function(t){t!=this._enabled&&(Oa._super.setEnabled.call(this,t),this._enabledChanged=!0,this.invalidateProperties())},Oa.prototype.getData=function(){return this._data},Oa.prototype.setData=function(t){var e;(this._data=t)&&(e=this._listData?E(this._data)?G.getProperty(this._data,this._listData.dataField):this._data[this._listData.dataField]:E(this._data)?G.elementToString(this._data):F(this._data)?this._data:this._data.toString()),I(e)||this._textSet||(this._text=e,this.element.value=this._text,this._textSet=!1),this.dispatchEvent(new w("change"))},Oa.prototype.getEditable=function(){return this._editable},Oa.prototype.setEditable=function(t){t!=this._editable&&(this._editable=t,this._editableChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("editableChanged")))},Oa.prototype.getImeMode=function(){return this._imeMode},Oa.prototype.setImeMode=function(t){this._imeMode=t,this.setStyle("imeMode",t)},Oa.prototype.getLength=function(){return this._text?this._text.length:-1},Oa.prototype.getListData=function(){return this._listData},Oa.prototype.setListData=function(t){var e;if(this._listData=t,null!=this._data)if(this._listData)if(E(this._data))try{e=G.getProperty(this._data,this._listData.dataField)}catch(i){e=""}else e=this._data.hasOwnProperty(this._listData.dataField)?this._data[this._listData.dataField]:"";else e=F(this._data)?this._data:this._data.toString();p(e)&&(e=""),I(e)||this._textSet||(this._text=e,this.element.value=this._text,this._textSet=!1),this.dispatchEvent(new w("change"))},Oa.prototype.getMaxChars=function(){return this._maxChars},Oa.prototype.setMaxChars=function(t){t!=this._maxChars&&(this._maxChars=t,this._maxCharsChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("maxCharsChanged")))},Oa.prototype.getRestrict=function(){return this._restrict},Oa.prototype.setRestrict=function(t){t&&F(t)&&(t=new RegExp(t)),t!=this._restrict&&(this._restrict=t,this._restrictChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("restrictChanged")))},Oa.prototype.getText=function(){return this.element.value},Oa.prototype.setText=function(t){p(t)&&(t=""),t!==this._text&&(this._textSet=!0,this._text=t,this._textChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("textChanged")))},Oa.prototype.getTextHeight=function(){return this._textHeight=this.measureText(this._text.replace("\n","</br>")).height},Oa.prototype.getTextWidth=function(){return this._textWidth=this.measureText(this._text.replace("\n","</br>")).width},Oa.prototype.createChildren=function(){Oa._super.createChildren.call(this),this._createTextField()},Oa.prototype.commitProperties=function(){Oa._super.commitProperties.call(this),this._textChanged&&(this.element.value=this._text,this._text=this.element.value,this._textChanged=!1),this._enabledChanged&&(this._enabled?this.removeAttr("disabled"):this.setAttr("disabled",!0),this._enabledChanged=!1),this._editableChanged&&(this._editable?this.removeAttr("readOnly"):document.addEventListener?this.setAttr("readOnly",!0):this.setAttr("readOnly","readonly"),this._editableChanged=!1),this._maxCharsChanged&&(this.setAttr("maxLength",this._maxChars),this._maxCharsChanged=!1),this._restrictChanged&&(this._restrictChanged=!1),this._textChanged&&(this.textFieldChanged(!1,!0),this._textChanged=!1)},Oa.prototype.measure=function(){Oa._super.measure.call(this),this.measuredWidth=Y.DEFAULT_MEASURED_WIDTH,this.measuredMinWidth=Y.DEFAULT_MEASURED_MIN_WIDTH,this.measuredMinHeight=this.measuredHeight=2*Y.DEFAULT_MEASURED_MIN_HEIGHT},Oa.prototype.focus=function(){r.ie9?this.select():Oa._super.focus.call(this)},Oa.prototype._createTextField=function(){this.addEvent("focus",this._focusInHandler,this),this.addEvent("change",this._changeHandler,this),this.addEvent("input",this._inputHandler,this),document.addEventListener||(this.addEvent("propertychange",this._inputHandler,this),this.addEvent("keyup",this._keyUpHandler,this))},Oa.prototype._removeTextField=function(){this.element&&(this.removeEvent("focus",this._focusInHandler,this),this.removeEvent("change",this._changeHandler,this),this.removeEvent("input",this._inputHandler,this),document.addEventListener||(this.removeEvent("propertychange",this._inputHandler,this),this.removeEvent("keyup",this._keyUpHandler,this)))},Oa.prototype.select=function(){this.element.select()},Oa.prototype._focusInHandler=function(t){this._editable&&this.element.select()},Oa.prototype._changeHandler=function(t){this._text=this.element.value;var e=new w("change");e.htmlEvent=t,this.dispatchEvent(e)},Oa.prototype._keyUpHandler=function(t){this._inputHandler(t)},Oa.prototype._findDiff=function(t,e){if(!t||!e)return t;for(var i=t.length>=e.length?t.length:e.length,s=0;s<i&&t[s]==e[s];s++);return t.substring(s)},Oa.prototype._inputHandler=function(t){if("propertychange"!=t.type||"value"==t.propertyName){if(this._restrict){var e=this.element.value;if(e&&e!=this._text&&(e=this._findDiff(e,this._text))&&(this._restrict.lastIndex=0,!this._restrict.test(e)))return this.element.value=this._text,t.stopPropagation(),void t.preventDefault()}this._text=this.element.value,e=new w("input"),e.htmlEvent=t,this.dispatchEvent(e)}},z(Y,u),Y.DEFAULT_MEASURED_WIDTH=10,Y.DEFAULT_MEASURED_HEIGHT=22,Y.DEFAULT_MEASURED_MIN_WIDTH=10,Y.DEFAULT_MEASURED_MIN_HEIGHT=22,Y.prototype.getAutocomplete=function(){return this._autocomplete},Y.prototype.setAutocomplete=function(t){this._autocomplete=t,this.setAttr("autocomplete",t)},Y.prototype.setEnabled=function(t){t!=this._enabled&&(Y._super.setEnabled.call(this,t),this._enabledChanged=!0,this.invalidateProperties())},Y.prototype.getData=function(){return this._data},Y.prototype.setData=function(t){var e;(this._data=t)&&(e=this._listData?E(this._data)?G.getProperty(this._data,this._listData.dataField):this._data[this._listData.dataField]:E(this._data)?G.elementToString(this._data):F(this._data)?this._data:this._data.toString()),I(e)||this._textSet||(this._text=e,this.element.value=this._text,this._textSet=!1),this.dispatchEvent(new w("change"))},Y.prototype.getDisplayAsPassword=function(){return this._displayAsPassword},Y.prototype.setDisplayAsPassword=function(t){t!=this._displayAsPassword&&(this._displayAsPassword=t,this._displayAsPasswordChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("displayAsPasswordChanged")))},Y.prototype.getEditable=function(){return this._editable},Y.prototype.setEditable=function(t){t!=this._editable&&(this._editable=t,this._editableChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("editableChanged")))},Y.prototype.getImeMode=function(){return this._imeMode},Y.prototype.setImeMode=function(t){this._imeMode=t,this.setStyle("imeMode",t)},Y.prototype.getLength=function(){return this._text?this._text.length:-1},Y.prototype.getListData=function(){return this._listData},Y.prototype.setListData=function(t){var e;if(this._listData=t,null!=this._data)if(this._listData)if(E(this._data))try{e=G.getProperty(this._data,this._listData.dataField)}catch(i){e=""}else e=this._data.hasOwnProperty(this._listData.dataField)?this._data[this._listData.dataField]:"";else e=F(this._data)?this._data:this._data.toString();p(e)&&(e=""),I(e)||this._textSet||(this._text=e,this.element.value=this._text,this._textSet=!1),
this.dispatchEvent(new w("change"))},Y.prototype.getMaxChars=function(){return this._maxChars},Y.prototype.setMaxChars=function(t){t!=this._maxChars&&(this._maxChars=t,this._maxCharsChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("maxCharsChanged")))},Y.prototype.getName=function(){return this._name},Y.prototype.setName=function(t){this._name=t,this.setAttr("name",t)},Y.prototype.getRestrict=function(){return this._restrict},Y.prototype.setRestrict=function(t){t&&F(t)&&(t=new RegExp(t)),t!=this._restrict&&(this._restrict=t,this._restrictChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("restrictChanged")))},Y.prototype.getText=function(){return this.element.value},Y.prototype.setText=function(t){p(t)&&(t=""),t!==this._text&&(this._textSet=!0,this._text=t,this._textChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("textChanged")),this.dispatchEvent(new w("valueCommit")))},Y.prototype.getTextHeight=function(){return this._textHeight=this.measureText(this._text).height},Y.prototype.getTextWidth=function(){return this._textWidth=this.measureText(this._text).width},Y.prototype.createChildren=function(){Y._super.createChildren.call(this),this.element.type=this._type,this._createTextField()},Y.prototype.commitProperties=function(){if(Y._super.commitProperties.call(this),this._textChanged&&(this.element.value=this._text,this._text=this.element.value,this._textChanged=!1),this._displayAsPasswordChanged){if(this._type=this._displayAsPassword?"password":"text",this.element.type!=this._type)if(document.addEventListener)this.element.type=this._type;else{this._removeTextField();var t=this.element;this.element=null,this.element="input",this._createElement(),this.element.type=this._type,t.size&&(this.element.size=t.size),t.value&&(this.element.value=t.value),t.name&&(this.element.name=t.name),t.id&&(this.element.id=t.id),t.className&&(this.element.className=t.className),t.parentNode.replaceChild(this.element,t),this._createTextField()}this._displayAsPasswordChanged=!1}this._enabledChanged&&(this._enabled?this.removeAttr("disabled"):this.setAttr("disabled",!0),this._enabledChanged=!1),this._editableChanged&&(this._editable?this.removeAttr("readOnly"):document.addEventListener?this.setAttr("readOnly",!0):this.setAttr("readOnly","readonly"),this._editableChanged=!1),this._maxCharsChanged&&(this.setAttr("maxLength",this._maxChars),this._maxCharsChanged=!1),this._restrictChanged&&(this._restrictChanged=!1)},Y.prototype.measure=function(){var t,e;Y._super.measure.call(this),this.measuredWidth=Y.DEFAULT_MEASURED_WIDTH,this._maxChars&&(this.measuredWidth=Math.min(this.measuredWidth,this.measureText("W").width*this._maxChars)),this._text&&""!=this._text?(e=this.measureText(this._text),t=e.width,e=e.height):(t=Y.DEFAULT_MEASURED_MIN_WIDTH,e=this.measureText(" ").height),this.measuredWidth=Math.max(t,this.measuredWidth),this.measuredHeight=Math.max(e,Y.DEFAULT_MEASURED_HEIGHT),this.measuredMinWidth=Y.DEFAULT_MEASURED_MIN_WIDTH,this.measuredMinHeight=Y.DEFAULT_MEASURED_MIN_HEIGHT},Y.prototype.focus=function(){r.ie9?this.select():Y._super.focus.call(this)},Y.prototype._createTextField=function(){this.addEvent("focus",this._focusInHandler,this),this.addEvent("change",this._changeHandler,this),this.addEvent("input",this._inputHandler,this),document.addEventListener||(this.addEvent("propertychange",this._inputHandler,this),this.addEvent("keyup",this._keyUpHandler,this))},Y.prototype._removeTextField=function(){this.element&&(this.removeEvent("focus",this._focusInHandler,this),this.removeEvent("change",this._changeHandler,this),this.removeEvent("input",this._inputHandler,this),document.addEventListener||(this.removeEvent("propertychange",this._inputHandler,this),this.removeEvent("keyup",this._keyUpHandler,this)))},Y.prototype.select=function(){this.element.select()},Y.prototype._focusInHandler=function(t){this._editable&&this.element.select()},Y.prototype._changeHandler=function(t){this._text=this.element.value;var e=new w("change");e.htmlEvent=t,this.dispatchEvent(e)},Y.prototype._keyUpHandler=function(t){this._inputHandler(t)},Y.prototype._findDiff=function(t,e){if(!t||!e)return t;for(var i=t.length>=e.length?t.length:e.length,s=0;s<i&&t[s]==e[s];s++);return t.substring(s)},Y.prototype._inputHandler=function(t){if("propertychange"!=t.type||"value"==t.propertyName&&!this._textChanged&&!this._textSet){if(this._restrict){var e=this.element.value;if(e&&e!=this._text&&(e=this._findDiff(e,this._text))&&(this._restrict.lastIndex=0,!this._restrict.test(e)))return this.element.value=this._text,t.stopPropagation(),void t.preventDefault()}this._text=this.element.value,e=new w("input"),e.htmlEvent=t,e.text=this._text,this.dispatchEvent(e)}},z(lb,Y),lb.prototype.setData=function(t){this._data=t,this._dataChanged=!0,this.invalidateProperties()},lb.prototype.setImeMode=function(t){this._imeMode=t,this._imeModeChanged=!0,this.invalidateProperties()},lb.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties()},lb.prototype.setName=function(t){this._name=t,this._nameChanged=!0,this.invalidateProperties()},lb.prototype.getText=function(){return this._inputText.getText()},lb.prototype.getWidth=function(){return this._inputText?this._inputText.getWidth():lb._super.getWidth.call(this)},lb.prototype.setWidth=function(t){return this._inputText?this._inputText.setWidth(t):lb._super.setWidth.call(this,t)},lb.prototype.getHeight=function(){return this._inputText?this._inputText.getHeight():lb._super.getHeight.call(this)},lb.prototype.setHeight=function(t){return this._inputText?this._inputText.setHeight(t):lb._super.setHeight.call(this,t)},lb.prototype.createChildren=function(){u._super.createChildren.call(this),this._inputText||(this._inputText=new Y,this._inputText.addEventListener("change",this._changeHandler,this),this._inputText.addEventListener("input",this._inputHandler,this),this.addEvent("submit",function(t){return t.preventDefault(),!1}),this.addChild(this._inputText))},lb.prototype.commitProperties=function(){u._super.commitProperties.call(this),this._inputText&&(this._textChanged&&(this._inputText.setText(this._text),this._textChanged=!1),this._displayAsPasswordChanged&&(this._inputText.setDisplayAsPassword(this._displayAsPassword),this._displayAsPasswordChanged=!1),this._enabledChanged&&(this._enabled?this.removeAttr("disabled"):this.setAttr("disabled",!0),this._enabledChanged=!1),this._editableChanged&&(this._inputText.setEditable(this._editable),this._editableChanged=!1),this._maxCharsChanged&&(this._inputText.setMaxChars(this._maxChars),this._maxCharsChanged=!1),this._restrictChanged&&(this._inputText.setRestrict(this._restrict),this._restrictChanged=!1),this._dataChanged&&(this._inputText.setData(this._data),this._dataChanged=!1),this._imeModeChanged&&(this._inputText.setImeMode(this._imeMode),this._imeModeChanged=!1),this._listDataChanged&&(this._inputText.setListData(this._listData),this._listDataChanged=!1),this._nameChanged&&(this._inputText.setName(this._name),this._nameChanged=!1))},lb.prototype.setActualSize=function(t,e){return this._inputText?this._inputText.setActualSize(t,e):lb._super.setActualSize.call(this,t,e)},lb.prototype.getStyle=function(t){return this._inputText?this._inputText.getStyle(t):lb._super.getStyle.call(this,t)},lb.prototype.setStyle=function(t,e){return this._inputText?this._inputText.setStyle(t,e):lb._super.setStyle.call(this,t,e)},lb.prototype.focus=function(){this._inputText?this._inputText.focus():lb._super.focus.call(this)},lb.prototype.blur=function(){this._inputText?this._inputText.blur():lb._super.blur.call(this)},lb.prototype.saveAutocomplete=function(){ld.getInstance().saveAutocomplete(this.getName(),this.getText())},lb.prototype._changeHandler=function(t){this.dispatchEvent(t)},lb.prototype._inputHandler=function(t){this.dispatchEvent(t)},z(Qc,u),Qc.maxWidth=300,Qc.prototype.getText=function(){return this._text},Qc.prototype.setText=function(t){this._text!=t&&(this._text=t,this._textChanged=!0,this.invalidateProperties(),this.invalidateSize())},Qc.prototype.commitProperties=function(){Qc._super.commitProperties.call(this),this._textChanged&&(this.element.innerHTML=this._text,this._textChanged=!1)},Qc.prototype.measure=function(){Qc._super.measure.call(this),this.measuredWidth=this.getWidth(),this.measuredHeight=this.getHeight()},z($d,Ta),$d.prototype.setDirection=function(t){},$d.prototype.getMinHeight=function(t){return 2*r.getScrollBarHeight()+1},$d.prototype.getMinWidth=function(t){return r.getScrollBarWidth()+1};var w=function(t,e,i){this.type=t,this.bubbles=1<arguments.length&&e,this.cancelable=2<arguments.length&&i,this.defaultPrevented=!1,this.eno=Sa.eventNo++,this._stoped=this._istoped=!1};w.prototype.clone=function(){return new w(this.type,this.bubbles,this.cancelable)},w.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0,this.htmlEvent&&(this.htmlEvent.preventDefault?this.htmlEvent.preventDefault():this.htmlEvent.returnValue=!1))},w.prototype.stopImmediatePropagation=function(){this._istoped=!0,this.htmlEvent&&(this.htmlEvent.stopImmediatePropagation?this.htmlEvent.stopImmediatePropagation():this.htmlEvent.cancelBubble=!0)},w.prototype.stopPropagation=function(){this._stoped=!0,this.htmlEvent&&(this.htmlEvent.stopPropagation?this.htmlEvent.stopPropagation():this.htmlEvent.cancelBubble=!0)};var Ib=function(t,e,i,s,r){w.call(this,t,e,i),this.newDate=s,this.triggerEvent=r};z(Ib,w),Ib.CHANGE="change",Ib.prototype.clone=function(){return new Ib(this.type,this.bubbles,this.cancelable,this.newDate,this.triggerEvent)};var md=function(t,e,i,s,r){w.call(this,t,e,i),this.relatedObject=s,this.htmlEvent=r};z(md,w),md.CHILD_ADD="childAdd",md.CHILD_REMOVE="childRemove",md.prototype.clone=function(){return new md(this.type,this.bubbles,this.cancelable,this.relatedObject,this.htmlEvent)};var y=function(t,e,i,s,r,n,o){w.call(this,t,e,i),this.kind=3<arguments.length?s:null,this.location=4<arguments.length?r:-1,this.oldLocation=5<arguments.length?n:-1,this.items=6<arguments.length?o:[]};z(y,w),y.COLLECTION_CHANGE="collectionChange",y.prototype.clone=function(){return new y(this.type,this.bubbles,this.cancelable,this.kind,this.location,this.oldLocation,this.items)};var Ad=function(t,e,i,s){w.call(this,t,e,i),this.menuItemCaption=s};z(Ad,w),Ad.MENU_ITEM_SELECT="menuItemSelect",Ad.prototype.clone=function(){return new Ad(this.type,this.bubbles,this.cancelable,this.menuItemCaption)};var od=function(t,e,i,s,r){w.call(this,t,e,i),this.detail=s,this.triggerEvent=r};z(od,w),od.SCROLL="scroll",od.prototype.clone=function(){return new od(this.type,this.bubbles,this.cancelable,this.detail,this.triggerEvent)};var ac=function(t,e,i,s,r,n,o){w.call(this,t,e,i),this.relatedObject=s,this.oldIndex=r,this.newIndex=n,this.triggerEvent=o};z(ac,w),ac.CHANGE="change",ac.CHILD_INDEX_CHANGE="childIndexChange",ac.HEADER_SHIFT="headerShift",ac.prototype.clone=function(){return new ac(this.type,this.bubbles,this.cancelable,this.relatedObject,this.oldIndex,this.newIndex,this.triggerEvent)};var L=function(t,e,i,s,r,n,o){w.call(this,t,e,i),this.columnIndex=3<arguments.length?s:-1,this.rowIndex=4<arguments.length?r:-1,this.reason=5<arguments.length?n:null,this.itemRenderer=6<arguments.length?o:null};z(L,w),L.CHANGE="change",L.ITEM_FOCUS_IN="itemFocusIn",L.ITEM_FOCUS_OUT="itemFocusOut",L.ITEM_CLICK="itemClick",L.ITEM_DOUBLE_CLICK="itemDoubleClick",L.ITEM_ROLL_OUT="itemRollOut",L.ITEM_ROLL_OVER="itemRollOver",L.ITEM_EDIT_BEGINNING="itemEditBeginning",L.ITEM_EDIT_BEGIN="itemEditBegin",L.ITEM_EDIT_END="itemEditEnd",L.prototype.clone=function(){return new L(this.type,this.bubbles,this.cancelable,this.columnIndex,this.rowIndex,this.reason,this.itemRenderer)};var Od=function(t,e,i,s,r){w.call(this,t,e,i),this.detail=s,this.triggerEvent=r};z(Od,w),Od.SCROLL="scroll",Od.prototype.clone=function(){return new Od(this.type,this.bubbles,this.cancelable,this.detail,this.triggerEvent)};var cc=function(t,e,i,s,r){w.call(this,t,e,i),this.bytesLoaded=s,this.bytesTotal=r};z(cc,w),cc.PROGRESS="progress",cc.prototype.clone=function(){return new cc(this.type,this.bubbles,this.cancelable,this.bytesLoaded,this.bytesTotal)};var wc=function(t,e,i,s,r,n,o,a){w.call(this,t,e,i),this.kind=s,this.property=r,this.oldValue=n,this.newValue=o,this.source=a?a:{}};z(wc,w),wc.PROPERTY_CHANGE="propertyChange",wc.prototype.clone=function(){return new wc(this.type,this.bubbles,this.cancelable,this.kind,this.property,this.oldValue,this.newValue,this.source)};var ma=function(t,e,i,s,r,n,o,a){w.call(this,t,e,i),this.detail=s,this.position=r,this.direction=n,this.delta=o,this.htmlEvent=a};z(ma,w),ma.SCROLL="scroll",ma.prototype.clone=function(){return new ma(this.type,this.bubbles,this.cancelable,this.detail,this.position,this.direction,this.delta,this.htmlEvent)};var bc=function(t,e,i,s){w.call(this,t,e,i),this.toolTip=s};z(bc,w),bc.TOOL_TIP_CREATE="toolTipCreate",bc.TOOL_TIP_END="toolTipEnd",bc.TOOL_TIP_HIDE="toolTipHide",bc.TOOL_TIP_SHOW="toolTipShow",bc.TOOL_TIP_SHOWN="toolTipShown",bc.TOOL_TIP_START="toolTipStart",bc.prototype.clone=function(){return new bc(this.type,this.bubbles,this.cancelable,this.toolTip)};var Yc=function(t,e,i,s){w.call(this,t,e,i),this.value=s};z(Yc,w),Yc.TWEEN_END="tweenEnd",Yc.TWEEN_START="tweenStart",Yc.TWEEN_UPDATE="tweenUpdate",Yc.prototype.clone=function(){return new Yc(this.type,this.bubbles,this.cancelable,this.value)},z(oa,wa),oa.activeTweens=[],oa.timer=null,oa.interval=50,oa.intervalTime=NaN,oa.addTween=function(t){t._id=oa.activeTweens.length,oa.activeTweens.push(t),oa.timer||(oa.timer=new rc(this,oa.timerHandler),oa.timer.start()),O(oa.intervalTime)&&(oa.intervalTime=(new Date).getTime()),t._startTime=t._previousUpdateTime=oa.intervalTime},oa.removeTweenAt=function(t){if(!(t>=oa.activeTweens.length||0>t)){oa.activeTweens.splice(t,1);var e,i=oa.activeTweens.length;for(e=t;e<i;e+=1)t=oa.activeTweens[e],t._id--;i||(oa.intervalTime=NaN,oa.timer.reset(),oa.timer=null)}},oa.removeTween=function(t){oa.removeTweenAt(t._id)},oa.timerHandler=function(t){var e;t=!1;var i;for(e=oa.activeTweens.length,oa.intervalTime=(new Date).getTime(),i=e;0<=i;--i)(e=oa.activeTweens[i])&&(e.needToLayout=!1,e._doInterval(),e.needToLayout&&(t=!0));t&&Ba.getInstance().validateNow()},oa.prototype.getPlayheadTime=function(){return this._playheadTime},oa.prototype.getPlayReversed=function(){return this._invertValues},oa.prototype.setPlayReversed=function(t){this._invertValues=t},oa.prototype.setTweenHandlers=function(t,e){this._updateFunction=t,this._endFunction=e},oa.prototype.setEasingFunction=function(t){this._userEquation=t},oa.prototype.endTween=function(t){var e=new Yc(Yc.TWEEN_END);t=this._getCurrentValue(t?oa.intervalTime-this._startTime:this.duration),this.dispatchEvent(e),null!=this._endFunction?this._endFunction(t):this.listener.onTweenEnd(t),0<=this._id&&oa.removeTweenAt(this._id),e.value=t},oa.prototype.seek=function(t){this._previousUpdateTime=t=oa.intervalTime,this._startTime=t-this._playheadTime,this._doSeek=!0},oa.prototype.reverse=function(){this._isPlaying?(this._doReverse=!1,this.seek(this.duration-this._playheadTime),this._invertValues=!this._invertValues):this._doReverse=!this._doReverse},oa.prototype.pause=function(){this._isPlaying=!1},oa.prototype.stop=function(){0<=this._id&&oa.removeTweenAt(this._id)},oa.prototype.resume=function(){this._isPlaying=!0,this._startTime=oa.intervalTime-this._playheadTime,this._doReverse&&(this.reverse(),this._doReverse=!1)},oa.prototype._defaultEasingFunction=function(t,e,i,s){return i/2*(Math.sin(Math.PI*(t/s-.5))+1)+e},oa.prototype._doInterval=function(){var t,e,i=!1;return this._previousUpdateTime=e=oa.intervalTime,(this._isPlaying||this._doSeek)&&(this._playheadTime=t=e-this._startTime,e=this._getCurrentValue(t),t>=this.duration&&!this._doSeek?(this.endTween(),i=!0):(this._started||(t=new Yc(Yc.TWEEN_START),this.dispatchEvent(t),this._started=!0),t=new Yc(Yc.TWEEN_UPDATE),t.value=e,this.dispatchEvent(t),null!=this._updateFunction?this._updateFunction(e):this.listener.onTweenUpdate(e)),this._doSeek=!1),i},oa.prototype._getCurrentValue=function(t){var e,i,s;if(0==this.duration)return this._endValue;if(this._invertValues&&(t=this.duration-t),this._arrayMode){for(s=[],i=this._startValue.length,e=0;e<i;e++)s.push(this._userEquation(t,this._startValue[e],this._endValue[e]-this._startValue[e],this.duration));return s}return this._userEquation(t,this._startValue,Number(this._endValue)-Number(this._startValue),this.duration)};var id=function(){function t(t,e,i,s){for(;s>=i;s--){var r=t.substring(e,e+s);if(r.length<i)break;var n;t:{var o=r;for(n=0;n<o.length;n++)if(-1=="1234567890".indexOf(o.charAt(n))){n=!1;break t}n=!0}if(n)return r}return null}var e=this;e.id=null,e.formatString="YYYY/MM/DD HH:NN:SS",e.parseFormatString=void 0,e.returnValueWhenError=!1;var i=function(){var t=/D{1,4}|E{1,4}|M{1,4}|YY(?:YY)?|([HhNSTt])\1?|[LloZ]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,s=/[^-+\dA-Z]/g,r=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t};return function(n,o,a){var l=i;1!=arguments.length||"[object String]"!=Object.prototype.toString.call(n)||/\d/.test(n)||(o=n,n=void 0),o=String(l.masks[o]||o||l.masks["default"]),"UTC:"==o.slice(0,4)&&(o=o.slice(4),a=!0);var h=a?"getUTC":"get",d=n[h+"Date"](),c=n[h+"Day"](),_=n[h+"Month"](),u=n[h+"FullYear"](),p=n[h+"Hours"](),g=n[h+"Minutes"](),m=n[h+"Seconds"](),h=n[h+"Milliseconds"](),f=a?0:n.getTimezoneOffset(),y={D:d,DD:r(d),DDD:l.i18n.dayNames[c],DDDD:l.i18n.dayNames[c+7],E:c,EE:r(c),EEE:l.i18n.dayNames[c],EEEE:l.i18n.dayNames[c+7],M:_+1,MM:r(_+1),MMM:l.i18n.monthNames[_],MMMM:l.i18n.monthNames[_+12],YY:String(u).slice(2),YYYY:u,h:p%12||12,hh:r(p%12||12),H:p,HH:r(p),N:g,NN:r(g),S:m,SS:r(m),l:r(h,3),L:r(99<h?Math.round(h/10):h),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:a?"UTC":(String(n).match(e)||[""]).pop().replace(s,""),o:(0<f?"-":"+")+r(100*Math.floor(Math.abs(f)/60)+Math.abs(f)%60,4)};return o.replace(t,function(t){return t in y?y[t]:t.slice(1,t.length-1)})}}();i.masks={"default":"DDD MMM DD YYYY HH:NN:SS",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"DDDD, MMMM D, YYYY",shortTime:"h:NN TT",mediumTime:"h:NN:SS TT",longTime:"h:NN:SS TT Z",isoDate:"YYYY-MM-DD",isoTime:"HH:NN:SS",isoDateTime:"YYYY-MM-DD'T'HH:NN:SS",isoUtcDateTime:"UTC:YYYY-MM-DD'T'HH:NN:SS'Z'"},i.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")},e.getDateFromFormat=function(e,s){e+="",s+="";for(var r,n,o,a,l=0,h=0,d=new Date,c=d.getYear(),_=d.getMonth()+1,u=1,p=d.getHours(),g=d.getMinutes(),d=d.getSeconds(),m="";h<s.length;){for(r=s.charAt(h),n="";s.charAt(h)==r&&h<s.length;)n+=s.charAt(h++);if("YYYY"==n||"YY"==n||"Y"==n){if("YYYY"==n&&(a=o=4),"YY"==n&&(a=o=2),"Y"==n&&(o=2,a=4),c=t(e,l,o,a),null==c)return 0;l+=c.length,2==c.length&&(c=70<c?1900+(c-0):2e3+(c-0))}else if("MMM"==n||"NNN"==n){for(r=_=0;r<i.i18n.monthNames.length;r++){var f=i.i18n.monthNames[r];if(e.substring(l,l+f.length).toLowerCase()==f.toLowerCase()&&("MMM"==n||"NNN"==n&&11<r)){_=r+1,12<_&&(_-=12),l+=f.length;break}}if(1>_||12<_)return 0}else if("EE"==n||"E"==n){for(r=0;r<i.i18n.dayNames.length;r++)if(n=i.i18n.dayNames[r],e.substring(l,l+n.length).toLowerCase()==n.toLowerCase()){l+=n.length;break}}else if("MM"==n||"M"==n){if(_=t(e,l,n.length,2),null==_||1>_||12<_)return 0;l+=_.length}else if("DD"==n||"D"==n){if(u=t(e,l,n.length,2),null==u||1>u||31<u)return 0;l+=u.length}else if("hh"==n||"h"==n){if(p=t(e,l,n.length,2),null==p||1>p||12<p)return 0;l+=p.length}else if("HH"==n||"H"==n){if(p=t(e,l,n.length,2),null==p||0>p||23<p)return 0;l+=p.length}else if("KK"==n||"K"==n){if(p=t(e,l,n.length,2),null==p||0>p||11<p)return 0;l+=p.length}else if("kk"==n||"k"==n){if(p=t(e,l,n.length,2),null==p||1>p||24<p)return 0;l+=p.length,p--}else if("NN"==n||"N"==n||"mm"==n||"m"==n){if(g=t(e,l,n.length,2),null==g||0>g||59<g)return 0;l+=g.length}else if("SS"==n||"S"==n){if(d=t(e,l,n.length,2),null==d||0>d||59<d)return 0;l+=d.length}else if("a"==n){if("am"==e.substring(l,l+2).toLowerCase())m="AM";else{if("pm"!=e.substring(l,l+2).toLowerCase())return 0;m="PM"}l+=2}else{if(e.substring(l,l+n.length)!=n)return 0;l+=n.length}}if(l!=e.length)return 0;if(2==_)if(0==c%4&&0!=c%100||0==c%400){if(29<u)return 0}else if(28<u)return 0;return(4==_||6==_||9==_||11==_)&&30<u?0:(12>p&&"PM"==m?p=p-0+12:11<p&&"AM"==m&&(p-=12),new Date(c,_-1,u,p,g,d))},e.format=function(t){e.error=void 0;var s=t;return s&&0!=s.toString().length?(s=s?dc(s)?t:new Date(Mb.parseWithFormat(s,e.parseFormatString)):new Date,isNaN(s)?(e.error="invalid date",e.returnValueWhenError?t:""):i(s,e.formatString)):(e.error="invalid date",e.returnValueWhenError?t:"")}},jd=function(){this.id=null,this.useNegativeSign=this.useThousandsSeparator=!0,this.precision=-1,this.applyPrecisionToInteger=!0,this.thousandsSeparatorTo=",",this.decimalSeparatorTo=".",this.rounding="none",this.returnValueWhenError=!1};jd.prototype.format=function(t){var e=parseFloat(t),i=-1==this.precision?0:Math.abs(this.precision),s=this.decimalSeparatorTo,r=this.useThousandsSeparator?this.thousandsSeparatorTo:"",e="down"==this.rounding?-1<this.precision&&0<i?Math.floor(e*Math.pow(10,i))/Math.pow(10,i):Math.floor(e):"up"==this.rounding?-1<this.precision&&0<i?Math.ceil(e*Math.pow(10,i))/Math.pow(10,i):Math.ceil(e):"nearest"==this.rounding?-1<this.precision&&0<i?Math.round(e*Math.pow(10,i))/Math.pow(10,i):Math.round(e):e,n=0>e?this.useNegativeSign?"-":"(":"",o=parseInt(e=-1<this.precision?Math.abs(e).toFixed(i+1):Math.abs(e))+"",a=o.length,a=3<a?a%3:0,l=e-o,h="";return this.error=void 0,isNaN(l)?(this.error="invalid number",this.returnValueWhenError?t:""):(0<l?h=s+e.toString().slice(o.toString().length+1):0<i&&(h=s+l.toFixed(i+1).slice(2)),h&&!this.applyPrecisionToInteger&&0<i&&0==l&&(h=""),n+(a?o.substr(0,a)+r:"")+o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+r)+(-1<this.precision?i?h.substr(0,i+s.length):"":h)+("("==n?")":""))};var Wd=function(){this.id=null,this.align="left",this.formatString=void 0,this.numberSymbol="#",this.returnValueWhenError=!1};Wd.prototype.formatValue=function(t,e){var i,s,r="",n=0,o=t.length;for(i=0;i<o;i++)s=t.charAt(i),r=s==this.numberSymbol?r+String(e).charAt(n++):r+t.charAt(i);return r},Wd.prototype.format=function(t){this.error=void 0;var e=String(t).length,i=0,s=0;if(p(t)||ze(t))return this.error="invalid value",this.returnValueWhenError?t:"";for(;0<=(s=this.formatString.indexOf(this.numberSymbol,s));)i++,s++;if(0==i)return this.error="invalid format",this.returnValueWhenError?t:"";if(i>e&&"right"==this.align){for(var r="",s=0,i=this.formatString.length-1;0<=i&&(r=this.formatString.charAt(i)+r,this.formatString.charAt(i)!=this.numberSymbol||(s++,s!=e));i--);return this.formatValue(r,t)}return this.formatValue(this.formatString,t)};var Cd=function(){jd.call(this),this.alignSymbol="right",this.percentSymbol="%",this.multiplyHundred=this.divideHundred=!1};z(Cd,jd),Cd.prototype.format=function(t){var e=parseFloat(t),i=-1==this.precision?0:Math.abs(this.precision),s=this.decimalSeparatorTo,r=this.useThousandsSeparator?this.thousandsSeparatorTo:"";this.error=void 0,this.divideHundred&&(e/=100),this.multiplyHundred&&(e*=100);var e="down"==this.rounding?-1<this.precision&&0<i?Math.floor(e*Math.pow(10,i))/Math.pow(10,i):Math.floor(e):"up"==this.rounding?-1<this.precision&&0<i?Math.ceil(e*Math.pow(10,i))/Math.pow(10,i):Math.ceil(e):"nearest"==this.rounding?-1<this.precision&&0<i?Math.round(e*Math.pow(10,i))/Math.pow(10,i):Math.round(e):e,n=0>e?this.useNegativeSign?"-":"(":"",o=parseInt(e=-1<this.precision?Math.abs(e).toFixed(i+1):Math.abs(e))+"",a=o.length,a=3<a?a%3:0,l=e-o,h="";return isNaN(l)?(this.error="invalid number",this.returnValueWhenError?t:""):(0<l?h=s+e.toString().slice(o.toString().length+1):0<i&&(h=s+l.toFixed(i+1).slice(2)),h&&!this.applyPrecisionToInteger&&0<i&&0==l&&(h=""),"left"==this.alignSymbol?n+this.percentSymbol+(a?o.substr(0,a)+r:"")+o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+r)+(-1<this.precision?i?h.substr(0,i+s.length):"":h)+("("==n?")":""):n+(a?o.substr(0,a)+r:"")+o.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+r)+(-1<this.precision?i?h.substr(0,i+s.length):"":h)+("("==n?")":"")+this.percentSymbol)},z(ad,wa),ad.prototype.getMessage=function(){return this._message},ad.prototype._setMessage=function(t){this._message=t},ad.prototype.getResponders=function(){return this._responders},ad.prototype.getResult=function(){return this._result},ad.prototype.addResponder=function(t){p(this._responders)&&(this._responders=[]),this._responders.push(t)},ad.prototype.hasResponder=function(){return!p(this._responders)&&0<this._responders.length},ad.prototype._applyFault=function(t){if(!p(this._responders))for(var e=0;e<this._responders.length;e++){var i=this._responders[e];p(i)||i.fault(t)}},ad.prototype._applyResult=function(t){if(this._setResult(t.result),!p(this._responders))for(var e=0;e<this._responders.length;e++){var i=this._responders[e];p(i)||i.result(t)}},ad.prototype._setResult=function(t){if(this._result!==t){var e=wc.createUpdateEvent(this,"result",this._result,t);this._result=t,this.dispatchEvent(e)}},le.prototype.result=function(t){this._resultHandler.call(this._context,t,this._token)},le.prototype.fault=function(t){this._faultHandler.call(this._context,t,this._token)};var Jb=function(){u.call(this,"div","ExcelCSVImportUtil"),this.showCloseButton=!0,this.UTF8=!1,this.UTF8Visible=!0,this.headerRowCount=0,this.useGroupedColumn=this.headerRowCountVisible=!0,this.csvDefaultCharSet="iso-8859-1",this.parsingDate=this.forceUseServer=!1,this.fileExtentions="",this._dateFieldNo=this._headerLineCount=-1,this._branchFieldNo=1,this._parseCompleted=!1,this._groupedColumnColNum=0,this.msgKeepColumns=B.getString("datagrid","msgKeepColumns"),this.msgNoDataToRead=B.getString("datagrid","msgNoDataToRead")};z(Jb,u),Jb.prototype.popUp=function(t,e){this._uploadUrl=e,t.addChild(this),this.setWidth(310),this.setX(t.getWidth()/2-this.getWidth()/2),this.setY(t.getHeight()/2-this.getHeight()/2)},Jb.prototype.getUTF8CheckBox=function(){return this._cbUTF8},Jb.prototype.getHeaderRowCntTextInput=function(){return this._rowCnt},Jb.prototype.insertIntoDataGrid=function(t,e){this._importDataGrid=t,0==e?confirm(this.msgKeepColumns)?this._insertImportDataToDataGrid(!0):this._insertImportDataToDataGrid(!1):this._insertImportDataToDataGrid(1==e)},Jb.prototype._parseCsv=function(){if(this._csvStr)if(0>this._csvStr.indexOf("\n"))alert(this.msgNoDataToRead);else if("<?"==this._csvStr.substr(0,2))alert(this.msgNoDataToRead);else{this.headerRowCount=Number(this._rowCnt.getText()),this._parsedHeaderArr=[],this._parsedDataArr=[];var t=new hb;this.parseFunction&&(t.parseFunction=this.parseFunction),t.parsingDate=this.parsingDate,t.setHeaderCnt(this.headerRowCount),this._parsedDataArr=t.parse(this._csvStr),this._parsedHeaderArr=t.getParsedHeaders(),this._parseCompleted=!0,t=new pd(pd.PARSE_COMPLETE,(!1),(!1),this._parsedDataArr,this._parsedHeaderArr),this.dispatchEvent(t),this.dispatchEvent(new w("close"))}else alert(this.msgNoDataToRead);this._removePopUp()},Jb.prototype._getChildrenColumns=function(t,e,i){for(var s=[];t<e;){var r,n=0,o=0;if(i==this._parsedHeaderArr.length-1)n=1;else for(r=t;r<e&&r<this._parsedHeaderArr[i].length;r++)if(this._parsedHeaderArr[i][r]&&0<this._parsedHeaderArr[i][r].length){if(0<n)break;n++}else o++;var a,o=t+o+1;for(a=i+1;a<this._parsedHeaderArr.length;a++)for(r=t;r<o&&r<this._parsedHeaderArr[a].length;r++)this._parsedHeaderArr[a][r]&&0<this._parsedHeaderArr[a][r].length&&n++;1==n?(n=new C,this._parsedHeaderArr[i][t]?n.setHeaderText(this._parsedHeaderArr[i][t]):n.setHeaderText("Column "+(this._groupedColumnColNum+1)),n.setDataField("F"+this._groupedColumnColNum),s.push(n),this._groupedColumnColNum++):(n=new fb,this._parsedHeaderArr[i][t]?n.setHeaderText(this._parsedHeaderArr[i][t]):n.setHeaderText("Header "+i+t),n.children=this._getChildrenColumns(t,o,i+1),s.push(n)),t=o}return s},Jb.prototype._getGroupedData=function(t,e){var i={};if(t.children&&0<t.children.length){var s,r=t.children;for(s=0;s<r.length;s++)r[s]instanceof fb?r[s].getDataField()?i[r[s].getDataField()]=this._getGroupedData(r[s],e):this._getSubData(r[s],e,i):r[s]instanceof C&&(r[s].getDataField()&&(null!=e["F"+this._groupedColumnColNum]?i[r[s].getDataField()]=e["F"+this._groupedColumnColNum]:i[r[s].getDataField()]=null),this._groupedColumnColNum++)}return i},Jb.prototype._getSubData=function(t,e,i){if(t.children&&0<t.children.length){var s=t.children;for(t=0;t<s.length;t++)s[t]instanceof fb?s[t].getDataField()?i[s[t].getDataField()]=this._getGroupedData(s[t],e):this._getSubData(s[t],e,i):s[t]instanceof C&&(s[t].getDataField()&&(null!=e["F"+this._groupedColumnColNum]?i[s[t].getDataField()]=e["F"+this._groupedColumnColNum]:i[s[t].getDataField()]=null),this._groupedColumnColNum++)}},Jb.prototype._insertImportDataToDataGrid=function(t){if(!t)if(this._parsedHeaderArr&&1<this._parsedHeaderArr.length&&this.useGroupedColumn)this._groupedColumnColNum=0,this._importDataGrid.setGroupedColumns(this._getChildrenColumns(0,this._parsedHeaderArr[0].length,0));else{var e,i,s=[];if(this._parsedHeaderArr&&1==this._parsedHeaderArr.length)for(e=0;e<this._parsedHeaderArr[0].length;e++)i=new C,this._parsedHeaderArr[0][e]?i.setHeaderText(this._parsedHeaderArr[0][e]):i.setHeaderText("Column "+(e+1)),i.setDataField("F"+e),s.push(i);else{var r=0;for(e in this._parsedDataArr[0])r++;for(e=0;e<r;e++)i=new C,i.setHeaderText("Column "+(e+1)),i.setDataField("F"+e),s.push(i)}this._importDataGrid.getGroupedColumns()&&0<this._importDataGrid.getGroupedColumns().length?this._importDataGrid.setGroupedColumns(s):this._importDataGrid.setColumns(s)}if(this._parsedDataArr&&0<this._parsedDataArr.length){if(t){if(s=[],this._importDataGrid.getGroupedColumns()&&0<this._importDataGrid.getGroupedColumns().length)for(var n=this._importDataGrid.getGroupedColumns(),o=0;o<this._parsedDataArr.length;o++){for(this._groupedColumnColNum=0,r=this._parsedDataArr[o],i={},e=0;e<n.length;e++)n[e]instanceof fb?n[e].getDataField()?i[n[e].getDataField()]=this._getGroupedData(n[e],r):this._getSubData(n[e],r,i):n[e]instanceof C&&(n[e].getDataField()&&(null!=r["F"+this._groupedColumnColNum]?i[n[e].getDataField()]=r["F"+this._groupedColumnColNum]:i[n[e].getDataField()]=null),this._groupedColumnColNum++);s.push(i)}else for(n=this._importDataGrid.getColumns(),o=0;o<this._parsedDataArr.length;o++){for(r=this._parsedDataArr[o],i={},e=0;e<n.length;e++)n[e].getDataField()&&(null!=r["F"+e]?i[n[e].getDataField()]=r["F"+e]:i[n[e].getDataField()]=null);s.push(i)}this._parsedDataArr=s}this._importDataGrid instanceof l&&this._importDataGrid._isSpanCollectionView()?t&&this._importDataGrid.getDataProvider()instanceof va?this._importDataGrid.getDataProvider().setSource(this._parsedDataArr):this._importDataGrid.setDataProvider(new na(this._parsedDataArr)):this._importDataGrid.setDataProvider(new P(this._parsedDataArr))}else this._importDataGrid instanceof l&&this._importDataGrid._isSpanCollectionView()?this._importDataGrid.setDataProvider(new na([])):this._importDataGrid.setDataProvider(new P([]));t=new w("complete"),this.dispatchEvent(t)},Jb.prototype._removePopUp=function(){if(!this._parseCompleted){var t=new w("cancel");this.dispatchEvent(t)}this.getParent()&&this.getParent().removeChild(this)},Jb.prototype.createChildren=function(){if(Jb._super.createChildren.call(this),this._headerHBox||(this._headerHBox=new u,this._headerHBox.setHeight(18),this._headerHBox.setStyle("textAlign","right"),this.addChild(this._headerHBox)),this._titleLabel||(this._titleLabel=new mc,this._titleLabel.setText(B.getString("datagrid","importTitle")),
this._titleLabel.setX(20),this._titleLabel.setStyle("position","absolute"),this._titleLabel.setStyle("fontWeight","bold"),this._headerHBox.addChild(this._titleLabel)),this._closeImage||(this._closeImage=new Ua,this._closeImage.setSrc(Ma+"close.png"),this._closeImage.setWidth(16),this._closeImage.setHeight(16),this._closeImage.setVisible(this.showCloseButton),this._closeImage.addEvent("click",this._closeImageClickHandler,this),this._headerHBox.addChild(this._closeImage),this._closeImage.setStyle("cursor","pointer"),this._closeImage.setStyle("position",""),this._closeImage.setStyle("float","right")),this._optionHBox||(this._optionHBox=new u,this._optionHBox.setStyle("padding","10px"),this._optionHBox.setStyle("paddingTop","25px"),this._optionHBox.setVisible(this.headerRowCountVisible||this.UTF8Visible),this.addChild(this._optionHBox)),this._rowCntLabel||(this._rowCntLabel=new mc,this._rowCntLabel.setText(B.getString("datagrid","rowCountLabelText")),this._rowCntLabel.setStyle("display","inline"),this._rowCntLabel.setVisible(this.headerRowCountVisible),this._rowCntLabel.setStyle("margin-right","6px"),this._optionHBox.addChild(this._rowCntLabel)),this._rowCnt||(this._rowCnt=new Y,this._rowCnt.setWidth(34),this._rowCnt.setText(this.headerRowCount.toString()),this._rowCnt.setMaxChars(5),this._rowCnt.setVisible(this.headerRowCountVisible),this._optionHBox.addChild(this._rowCnt),this._rowCnt.setStyle("position","")),this._cbUTF8||(this._cbUTF8=new Ka,this._cbUTF8.setLabel(B.getString("datagrid","UTF8")),this._cbUTF8.setSelected(this.UTF8),this._cbUTF8.setStyle("display","inline"),this._cbUTF8.setStyle("paddingLeft","20px"),this._cbUTF8.setVisible(this.UTF8Visible),this._optionHBox.addChild(this._cbUTF8),this._cbUTF8.setStyle("position",""),this._cbUTF8.setWidth(120)),this._fileBox||(this._fileBox=new u,this._fileBox.setStyle("padding","10px"),this.addChild(this._fileBox)),!this._fileInputIFrame){try{this._fileInputIFrame=document.createElement("<iframe name='Kool__"+this.name+"_iframe'>")}catch(t){this._fileInputIFrame=document.createElement("iframe"),this._fileInputIFrame.id="Kool__"+this.name+"_iframe",this._fileInputIFrame.name="Kool__"+this.name+"_iframe"}m.setStyle(this._fileInputIFrame,"width","200px"),m.setStyle(this._fileInputIFrame,"height","0px"),m.setStyle(this._fileInputIFrame,"border","0px"),this._fileBox.element.appendChild(this._fileInputIFrame)}if(!this._fileInputForm){this._fileInputForm=document.createElement("form"),this._fileInputForm.method="POST",this._fileInputForm.enctype="multipart/form-data",this._fileInputForm.encoding="multipart/form-data",this._fileInputForm.target="Kool__"+this.name+"_iframe",this._fileInputForm.id="Kool__excelImportForm"+Math.ceil(1e3*Math.random()),this._fileInputUtf8Element=document.createElement("input"),this._fileInputUtf8Element.name="utf8",this._fileInputUtf8Element.type="hidden",this._fileInputForm.appendChild(this._fileInputUtf8Element);var e=document.createElement("input");e.name="encoding",e.type="hidden",e.value=this.csvDefaultCharSet,this._fileInputForm.appendChild(e),this._fileInputFileElement=document.createElement("input"),this._fileInputFileElement.name="fileImport",this._fileInputFileElement.type="file",this.fileExtentions&&(this._fileInputFileElement.accept=this.fileExtentions),m.setStyle(this._fileInputFileElement,"width","100%"),v.addEvent(this._fileInputFileElement,"change",this._fileInputChangeHandler,this),this._fileInputForm.appendChild(this._fileInputFileElement),this._fileBox.element.appendChild(this._fileInputForm)}},Jb.prototype._closeImageClickHandler=function(t){this.removeEvent("click",this._closeImageClickHandler,this),this._removePopUp()},Jb.prototype._fileInputChangeHandler=function(t){var e=this;e.UTF8=e._cbUTF8.getSelected();var i=e._fileInputFileElement.value,i=i.replace(/^.*[\\\/]/,"");!i||i.match(/[\~\#\%\&\*\{\}\\\:\<\>\?\/\+\|]/)?(alert(B.getString("datagrid","invalidFileName")),e._fileInputFileElement.focus()):"csv"!=i.split(".").pop().toLowerCase()?(alert(B.getString("datagrid","invalidFileExtension",["csv"])),e._fileInputFileElement.focus()):!e.forceUseServer&&window.FileReader?(t=t.target.files[0],i=new FileReader,e.importFileName=t.name,i.onload=function(t){e._csvStr=t.target.result,e._parseCsv()},e.UTF8?i.readAsText(t):i.readAsText(t,e.csvDefaultCharSet)):(v.addEvent2(e._fileInputIFrame,"load",e._loadFileInputIFrameHandler,e),e._fileInputUtf8Element.value=e._cbUTF8.getSelected().toString(),e._fileInputForm.action=e._uploadUrl,e._fileInputForm.submit())},Jb.prototype._loadFileInputIFrameHandler=function(t){if(v.removeEvent2(this._fileInputIFrame,"load",this._loadFileInputIFrameHandler,this),t=t.target.contentDocument?t.target.contentDocument:t.target.contentWindow.document){var e=t.getElementsByTagName("body")[0].innerText||t.getElementsByTagName("body")[0].innterHTML||t.getElementsByTagName("body")[0].textContent;e&&(0<=e.indexOf("fileName=")&&(t=e.substring(e.indexOf("fileName=")+9,e.indexOf("&")),this.importFileName=decodeURIComponent(t).replace(/\+/g," ")),0<=e.indexOf("csvStr=")&&(this._csvStr=e.substr(e.indexOf("csvStr=")+7)),this._parseCsv())}};var hc=function(){u.call(this,"div","ExcelImportUtil"),this.showCloseButton=!0,this.headerRowCount=0,this.useGroupedColumn=this.headerRowCountVisible=!0,this.selectSheet=this.forceUseServer=!1,this.fileExtentions=".xlsx,.xls",this._dateFieldNo=this._headerLineCount=-1,this._branchFieldNo=1,this._parseCompleted=!1,this._groupedColumnColNum=0,this.msgKeepColumns=B.getString("datagrid","msgKeepColumns"),this.msgNoDataToRead=B.getString("datagrid","msgNoDataToRead")};z(hc,u),hc.prototype.popUp=function(t,e){if("undefined"==typeof window.XLSX||!window.XLSX)throw"xlsx.min.js required";this._uploadUrl=e,t.addChild(this),this.setWidth(310),this.setX(t.getWidth()/2-this.getWidth()/2),this.setY(t.getHeight()/2-this.getHeight()/2)},hc.prototype.getHeaderRowCntTextInput=function(){return this._rowCnt},hc.prototype.insertIntoDataGrid=function(t,e){Jb.prototype.insertIntoDataGrid.call(this,t,e)},hc.prototype._parseExcelFile=function(){if(this._base64Str){this.headerRowCount=Number(this._rowCnt.getText());try{if(this._parsedHeaderArr=[],this._parsedDataArr=[],this._wb=window.XLSX.read(this._base64Str,{type:"base64"}),this.selectSheet&&1<this._wb.SheetNames.length){this._optionHBox.setVisible(!1),this._fileInputFileElement.style.display="none",this._sheetHBox.setStyle("position",""),this._sheetHBox.setVisible(!0);for(var t=[B.getString("datagrid","sheetSelectComboBoxOption")],e=0;e<this._wb.SheetNames.length;e++)t.push(this._wb.SheetNames[e]);this._sheetComboBox.setDataProvider(t),this._sheetComboBox.addEventListener("change",this._sheetComboBoxChangeHandler,this)}else this._parseSheet(this._wb.Sheets[this._wb.SheetNames[0]]),this._parseComplete()}catch(i){alert(i.message||i)}}else alert(this.msgNoDataToRead),this._removePopUp()},hc.prototype._parseSheet=function(t){if(null!=t&&null!=t["!ref"])try{var e,i,s,r,n=function(t){var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e},o=function(t){var e,i={s:{c:0,r:0},e:{c:0,r:0}},s=0,r=0,n=t.length;for(e=0;s<n&&!(1>(r=t.charCodeAt(s)-64)||26<r);++s)e=26*e+r;for(i.s.c=--e,e=0;s<n&&!(0>(r=t.charCodeAt(s)-48)||9<r);++s)e=10*e+r;if(i.s.r=--e,s===n||58===t.charCodeAt(++s))return i.e.c=i.s.c,i.e.r=i.s.r,i;for(e=0;s!=n&&!(1>(r=t.charCodeAt(s)-64)||26<r);++s)e=26*e+r;for(i.e.c=--e,e=0;s!=n&&!(0>(r=t.charCodeAt(s)-48)||9<r);++s)e=10*e+r;return i.e.r=--e,i}(t["!ref"]),a=[],l=this.parseFunction?ua.findFunction(this.parseFunction):null;for(r=o.s.c;r<=o.e.c;++r)a[r]=n(r);for(s=o.s.r;s<=o.e.r;++s){for(e={},n={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},r=o.s.c;r<=o.e.c;++r){var h=t[a[r]+(""+(s+1))];e["F"+r]=void 0===h||void 0===h.t?void 0:"e"===h.t?n[h.v]:h.v}if(s<this.headerRowCount){for(i=[],r=o.s.c;r<=o.e.c;++r)i.push(e["F"+r]?e["F"+r]:"");this._parsedHeaderArr.push(i)}else l&&(e=l(e,s)),this._parsedDataArr.push(e)}}catch(d){alert(d.message||d)}},hc.prototype._parseComplete=function(){this._parseCompleted=!0;var t=new qd(qd.PARSE_COMPLETE,(!1),(!1),this._parsedDataArr,this._parsedHeaderArr);this.dispatchEvent(t),this.dispatchEvent(new w("close")),this._removePopUp()},hc.prototype._getChildrenColumns=function(t,e,i){return Jb.prototype._getChildrenColumns.call(this,t,e,i)},hc.prototype._getGroupedData=function(t,e){return Jb.prototype._getGroupedData.call(this,t,e)},hc.prototype._getSubData=function(t,e,i){Jb.prototype._getSubData.call(this,t,e,i)},hc.prototype._insertImportDataToDataGrid=function(t){Jb.prototype._insertImportDataToDataGrid.call(this,t)},hc.prototype._removePopUp=function(){Jb.prototype._removePopUp.call(this)},hc.prototype.createChildren=function(){if(hc._super.createChildren.call(this),this._headerHBox||(this._headerHBox=new u,this._headerHBox.setHeight(18),this._headerHBox.setStyle("textAlign","right"),this.addChild(this._headerHBox)),this._titleLabel||(this._titleLabel=new mc,this._titleLabel.setText(B.getString("datagrid","importExcelTitle")),this._titleLabel.setX(20),this._titleLabel.setStyle("position","absolute"),this._titleLabel.setStyle("fontWeight","bold"),this._headerHBox.addChild(this._titleLabel)),this._closeImage||(this._closeImage=new Ua,this._closeImage.setSrc(Ma+"close.png"),this._closeImage.setWidth(16),this._closeImage.setHeight(16),this._closeImage.setVisible(this.showCloseButton),this._closeImage.addEvent("click",this._closeImageClickHandler,this),this._headerHBox.addChild(this._closeImage),this._closeImage.setStyle("cursor","pointer"),this._closeImage.setStyle("position",""),this._closeImage.setStyle("float","right")),this._optionHBox||(this._optionHBox=new u,this._optionHBox.setStyle("padding","10px"),this._optionHBox.setStyle("paddingTop","25px"),this._optionHBox.setVisible(this.headerRowCountVisible||this.UTF8Visible),this.addChild(this._optionHBox)),this._rowCntLabel||(this._rowCntLabel=new mc,this._rowCntLabel.setText(B.getString("datagrid","rowCountLabelText")),this._rowCntLabel.setStyle("display","inline"),this._rowCntLabel.setVisible(this.headerRowCountVisible),this._rowCntLabel.setStyle("margin-right","6px"),this._optionHBox.addChild(this._rowCntLabel)),this._rowCnt||(this._rowCnt=new Y,this._rowCnt.setWidth(34),this._rowCnt.setText(this.headerRowCount.toString()),this._rowCnt.setMaxChars(5),this._rowCnt.setVisible(this.headerRowCountVisible),this._optionHBox.addChild(this._rowCnt),this._rowCnt.setStyle("position","")),this._sheetHBox||(this._sheetHBox=new u,this._sheetHBox.setStyle("position","absolute"),this._sheetHBox.setStyle("padding","10px"),this._sheetHBox.setStyle("paddingTop","25px"),this._sheetHBox.setVisible(!1),this.addChild(this._sheetHBox)),this._sheetSelectLabel||(this._sheetSelectLabel=new mc,this._sheetSelectLabel.setText(B.getString("datagrid","sheetSelectLabelText")),this._sheetHBox.addChild(this._sheetSelectLabel)),this._sheetComboBox||(this._sheetComboBox=new za,this._sheetComboBox.setWidth(250),this._sheetComboBox.setStyle("marginTop","10px"),this._sheetHBox.addChild(this._sheetComboBox)),this._fileBox||(this._fileBox=new u,this._fileBox.setStyle("padding","10px"),this.addChild(this._fileBox)),!this._fileInputIFrame){try{this._fileInputIFrame=document.createElement("<iframe name='Kool__"+this.name+"_iframe'>")}catch(t){this._fileInputIFrame=document.createElement("iframe"),this._fileInputIFrame.id="Kool__"+this.name+"_iframe",this._fileInputIFrame.name="Kool__"+this.name+"_iframe"}m.setStyle(this._fileInputIFrame,"width","200px"),m.setStyle(this._fileInputIFrame,"height","0px"),m.setStyle(this._fileInputIFrame,"border","0px"),this._fileBox.element.appendChild(this._fileInputIFrame)}this._fileInputForm||(this._fileInputForm=document.createElement("form"),this._fileInputForm.method="POST",this._fileInputForm.enctype="multipart/form-data",this._fileInputForm.encoding="multipart/form-data",this._fileInputForm.target="Kool__"+this.name+"_iframe",this._fileInputForm.id="Kool__excelImportForm"+Math.ceil(1e3*Math.random()),this._fileInputFileElement=document.createElement("input"),this._fileInputFileElement.name="fileImport",this._fileInputFileElement.type="file",this.fileExtentions&&(this._fileInputFileElement.accept=this.fileExtentions),m.setStyle(this._fileInputFileElement,"width","100%"),v.addEvent(this._fileInputFileElement,"change",this._fileInputChangeHandler,this),this._fileInputForm.appendChild(this._fileInputFileElement),this._fileBox.element.appendChild(this._fileInputForm))},hc.prototype._closeImageClickHandler=function(t){Jb.prototype._closeImageClickHandler.call(this,t)},hc.prototype._fileInputChangeHandler=function(t){var e=this,i=e._fileInputFileElement.value,i=i.replace(/^.*[\\\/]/,"");if(!i||i.match(/[\~\#\%\&\*\{\}\\\:\<\>\?\/\+\|]/))alert(B.getString("datagrid","invalidFileName")),e._fileInputFileElement.focus();else if("xls"!=i.split(".").pop().toLowerCase()&&"xlsx"!=i.split(".").pop().toLowerCase())alert(B.getString("datagrid","invalidFileExtension",["xls,xlsx"])),e._fileInputFileElement.focus();else if(!e.forceUseServer&&window.FileReader)t=t.target.files[0],i=new FileReader,e.importFileName=t.name,i.onload=function(t){t=t.target.result;for(var i="",s=0;s<t.byteLength/10240;++s)i+=String.fromCharCode.apply(null,new Uint8Array(Qe.slice(t,10240*s,10240*s+10240)));i+=String.fromCharCode.apply(null,new Uint8Array(Qe.slice(t,10240*s))),e._base64Str=btoa(i),e._parseExcelFile()},i.readAsArrayBuffer(t);else{if(!e._uploadUrl)throw Error("url is required.");v.addEvent2(e._fileInputIFrame,"load",e._loadFileInputIFrameHandler,e),e._fileInputForm.action=e._uploadUrl,e._fileInputForm.submit()}},hc.prototype._loadFileInputIFrameHandler=function(t){if(v.removeEvent2(this._fileInputIFrame,"load",this._loadFileInputIFrameHandler,this),t=t.target.contentDocument?t.target.contentDocument:t.target.contentWindow.document){var e=t.getElementsByTagName("body")[0].innerText||t.getElementsByTagName("body")[0].innterHTML||t.getElementsByTagName("body")[0].textContent;e&&(0<=e.indexOf("fileName=")&&(t=e.substring(e.indexOf("fileName=")+9,e.indexOf("&")),this.importFileName=decodeURIComponent(t).replace(/\+/g," ")),0<=e.indexOf("encodedStr=")&&(this._base64Str=e.substr(e.indexOf("encodedStr=")+11)),this._parseExcelFile())}},hc.prototype._sheetComboBoxChangeHandler=function(t){t=this._sheetComboBox.getSelectedIndex(),0<t&&(this._parseSheet(this._wb.Sheets[this._wb.SheetNames[t-1]]),this._parseComplete())};var Ia=function(){wa.call(this),this._BOF=2057,this._BIFF8=1536,this._BLANK=513,this._CODEPAGE=66,this._COLINFO=125,this._COLWIDTH=36,this._CONTINUE=60,this._DATEMODE=34,this._DEFCOLWIDTH=85,this._DIMENSIONS=512,this._EOF=10,this._EXTSST=255,this._FONT=49,this._FORMAT=1054,this._LABELSST=253,this._MERGEDCELLS=229,this._NUMBER=515,this._PALETTE=146,this._ROW=520,this._SHEET=133,this._SST=252,this._STANDARDWIDTH=153,this._STYLE=659,this._UTF16=1200,this._WINDOW1=61,this._WINDOW2=574,this._XF=224,this._ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this._cellStream=new aa,this._cellStream.endian=aa.LITTLE_ENDIAN,this._cellArrs=[],this._paletteArrOri=[0,16777215,16711680,65280,255,16776960,16711935,65535,-1,-1,-1,-1,-1,-1,-1,-1,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,-1,-1,-1,-1,-1,-1,-1,-1,52479,-1,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,-1,3355545,3355443,"#000000","#FFFFFF","#000000","#00FF00","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#FFFFFF","#000000","#FFFF00","#000000","#000000"],this._paletteArr=this._paletteArrOri.slice(0),this._fontArr=[{h:11,o:0,c:0,w:400,e:0,u:0,n:null},{h:11,o:0,c:0,w:400,e:0,u:0,n:null},{h:11,o:0,c:0,w:400,e:0,u:0,n:null},{h:11,o:0,c:0,w:400,e:0,u:0,n:null},{h:11,o:0,c:0,w:400,e:0,u:0,n:null},{h:11,o:0,c:0,w:400,e:0,u:0,n:null},{h:8,o:0,c:0,w:400,e:0,u:0,n:null}],this._formatArr=[{i:0,t:"n",f:"General"},{i:1,t:"n",f:"0"},{i:2,t:"n",f:"0.00"},{i:3,t:"n",f:"#,##0"},{i:4,t:"n",f:"#,##0.00"},{i:5,t:"c",f:'"\\"#,##0;\\-"\\"#,##0'},{i:6,t:"c",f:'"\\"#,##0;[Red]\\-"\\"#,##0'},{i:7,t:"c",f:'"\\"#,##0.00;\\-"\\"#,##0.00'},{i:8,t:"c",f:'"\\"#,##0.00;[Red]\\-"\\"#,##0.00'},{i:9,t:"p",f:"0%"},{i:10,t:"p",f:"0.00%"},{i:23,t:"c",f:"\\$#,##0_);\\(\\$#,##0\\)"},{i:24,t:"c",f:"\\$#,##0_);[Red]\\(\\$#,##0\\)"},{i:25,t:"c",f:"\\$#,##0.00_);\\(\\$#,##0.00\\)"},{i:26,t:"c",f:"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)"},{i:41,t:"c",f:'_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-'},{i:42,t:"c",f:'_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-'},{i:43,t:"c",f:'_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-'},{i:44,t:"c",f:'_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-'},{i:176,t:"d",f:"yyyy\\/mm\\/dd"},{i:177,t:"d",f:"yyyy-mm-dd"},{i:178,t:"d",f:"yy\\/mm\\/dd"},{i:179,t:"d",f:"yy-mm-dd"},{i:180,t:"d",f:"yyyy\\/mm\\/dd hh:mm"},{i:181,t:"d",f:"yyyy-mm-dd hh:mm"},{i:182,t:"d",f:"yy\\/mm\\/dd hh:mm"},{i:183,t:"d",f:"yy-mm-dd hh:mm"},{i:184,t:"d",f:"yyyy\\/mm\\/dd hh:mm:ss"},{i:185,t:"d",f:"yyyy-mm-dd hh:mm:ss"}],this._xfArr=[{fo:0,fm:0,ty:65525,al:16,it:0,at:0,b1:0,b2:0,b3:8384},{fo:1,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:1,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:2,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:2,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:65525,al:16,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:0,ty:1,al:16,it:0,at:0,b1:0,b2:0,b3:8384},{fo:5,fm:9,ty:65525,al:16,it:0,at:248,b1:0,b2:0,b3:8384},{fo:5,fm:43,ty:65525,al:16,it:0,at:248,b1:0,b2:0,b3:8384},{fo:5,fm:41,ty:65525,al:16,it:0,at:248,b1:0,b2:0,b3:8384},{fo:5,fm:44,ty:65525,al:16,it:0,at:248,b1:0,b2:0,b3:8384},{fo:5,fm:42,ty:65525,al:16,it:0,at:248,b1:0,b2:0,b3:8384},{fo:0,fm:176,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:177,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:178,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:179,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:180,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:181,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:182,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:183,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:184,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384},{fo:0,fm:185,ty:1,al:17,it:0,at:244,b1:0,b2:0,b3:8384}],this._resetCalled=!1,this._titleRowCount=0,this._sstArr=[],this._isMulti=this._exportTxt=this._exportXls=!1,this.defaultBackgroundColor=16777215,this.defaultFontName="Malgun Gothic",this.defaultFontSize=11,this.exportFileName="export.xlsx",this.exportType="xlsx",this.exportTxtSeperator=",",this.exportCodePage=949,this.exportFooterAlign="right",this.exportFooterColor=0,this.exportFooterFontSize=10,this.exportFooterHeight=20,this.exportTitleAlign="center",this.exportTitleColor=0,this.exportTitleFontSize=18,this.exportTitleHeight=50,this.spanedCells=[],this.headerRowCount=0};z(Ia,wa),Ia.prototype.getExportBytes=function(){return this._exportXls?this._cdfStream:this._cellArrs.length},Ia.prototype._writeExcelTag=function(t,e){e.writeShort(t.getType()),e.writeShort(t.getLength()),t._data.setPosition(0),t._data.readBytes(e,e.getPosition(),t._data.getBytesAvailable())},Ia.prototype._strToUTF16=function(t){for(var e,i=new aa,s=0,r=t.length;s<r;)e=t.charCodeAt(s),255>e?(i.writeByte(e),i.writeByte(0)):(i.writeByte(255&e),i.writeByte(e>>8)),s++;return i},Ia.prototype._writeUnicodeStr8BitLength=function(t,e){e&&(t.writeByte(e.length),t.writeByte(1),t.writeBytes(this._strToUTF16(e)))},Ia.prototype._writeUnicodeStr16BitLength=function(t,e){e&&(t.writeShort(e.length),t.writeByte(1),t.writeBytes(this._strToUTF16(e)))},Ia.prototype._checkAndSetColor=function(t){var e;for(e=0;64>e;e++)if(0<=this._paletteArr[e]&&this._paletteArr[e]==t)return e;for(e=8;64>e&&!(0>this._paletteArr[e]);e++);return 64>e?(this._paletteArr[e]=t,e):0},Ia.prototype._checkAndSetFont=function(t,e,i,s,r,n){var o;for(n=n?n:this.defaultFontName,o=0;o<this._fontArr.length;o++)if(n==this._fontArr[o].n&&this._fontArr[o].c==r&&t==this._fontArr[o].h&&(e&&700==this._fontArr[o].w||!e&&400==this._fontArr[o].w)&&(i&&2==(2&this._fontArr[o].o)||!i&&2!=(2&this._fontArr[o].o))&&(s&&0!=this._fontArr[o].u||!s&&0==this._fontArr[o].u))return 4>o?o:o+1;return o={},o.h=t,o.o=i?2:0,o.c=r,o.w=e?700:400,o.e=0,o.u=s?1:0,o.n=n,this._fontArr.push(o),this._fontArr.length},Ia.prototype._checkAndSetFormat=function(t){var e;if(!t)return 0;for(t=0<=t.indexOf("YY")||0<=t.indexOf("M")||0<=t.indexOf("D")||0<=t.indexOf("N")||0<=t.indexOf("S")?0<=t.indexOf("N")?t.replace(/N/g,"M").toLowerCase().replace(/\//g,"\\/"):t.toLowerCase().replace(/\//g,"\\/"):t,e=0;e<this._formatArr.length;e++)if(t==this._formatArr[e].f)return this._formatArr[e].i;return e={},e.i=this._formatArr[this._formatArr.length-1].i+1,e.t="u",e.f=t,this._formatArr.push(e),e.i},Ia.prototype.setExportType=function(t){this.exportType=t,this._exportXls=this._exportTxt=!1,"xls"==t?this._exportXls=!0:"csv"==t?this._exportTxt=!0:"tsv"==t&&(this._exportTxt=!0,this.exportTxtSeperator="\t")},Ia.prototype.getFormatString=function(t){var e,i;if(t instanceof Cd){if(e=t.useThousandsSeparator?"#,##0":"0",0<t.precision)for(e+=".",i=0;i<t.precision;i++)e+="0";e="left"==t.alignSymbol?'"'+t.percentSymbol+'"'+e:e+'"'+t.percentSymbol+'"',t.useNegativeSign||(e="_("+e+"_);("+e+")")}else if(t instanceof jd){if(e=t.useThousandsSeparator?"#,##0":"0",0<t.precision)for(e+=".",i=0;i<t.precision;i++)e+="0";t.useNegativeSign||(e="_("+e+"_);("+e+")")}else if(t instanceof id)e=t.formatString;else if(t instanceof Wd)e=t.formatString,0<=e.indexOf(":")&&(e=e.replace(/:/g,'":"')),0<=e.indexOf("/")&&(e=e.replace(/\//g,'"/"'));else if(t instanceof ae){if(e=t.useThousandsSeparator?"#,##0":"0",0<t.precision)for(e+=".",i=0;i<t.precision;i++)e+="0";e="left"==t.alignSymbol?'"'+t.currencySymbol+'"'+e:e+'"'+t.currencySymbol+'"',t.useNegativeSign||(e="_("+e+"_);("+e+")")}return e},Ia.prototype.reset=function(){var t;if(!this._isMulti){for(this._paletteArr=this._paletteArrOri.slice(0);7<this._fontArr.length;)this._fontArr.pop();for(t=0;t<this._fontArr.length;t++)this._fontArr[t].h=6==t?8:this.defaultFontSize,this._fontArr[t].n=this.defaultFontName;for(;29<this._formatArr.length;)this._formatArr.pop();for(;31<this._xfArr.length;)this._xfArr.pop()}this._titleRowCount=this.exportTitle?1:0,this._internalMergedCells=[],this._resetCalled=!0},Ia.prototype.getXfIndex=function(t,e,i,s,r,n,o,a,l,h,d,c,_,u,p,g,m,f,y,b,v){for(r=this._checkAndSetColor(r),t=this._checkAndSetFont(Math.round(.75*(0<=t?t:this.defaultFontSize)),e,i,s,r,n),o=this._checkAndSetFormat(o),s=i=e=0,n=this._checkAndSetColor(0<=v?v:this.defaultBackgroundColor),c&&(e=this._checkAndSetColor(_)),p&&(i=this._checkAndSetColor(g)),f&&(s=this._checkAndSetColor(y)),_={},_.fo=t,_.fm=o,_.ty=1,_.al=0,a&&("left"==a?_.al|=1:"center"==a?_.al|=2:"right"==a&&(_.al|=3)),h&&(_.al|=8),l&&("middle"==l?_.al|=16:"bottom"==l&&(_.al|=32)),_.it=d,_.at=244,_.b1=0,_.b2=0,c&&(_.b1="double"==u?1536|_.b1:"dotted"==u?1024|_.b1:"dashed"==u?768|_.b1:"medium"==u?512|_.b1:"none"==u?0|_.b1:256|_.b1,_.b2|=e),p&&(_.b1="double"==m?24576|_.b1:"dotted"==m?16384|_.b1:"dashed"==m?12288|_.b1:"medium"==m?8192|_.b1:"none"==m?0|_.b1:4096|_.b1,_.b2|=i<<7),f&&(_.b1="double"==b?102|_.b1:"dotted"==b?68|_.b1:"dashed"==b?51|_.b1:"medium"==b?34|_.b1:17|_.b1,_.b1=_.b1|s<<16|s<<23),0<=v&&(_.b2|=67108864),_.b3=8320|n,a=0;a<this._xfArr.length;a++)if(this._xfArr[a].fo==_.fo&&this._xfArr[a].fm==_.fm&&this._xfArr[a].ty==_.ty&&this._xfArr[a].al==_.al&&this._xfArr[a].it==_.it&&this._xfArr[a].at==_.at&&this._xfArr[a].b1==_.b1&&this._xfArr[a].b2==_.b2&&this._xfArr[a].b3==_.b3)return a;return this._xfArr.push(_),this._xfArr.length-1},Ia.prototype.writeColumnInfo=function(t,e,i,s){if(s=3<arguments.length?s:-1,!this._exportTxt)if(this._exportXls){var r=0<=s?s:0,n=new eb(this._COLINFO);n._data.writeShort(t),n._data.writeShort(t),i?(n._data.writeShort(28*e),n._data.writeShort(r),n._data.writeShort(2)):(n._data.writeShort(0),n._data.writeShort(r),n._data.writeShort(3)),n._data.writeShort(0),this._colInfoStream||(this._colInfoStream=new aa,this._colInfoStream.endian=aa.LITTLE_ENDIAN),this._writeExcelTag(n,this._colInfoStream)}else this._colInfoStr||(this._colInfoStr=""),this._colInfoStr+='<col min="'+(t+1)+'" max="'+(t+1)+(i?"":'" hidden="1')+'" width="'+e/9+'"/>'},Ia.prototype.writeCellLabel=function(t,e,i,s){s=3<arguments.length?s:-1;var r,n=0<s?s:0,o=t+this._titleRowCount;this._exportXls?(o=new eb(this._LABELSST),o._data.writeShort(t+this._titleRowCount),o._data.writeShort(e),o._data.writeShort(n),i&&0<i.length?(r=this._sstArr.length,this._sstArr.push(i),o._data.writeUnsignedInt(r)):o._type=this._BLANK,this._writeExcelTag(o,this._cellStream)):(this._cellArrs[o]||(this._cellArrs[o]=[]),i&&0<i.length?this._exportTxt?this._cellArrs[o][e]=i:(r=this._sstArr.length,i&&" "==i.charAt(0)&&(i="$zpa@ce@$"+i),this._sstArr.push(G.escapeXML(i)),r='<c r="'+this._getA1addr(e,o)+'" s="'+n+'" t="s"><v>'+r+"</v></c>",this._cellArrs[o][e]=r.toString()):this._exportTxt?this._cellArrs[o][e]='""':(r='<c r="'+this._getA1addr(e,o)+'" s="'+n+'"/>',this._cellArrs[o][e]=r.toString()))},Ia.prototype.writeCellNumber=function(t,e,i,s){s=3<arguments.length?s:-1;var r,n;n=0<s?s:0;var o=t+this._titleRowCount;this._exportXls?(o=new eb(this._NUMBER),o._data.writeShort(t+this._titleRowCount),o._data.writeShort(e),o._data.writeShort(n),isNaN(i)?o._type=this._BLANK:o._data.writeDouble(i),this._writeExcelTag(o,this._cellStream)):(this._cellArrs[o]||(this._cellArrs[o]=[]),isNaN(i)?this._exportTxt?this._cellArrs[o][e]="":(n='<c r="'+this._getA1addr(e,o)+'" s="'+n+'"/>',this._cellArrs[o][e]=n.toString()):isFinite(i)?this._exportTxt?this._cellArrs[o][e]=i.toString():(n='<c r="'+this._getA1addr(e,o)+'" s="'+n+'"><v>'+i+"</v></c>",this._cellArrs[o][e]=n.toString()):this._exportTxt?this._cellArrs[o][e]=i.toString():(r=this._sstArr.length,this._sstArr.push(G.escapeXML(i.toString())),n='<c r="'+this._getA1addr(e,o)+'" s="'+n+'" t="s"><v>'+r+"</v></c>",this._cellArrs[o][e]=n.toString()))},Ia.prototype.writeCellDate=function(t,e,i,s){s=3<arguments.length?s:-1;var r,n=0<s?s:21,o=t+this._titleRowCount;if(i)if(1900>i.getFullYear())r=s;else{r=1e3*(60*(60*i.getHours()+i.getMinutes())+i.getSeconds())+i.getMilliseconds();var a=(Math.floor((i.getTime()-r)/1e3)-60*i.getTimezoneOffset())/86400+25569;r=r?a+r/864e5:a}this._exportXls?(a=new eb(this._NUMBER),a._data.writeShort(o),a._data.writeShort(e),a._data.writeShort(n),i?a._data.writeDouble(r):a._type=this._BLANK,this._writeExcelTag(a,this._cellStream)):(this._cellArrs[o]||(this._cellArrs[o]=[]),this._cellArrs[o][e]=i?this._exportTxt?r.toString():'<c r="'+this._getA1addr(e,o)+'" s="'+n+'"><v>'+r+"</v></c>":this._exportTxt?"":'<c r="'+this._getA1addr(e,o)+'" s="'+n+'"/>')},Ia.prototype.writeCellBlank=function(t,e,i){i=2<arguments.length?i:-1;var s;s=0<i?i:0;var r=t+this._titleRowCount;if(this._exportXls){var n=new eb(this._BLANK);n._data.writeShort(r),n._data.writeShort(e),n._data.writeShort(s),this._writeExcelTag(n,this._cellStream)}else this._cellArrs[r]||(this._cellArrs[r]=[]),this._exportTxt?this._cellArrs[r][e]="":(s='<c r="'+this._getA1addr(e,r)+'" s="'+s+'"/>',this._cellArrs[r][e]=s.toString())},Ia.prototype._numToAlpha=function(t){var e=Math.floor(t/26)-1;return(-1<e?this._numToAlpha(e):"")+this._ALPHABET.charAt(t%26)},Ia.prototype._getA1addr=function(t,e){return this._numToAlpha(t)+(e+1)},Ia.prototype._makeWorkbookGlobalsStreamXlsx=function(){if("undefined"==typeof window.JSZip||!window.JSZip)throw"jszip.min.js required";var t,e;this._zip=new window.JSZip,this._zip.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>'),this._zip.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'),t=this._zip.folder("docProps"),t.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>KoolGrid</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="1" baseType="lpstr"><vt:lpstr>'+(this.exportSheetName?this.exportSheetName:"Sheet1")+"</vt:lpstr></vt:vector></TitlesOfParts><Manager></Manager><Company>RiaMore Soft</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>3.0</AppVersion></Properties>"),t.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>KoolGrid.js</dc:creator><cp:lastModifiedBy>KoolGrid.js</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">'+Mb.toISOString(new Date)+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+Mb.toISOString(new Date)+"</dcterms:modified></cp:coreProperties>"),this._zip_xl=this._zip.folder("xl"),this._zip_xl.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView xWindow="0" yWindow="45" windowWidth="19080" windowHeight="11370" tabRatio="200"/></bookViews><sheets><sheet name="'+(this.exportSheetName?this.exportSheetName:"Sheet1")+'" sheetId="1" r:id="rId1"/></sheets><calcPr calcId="0"/></workbook>'),
this._zip_xl.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/></Relationships>'),this._zip_xl.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface="Malgun Gothic"/><a:font script="Hans" typeface="?"/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface="Malgun Gothic"/><a:font script="Hans" typeface="?"/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>');var i,s;if(4<this._formatArr.length){for(i='<numFmts count="'+(this._formatArr.length-4)+'">',t=4;t<this._formatArr.length;t++)i+='<numFmt numFmtId="'+this._formatArr[t].i+'" formatCode="'+G.escapeXML(this._formatArr[t].f)+'"/>';i+="</numFmts>"}if(0<this._fontArr.length){for(s='<fonts count="'+this._fontArr.length+'" x14ac:knownFonts="1">',t=0;t<this._fontArr.length;t++)s+='<font><sz val="'+Math.round(this._fontArr[t].h)+'"/>',s+='<name val="'+G.escapeXML(this._fontArr[t].n)+'"/>',400<this._fontArr[t].w&&(s+="<b/>"),this._fontArr[t].u&&(s+="<u/>"),this._fontArr[t].o&&(s+="<i/>"),s+='<color rgb="'+N.no2hex(this._paletteArr[this._fontArr[t].c])+'"/>',s+='<charset val="1"/>',s+="</font>";s+="</fonts>"}var r='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+this._xfArr.length+'">',n=[{idx:-1,str:'<fill><patternFill patternType="none"/></fill>'},{idx:-2,str:'<fill><patternFill patternType="gray125"/></fill>'}],o=[{idx:"00",str:"<border><left/><right/><top/><bottom/></border>"}];for(t=0;t<this._xfArr.length;t++){var a=this._xfArr[t],r=r+('<xf numFmtId="'+a.fm+'" fontId="'+(4>a.fo?a.fo:a.fo-1)+'" xfId="0"');if(67108864&a.b2){var l=(65535&a.b3)-8320;for(e=2;e<n.length;e++)if(n[e].idx==l){r+=' fillId="'+e+'"';break}e>=n.length&&(n.push({idx:l,str:'<fill><patternFill patternType="solid"><fgColor rgb="'+N.no2hex(this._paletteArr[l])+'"/></patternFill></fill>'}),r+=' fillId="'+(n.length-1)+'"')}else r+=' fillId="0"';var l=a.b1,h=16777215&a.b2,d=l.toString(16)+h.toString(16),c="";for(e=0;e<o.length;e++)if(o[e].idx==d){r+=' borderId="'+e+'"';break}e>=o.length&&(e=(8323072&l)>>16,17==(255&l)?c+='<left style="thin"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="thin"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':34==(255&l)?c+='<left style="medium"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':51==(255&l)?c+='<left style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':68==(255&l)?c+='<left style="dotted"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="dotted"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':102==(255&l)&&(c+='<left style="double"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="double"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>'),e=127&h,256==(3840&l)?c+='<top style="thin"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':512==(3840&l)?c+='<top style="medium"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':768==(3840&l)?c+='<top style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':1024==(3840&l)?c+='<top style="dotted"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':1536==(3840&l)&&(c+='<top style="double"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>'),h=(16256&h)>>7,4096==(61440&l)?c+='<bottom style="thin"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':8192==(61440&l)?c+='<bottom style="medium"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':12288==(61440&l)?c+='<bottom style="dashed"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':16384==(61440&l)?c+='<bottom style="dotted"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':24576==(61440&l)&&(c+='<bottom style="double"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>'),o.push({idx:d,str:"<border>"+c+"</border>"}),r+=' borderId="'+(o.length-1)+'"'),r+=">",(a.al||a.it)&&(l=a.al,r+="<alignment"+(3==(3&l)?' horizontal="right"':2==(3&l)?' horizontal="center"':1==(3&l)?' horizontal="left"':"")+(16==(240&l)?' vertical="center"':32==(240&l)?' vertical="bottom"':' vertical="top"')+(8==(8&l)?' wrapText="1"':"")+(a.it?' indent="'+a.it+'"':"")+"/>"),r+="</xf>"}for(r+="</cellXfs>",this._xfArr=null,a='<fills count="'+n.length+'">',t=0;t<n.length;t++)a+=n[t].str;for(a+="</fills>",n='<borders count="'+o.length+'">',t=0;t<o.length;t++)n+=o[t].str;for(n+="</borders>",o="<colors><indexedColors>",t=0;64>t;t++)o=0<=this._paletteArr[t]?o+('<rgbColor rgb="'+N.no2hex(this._paletteArr[t])+'"/>'):o+'<rgbColor rgb="000000"/>';this._zip_xl.file("styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+i+s+a+n+r+(o+"</indexedColors></colors>")+"</styleSheet>"),i=new Bd,i.append('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="105" uniqueCount="105">'),0<this._sstArr.length&&(t="<si><t>"+this._sstArr.join("</t></si><si><t>"),0<t.indexOf("<t>$zpa@ce@$")&&(t=t.replace(/<t>\$zpa@ce@\$/g,'<t xml:space="preserve">')),i.append(t),i.append("</t></si>")),this._sstArr=null,i.append("</sst>"),this._zip_xl.file("sharedStrings.xml",i.toString())},Ia.prototype._getSheetStreamXlsx=function(){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetViews><sheetView workbookViewId="0" showOutlineSymbols="true"/></sheetViews><sheetFormatPr defaultRowHeight="19.5" x14ac:dyDescent="0.3"/>';this._colInfoStr&&(t+="<cols>"+this._colInfoStr+"</cols>");var e,i,s,r,n=new Bd;for(n.append("<sheetData>"),e=0,s=this._cellArrs.length;e<s;e++)if(this._cellArrs[e]&&this._cellArrs[e].length){for(n.append('<row r="'),n.append(e+1),0==e&&this.exportTitle?(n.append('" customHeight="1" x14ac:dyDescent="0.35" ht="'),n.append(.75*this.exportTitleHeight)):e==s-1&&this.exportFooter&&(n.append('" customHeight="1" x14ac:dyDescent="0.35" ht="'),n.append(.75*this.exportFooterHeight)),n.append('">'),i=0,r=this._cellArrs[e].length;i<r;i++)this._cellArrs[e][i]&&n.append(this._cellArrs[e][i]);n.append("</row>"),this._cellArrs[e]=null}if(this._cellArrs={length:s},n.append("</sheetData>"),t+=n.toString(),this.mergedCells&&0<this.mergedCells.length||this._internalMergedCells&&0<this._internalMergedCells.length){if(i='<mergeCells count="'+((this.mergedCells?this.mergedCells.length:0)+(this._internalMergedCells?this._internalMergedCells.length:0))+'">',this.mergedCells)for(e=0;e<this.mergedCells.length;e++)i+='<mergeCell ref="'+this._getA1addr(this.mergedCells[e].colNo,this.mergedCells[e].rowNo+this._titleRowCount)+":"+this._getA1addr(this.mergedCells[e].colNo+this.mergedCells[e].colSpan-1,this.mergedCells[e].rowNo+this._titleRowCount+this.mergedCells[e].rowSpan-1)+'"/>';if(this._internalMergedCells)for(e=0;e<this._internalMergedCells.length;e++)i+='<mergeCell ref="'+this._getA1addr(this._internalMergedCells[e].colNo,this._internalMergedCells[e].rowNo)+":"+this._getA1addr(this._internalMergedCells[e].colNo+this._internalMergedCells[e].colSpan-1,this._internalMergedCells[e].rowNo+this._internalMergedCells[e].rowSpan-1)+'"/>';t+=i+"</mergeCells>"}return t+"</worksheet>"},Ia.prototype._makeSheetStreamXlsx=function(){this._zip_xl.folder("worksheets").file("sheet1.xml",this._getSheetStreamXlsx())},Ia.prototype._makeWorkbookGlobalsStream1=function(){this._wbGlobalsStream=new aa,this._wbGlobalsStream.endian=aa.LITTLE_ENDIAN;var t=new eb(this._BOF);t._data.writeShort(this._BIFF8),t._data.writeShort(5),t._data.writeShort(3515),t._data.writeShort(1996),t._data.writeUnsignedInt(8),t._data.writeUnsignedInt(0),this._writeExcelTag(t,this._wbGlobalsStream),t=new eb(this._CODEPAGE),t._data.writeShort(this._UTF16),this._writeExcelTag(t,this._wbGlobalsStream),t=new eb(this._WINDOW1),t._data.writeShort(0),t._data.writeShort(45),t._data.writeShort(19080),t._data.writeShort(11370),t._data.writeShort(56),t._data.writeShort(0),t._data.writeShort(0),t._data.writeShort(256),t._data.writeShort(200),this._writeExcelTag(t,this._wbGlobalsStream),t=new eb(this._DATEMODE),t._data.writeShort(0),this._writeExcelTag(t,this._wbGlobalsStream);for(var e=new eb(this._FONT),t=0;t<this._fontArr.length;t++)e._data.writeShort(20*this._fontArr[t].h),e._data.writeShort(this._fontArr[t].o),e._data.writeShort(this._fontArr[t].c),e._data.writeShort(this._fontArr[t].w),e._data.writeShort(this._fontArr[t].e),e._data.writeByte(this._fontArr[t].u),e._data.writeByte(3),e._data.writeByte(1),e._data.writeByte(0),this._writeUnicodeStr8BitLength(e._data,this._fontArr[t].n),this._writeExcelTag(e,this._wbGlobalsStream),e._data.clear();for(e=new eb(this._FORMAT),t=5;t<this._formatArr.length;t++)e._data.writeShort(this._formatArr[t].i),this._writeUnicodeStr16BitLength(e._data,this._formatArr[t].f),this._writeExcelTag(e,this._wbGlobalsStream),e._data.clear();for(e=new eb(this._XF),t=0;t<this._xfArr.length;t++)e._data.writeShort(this._xfArr[t].fo),e._data.writeShort(this._xfArr[t].fm),e._data.writeShort(this._xfArr[t].ty),e._data.writeByte(this._xfArr[t].al),e._data.writeByte(0),e._data.writeByte(this._xfArr[t].it),e._data.writeByte(this._xfArr[t].at),e._data.writeUnsignedInt(this._xfArr[t].b1),e._data.writeUnsignedInt(this._xfArr[t].b2),e._data.writeShort(this._xfArr[t].b3),this._writeExcelTag(e,this._wbGlobalsStream),e._data.clear();for(t=new eb(this._STYLE),t._data.writeShort(32784),t._data.writeByte(5),t._data.writeByte(255),this._writeExcelTag(t,this._wbGlobalsStream),t._data.setPosition(0),t._data.writeShort(32785),t._data.writeByte(3),this._writeExcelTag(t,this._wbGlobalsStream),t._data.setPosition(0),t._data.writeShort(32786),t._data.writeByte(6),this._writeExcelTag(t,this._wbGlobalsStream),t._data.setPosition(0),t._data.writeShort(32787),t._data.writeByte(4),this._writeExcelTag(t,this._wbGlobalsStream),t._data.setPosition(0),t._data.writeShort(32788),t._data.writeByte(7),this._writeExcelTag(t,this._wbGlobalsStream),t._data.setPosition(0),t._data.writeShort(32768),t._data.writeByte(0),this._writeExcelTag(t,this._wbGlobalsStream),e=new eb(this._PALETTE),e._data.writeShort(56),t=8;64>t;t++)0<=this._paletteArr[t]?(e._data.writeByte((16711680&this._paletteArr[t])>>16),e._data.writeByte((65280&this._paletteArr[t])>>8),e._data.writeByte(255&this._paletteArr[t])):(e._data.writeByte(0),e._data.writeByte(0),e._data.writeByte(0)),e._data.writeByte(0);this._writeExcelTag(e,this._wbGlobalsStream),this._sst=null},Ia.prototype._makeWorkbookGlobalsStream2=function(t,e){var i=this;if(0<i._sstArr.length){var s=i._sstArr.length;for(i._sst||(i._startpnt=i._wbGlobalsStream.getPosition(),i._sstIbPnts=[],i._sstCbPnts=[],i._ip=4,i._sstpnt=0,i._sst=new eb(i._SST),i._sst._data.writeUnsignedInt(i._sstArr.length),i._sst._data.writeUnsignedInt(i._sstArr.length));i._sstpnt<s;){var r=i._strToUTF16(i._sstArr[i._sstpnt]);if(i._sstIbPnts.push(i._ip),8224>=i._sst._data.getPosition()+(3+r.getLength()))i._sstCbPnts.push(i._sst._data.getPosition()+4),i._sst._data.writeShort(i._sstArr[i._sstpnt].length),i._sst._data.writeByte(1),i._sst._data.writeBytes(r),i._ip+=3+r.getLength();else if(8219<i._sst._data.getPosition())i._writeExcelTag(i._sst,i._wbGlobalsStream),i._sst=new eb(i._CONTINUE),i._sstCbPnts.push(i._sst._data.getPosition()+4),i._sst._data.writeShort(i._sstArr[i._sstpnt].length),i._sst._data.writeByte(1),i._sst._data.writeBytes(r),i._ip+=7+r.getLength();else{i._sstCbPnts.push(i._sst._data.getPosition()+4),i._sst._data.writeShort(i._sstArr[i._sstpnt].length),i._sst._data.writeByte(1);var n=8224-i._sst._data.getPosition();1==n%2&&n--,i._sst._data.writeBytes(r,0,n),i._writeExcelTag(i._sst,i._wbGlobalsStream),i._sst=new eb(i._CONTINUE),i._sst._data.writeByte(1),i._sst._data.writeBytes(r,n,r.getLength()-n),i._ip+=8+r.getLength()}if(i._sstpnt++,t&&0==i._sstpnt%2e3)break}if(i._sstpnt==s){i._writeExcelTag(i._sst,i._wbGlobalsStream);var r=0,n=new eb(i._EXTSST),o=8;for(8224<i._sstIbPnts.length&&(o=i._sstIbPnts.length/8224*8),n._data.writeShort(o);r<i._sstIbPnts.length&&8216>n.length;)n._data.writeUnsignedInt(i._startpnt+i._sstIbPnts[r]),n._data.writeShort(i._sstCbPnts[r]),n._data.writeShort(0),r+=o;i._writeExcelTag(n,i._wbGlobalsStream)}}t?i._sstpnt==s?(i._sstIbPnts=i._sstCbPnts=i._sst=null,e()):setTimeout(function(){i._makeWorkbookGlobalsStream2(t,e)},10):i._sstIbPnts=i._sstCbPnts=i._sst=null},Ia.prototype._makeWorkbookGlobalsStream3=function(){var t=new eb(this._SHEET),e=this.exportSheetName?this.exportSheetName:"Sheet1";t._data.writeUnsignedInt(this._wbGlobalsStream.getLength()+4+4+2+(2+2*e.length)+4),t._data.writeByte(0),t._data.writeByte(0),this._writeUnicodeStr8BitLength(t._data,e),this._writeExcelTag(t,this._wbGlobalsStream),t=new eb(this._EOF),this._writeExcelTag(t,this._wbGlobalsStream)},Ia.prototype._makeSheetStream=function(){this._sheetStream=new aa,this._sheetStream.endian=aa.LITTLE_ENDIAN;var t=new eb(this._BOF);t._data.writeShort(this._BIFF8),t._data.writeShort(16);var e=new Date;if(t._data.writeShort(e.getMilliseconds()),t._data.writeShort(e.getFullYear()),t._data.writeUnsignedInt(0),t._data.writeUnsignedInt(0),this._writeExcelTag(t,this._sheetStream),t=new eb(this._DEFCOLWIDTH),t._data.writeShort(10),this._writeExcelTag(t,this._sheetStream),this._colInfoStream&&this._sheetStream.writeBytes(this._colInfoStream),e=new eb(this._DIMENSIONS),e._data.writeUnsignedInt(0),t=this.rowCount+this._titleRowCount,this.exportFooter&&t++,e._data.writeUnsignedInt(t),e._data.writeShort(0),e._data.writeShort(this.columnCount),e._data.writeShort(0),this._writeExcelTag(e,this._sheetStream),this.exportTitle&&(e=new eb(this._ROW),e._data.writeShort(0),e._data.writeShort(0),e._data.writeShort(this.columnCount),e._data.writeShort(15*this.exportTitleHeight),e._data.writeShort(0),e._data.writeShort(0),e._data.writeUnsignedInt(320),this._writeExcelTag(e,this._sheetStream)),this.exportFooter&&(e=new eb(this._ROW),e._data.writeShort(t-1),e._data.writeShort(0),e._data.writeShort(this.columnCount),e._data.writeShort(15*this.exportFooterHeight),e._data.writeShort(0),e._data.writeShort(0),e._data.writeUnsignedInt(320),this._writeExcelTag(e,this._sheetStream)),this._cellStream&&this._sheetStream.writeBytes(this._cellStream),this._cellStream=null,t=new eb(this._WINDOW2),t._data.writeShort(1718),t._data.writeShort(0),t._data.writeShort(0),t._data.writeShort(0),t._data.writeShort(0),t._data.writeShort(0),t._data.writeShort(0),t._data.writeUnsignedInt(0),this._writeExcelTag(t,this._sheetStream),t=new eb(this._STANDARDWIDTH),t._data.writeShort(5120),this._writeExcelTag(t,this._sheetStream),this.mergedCells&&0<this.mergedCells.length){for(e=new eb(this._MERGEDCELLS),t=0;t<this.mergedCells.length;t++)0==t%1027&&(0<e._data.getLength()&&(this._writeExcelTag(e,this._sheetStream),e._data.clear()),1027<this.mergedCells.length-t?e._data.writeShort(1027):e._data.writeShort(this.mergedCells.length-t)),e._data.writeShort(this.mergedCells[t].rowNo+this._titleRowCount),e._data.writeShort(this.mergedCells[t].rowNo+this._titleRowCount+this.mergedCells[t].rowSpan-1),e._data.writeShort(this.mergedCells[t].colNo),e._data.writeShort(this.mergedCells[t].colNo+this.mergedCells[t].colSpan-1);0<e._data.getLength()&&this._writeExcelTag(e,this._sheetStream)}if(this._internalMergedCells&&0<this._internalMergedCells.length){for(e=new eb(this._MERGEDCELLS),e._data.writeShort(this._internalMergedCells.length),t=0;t<this._internalMergedCells.length;t++)e._data.writeShort(this._internalMergedCells[t].rowNo),e._data.writeShort(this._internalMergedCells[t].rowNo+this._internalMergedCells[t].rowSpan-1),e._data.writeShort(this._internalMergedCells[t].colNo),e._data.writeShort(this._internalMergedCells[t].colNo+this._internalMergedCells[t].colSpan-1);0<e._data.getLength()&&this._writeExcelTag(e,this._sheetStream)}t=new eb(this._EOF),this._writeExcelTag(t,this._sheetStream)},Ia.prototype._makeZipStream=function(){var t,e,i,s=this;if(s._cdfStream=new aa,s._cdfStream.endian=aa.LITTLE_ENDIAN,s._zip.generateAsync)s._zip.generateAsync({type:"string",compression:"DEFLATE"}).then(function(r){for(s._zip=null,t=r,e=0,i=t.length;e<i;e++)s._cdfStream.writeByte(t.charCodeAt(e));t=null,s.dispatchEvent(new w("complete"))});else{for(t=s._zip.generate({type:"string",compression:"DEFLATE"}),s._zip=null,e=0,i=t.length;e<i;e++)s._cdfStream.writeByte(t.charCodeAt(e));t=null,s.dispatchEvent(new w("complete"))}},Ia.prototype._makeCDFStream1=function(){var t=Math.ceil((this._wbGlobalsStream.getLength()+this._sheetStream.getLength())/512);0!=t%8&&(t+=8-t%8);var e=Math.ceil((t+1)/128);(1<e||0==(t+1)%128)&&(e=Math.ceil((t+1+e)/128));var i=0;109<e&&(i=Math.ceil((e-109)/127));var s=new Xd;s._data.writeByte(208),s._data.writeByte(207),s._data.writeByte(17),s._data.writeByte(224),s._data.writeByte(161),s._data.writeByte(177),s._data.writeByte(26),s._data.writeByte(225),s._data.setPosition(s._data.getPosition()+16),s._data.writeShort(62),s._data.writeShort(3),s._data.writeShort(65534),s._data.writeShort(9),s._data.writeShort(6),s._data.setPosition(s._data.getPosition()+10),s._data.writeUnsignedInt(e),s._data.writeUnsignedInt(t+e),s._data.writeUnsignedInt(0),s._data.writeUnsignedInt(4096),s._data.writeInt(-2),s._data.writeUnsignedInt(0),0<i?s._data.writeInt(t+e+1):s._data.writeInt(-2),s._data.writeUnsignedInt(i);var r,n,o;for(this._msatArr=[],r=0;109>r;r++)r<e?s._data.writeInt(t+r):r>=e&&s._data.writeInt(-1);for(r=0;r<i;r++){for(o=new Xd,o._data.setPosition(0),n=0;127>n;n++)109+127*r+n<e?o._data.writeInt(109+127*r+t+n):109+127*r+n>=e&&o._data.writeInt(-1);r==i-1?o._data.writeInt(-2):o._data.writeInt(r+t+e+2),this._msatArr.push(o)}for(i=this._cdfDirectory=new Xd,i._data.writeBytes(this._strToUTF16("Root Entry")),i._data.setPosition(64),i._data.writeShort(22),i._data.writeByte(5),i._data.writeByte(1),i._data.writeInt(-1),i._data.writeInt(-1),i._data.writeInt(1),i._data.setPosition(i._data.getPosition()+16),i._data.writeInt(0),i._data.writeDouble(0),i._data.writeDouble(0),i._data.writeInt(-2),i._data.writeInt(0),i._data.writeInt(0),r=i._data.getPosition(),i._data.writeBytes(this._strToUTF16("Workbook")),i._data.setPosition(r+64),i._data.writeShort(18),i._data.writeByte(2),i._data.writeByte(1),i._data.writeInt(-1),i._data.writeInt(-1),i._data.writeInt(-1),i._data.setPosition(i._data.getPosition()+16),i._data.writeInt(0),i._data.writeDouble(0),i._data.writeDouble(0),i._data.writeInt(0),i._data.writeInt(512*t),i._data.writeInt(0),this._satArr=[],r=0;r<t+1+e;r++){if(0==r%128){for(o=new Xd,n=0;n<o._data.getLength()/4;n++)o._data.writeInt(-1);o._data.setPosition(0),this._satArr.push(o)}r==t-1?o._data.writeInt(-2):r==t+e?o._data.writeInt(-2):r>=t?o._data.writeInt(-3):o._data.writeInt(r+1)}this._cdfStream=new aa,this._cdfStream.endian=aa.LITTLE_ENDIAN,this._cdfStream.writeBytes(s._data),this._cdfStream.writeBytes(this._wbGlobalsStream)},Ia.prototype._makeCDFStream2=function(){var t;if(this._cdfStream.writeBytes(this._sheetStream),0<(this._sheetStream.getLength()+this._wbGlobalsStream.getLength())%4096)for(t=4096;t>(this._sheetStream.getLength()+this._wbGlobalsStream.getLength())%4096;t--)this._cdfStream.writeByte(0);for(t=0;t<this._satArr.length;t++)this._cdfStream.writeBytes(this._satArr[t]._data);for(this._cdfStream.writeBytes(this._cdfDirectory._data),t=0;t<this._msatArr.length;t++)this._cdfStream.writeBytes(this._msatArr[t]._data);this._wbGlobalsStream=this._sheetStream=this._satArr=this._cdfDirectory=this._msatArr=null,this.dispatchEvent(new w("complete"))},Ia.prototype._addTitleFooter=function(){if(this.exportTitle){var t=this.getXfIndex(this.exportTitleFontSize,!1,!1,!1,this.exportTitleColor,this.defaultFontName,null,this.exportTitleAlign,"middle",!0,0,!1,0,"",!1,0,"",!1,0,"",this.defaultBackgroundColor);this.writeCellLabel(-1*this._titleRowCount,0,this.exportTitle,t),t={rowNo:0,rowSpan:1,colNo:0},t.colSpan=this.columnCount,this._internalMergedCells.push(t)}if(this.exportFooter){var e=this.rowCount+this._titleRowCount+1,t=this.getXfIndex(this.exportFooterFontSize,!1,!1,!1,this.exportFooterColor,this.defaultFontName,null,this.exportFooterAlign,"middle",!0,0,!1,0,"",!1,0,"",!1,0,"",this.defaultBackgroundColor);this.writeCellLabel(e-1-this._titleRowCount,0,this.exportFooter,t),t={},t.rowNo=e-1,t.rowSpan=1,t.colNo=0,t.colSpan=this.columnCount,this._internalMergedCells.push(t)}},Ia.prototype._makeTextStream=function(){var t,e,i,s,r=new Bd;if("undefined"==typeof window.cptable||!window.cptable)throw"cpexcel.js required";for(this.exportTitle&&(r.append(this.exportTitle),r.append("\n")),t=0,i=this._cellArrs.length;t<i;t++)if(this._cellArrs[t]&&this._cellArrs[t].length){for(e=0,s=this._cellArrs[t].length;e<s;e++)this._cellArrs[t][e]&&r.append(hb.encode(this._cellArrs[t][e])),e<s-1&&r.append(this.exportTxtSeperator);r.append("\n")}this.exportFooter&&(r.append(this.exportFooter),r.append("\n")),t=this.exportCodePage?window.cptable.utils.encode(this.exportCodePage,r.toString()):window.cptable.utils.encode(65001,r.toString()),this._cdfStream=new aa,this._cdfStream.endian=aa.LITTLE_ENDIAN,this._cdfStream.writeArray(t)},Ia.prototype.exportExcelMakeCDF=function(t){t=0<arguments.length&&t;var e=this;if(!e._resetCalled)throw Error("reset() must called before this function run");if(e._isMulti)e._addTitleFooter(),e.dispatchEvent(new w("complete"));else try{e._addTitleFooter(),e._exportTxt?e._makeTextStream():e._exportXls?t?(e._makeWorkbookGlobalsStream1(),setTimeout(function(){e._makeWorkbookGlobalsStream2(t,function(){e._makeWorkbookGlobalsStream3(),e._makeSheetStream(),setTimeout(function(){e._makeCDFStream1(),setTimeout(function(){e._makeCDFStream2()},10)},10)})},10)):(e._makeWorkbookGlobalsStream1(),e._makeWorkbookGlobalsStream2(t),e._makeWorkbookGlobalsStream3(),e._makeSheetStream(),e._makeCDFStream1(),e._makeCDFStream2()):t?setTimeout(function(){e._makeWorkbookGlobalsStreamXlsx(),setTimeout(function(){e._makeSheetStreamXlsx(),setTimeout(function(){e._makeZipStream()},10)},10)},10):(e._makeWorkbookGlobalsStreamXlsx(),e._makeSheetStreamXlsx(),e._makeZipStream())}catch(i){e.dispatchEvent(new J(J.EXPORT_MAKE_ERROR,(!1),(!1),null,i.message||i))}},Ia.prototype.exportExcelSave=function(t,e,i){i=2<arguments.length&&i;var s,r=this;if(!r._resetCalled)throw Error("reset() must called before this function run");if(!r._cdfStream&&!r._zip)throw Error("exportExcelMakeCDF() must called before this function run");s=e?e:document.body;try{if("function"==typeof Blob&&window.Uint8Array){var n,o,a=r._cdfStream.getBuffer(),l=new Uint8Array(a.length);for(n=0,o=a.length;n<o;n++)l[n]=a[n];r._cdfStream=null;var h=new Blob([l],{type:"application/octet-stream"});if(window.navigator.msSaveBlob)window.navigator.msSaveOrOpenBlob(h,r.exportFileName);else{var d=document.createElementNS("http://www.w3.org/1999/xhtml","a"),c=window.URL.createObjectURL(h);d.href=c,d.download=r.exportFileName;var _=document.createEvent("MouseEvents");_.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(_)}setTimeout(function(){r.dispatchEvent(new J(J.EXPORT_SAVE_COMPLETE))},100)}else{if(!t)throw Error("Save url is required.");var u=s.childNodes;for(n=0;u&&n<u.length;n++)u[n].id&&0<=u[n].id.indexOf("Kool__excelSaveForm")&&s.removeChild(u[n]);r._saveForm=document.createElement("form"),r._saveForm.method="POST",r._saveForm.id="Kool__excelSaveForm"+Math.ceil(1e3*Math.random()),r._saveForm.action=t;var p,g,m=0,f=document.createElement("input");if(n=0,f.name="fileName",f.type="hidden",f.value=r.exportFileName,
r._saveForm.appendChild(f),i){var y=new zb;y.addEventListener("complete",function(){for(r._cdfStream=null,p=y.asyncOuput,y=null;n<p.length;)g=document.createElement("input"),g.name="fileData"+m,g.type="hidden",g.value=p.substr(n,65536),r._saveForm.appendChild(g),n+=65536,m++;s.appendChild(r._saveForm),p=null,r._saveForm.submit(),setTimeout(function(){r.dispatchEvent(new J(J.EXPORT_SAVE_COMPLETE))},100)},r),y.encodeAsync(r._cdfStream.getBuffer())}else{for(p=zb.encode(r._cdfStream.getBuffer()),r._cdfStream=null;n<p.length;)g=document.createElement("input"),g.name="fileData"+m,g.type="hidden",g.value=p.substr(n,65536),r._saveForm.appendChild(g),n+=65536,m++;s.appendChild(r._saveForm),p=null,r._saveForm.submit(),setTimeout(function(){r.dispatchEvent(new J(J.EXPORT_SAVE_COMPLETE))},100)}}}catch(b){r.dispatchEvent(new J(J.EXPORT_SAVE_ERROR,(!1),(!1),null,b.message||b))}},Ia.prototype.exportExcelUpload=function(t,e){e=1<arguments.length&&e;var i=this;if(!i._resetCalled)throw Error("reset() must called before this function run");if(!i._cdfStream&&!i._zip)throw Error("exportExcelMakeCDF() must called before this function run");if(!t)throw Error("Upload url is required.");try{if(window.XMLHttpRequest?i._xmlHttp=new XMLHttpRequest:window.ActiveXObject&&(i._xmlHttp=new ActiveXObject("Microsoft.XMLHTTP")),i._xmlHttp.onreadystatechange=i._uploadCompleteHandler,i._xmlHttp.sender=i,i._xmlHttp.open("POST",t,!0),i._xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e){var s=new zb;s.addEventListener("complete",function(){var t=s.asyncOuput;s=null,i._xmlHttp.send("fileName="+encodeURIComponent(i.exportFileName)+"&fileData="+encodeURIComponent(t))},i),s.encodeAsync(i._cdfStream.getBuffer())}else i._xmlHttp.send("fileName="+encodeURIComponent(i.exportFileName)+"&fileData="+encodeURIComponent(zb.encode(i._cdfStream.getBuffer())))}catch(r){i.dispatchEvent(new J(J.EXPORT_UPLOAD_ERROR,(!1),(!1),null,r.message))}},Ia.prototype._uploadCompleteHandler=function(){var t=this.sender;if(4==this.readyState)if(200==this.status){var e=this.responseText;t._xmlHttp=null,t.dispatchEvent(new J(J.EXPORT_UPLOAD_COMPLETE,(!1),(!1),null,e))}else t._xmlHttp=null,t.dispatchEvent(new J(J.EXPORT_UPLOAD_ERROR,(!1),(!1),null,this.status))};var eb=function(t,e){this._type=t,this._data=null==e?new aa:e,this._data.endian=aa.LITTLE_ENDIAN};eb.prototype.getType=function(){return this._type},eb.prototype.setType=function(t){this._type=t},eb.prototype.getData=function(){return this._data},eb.prototype.getLength=function(){return this._data.getLength()};var Xd=function(t){this._SECTOR_SIZE=512,null==t?(this._data=new aa,this._data.endian=aa.LITTLE_ENDIAN,this._data.setLength(this._SECTOR_SIZE)):(t.getLength()!=this._SECTOR_SIZE&&t.setLength(this._SECTOR_SIZE),this._data=t)};Xd.prototype.getData=function(){return this._data},Xd.prototype.getLength=function(){return this._data.getLength()};var Oc=function(){wa.call(this),this._sstArr=[],this._exportExcelAsync=this._exportXls=!1,this._curGridIdx=0,this.exportFileName="export.xlsx",this.exportType="xlsx"};z(Oc,wa),Oc.prototype.setExportType=function(t){if(this.exportType=t,"xls"==t)throw Error("Exporting multi grids to xls file format is not supported");this._exportXls=!1},Oc.prototype.exportExcelMake=function(t){if(t=0<arguments.length&&t,!this.exportGrids)throw Error("Please set datagrids to export");this._exportExcelAsync=t,this._curGridIdx=0;var e,i=new Ia;for(this._paletteArr=i._paletteArrOri.slice(0),this._fontArr=i._fontArr.slice(0),this._formatArr=i._formatArr.slice(0),this._xfArr=i._xfArr.slice(0),this.exportGrids[0].getStyle("fontFamily")&&((e=this.exportGrids[0].getStyle("fontFamily"))&&(e=m.getFontFamily(e)[0]),i.defaultFontName=e),this.exportGrids[0].getStyle("fontSize")&&(i.defaultFontSize=this.exportGrids[0].getSizeStyle("fontSize")),e=0;e<this._fontArr.length;e++)this._fontArr[e].h=6==e?8:i.defaultFontSize,this._fontArr[e].n=i.defaultFontName;i._paletteArr=this._paletteArr,i._fontArr=this._fontArr,i._formatArr=this._formatArr,i._xfArr=this._xfArr,i._sstArr=this._sstArr,i._isMulti=!0,this._excelExportUtils=[i],this.exportGrids[0].exportType=this.exportType,this.exportGrids[0].addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this.exportGrids[0].addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this.exportGrids[0].exportExcelMake(this._exportExcelAsync,this._excelExportUtils[0])},Oc.prototype._makeWorkbookGlobalsStreamXlsx=function(){if("undefined"==typeof window.JSZip||!window.JSZip)throw"jszip.min.js required";var t,e,i;for(this._zip=new window.JSZip,i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>',t=0;t<this.exportGrids.length;t++)i+='<Override PartName="/xl/worksheets/sheet'+(t+1)+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>';this._zip.file("[Content_Types].xml",i+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>'),this._zip.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>');var s=this._zip.folder("docProps");for(i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>KoolGrid</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+this.exportGrids.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="'+this.exportGrids.length+'" baseType="lpstr">',t=0;t<this.exportGrids.length;t++)i+="<vt:lpstr>"+(this.exportGrids[t].exportSheetName?this.exportGrids[t].exportSheetName:"Sheet"+(t+1))+"</vt:lpstr>";for(s.file("app.xml",i+"</vt:vector></TitlesOfParts><Manager></Manager><Company>RiaMore Soft</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>3.0</AppVersion></Properties>"),s.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>KoolGrid.js</dc:creator><cp:lastModifiedBy>KoolGrid.js</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">'+Mb.toISOString(new Date)+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+Mb.toISOString(new Date)+"</dcterms:modified></cp:coreProperties>"),this._zip_xl=this._zip.folder("xl"),i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView xWindow="0" yWindow="45" windowWidth="19080" windowHeight="11370" tabRatio="200"/></bookViews><sheets>',t=0;t<this.exportGrids.length;t++)i+='<sheet name="'+(this.exportGrids[t].exportSheetName?this.exportGrids[t].exportSheetName:"Sheet"+(t+1))+'" sheetId="'+(t+1)+'" r:id="rId'+(t+4)+'"/>';for(this._zip_xl.file("workbook.xml",i+'</sheets><calcPr calcId="0"/></workbook>'),i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>',t=0;t<this.exportGrids.length;t++)i+='<Relationship Id="rId'+(t+4)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(t+1)+'.xml"/>';i+="</Relationships>",this._zip_xl.folder("_rels").file("workbook.xml.rels",i),this._zip_xl.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface="Malgun Gothic"/><a:font script="Hans" typeface="?"/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface="Malgun Gothic"/><a:font script="Hans" typeface="?"/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>');var r;if(4<this._formatArr.length){for(r='<numFmts count="'+(this._formatArr.length-4)+'">',t=4;t<this._formatArr.length;t++)r+='<numFmt numFmtId="'+this._formatArr[t].i+'" formatCode="'+G.escapeXML(this._formatArr[t].f)+'"/>';r+="</numFmts>"}var n;if(0<this._fontArr.length){for(n='<fonts count="'+this._fontArr.length+'" x14ac:knownFonts="1">',t=0;t<this._fontArr.length;t++)n+='<font><sz val="'+Math.round(this._fontArr[t].h)+'"/>',n+='<name val="'+G.escapeXML(this._fontArr[t].n)+'"/>',400<this._fontArr[t].w&&(n+="<b/>"),this._fontArr[t].u&&(n+="<u/>"),this._fontArr[t].o&&(n+="<i/>"),n+='<color rgb="'+N.no2hex(this._paletteArr[this._fontArr[t].c])+'"/>',n+='<charset val="1"/>',n+="</font>";n+="</fonts>"}i='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+this._xfArr.length+'">';var o=[{idx:-1,str:'<fill><patternFill patternType="none"/></fill>'},{idx:-2,str:'<fill><patternFill patternType="gray125"/></fill>'}],s=[{idx:"00",str:"<border><left/><right/><top/><bottom/></border>"}];for(t=0;t<this._xfArr.length;t++){var a=this._xfArr[t];if(i+='<xf numFmtId="'+a.fm+'" fontId="'+(4>a.fo?a.fo:a.fo-1)+'" xfId="0"',67108864&a.b2){var l=(65535&a.b3)-8320;for(e=2;e<o.length;e++)if(o[e].idx==l){i+=' fillId="'+e+'"';break}e>=o.length&&(o.push({idx:l,str:'<fill><patternFill patternType="solid"><fgColor rgb="'+N.no2hex(this._paletteArr[l])+'"/></patternFill></fill>'}),i+=' fillId="'+(o.length-1)+'"')}else i+=' fillId="0"';var l=a.b1,h=16777215&a.b2,d=l.toString(16)+h.toString(16),c="";for(e=0;e<s.length;e++)if(s[e].idx==d){i+=' borderId="'+e+'"';break}e>=s.length&&(e=(8323072&l)>>16,17==(255&l)?c+='<left style="thin"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="thin"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':51==(255&l)?c+='<left style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':68==(255&l)?c+='<left style="dotted"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="dotted"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>':102==(255&l)&&(c+='<left style="double"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></left><right style="double"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></right>'),e=127&h,256==(3840&l)?c+='<top style="thin"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':512==(3840&l)?c+='<top style="medium"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':768==(3840&l)?c+='<top style="dashed"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':1024==(3840&l)?c+='<top style="dotted"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>':1536==(3840&l)&&(c+='<top style="double"><color rgb="'+N.no2hex(this._paletteArr[e])+'"/></top>'),h=(16256&h)>>7,4096==(61440&l)?c+='<bottom style="thin"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':8192==(61440&l)?c+='<bottom style="medium"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':12288==(61440&l)?c+='<bottom style="dashed"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':16384==(61440&l)?c+='<bottom style="dotted"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>':24576==(61440&l)&&(c+='<bottom style="double"><color rgb="'+N.no2hex(this._paletteArr[h])+'"/></bottom>'),s.push({idx:d,str:"<border>"+c+"</border>"}),i+=' borderId="'+(s.length-1)+'"'),i+=">",(a.al||a.it)&&(l=a.al,i+="<alignment"+(3==(3&l)?' horizontal="right"':2==(3&l)?' horizontal="center"':1==(3&l)?' horizontal="left"':"")+(16==(240&l)?' vertical="center"':32==(240&l)?' vertical="bottom"':' vertical="top"')+(8==(8&l)?' wrapText="1"':"")+(a.it?' indent="'+a.it+'"':"")+"/>"),i+="</xf>"}for(i+="</cellXfs>",this._xfArr=null,a='<fills count="'+o.length+'">',t=0;t<o.length;t++)a+=o[t].str;for(a+="</fills>",o='<borders count="'+s.length+'">',t=0;t<s.length;t++)o+=s[t].str;for(o+="</borders>",s="<colors><indexedColors>",t=0;64>t;t++)s=0<=this._paletteArr[t]?s+('<rgbColor rgb="'+N.no2hex(this._paletteArr[t])+'"/>'):s+'<rgbColor rgb="000000"/>';this._zip_xl.file("styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+r+n+a+o+i+(s+"</indexedColors></colors>")+"</styleSheet>"),r=new Bd,r.append('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="105" uniqueCount="105">'),0<this._sstArr.length&&(t="<si><t>"+this._sstArr.join("</t></si><si><t>"),0<t.indexOf("<t>$zpa@ce@$")&&(t=t.replace(/<t>\$zpa@ce@\$/g,'<t xml:space="preserve">')),r.append(t),r.append("</t></si>")),this._sstArr=null,r.append("</sst>"),this._zip_xl.file("sharedStrings.xml",r.toString())},Oc.prototype._makeSheetStreamXlsx=function(){var t;for(t=0;t<this._excelExportUtils.length;t++)this._zip_xl.folder("worksheets").file("sheet"+(t+1)+".xml",this._excelExportUtils[t]._getSheetStreamXlsx())},Oc.prototype._makeZipStream=function(){var t,e,i,s=this;if(s._cdfStream=new aa,s._cdfStream.endian=aa.LITTLE_ENDIAN,s._zip.generateAsync)s._zip.generateAsync({type:"string",compression:"DEFLATE"}).then(function(r){for(s._zip=null,t=r,e=0,i=t.length;e<i;e++)s._cdfStream.writeByte(t.charCodeAt(e));t=null,s.dispatchEvent(new J(J.EXPORT_MAKE_COMPLETE))});else{for(t=s._zip.generate({type:"string",compression:"DEFLATE"}),s._zip=null,e=0,i=t.length;e<i;e++)s._cdfStream.writeByte(t.charCodeAt(e));t=null,s.dispatchEvent(new J(J.EXPORT_MAKE_COMPLETE))}},Oc.prototype._exportExcelMakeCDF=function(t){t=0<arguments.length&&t;var e=this;try{t?setTimeout(function(){e._makeWorkbookGlobalsStreamXlsx(),setTimeout(function(){e._makeSheetStreamXlsx(),setTimeout(function(){e._makeZipStream()},10)},10)},10):(e._makeWorkbookGlobalsStreamXlsx(),e._makeSheetStreamXlsx(),e._makeZipStream())}catch(i){e.dispatchEvent(new J(J.EXPORT_MAKE_ERROR,(!1),(!1),null,i.message||i))}},Oc.prototype.exportExcelSave=function(t,e,i){i=2<arguments.length&&i;var s,r=this;if(!r._cdfStream&&!r._zip)throw Error("exportExcelMakeCDF() must called before this function run");s=e?e:document.body;try{if("function"==typeof Blob&&window.Uint8Array){var n,o,a=r._cdfStream.getBuffer(),l=new Uint8Array(a.length);for(n=0,o=a.length;n<o;n++)l[n]=a[n];r._cdfStream=null;var h=new Blob([l],{type:"application/octet-stream"});if(window.navigator.msSaveBlob)window.navigator.msSaveOrOpenBlob(h,r.exportFileName);else{var d=document.createElementNS("http://www.w3.org/1999/xhtml","a"),c=window.URL.createObjectURL(h);d.href=c,d.download=r.exportFileName;var _=document.createEvent("MouseEvents");_.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(_)}setTimeout(function(){r.dispatchEvent(new J(J.EXPORT_SAVE_COMPLETE))},100)}else{var u=s.childNodes;for(n=0;u&&n<u.length;n++)u[n].id&&0<=u[n].id.indexOf("Kool__excelSaveForm")&&s.removeChild(u[n]);r._saveForm=document.createElement("form"),r._saveForm.method="POST",r._saveForm.id="Kool__excelSaveForm"+Math.ceil(1e3*Math.random()),r._saveForm.action=t;var p=0,g=document.createElement("input");if(n=0,g.name="fileName",g.type="hidden",g.value=r.exportFileName,r._saveForm.appendChild(g),i){var m=new zb;m.addEventListener("complete",function(){r._cdfStream=null;var t=m.asyncOuput;for(m=null;n<t.length;){var e=document.createElement("input");e.name="fileData"+p,e.type="hidden",e.value=t.substr(n,65536),r._saveForm.appendChild(e),n+=65536,p++}s.appendChild(r._saveForm),t=null,r._saveForm.submit(),setTimeout(function(){r.dispatchEvent(new J(J.EXPORT_SAVE_COMPLETE))},100)},r),m.encodeAsync(r._cdfStream.getBuffer())}else{var f=zb.encode(r._cdfStream.getBuffer());for(r._cdfStream=null;n<f.length;){var y=document.createElement("input");y.name="fileData"+p,y.type="hidden",y.value=f.substr(n,65536),r._saveForm.appendChild(y),n+=65536,p++}s.appendChild(r._saveForm),f=null,r._saveForm.submit(),setTimeout(function(){r.dispatchEvent(new J(J.EXPORT_SAVE_COMPLETE))},100)}}}catch(b){r.dispatchEvent(new J(J.EXPORT_SAVE_ERROR,(!1),(!1),null,b.message||b))}},Oc.prototype.exportExcelUpload=function(t,e){e=1<arguments.length&&e;var i=this;if(!i._cdfStream&&!i._zip)throw Error("exportExcelMakeCDF() must called before this function run");try{if(window.XMLHttpRequest?i._xmlHttp=new XMLHttpRequest:window.ActiveXObject&&(i._xmlHttp=new ActiveXObject("Microsoft.XMLHTTP")),i._xmlHttp.onreadystatechange=i._uploadCompleteHandler,i._xmlHttp.sender=i,i._xmlHttp.open("POST",t,!0),i._xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e){var s=new zb;s.addEventListener("complete",function(){var t=s.asyncOuput;s=null,i._xmlHttp.send("fileName="+encodeURIComponent(i.exportFileName)+"&fileData="+encodeURIComponent(t))},i),s.encodeAsync(i._cdfStream.getBuffer())}else i._xmlHttp.send("fileName="+encodeURIComponent(i.exportFileName)+"&fileData="+encodeURIComponent(i._exportXls?zb.encode(i._cdfStream.getBuffer()):i._zip.generate()))}catch(r){i.dispatchEvent(new J(J.EXPORT_UPLOAD_ERROR,(!1),(!1),null,r.message))}},Oc.prototype._excelExportMakeCompleteHandler=function(t){this.exportGrids[this._curGridIdx].removeEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this.exportGrids[this._curGridIdx].removeEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this._curGridIdx<this.exportGrids.length-1?(this._curGridIdx++,t=new Ia,t._paletteArr=this._paletteArr,t._fontArr=this._fontArr,t._formatArr=this._formatArr,t._xfArr=this._xfArr,t._sstArr=this._sstArr,t._isMulti=!0,this._excelExportUtils[this._curGridIdx]=t,this.exportGrids[this._curGridIdx].exportType=this.exportType,this.exportGrids[this._curGridIdx].addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this.exportGrids[this._curGridIdx].addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this.exportGrids[this._curGridIdx].exportExcelMake(this._exportExcelAsync,this._excelExportUtils[this._curGridIdx])):(this.defaultFontSize=this._excelExportUtils[this._curGridIdx].defaultFontSize,this.defaultFontName=this._excelExportUtils[this._curGridIdx].defaultFontName,this._exportExcelMakeCDF(this._exportExcelAsync))},Oc.prototype._excelExportMakeErrorHandler=function(t){this.exportGrids[this._curGridIdx].removeEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this.exportGrids[this._curGridIdx].removeEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this.dispatchEvent(t)},Oc.prototype._uploadCompleteHandler=function(){var t=this.sender;if(4==this.readyState)if(200==this.status){var e=this.responseText;t._xmlHttp=null,t.dispatchEvent(new J(J.EXPORT_UPLOAD_COMPLETE,(!1),(!1),null,e))}else t._xmlHttp=null,t.dispatchEvent(new J(J.EXPORT_UPLOAD_ERROR,(!1),(!1),null,this.status))};var ge=function(t){this.className=this.className?this.className:"ChildItemPendingError",ca.call(this,t)};z(ge,ca);var Sc=function(){},Tc=function(){};z(Tc,Sc),Tc.prototype.summaryCalculationBegin=function(t){var e=t.dataField,i={};switch(t.summaryOperation){case"SUM":i[e]=0;break;case"MIN":i[e]=Number.MAX_VALUE;break;case"MAX":i[e]=-Number.MAX_VALUE;break;case"COUNT":i[e]=[],i[e+"Counter"]=0;break;case"AVG":i[e]=0,i[e+"Count"]=0}return i},Tc.prototype.calculateSummary=function(t,e,i){var s,r=e.dataField;switch(s=E(i)?Number(G.getProperty(i,r)):Xa(i[r])?i[r]:Number(i[r]),e.summaryOperation){case"SUM":isNaN(s)||(t.hasOwnProperty(r)?t[r]+=s:t[r]=s);break;case"MIN":isNaN(s)||(t.hasOwnProperty(r)?t[r]=t[r]<s?t[r]:s:t[r]=s);break;case"MAX":isNaN(s)||(t.hasOwnProperty(r)?t[r]=t[r]>s?t[r]:s:t[r]=s);break;case"COUNT":t.hasOwnProperty(r)?(t[r].push(i[r]),t[r+"Counter"]+=1):(t[r]=[i[r]],t[r+"Counter"]=1);break;case"AVG":t.hasOwnProperty(r)?(t[r]+=s,t[r+"Count"]+=1):(t[r]=s,t[r+"Count"]=1)}},Tc.prototype.returnSummary=function(t,e){var i=0,s=e.dataField;switch(e.summaryOperation){case"SUM":case"MIN":case"MAX":i=t[s];break;case"COUNT":i=t[s+"Counter"];break;case"AVG":i=t[s]/t[s+"Count"]}return i},Tc.prototype.summaryOfSummaryCalculationBegin=function(t,e){var i,s={};for(i in t)s[i]=t[i];return s},Tc.prototype.calculateSummaryOfSummary=function(t,e,i){var s;switch(i.summaryOperation){case"AVG":case"SUM":for(s in e)t[s]+=e[s];break;case"MIN":for(s in e)t[s]=t[s]<e[s]?t[s]:e[s];break;case"MAX":for(s in e)t[s]=t[s]>e[s]?t[s]:e[s];break;case"COUNT":for(s in e)ha(t[s])?t[s]=t[s].concat(e[s]):t[s]+=e[s]}},Tc.prototype.returnSummaryOfSummary=function(t,e){var i=0,s=e.dataField;switch(e.summaryOperation){case"SUM":case"MIN":case"MAX":i=t[s];break;case"COUNT":i=t[s+"Counter"];break;case"AVG":i=t[s]/t[s+"Count"]}return i};var he=function(){this.label="GroupLabel",this.groupingObjectFunction=this.fields=this.compareFunction=void 0};he._defaultProperty="fields",he._propertyType={fields:Array};var ie=function(t,e,i,s){this.uno=Sa.elementNo++,this.name=0<arguments.length?t:null,this.caseInsensitive=1<arguments.length&&e,this.compareFunction=void 0,this.descending=2<arguments.length&&i,this.numeric=3<arguments.length&&s,this.summaries=this.groupingObjectFunction=this.groupingFunction=void 0};ie._propertyType={summaries:Array};var T=function(t,e){wa.call(this),arguments.length&&this._initializeCollection(t.getRoot(),t,e),this._childrenMapCache={},this._showRoot=!0,this.filterFunction=null};z(T,wa),T.prototype.getHasRoot=function(){return this._hasRoot},T.prototype.getOpenNodes=function(){return this._openNodes},T.prototype.setOpenNodes=function(t){if(t){this._openNodes={};for(var e in t)this._openNodes[V.getUID(e)]=e}else this._openNodes={};this._hierarchicalData&&(this._currentLength=this.calculateLength(),t=new y(y.COLLECTION_CHANGE),t.kind="refresh",this.dispatchEvent(t))},T.prototype.getLength=function(){return this._currentLength},T.prototype.getShowRoot=function(){return this._showRoot},T.prototype.setShowRoot=function(t){this._showRoot!=t&&(this._showRoot=t,this._hierarchicalData&&(this._initializeCollection(this._hierarchicalData.getRoot(),this._hierarchicalData,this._openNodes),t=new y(y.COLLECTION_CHANGE),t.kind="reset",this.dispatchEvent(t)))},T.prototype.getSort=function(){return this._sort},T.prototype.setSort=function(t){this._sort=t},T.prototype.getSource=function(){return this._hierarchicalData},T.prototype.setSource=function(t){this._initializeCollection(t.getRoot(),t,this._openNodes);
},T.prototype._getCollection=function(t){if(E(t)||Uc(t))return new Hb(t);if(t instanceof xb)return t;if(ha(t))return new P(t);if(Ea(t)){var e=[];return e.push(t),new P(e)}return new P},T.prototype._initializeCollection=function(t,e,i){this._parentMap={},this._childrenMap={},this._childrenMapCache={},this._treeData&&this._treeData.removeEventListener(y.COLLECTION_CHANGE,this.collectionChangeHandler,this,!1),this._hierarchicalData&&this._hierarchicalData.removeEventListener(y.COLLECTION_CHANGE,this.collectionChangeHandler,this,!1),(this._treeData=this._getCollection(t))&&(this._hasRoot=1==this._treeData.getLength()),this._hierarchicalData&&!this._showRoot&&this._hasRoot&&(t=this._treeData.createCursor().getCurrent(),this._hierarchicalData.hasChildren(t)&&(t=this._hierarchicalData.getChildren(t),this._treeData=this._getCollection(t))),this._treeData.addEventListener(y.COLLECTION_CHANGE,this.collectionChangeHandler,this,!1,-50),this._hierarchicalData=e,this._hierarchicalData.addEventListener(y.COLLECTION_CHANGE,this.collectionChangeHandler,this,!1,-50),this._openNodes=i?i:{},this._currentLength=this.calculateLength()},T.prototype._internalRefresh=function(t){var e,i,s=!1;null==this._treeData.filterFunction&&null==this.filterFunction||(this._treeData.filterFunction=this.filterFunction,this._treeData.refresh(),s=!0);for(e in this._openNodes)!(i=this.getChildren(e))||null==i.filterFunction&&null==this.filterFunction||(i.filterFunction=this.filterFunction,i.refresh(),s=!0);s&&this._updateLength(),!this._sortCanBeApplied(this._treeData)||null==this._treeData.getSort()&&null==this._sort||(this._treeData.setSort(this._sort),this._treeData.refresh(),t=!0);for(e in this._openNodes)(i=this.getChildren(e))&&this._sortCanBeApplied(i)&&(null!=i.getSort()||null!=this._sort)&&(i.setSort(this._sort),i.refresh(),t=!0);return t&&(t=new y(y.COLLECTION_CHANGE),t.kind="refresh",this.dispatchEvent(t)),!0},T.prototype._sortCanBeApplied=function(t){var e;if(null==this._sort)return!0;var i=t.createCursor().getCurrent();if(!i||!this._sort.getFields())return!1;for(t=0;t<this._sort.getFields().length;t++)if(e=this._sort.getFields()[t],E(i)){if(!G.getProperty(i,e.name))return!1}else if(!i.hasOwnProperty(e.name))return!1;return!0},T.prototype._updateLength=function(t,e){this._currentLength=this.calculateLength()},T.prototype._getVisibleNodes=function(t,e,i){i.push(t);var s=V.getUID(t);if(this._parentMap[s]=e,this._openNodes[s]&&this._hierarchicalData.canHaveChildren(t)&&this._hierarchicalData.hasChildren(t)&&(e=this.getChildren(t),null!=e))for(e=e.createCursor();!e.getAfterLast();){this._getVisibleNodes(e.getCurrent(),t,i);try{e.moveNext()}catch(r){if(r instanceof ca)break}}},T.prototype._getVisibleLocation=function(t){var e,i=0,s=this._treeData.createCursor();for(e=0;e<t&&!s.getAfterLast();e++){i+=this.calculateLength(s.getCurrent(),null)+1;try{s.moveNext()}catch(r){if(r instanceof ca)break}}return i},T.prototype._getVisibleLocationInSubCollection=function(t,e){var i,s=e,r=t;for(t=this.getParentItem(t);null!=t;){for(i=this._childrenMap[V.getUID(t)],i=i.createCursor();!i.getAfterLast();){if(i.getCurrent()==r){s++;break}s+=this.calculateLength(i.getCurrent(),t)+1;try{i.moveNext()}catch(n){if(n instanceof ca)break}}r=t,t=this.getParentItem(t)}for(i=this._treeData.createCursor();!i.getAfterLast();){if(i.getCurrent()==r){s++;break}s+=this.calculateLength(i.getCurrent(),t)+1;try{i.moveNext()}catch(n){if(n instanceof ca)break}}return s},T.prototype.getNodeDepth=function(t){var e=1;for(t=this.getParentItem(t);t;)t=this.getParentItem(t),e++;return e=this._hasRoot&&!this._showRoot?e-1:e,1>e?1:e},T.prototype.getParentItem=function(t){if(t=V.getUID(t),this._parentMap.hasOwnProperty(t))return this._parentMap[t]},T.prototype.calculateLength=function(e,i){var s,r=0,n=0;if(s=!0,e){if(s=V.getUID(e),this._parentMap[s]=i,null!=e&&this._openNodes[s]&&this._hierarchicalData.canHaveChildren(e)&&this._hierarchicalData.hasChildren(e)&&(s=this.getChildren(e),null!=s)){var o=s.createCursor();try{for(o.seek(t.getFIRST());!o.getAfterLast();){r+=this.calculateLength(o.getCurrent(),e)+1,n++;try{o.moveNext()}catch(a){if(a instanceof ca)return r+=s.length-n}}}catch(a){a instanceof ca&&(r+=1)}}}else{if(o=this._treeData.createCursor(),o.getBeforeFirst())return this._treeData.getLength();for(;!o.getAfterLast();){if(e=o.getCurrent(),E(e)&&s){s=!1;var l=e.parentNode;l&&(this._childrenMap[V.getUID(l)]=this._treeData,this._parentNode=l)}r=null===e?r+1:r+(this.calculateLength(e,null)+1),n++;try{o.moveNext()}catch(a){if(a instanceof ca){r+=this._treeData.getLength()-n;break}}}}return r},T.prototype.describeData=function(){return null},T.prototype.createCursor=function(t){return new Cb(this,this._treeData,this._hierarchicalData,t)},T.prototype.contains=function(t){for(var e=this.createCursor();!e.getAfterLast();){if(e.getCurrent()==t)return!0;try{e.moveNext()}catch(i){if(i instanceof ca)break}}return!1},T.prototype.disableAutoUpdate=function(){this._treeData.disableAutoUpdate();for(var t in this._childrenMap)this._childrenMap[t].disableAutoUpdate()},T.prototype.enableAutoUpdate=function(){this._treeData.enableAutoUpdate();for(var t in this._childrenMap)this._childrenMap[t].enableAutoUpdate()},T.prototype.itemUpdated=function(t,e,i,s){var r=new y(y.COLLECTION_CHANGE);r.kind="update";var n=new wc(wc.PROPERTY_CHANGE);n.source=t,n.property=e,n.oldValue=i,n.newValue=s,r.items.push(n),this.dispatchEvent(r)},T.prototype.refresh=function(){return this._internalRefresh(!0)},T.prototype.getChildren=function(t){var e=V.getUID(t),i=this._hierarchicalData.getChildren(t),s=this._childrenMapCache[e];return s?(s._dispatchResetEvent=!1,Uc(i)?s.setSource(i,t):ha(i)&&s.setSource(i),s.refresh(),this._childrenMap[e]=s):i?(i instanceof xb?s=i:ha(i)?s=new P(i):Uc(i)||E(i)?s=new Hb(i,t):(t=Array(i),null!=t&&(s=new P(t))),this._childrenMapCache[e]=s,t=this._childrenMap[e],t!=s&&(null!=t&&t.removeEventListener(y.COLLECTION_CHANGE,this.nestedCollectionChangeHandler,this),s.addEventListener(y.COLLECTION_CHANGE,this.nestedCollectionChangeHandler,this,!1,0),this._childrenMap[e]=s),s):null},T.prototype.openNode=function(t){this._openNodes[V.getUID(t)]=t;var e=this.getChildren(t);if(e){for(!this._sortCanBeApplied(e)||null==e.getSort()&&null==this._sort||e.setSort(this._sort),null==e.filterFunction&&null==this.filterFunction||(e.filterFunction=this.filterFunction),e.refresh(),e=e.createCursor();!e.getAfterLast();){var i=V.getUID(e.getCurrent());this._parentMap[i]=t;try{e.moveNext()}catch(s){if(s instanceof ca)break}}this._updateLength()}},T.prototype.closeNode=function(t){t=V.getUID(t);var e=this._childrenMap[t];if(delete this._openNodes[t],e)for(e=e.createCursor();!e.getAfterLast();){t=V.getUID(e.getCurrent()),delete this._parentMap[t];try{e.moveNext()}catch(i){if(i instanceof ca)break}}this._updateLength()},T.prototype.addChild=function(t,e){return null==t?this.addChildAt(t,e,this._treeData.getLength()):this.addChildAt(t,e,this.getChildren(t).getLength())},T.prototype.removeChild=function(t,e){var i;for(i=null==t?this._treeData.createCursor():this.getChildren(t).createCursor();!i.getAfterLast();){if(i.getCurrent()==e)return i.remove(),!0;try{i.moveNext()}catch(s){if(s instanceof ca)break}}return!1},T.prototype.addChildAt=function(e,i,s){if(e){if(!this._hierarchicalData.canHaveChildren(e))return!1;e=this.getChildren(e).createCursor()}else e=this._treeData.createCursor();try{e.seek(t.getFIRST(),s)}catch(r){if(r instanceof ca)return!1}return e.insert(i),!0},T.prototype.removeChildAt=function(e,i){var s;s=e?this.getChildren(e).createCursor():this._treeData.createCursor();try{s.seek(t.getFIRST(),i)}catch(r){if(r instanceof ca)return!1}return!s.getBeforeFirst()&&!s.getAfterLast()&&(s.remove(),!0)},T.prototype.collectionChangeHandler=function(t){var e,i,s,r,n;if(t instanceof y)if("reset"==t.kind)this._hierarchicalData&&this._initializeCollection(this._hierarchicalData.getRoot(),this._hierarchicalData,this._openNodes),this._updateLength(),this._internalRefresh(!1),this.dispatchEvent(t);else if("add"==t.kind){for(s=t.items.length,n=new y(y.COLLECTION_CHANGE,(!1),(!0),t.kind),n.location=this._getVisibleLocation(t.location),e=0;e<s;e++)r=t.items[e],this._getVisibleNodes(r,null,n.items);this._currentLength+=n.items.length,this.dispatchEvent(n)}else if("remove"==t.kind){for(s=t.items.length,n=new y(y.COLLECTION_CHANGE,(!1),(!0),t.kind),n.location=this._getVisibleLocation(t.location),e=0;e<s;e++)r=t.items[e],this._getVisibleNodes(r,null,n.items);this._currentLength-=n.items.length,this.dispatchEvent(n)}else if("update"==t.kind)this.dispatchEvent(t);else if("replace"==t.kind){for(s=t.items.length,n=new y(y.COLLECTION_CHANGE,(!1),(!0),"remove"),e=0;e<s;e++)r=t.items[e].oldValue,this._getVisibleNodes(r,null,n.items);for(e=i=0;e<s;e++){for(r=t.items[e].oldValue;n.items[i]!=r;)i++;n.items.splice(i,1)}n.items.length&&(this._currentLength-=n.items.length,this.dispatchEvent(n)),this.dispatchEvent(t)}},T.prototype.nestedCollectionChangeHandler=function(t){var e,i,s,r,n;if(t instanceof y)if("expand"==t.kind)t.stopImmediatePropagation();else if("add"==t.kind){for(this._updateLength(),s=t.items.length,n=new y(y.COLLECTION_CHANGE,(!1),(!0),t.kind),e=0;e<s;e++)r=t.items[e],i=this.getParentItem(r),null!=i&&this._getVisibleNodes(r,i,n.items);n.location=this._getVisibleLocationInSubCollection(i,t.location),this.dispatchEvent(n)}else if("remove"==t.kind){for(s=t.items.length,n=new y(y.COLLECTION_CHANGE,(!1),(!0),t.kind),e=0;e<s;e++)r=t.items[e],i=this.getParentItem(r),null!=i&&this._getVisibleNodes(r,i,n.items);n.location=this._getVisibleLocationInSubCollection(i,t.location),this._currentLength-=n.items.length,this.dispatchEvent(n)}else if("update"==t.kind)this.dispatchEvent(t);else if("replace"==t.kind){for(s=t.items.length,n=new y(y.COLLECTION_CHANGE,(!1),(!0),"remove"),e=0;e<s;e++)r=t.items[e].oldValue,i=this.getParentItem(r),null!=i&&this._getVisibleNodes(r,i,n.items);for(e=i=0;e<s;e++){for(r=t.items[e].oldValue;n.items[i]!=r;)i++;n.items.splice(i,1)}n.items.length&&(this._currentLength-=n.items.length,this.dispatchEvent(n)),this.dispatchEvent(t)}else"reset"==t.kind&&(this._updateLength(),n=new y(y.COLLECTION_CHANGE,(!1),(!0),"refresh"),this.dispatchEvent(n))};var Cb=function(e,i,s,r){wa.call(this),this._currentChildBookmark=t.getFIRST(),this._currentIndex=0,this._currentDepth=1,this._parentNodes=[],this._childIndexStack=[],this._collection=e,this._model=i,this._hierarchicalData=s,r&&this._collection.addEventListener(y.COLLECTION_CHANGE,this.collectionChangeHandler,this,!1,0),this._modelCursor=this._model.createCursor(),1<this._model.getLength()?this._more=!0:this._more=!1};z(Cb,wa),Cb.prototype.getIndex=function(){return this._currentIndex},Cb.prototype.getBookmark=function(){return new t(this._currentIndex.toString())},Cb.prototype.getCurrent=function(){if(0==this._childIndexStack.length)return this._modelCursor.getCurrent();var t=this._childNodes.createCursor();try{return t.seek(this._currentChildBookmark),t.getCurrent()}catch(e){}return null},Cb.prototype.getCurrentDepth=function(){return this._currentDepth},Cb.prototype.getBeforeFirst=function(){return this._currentIndex<=this._collection.getLength()&&null==this.getCurrent()},Cb.prototype.getAfterLast=function(){return this._currentIndex>=this._collection.getLength()&&null==this.getCurrent()},Cb.prototype.getView=function(){return this._model},Cb.prototype._isItemVisible=function(t){for(t=this._collection.getParentItem(t);null!=t;){if(null==this._collection.getOpenNodes()[V.getUID(t)])return!1;t=this._collection.getParentItem(t)}return!0},Cb.prototype._getParentStack=function(t){var e=[];for(t=this._collection.getParentItem(t);null!=t;)e.unshift(t),t=this._collection.getParentItem(t);return e},Cb.prototype._isNodeBefore=function(e,i){if(null==i)return!1;for(var s,r,n=this.getParentStack(e),o=this.getParentStack(i);n.length&&o.length;){var a=n.shift(),l=o.shift();if(a!=l){s=this._collection.getParentItem(a),s=null!=s&&this._hierarchicalData.canHaveChildren(s)&&this._hierarchicalData.hasChildren(s)?this._collection.getChildren(s):this._model,s=s.createCursor();try{s.seek(t.getFIRST(),void 0),r=s.getCurrent()}catch(h){if(h instanceof ca)return!1}if(r==l)return!1;if(r==a)return!0}}for(n.length&&(e=n.shift()),o.length&&(i=o.shift()),s=this._model,s=s.createCursor();!s.getAfterLast()&&(r=s.getCurrent(),r!=i);){if(r==e)return!0;try{s.moveNext()}catch(h){if(h instanceof ca)break}}return!1},Cb.prototype.findAny=function(e){this.seek(t.getFIRST());var i,s,r;for(i=!1;!i;){i=this._hierarchicalData.getData(this.getCurrent()),s=!0;for(r in e)if(i[r]!=e[r]){s=!1;break}if(s)return!0;i=this.moveNext()}return!1},Cb.prototype.findFirst=function(t){return this.findAny(t)},Cb.prototype.findLast=function(e){this.seek(t.getLAST());var i,s,r;for(i=!1;!i;){i=this.getCurrent(),s=!0;for(r in e)if(i[r]!=e[r]){s=!1;break}if(s)return!0;i=this.movePrevious()}return!1},Cb.prototype.moveNext=function(){var e=this.getCurrent();if(null==e)return!1;var i,s=V.getUID(e);if(this._collection.getOpenNodes()[s]&&this._hierarchicalData.canHaveChildren(e)&&this._hierarchicalData.hasChildren(e)){if(s=this._childNodes,this._childNodes=this._collection.getChildren(e),0<this._childNodes.getLength()){this._childIndexStack.push(this._currentChildBookmark),this._parentNodes.push(e),this._currentChildBookmark=t.getFIRST(),i=this._childNodes.createCursor();try{i.getCurrent()}catch(r){if(r instanceof ca)throw new ge(r.message)}return this._currentIndex++,this._currentDepth++,!0}this._childNodes=s}for(;;){if(this._childNodes){i=this._childNodes.createCursor();try{i.seek(this._currentChildBookmark),i.moveNext()}catch(r){r instanceof ca&&i.seek(t.getFIRST())}}if(null!=this._childNodes&&0<this._childNodes.getLength()&&(i.getBookmark()==t.getLAST()||i.getAfterLast())){if(1>this._childIndexStack.length&&!this._more)return this._currentIndex++,this._currentDepth=1,!1;e=this._parentNodes.pop(),s=this._parentNodes[this._parentNodes.length-1],null!=s&&this._hierarchicalData.canHaveChildren(s)&&this._hierarchicalData.hasChildren(s)?this._childNodes=this._collection.getChildren(s):this._childNodes=null,this._currentChildBookmark=this._childIndexStack.pop(),this._currentDepth--}else{if(0==this._childIndexStack.length){if(this._currentDepth=1,this._more=this._modelCursor.moveNext()){e=this._modelCursor.getCurrent();break}return this._currentDepth=1,this._currentIndex++,!1}try{i=this._childNodes.createCursor(),i.seek(this._currentChildBookmark),i.moveNext(),this._currentChildBookmark=i.getBookmark(),e=i.getCurrent();break}catch(r){if(r instanceof ca){if(e=this._parentNodes.pop(),s=this._parentNodes[this._parentNodes.length-1],null!=s&&this._hierarchicalData.canHaveChildren(s)&&this._hierarchicalData.hasChildren(s)?this._childNodes=this._collection.getChildren(s):this._childNodes=null,this._currentChildBookmark=this._childIndexStack.pop(),this._currentDepth--,0==this._childIndexStack.length){if(this._currentDepth=1,this._more=this._modelCursor.moveNext())throw this._modelCursor.getCurrent(),new ge(r.message);return this._currentDepth=1,this._currentIndex++,!1}break}}}}return e&&(s=V.getUID(e),this._collection._parentMap.hasOwnProperty(s)||(this._collection._parentMap[s]=this._parentNodes[this._parentNodes.length-1])),this._currentIndex++,!0},Cb.prototype.movePrevious=function(){var e=this.getCurrent();if(p(e))return!1;var i;if(this._parentNodes&&0<this._parentNodes.length){if(this._currentChildBookmark==t.getFIRST())return this._parentNodes.pop(),this._currentChildBookmark=this._childIndexStack.pop(),e=this._parentNodes[this._parentNodes.length-1],null!=e&&this._hierarchicalData.canHaveChildren(e)&&this._hierarchicalData.hasChildren(e)?this._childNodes=this._collection.getChildren(e):this._childNodes=null,this._currentDepth--,this._currentIndex--,!0;try{i=this._childNodes.createCursor(),i.seek(this._currentChildBookmark),i.movePrevious(),this._currentChildBookmark=i.getBookmark(),e=i.getCurrent();try{i.movePrevious(),i.getBookmark()==t.getFIRST()&&(this._currentChildBookmark=t.getFIRST())}catch(s){}}catch(s){if(s instanceof ca)return!1}}else{if(!(this._more=this._modelCursor.movePrevious()))return this._currentIndex=-1,!1;e=this._modelCursor.getCurrent()}for(;this._collection.getOpenNodes()[V.getUID(e)]&&this._hierarchicalData.canHaveChildren(e)&&this._hierarchicalData.hasChildren(e);){if(i=this._childNodes,this._childNodes=this._collection.getChildren(e),!(0<this._childNodes.getLength())){this._childNodes=i;break}this._childIndexStack.push(this._currentChildBookmark),this._parentNodes.push(e),1==this._childNodes.getLength()?this._currentChildBookmark=t.getFIRST():this._currentChildBookmark=t.getLAST(),i=this._childNodes.createCursor();try{i.seek(this._currentChildBookmark),e=i.getCurrent()}catch(s){if(s instanceof ca){try{for(i.seek(t.getFIRST());!i.getAfterLast();)i.getCurrent(),i.moveNext()}catch(r){}throw new ge(s.message)}}this._currentDepth++}return e&&(e=V.getUID(e),this._collection._parentMap.hasOwnProperty(e)||(this._collection._parentMap[e]=this._parentNodes[this._parentNodes.length-1])),this._currentIndex--,!0},Cb.prototype.seek=function(e,i,s){i=1<arguments.length?i:0,s=2<arguments.length?s:0;var r;r=e==t.getFIRST()?0:e==t.getCURRENT()?this._currentIndex:e==t.getLAST()?this._collection.getLength()-1:parseInt(e.getValue()),r=Math.max(Math.min(r+i,this._collection.getLength()),0);var n=Math.abs(this._currentIndex-r),o=Math.abs(this._collection.getLength()-r),a=!0;if(n<r?o<n?(this.moveToLast(),0==o?(this.moveNext(),r=0):r=o-1,a=!1):(a=this._currentIndex<r,r=n,this._currentIndex==this._collection.getLength()&&(r--,this.moveToLast())):o<r?(this.moveToLast(),0==o?(this.moveNext(),r=0):r=o-1,a=!1):this.moveToFirst(),a)for(;r&&0<r;)this.moveNext(),r--;else for(;r&&0<r;)this.movePrevious(),r--},Cb.prototype.moveToFirst=function(){this._childNodes=null,this._modelCursor.seek(t.getFIRST(),0),1<this._model.getLength()?this._more=!0:this._more=!1,this._currentChildBookmark=t.getFIRST(),this._parentNodes=[],this._childIndexStack=[],this._currentIndex=0,this._currentDepth=1},Cb.prototype.moveToLast=function(){this._childNodes=null,this._childIndexStack=[],this._currentDepth=1,this._parentNodes=[],this._modelCursor.seek(t.getLAST(),0);for(var e=this._modelCursor.getCurrent();this._collection.getOpenNodes()[V.getUID(e)]&&this._hierarchicalData.canHaveChildren(e)&&this._hierarchicalData.hasChildren(e);){var i=this._childNodes;if(this._childNodes=this._collection.getChildren(e),!(null!=this._childNodes&&0<this._childNodes.getLength())){this._childNodes=i;break}i=this._childNodes.createCursor();try{i.seek(t.getLAST())}catch(s){if(s instanceof ca)break}this._parentNodes.push(e),this._childIndexStack.push(this._currentChildBookmark),e=i.getCurrent(),this._currentChildBookmark=t.getLAST();try{i.movePrevious(),i.getBookmark()==t.getFIRST()&&(this._currentChildBookmark=t.getFIRST())}catch(s){}this._currentDepth++}this._currentIndex=this._collection.getLength()-1},Cb.prototype.insert=function(t){var e=this._collection.getParentItem(this.getCurrent());this._collection.addChildAt(e,t,this._currentIndex)},Cb.prototype.remove=function(){var t=this.getCurrent(),e=this._collection.getParentItem(this.getCurrent());return this._collection.removeChild(e,this.getCurrent()),t},Cb.prototype.removeListener=function(){this._collection.removeEventListener(y.COLLECTION_CHANGE,this.collectionChangeHandler,this,!1,0)},Cb.prototype.collectionChangeHandler=function(e){var i,s,r,n,o,a,l=!1;for(r=this._getParentStack(this.getCurrent()),a={},s=r.length,i=0;i<s-1;i++)a[r[i]]=i+1;o=r[r.length-1];var h;if("add"==e.kind){for(s=e.items.length,e.location<=this._currentIndex&&(this._currentIndex+=s,l=!0),i=0;i<s;i++)if(r=e.items[i],l)if(n=this._collection.getParentItem(r),h=this._collection.getChildren(n),n==o){if(h){h=h.createCursor();try{h.seek(this._currentChildBookmark),h.moveNext(),this._currentChildBookmark=h.getBookmark()}catch(d){}}}else if(null!=a[n]&&h){h=h.createCursor();try{h.seek(this._currentChildBookmark),h.moveNext(),this._currentChildBookmark=h.getBookmark()}catch(d){}this._childIndexStack[a[n]]=this._currentChildBookmark}}else if("remove"==e.kind){if(s=e.items.length,e.location<=this._currentIndex){if(e.location+s>=this._currentIndex){for(i=e.location,this.moveToFirst(),this.seek(t.getFIRST(),i),i=0;i<s;i++)r=e.items[i],delete this._collection._parentMap[V.getUID(r)];return}this._currentIndex-=s,l=!0}for(i=0;i<s;i++){if(r=e.items[i],l)if(n=this._collection.getParentItem(r),h=this._collection.getChildren(n),n==o){if(h){h=h.createCursor();try{h.seek(this._currentChildBookmark),h.movePrevious(),this._currentChildBookmark=h.getBookmark()}catch(d){}}}else if(null!=a[n]&&h){h=h.createCursor();try{h.seek(this._currentChildBookmark),h.movePrevious(),this._currentChildBookmark=h.getBookmark()}catch(d){}this._childIndexStack[a[n]]=this._currentChildBookmark}delete this._collection._parentMap[V.getUID(r)]}}else"reset"==e.kind&&(this._model=this._collection._treeData,this._modelCursor=this._model.createCursor(),this._collection.dispatchEvent(new w("cursorUpdate")))};var pb=function(t){wa.call(this),this.childrenField="children",arguments.length?this.setSource(t):this.setSource(null)};z(pb,wa),pb.prototype.getSource=function(){return this._source},pb.prototype.setSource=function(t){this._source=t,t=new y(y.COLLECTION_CHANGE),t.kind="reset",this.dispatchEvent(t)},pb.prototype.canHaveChildren=function(t){if(null==t)return!1;var e=!1;if(E(t)){var i="children"==this.childrenField?t.childNodes:t.child(this.childrenField).childNodes;(t=G.getAttribute(t,"isBranch"))?"true"==t&&(e=!0):0!=i.length&&(e=!0)}else if(Ea(t))try{I(t[this.childrenField])||(e=!0)}catch(s){}return e},pb.prototype.getChildren=function(t){if(null==t)return null;var e;if(E(t))e="children"==this.childrenField?t.childNodes:t.child(this.childrenField).childNodes;else if(Ea(t))try{e=t[this.childrenField]}catch(i){}return e},pb.prototype.hasChildren=function(t){if(null==t)return!1;t=this.getChildren(t);try{if(t instanceof xb&&0<t.getLength()||0<t.length)return!0}catch(e){}return!1},pb.prototype.getData=function(t){return t},pb.prototype.getRoot=function(){return this._source};var Fe=function(t,e){this.uno=Sa.elementNo++,this.dataField=0<arguments.length?t:null,this.summaryOperation=1<arguments.length?e:"SUM",this.label=void 0},ic=function(){},je=function(){this.fields=void 0,this.summaryPlacement="last",this.summaryObjectFunction=void 0};je._defaultProperty="fields",je._propertyType={fields:Array};var fa=function(){pb.call(this),this.async=!1,this.grouping=this.summaries=void 0,this.beforeSorting=!0,this._newCollection=new P,fa._super.setSource.call(this,this._newCollection.getSource()),this._objectSummaryMap={},this._parentMap={},this._prepared=this._dispatchCollectionEvents=!1,this._currentPosition=t.getFIRST(),this._optimizeSummaries=!1};fa._defaultProperty="grouping",fa._propertyType={summaries:Array},z(fa,pb),fa.prototype.getSource=function(){return this._sourceCol},fa.prototype.setSource=function(t){this._sourceCol&&this._sourceCol.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),t?(this._sourceCol=this._getCollection(t),this._sourceCol instanceof xb&&this._sourceCol.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this)):this._sourceCol=null},fa.prototype.getChildren=function(t){var e,i,s=fa._super.getChildren.call(this,t);if(null!=s){if(!(s instanceof xb))return null;for(i=s.createCursor();!i.getAfterLast();)e=V.getUID(i.getCurrent()),this._parentMap[e]=t,i.moveNext()}return s},fa.prototype.getRoot=function(){return fa._super.getSource.call(this)},fa.prototype.refresh=function(t,e){e=1<arguments.length&&e;var i;return bb(t)&&(this.async=t),this._dispatchCollectionEvents=!!this.async||e,!this.grouping||!this.grouping.fields||1>this.grouping.fields.length?(fa._super.setSource.call(this,this.getSource()),i=new y(y.COLLECTION_CHANGE),i.kind="reset",this.dispatchEvent(i),!0):(fa._super.setSource.call(this,this._newCollection),i=new y(y.COLLECTION_CHANGE),i.kind="reset",this.dispatchEvent(i),this._parentMap={},this._objectSummaryMap={},this._summariesTracker=null,this._summaryPresent=!1,this._prepareSummaryFields(),this.getSource()&&this.grouping?i=this._makeGroupedCollection():(this._initialize(),this._newCollection.removeAll(),i=new y(y.COLLECTION_CHANGE),i.kind="reset",this.dispatchEvent(i),i=!0),i)},fa.prototype.cancelRefresh=function(){this._timer&&(clearInterval(this._timer),this._timer=null,this._cleanUp())},fa.prototype._addItem=function(t,e){for(var i=fa._super.getSource.call(this),s=null,r=0;r<this.grouping.fields.length;){var n=this._checkForParentExistence(i,t,r);if(!n)break;(s=n)&&(i=this.getChildren(s),r++)}s?(i=this.getChildren(s),r<=this.grouping.fields.length-1?(this._createGroupsAndInsertItem(i,t,r),this._updateSummary(t)):U(i.addItem)&&(i.addItem(t),this._updateParentMap(s,t),this._updateSummary(t))):(this._createGroupsAndInsertItem(fa._super.getSource.call(this),t),this._updateSummary(t))},fa.prototype._checkForParentExistence=function(t,e,i){for(t=t.createCursor(),e=this._getDataLabel(e,this.grouping.fields[i]);!t.getAfterLast();){if(i=t.getCurrent(),i.hasOwnProperty(this.grouping.label)&&i[this.grouping.label]==e)return i;t.moveNext()}return null},fa.prototype._createGroupsAndInsertItem=function(t,e,i){i=2<arguments.length?i:0;var s,r,n=this.grouping.fields.length;for(s=i;s<n;s++){var o,a=this._getDataLabel(e,this.grouping.fields[s]);if(!a)break;if(o=null!=this.grouping.fields[s].groupingObjectFunction?this.grouping.fields[s].groupingObjectFunction(a):null!=this.grouping.groupingObjectFunction?this.grouping.groupingObjectFunction(a):{},o[this.childrenField]=new P,o[this.grouping.label]=a,U(t.addItem)&&(t.addItem(o),r=null!=r?r:this._getParent(t.createCursor().getCurrent()),this._updateParentMap(r,o),t=this.getChildren(o),r=o,s==n-1)){t.addItem(e),this._updateParentMap(o,e);break}}},fa.prototype._getCollection=function(t){if(E(t))return new Hb(t);if(t instanceof xb)return t;if(ha(t))return new P(t);if(Ea(t)){var e=[];return e.push(t),new P(e)}return new P},fa.prototype._getDataLabel=function(t,e){return null!=e.groupingFunction?e.groupingFunction(t,e):E(t)?G.hasElementProperty(t,e.name)?G.getProperty(t,e.name):"Not Available":t.hasOwnProperty(e.name)?t[e.name]:"Not Available"},fa.prototype._getParent=function(t){if(t=V.getUID(t),this._parentMap.hasOwnProperty(t))return this._parentMap[t]},fa.prototype._generateRootSummaries=function(t){t=fa._super.getSource.call(this),this._getSummaries(t,-1)},fa.prototype._getSummariesForRow=function(t,e,i){e=new pb(e),e.childrenField=this.childrenField,i=new T(e,{});var s=new pc(i,i,e);e=this._summaryFields.length;var r,n,o=new Tc,a={};for(i=0;i<e;i++)r=this._summaryFields[i],n=!F(r.summaryOperation)&&r.summaryOperation instanceof Sc?r.summaryOperation:o,a[r.uno]=n.summaryCalculationBegin(r);for(;!s.getAfterLast();){for(i=0;i<e;i++)r=this._summaryFields[i],n=!F(r.summaryOperation)&&r.summaryOperation instanceof Sc?r.summaryOperation:o,n.calculateSummary(a[r.uno],r,s.getCurrent());s.moveNext()}for(i=0;i<e;i++)r=this._summaryFields[i],n=!F(r.summaryOperation)&&r.summaryOperation instanceof Sc?r.summaryOperation:o,s=n.returnSummary(a[r.uno],r),this._populateSummary(t,r,a[r.uno],s)},fa.prototype._populateSummary=function(t,e,i,s){var r=e.summaryOperation.toString();t=V.getUID(t),p(this._summariesTracker)&&(this._summariesTracker={}),I(this._summariesTracker[t])&&(this._summariesTracker[t]={}),I(this._summariesTracker[t][r])&&(this._summariesTracker[t][r]={}),I(this._summariesTracker[t][r][e.dataField])&&(this._summariesTracker[t][r][e.dataField]={}),this._summariesTracker[t][r][e.dataField]={summaryObject:i,value:s}},fa.prototype._getSummary=function(t,e){var i=e.summaryOperation.toString(),s=V.getUID(t);return p(this._summariesTracker)||I(this._summariesTracker[s])||I(this._summariesTracker[s][i])||I(this._summariesTracker[s][i][e.dataField])?null:this._summariesTracker[s][i][e.dataField]},fa.prototype._getSummaries=function(t,e){if(!(e>this.grouping.fields.length-1)){var i=this.getChildren(t);if(t==fa._super.getSource.call(this)&&(i=t),i&&0!=i.getLength()){if(e==this.grouping.fields.length-1)this._getSummariesForRow(t,i,e);else{for(var s,r,n=i.createCursor(),o=!0,i=new Tc,a={};!n.getAfterLast();){var l=n.getCurrent();if(!(l instanceof ic)){var h,d=this._summaryFields.length;for(h=0;h<d;h++){s=this._summaryFields[h],r=!F(s.summaryOperation)&&s.summaryOperation instanceof Sc?s.summaryOperation:i;var c=this._getSummary(l,s);o?a[s.uno]=r.summaryOfSummaryCalculationBegin(c.summaryObject,s):r.calculateSummaryOfSummary(a[s.uno],c.summaryObject,s)}}o=!1,n.moveNext()}if(!o)for(h=0;h<d;h++)s=this._summaryFields[h],r=!F(s.summaryOperation)&&s.summaryOperation instanceof Sc?s.summaryOperation:i,n=r.returnSummaryOfSummary(a[s.uno],s),this._populateSummary(t,s,a[s.uno],n)}-1==e?this._insertSummaries(fa._super.getSource.call(this),-1,!0):this._insertSummaries(t,e)}}},fa.prototype._insertSummaries=function(t,e,i){i=2<arguments.length&&i;var s=this.summaries;if(i||(s=this.grouping.fields[e].summaries),s){var r,n=[],o=s.length;for(r=0;r<o;r++){var a=s[r];n[r]=null!=a.summaryObjectFunction?a.summaryObjectFunction():new ic;var l,h=a.fields.length;for(l=0;l<h;l++){var d=a.fields[l],c=d.label?d.label:d.dataField,d=this._getSummary(t,d);null!=d&&(d=d.value,n[r][c]=d)}a=V.getUID(t),void 0==this._objectSummaryMap[a]&&(this._objectSummaryMap[a]=[]),this._objectSummaryMap[a].push(n[r])}i?this._insertRootSummary(n):this._insertSummary(t,n,s)}},fa.prototype._initialize=function(){this._currentData=null,this._currentGroups=[],this._currentGroupLabels=[],this._currentIndices=[],this._childrenArray=null},fa.prototype._insertRootSummary=function(t){var e=fa._super.getSource.call(this);if(U(e.addItemAt)){var i,s=t.length;for(i=0;i<s;i++){var r=this.summaries[i];-1!=r.summaryPlacement.indexOf("first")&&e.addItemAt(t[i],0),-1!=r.summaryPlacement.indexOf("last")&&e.addItem(t[i])}}},fa.prototype._insertSummary=function(t,e,i){var s,r,n=i.length;for(s=0;s<n;s++){var o=i[s];if(-1!=o.summaryPlacement.indexOf("group"))for(r in e[s])"rm_internal_uid"!=r&&"constructor"!=r&&(t[r]=e[s][r]);var a;-1!=o.summaryPlacement.indexOf("first")&&(a=this.getChildren(t))&&a.addItemAt(e[s],0),-1!=o.summaryPlacement.indexOf("last")&&(a=this.getChildren(t))&&a.addItem(e[s])}},fa.prototype._makeGroupedCollection=function(){var t,e=this,i=[],s=e.grouping.fields.length;if(e._oldSort=e.getSource().getSort(),e.beforeSorting){for(t=0;t<s;t++){var r=e.grouping.fields[t],n=new sb(r.name,r.caseInsensitive,r.descending,r.numeric);n.compareFunction=r.compareFunction,i.push(n)}if(e.getSource().setSort(new Ac),null!=e.grouping.compareFunction&&e.getSource().getSort().setCompareFunction(e.grouping.compareFunction),e.getSource().getSort().setFields(i),i=e.getSource().refresh(),!i)return i}return e.async?(e._timer&&clearInterval(e._timer),e._timer=setInterval(function(){e._timerHandler()},10),!0):e._buildGroups()},fa.prototype._timerHandler=function(){this._buildGroups()&&(clearInterval(this._timer),this._timer=null)},fa.prototype._buildGroups=function(){var e=this;if(!e._prepared){var i={};if(e._initialize(),e._newCollection.removeAll(),!e.getSource()||0==e.getSource().getLength())return!1;if(e._dispatchCollectionEvents){var s=new pb(e._newCollection);s.childrenField=e.childrenField,e._hView=new T(s,i)}if(e._flatView=e.getSource(),e._flatCursor=e._flatView.createCursor(!0),e._gf=e.grouping.fields,e._fieldCount=e._gf.length,e._gf&&(e._prepared=!0,e.async))return!1;if(e.async)return!0}for(e._flatCursor.seek(e._currentPosition);!e._flatCursor.getAfterLast()&&e._currentPosition!=t.getLAST();){for(e._currentData=e._flatCursor.getCurrent(),i=s=0;i<e._fieldCount;++i){var r=e._getDataLabel(e._currentData,e._gf[i]);if(r!=e._currentGroupLabels[i]){if(e._childrenArray&&e._childrenArray.length&&(e._currentGroups[e._fieldCount-1][e.childrenField].setSource(e._childrenArray),e._childrenArray=[]),
e._summaryPresent)for(s=e._currentGroups.length-1;s>=i;s--)e._getSummaries(e._currentGroups[s],s);e._currentGroupLabels.splice(i+1,e._currentGroupLabels.length-i-1),e._currentGroups.splice(i+1,e._currentGroups.length-i-1),e._currentIndices.splice(i+1,e._currentIndices.length-i-1),e._currentGroupLabels[i]=r,e._currentGroups[i]=null!=e._gf[i].groupingObjectFunction?e._gf[i].groupingObjectFunction(r):null!=e.grouping.groupingObjectFunction?e.grouping.groupingObjectFunction(r):{},e._currentGroups[i][e.childrenField]=new P,e._currentGroups[i][e.grouping.label]=e._currentGroupLabels[i],e._itemIndex=e._currentIndices[i-1]?e._currentIndices[i-1]:0,e._dispatchCollectionEvents?e._hView.addChild(e._currentGroups[i-1],e._currentGroups[i]):0<i?e._currentGroups[i-1][e.childrenField].getSource().push(e._currentGroups[i]):e._newCollection.getSource().push(e._currentGroups[i]),e._currentIndices[i-1]=++e._itemIndex}i==e._fieldCount-1&&(e._itemIndex=e._currentIndices[i]?e._currentIndices[i]:0,e._childrenArray||(e._childrenArray=[]),e._childrenArray.push(e._currentData),e._currentIndices[i]=++e._itemIndex)}try{if(e._flatCursor.moveNext(),e._currentPosition=e._flatCursor.getBookmark(),e.async)return!1}catch(n){n instanceof ca&&(e._cleanUp(),n.addResponder(new S(function(t,i){e._makeGroupedCollection()},function(t,e){})))}}if(e._currentPosition==t.getLAST()){if(e._childrenArray&&e._childrenArray.length&&(e._currentGroups[e._fieldCount-1][e.childrenField].setSource(e._childrenArray),e._summaryPresent))for(s=e._fieldCount-1;0<=s;s--)e._getSummaries(e._currentGroups[s],s);e.getSource()&&e.summaries&&(fa._super.getSource.call(e)||fa._super.setSource.call(e,new P([e.getSource()])),e._generateRootSummaries(p(e.grouping))),e._newCollection.refresh(),i=new y(y.COLLECTION_CHANGE),i.kind="refresh",e.dispatchEvent(i),e._cleanUp()}return!0},fa.prototype._prepareSummaryFields=function(){this._summaryFields=[];var t,e,i,s;if(null!=this.grouping.fields)for(t=0;t<this.grouping.fields.length;t++){var r=this.grouping.fields[t];if(null!=r.summaries)for(e=0;e<r.summaries.length;e++)if(s=r.summaries[e],null!=s.fields)for(i=0;i<s.fields.length;i++)this._summaryPresent=!0,this._summaryFields.push(s.fields[i])}if(null!=this.summaries)for(t=0;t<this.summaries.length;t++)if(s=this.summaries[t],null!=s.fields)for(e=0;e<s.fields.length;e++)this._summaryPresent=!0,this._summaryFields.push(s.fields[e])},fa.prototype._cleanUp=function(){this.getSource().setSort(this._oldSort),this.getSource().refresh(),this._prepared=!1,this._currentPosition=t.getFIRST(),this._oldSort=null,this._flatCursor.removeListener(),this._flatCursor=null},fa.prototype._applyFunctionForParentNodes=function(t,e,i){if(i=2<arguments.length?i:0,0<t.getLength())for(var s=t.createCursor();!s.getAfterLast();){var r=this.getChildren(s.getCurrent());if(r instanceof P)for(var n=r.createCursor();!n.getAfterLast();){var o=n.getCurrent();if(this.hasChildren(o)){this._applyFunctionForParentNodes(r,e,i+1);break}n.moveNext()}e.call(this,s.getCurrent(),i),s.moveNext()}},fa.prototype._regenerateRootSummaries=function(){if(this.summaries){var t=fa._super.getSource.call(this);this.grouping||(t=t.createCursor().getCurrent());var e=V.getUID(t),i=this._objectSummaryMap[e];if(i&&U(t.getItemIndex)){var s,r=i.length;for(s=0;s<r;s++){var n=t.getItemIndex(i[s]);-1!=n&&t.removeItemAt(n)}delete this._objectSummaryMap[e],this._generateRootSummaries(null==this.grouping)}}},fa.prototype._removeAllSummaries=function(){this._applyFunctionForParentNodes(fa._super.getSource.call(this),this._removeSummary)},fa.prototype._removeItemAndSummaries=function(t,e,i){i=2<arguments.length&&i;for(var s=[],r=this.getParent(e);null!=r;){var n,o=!0,a=this.getChildren(r);if(a){if(a.contains(e)&&U(a.getItemIndex)){i&&(n=a.getItemIndex(e),-1!=n&&(a.removeItemAt(n),n=V.getUID(e),this._parentMap[n]&&delete this._parentMap[n]));var l=V.getUID(r);if(this._objectSummaryMap[l]){var h,d=this._objectSummaryMap[l],c=d.length;for(h=0;h<c;h++)n=a.getItemIndex(d[h]),-1!=n&&a.removeItemAt(n);delete this._objectSummaryMap[l]}null!=this._summariesTracker&&this._summariesTracker[l]&&(this._summariesTracker[l]={}),i&&(0==a.length&&null!=this._getParent(r)?o=!1:i=!1)}if(o&&s.push(r),e=r,r=this._getParent(r),!r){if(1==s.length&&0==this.getChildren(s[0]).getLength()&&U(t.getItemIndex)&&(n=t.getItemIndex(e),-1!=n)){t.removeItemAt(n);break}return s.reverse()}}}return null},fa.prototype._removeSummary=function(t,e){var i=this.getChildren(t);i&&this._removeItemAndSummaries(fa._super.getSource.call(this),i.createCursor().getCurrent())},fa.prototype._updateParentMap=function(t,e){var i=V.getUID(e);this._parentMap[i]=t},fa.prototype._updateSummary=function(t,e){e=1<arguments.length&&e;var i;i=fa._super.getSource.call(this);var s;if((this._summaryPresent||e)&&(s=this._removeItemAndSummaries(i,t,e)),this._summaryPresent&&s)for(i=s.length,--i;0<=i;i--)this._getSummaries(s[i],i)},fa.prototype._collectionChangeHandler=function(t){if(this.grouping){var e,i,s,r,n;if("update"==t.kind)for(r=t.items.length,i=0;i<r;i++){var o;if(e=t.items[i].source){for(n=this.grouping.fields.length,s=0;s<n;s++)if(t.items[i].property==this.grouping.fields[s].name){o=!0,this._updateSummary(e,!0),this._addItem(e);break}o||this._updateSummary(e)}}if("add"==t.kind)for(r=t.items.length,i=0;i<r;i++)e=t.items[i],this._addItem(e);if("remove"==t.kind)for(r=t.items.length,i=0;i<r;i++)e=t.items[i],this._updateSummary(e,!0);if("replace"==t.kind)for(r=t.items.length,i=0;i<r;i++)e=t.items[i].newValue,this._updateSummary(t.items[i].oldValue,!0),this._addItem(e);this._regenerateRootSummaries()}};var pc=function(t,e,i){wa.call(this),this._currentIndex=this._currentChildIndex=0,this._currentDepth=1,this._childNodes=[],this._parentNodes=[],this._childIndexStack=[],this._collection=t,this._model=e,this._hierarchicalData=i,this._modelCursor=this._model.createCursor(),1<this._model.getLength()?this._more=!0:this._more=!1};z(pc,wa),pc.prototype.getIndex=function(){return this._currentIndex},pc.prototype.getBookmark=function(){return null},pc.prototype.getCurrent=function(){try{if(0==this._childIndexStack.length){if(!(this._hierarchicalData.canHaveChildren(this._modelCursor.getCurrent())||this._modelCursor.getCurrent()instanceof ic))return this._modelCursor.getCurrent();this.moveNext()}return this._childNodes.getItemAt(this._currentChildIndex)}catch(t){}return null},pc.prototype.getCurrentDepth=function(){return this._currentDepth},pc.prototype.getBeforeFirst=function(){return this._currentIndex<=this._collection.getLength()&&null==this.getCurrent()},pc.prototype.getAfterLast=function(){return this._currentIndex>=this._collection.getLength()&&null==this.getCurrent()},pc.prototype.getView=function(){return this._model},pc.prototype.findAny=function(t){return!1},pc.prototype.findFirst=function(t){return!1},pc.prototype.findLast=function(t){return!1},pc.prototype.moveNext=function(){var t=0==this._childIndexStack.length?this._modelCursor.getCurrent():this.getCurrent();if(!t)return!1;var e=V.getUID(t);if(this._collection._parentMap.hasOwnProperty(e)||(this._collection._parentMap[e]=this._parentNodes[this._parentNodes.length-1]),e=!0,this._hierarchicalData.canHaveChildren(t)&&this._hierarchicalData.hasChildren(t)){var i=this._childNodes;if(this._childNodes=this._collection.getChildren(t),0<this._childNodes.getLength())return this._childIndexStack.push(this._currentChildIndex),this._parentNodes.push(t),this._currentChildIndex=0,t=this._childNodes.getItemAt(0),this._currentIndex++,this._currentDepth++,(this._hierarchicalData.canHaveChildren(t)||t instanceof ic)&&(e=this.moveNext()),e;this._childNodes=i}for(;;)if(null!=this._childNodes&&0<this._childNodes.length&&this._currentChildIndex>=Math.max(this._childNodes.length-1,0)){if(1>this._childIndexStack.length&&!this._more)return this._currentIndex++,this._currentDepth=1,!1;t=this._parentNodes.pop(),i=this._parentNodes[this._parentNodes.length-1],null!=i&&this._hierarchicalData.canHaveChildren(i)&&this._hierarchicalData.hasChildren(i)?this._childNodes=this._collection.getChildren(i):this._childNodes=[],this._currentChildIndex=this._childIndexStack.pop(),this._currentDepth--}else{if(0==this._childIndexStack.length){if(this._currentDepth=1,this._more=this._modelCursor.moveNext()){t=this._modelCursor.getCurrent();break}return this._currentDepth=1,this._currentIndex++,!1}try{t=this._childNodes[++this._currentChildIndex];break}catch(s){if(s instanceof vc)return!1}}return this._currentIndex++,(this._hierarchicalData.canHaveChildren(t)||t instanceof ic)&&(e=this.moveNext()),e},pc.prototype.movePrevious=function(){var t=this.getCurrent();if(!t)return!1;var e=!0;if(this._parentNodes&&0<this._parentNodes.length){if(0==this._currentChildIndex){t=this._parentNodes.pop(),this._currentChildIndex=this._childIndexStack.pop();var i=this._parentNodes[this._parentNodes.length-1];return null!=i&&this._hierarchicalData.canHaveChildren(i)&&this._hierarchicalData.hasChildren(i)?this._childNodes=this._collection.getChildren(i):this._childNodes=[],this._currentDepth--,this._currentIndex--,!this.beforeFirst()&&(this._hierarchicalData.canHaveChildren(t)||t instanceof ic)&&(e=this.movePrevious()),e}try{t=this._childNodes[--this._currentChildIndex]}catch(s){if(s instanceof vc)return!1}}else{if(!(this._more=this._modelCursor.movePrevious()))return this._currentIndex=-1,!1;t=this._modelCursor.getCurrent()}for(;this._hierarchicalData.canHaveChildren(t)&&this._hierarchicalData.hasChildren(t);){if(i=this._childNodes,this._childNodes=this._collection.getChildren(t),!(0<this._childNodes.length)){this._childNodes=i;break}this._childIndexStack.push(this._currentChildIndex),this._parentNodes.push(t),this._currentChildIndex=this._childNodes.length-1,t=this._childNodes[this._currentChildIndex],this._currentDepth++}return this._currentIndex--,(this._hierarchicalData.canHaveChildren(t)||t instanceof ic)&&(e=this.movePrevious()),e},pc.prototype.seek=function(t,e,i){},pc.prototype.insert=function(t){},pc.prototype.remove=function(){return null};var $a=function(t){la.call(this),this._sourceIsXML=!1,this._currentPage=1,this._rowsPerPage=20,arguments.length?this.setSource(t):this.setSource(null)};$a._defaultProperty="source",z($a,la),$a.prototype.getCurrentPage=function(){return this._currentPage},$a.prototype.setCurrentPage=function(t){this._currentPage=t,this._setPageRows()},$a.prototype.getFilterFunction=function(){return this._sourceCol?this._sourceCol.filterFunction:null},$a.prototype.setFilterFunction=function(t){this._sourceCol&&(this._sourceCol.filterFunction=t)},$a.prototype.getRowsPerPage=function(){return this._rowsPerPage},$a.prototype.setRowsPerPage=function(t){this._rowsPerPage=t,this._setPageRows()},$a.prototype.getSort=function(){return this._sourceCol?this._sourceCol.getSort():null},$a.prototype.setSort=function(t){this._sourceCol&&this._sourceCol.setSort(t)},$a.prototype.getTotalLength=function(){return this._sourceCol?this._sourceCol.getLength():0},$a.prototype.getTotalPageCount=function(){return this._sourceCol?Math.ceil(this._sourceCol.getLength()/this._rowsPerPage):0},$a.prototype.getSource=function(){return this._sourceCol},$a.prototype.setSource=function(t){this._sourceCol&&this._sourceCol.removeEventListener(y.COLLECTION_CHANGE,this._sourceCollectionChangeHandler,this),this._sourceIsXML=!1,this.setList(new Gb([]));var e=new y(y.COLLECTION_CHANGE);e.kind="reset",t?(this._sourceCol=this._getCollection(t),this.dispatchEvent(e),this._sourceCol instanceof xb&&this._sourceCol.addEventListener(y.COLLECTION_CHANGE,this._sourceCollectionChangeHandler,this),this._setPageRows()):(this._sourceCol=null,this.dispatchEvent(e))},$a.prototype._getCollection=function(t){if(E(t))return this._sourceIsXML=!0,new Hb(t);if(t instanceof xb)return t;if(ha(t))return new P(t);if(Ea(t)){var e=[];return e.push(t),new P(e)}return new P},$a.prototype._getSourceIndex=function(t){return(Math.max(1,this._currentPage)-1)*this._rowsPerPage+t},$a.prototype._checkCurrentPage=function(){this._currentPage>this.getTotalPageCount()&&(this._currentPage=this.getTotalPageCount()),1>this._currentPage&&(this._currentPage=1)},$a.prototype._internalDispatchEvent=function(t,e,i){if(i=2<arguments.length?i:-1,this.dispatchEventEnabled&&this.hasEventListener(y.COLLECTION_CHANGE)){var s=new y(y.COLLECTION_CHANGE);s.kind=t,e&&s.items.push(e),s.location=i,this.dispatchEvent(s)}},$a.prototype._setPageRows=function(){var t,e,i,s;if(this._checkCurrentPage(),this._sourceCol){for(this._dispatchResetEvent=!1,$a._super.removeAll.call(this),s=[],t=e=(this._currentPage-1)*this._rowsPerPage,i=this._sourceCol.getLength();t<i&&!(0<this._rowsPerPage&&t>=e+this._rowsPerPage);t++)s.push(this._sourceCol.getItemAt(t));this.setList(new Gb(s)),this._dispatchResetEvent=!0,this.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"refresh",(-1),(-1)))}},$a.prototype.setItemAt=function(t,e){this._sourceCol&&this._sourceCol.setItemAt(t,this._getSourceIndex(e))},$a.prototype.addItem=function(t){this._sourceCol&&this._sourceCol.addItem(t)},$a.prototype.addItemAt=function(t,e){this._sourceCol&&this._sourceCol.addItemAt(t,this._getSourceIndex(e))},$a.prototype.addAll=function(t){this._sourceCol&&this._sourceCol.addAll(t)},$a.prototype.addAllAt=function(t,e){this._sourceCol&&this._sourceCol.addAllAt(t,e)},$a.prototype.removeItemAt=function(t){return this._sourceCol?this._sourceCol.removeItemAt(this._getSourceIndex(t)):null},$a.prototype.removeAll=function(){this._sourceCol&&(this._sourceCol.removeAll(),this._currentPage=1)},$a.prototype.getProperty=function(t,e){return this._sourceCol?this._sourceCol.getProperty(t,e):null},$a.prototype.setProperty=function(t,e,i){if(this._sourceCol)return this._sourceCol.setProperty(t,e,i)},$a.prototype.getPropertyAt=function(t,e){if(this._sourceCol)return this._sourceCol.getPropertyAt(this._getSourceIndex(t),e)},$a.prototype.setPropertyAt=function(t,e,i){if(this._sourceCol)return this._sourceCol.setPropertyAt(this._getSourceIndex(t),e,i)},$a.prototype.itemUpdated=function(t,e,i,s){this._sourceCol&&this._sourceCol.itemUpdated(t,e,i,s)},$a.prototype.refresh=function(){if(this._sourceCol)return this._sourceCol.getSort()||null!=this._sourceCol.filterFunction||this._sourceCol._localIndex?this._sourceCol.refresh():this._setPageRows();var t=new y(y.COLLECTION_CHANGE);return t.kind="reset",this.dispatchEvent(t),!0},$a.prototype.toXMLString=function(){if(this._sourceCol&&this._sourceIsXML){for(var t="",e=this._sourceCol._list._sourceParent.nodeName,i=0;i<this.getLength();i++)t+=G.elementToString(this.getItemAt(i));return e&&(t="<"+e+">"+t+"</"+e+">"),t}return""},$a.prototype._sourceCollectionChangeHandler=function(t){"update"==t.kind&&t.items&&ha(t.items)&&0<t.items.length&&t.items[0]instanceof wc&&"update"==t.items[0].kind&&null==t.items[0].newValue&&null==t.items[0].oldValue&&null==t.items[0].property||(this.dispatchEvent(t),this._setPageRows())};var na=function(t){P.call(this),this._source=null,arguments.length?this.setSource(t):this.setSource(null),this._cellAttributeFieldSuffix="_attr",this._rowAttributeField="_rattr",this.autoResetRowSpan=!0,this.cellAttributes=void 0,this.extractable=this.dispatchEventEnabled=!0,this.rowAttributes=void 0};z(na,P),na.prototype.getCellAttributeFieldSuffix=function(){return this._cellAttributeFieldSuffix},na.prototype.setCellAttributeFieldSuffix=function(t){this._cellAttributeFieldSuffix=t,this.cellAttributes&&(this.cellAttributes={},this.extractAttributes())},na.prototype.getGrid=function(){return this._grid},na.prototype.setGrid=function(t){this._grid!=t?(this._grid&&this._grid.removeEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this),this._grid=t,this._grid.addEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this,!1,0),this._spanColumns=this._grid._spanColumns,this.extractAttributes()):this._spanColumns!=this._grid._spanColumns&&(this._spanColumns=this._grid._spanColumns,this.extractAttributes())},na.prototype.getRowAttributeField=function(){return this._rowAttributeField},na.prototype.setRowAttributeField=function(t){this._rowAttributeField=t,this.rowAttributes&&(this.rowAttributes={},this.extractAttributes())},na.prototype.setList=function(t){na._super.setList.call(this,t),this.cellAttributes={},this.rowAttributes={},this.extractAttributes()},na.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},na.prototype._setRowAttributeObject=function(t,e){if(e&&e[this._rowAttributeField]){var i,s=new xc,r=e[this._rowAttributeField];for(i in r)switch(i){case"styleName":s.styleName=r[i];break;case"backgroundColor":s.backgroundColor=r[i];break;case"formatString":s.formatString=r[i];break;case"editable":s.editable=r[i];break;case"rowHeight":s.rowHeight=r[i];break;default:s[i]=r[i]}r=this._itemToUID(e),this.rowAttributes[r]&&delete this.rowAttributes[r],this.rowAttributes[r]=s}},na.prototype._findItemRowNo=function(t){return this._localIndex?Ra.indexOf(this._localIndex,t):this._list?this._list.getItemIndex(t):-1},na.prototype._registCellAttribute=function(t,e,i){var s=this._itemToUID(t);if(i._type=1,1==i.rowSpan&&1==i.colSpan)this.cellAttributes[s+","+e]=i;else if(t=this._findItemRowNo(t),!(0>t))for(var r=t;r<t+i.rowSpan;r++)for(var n=e;n<e+i.colSpan;n++)if(r==t&&n==e)this.cellAttributes[s+","+e]=i;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=i._oItem,o._rowGap=r-t,o.rowSpan=i.rowSpan,o.colSpan=i.colSpan,o.styleName=i.styleName,o.backgroundColor=i.backgroundColor,o.formatString=i.formatString,o.editable=i.editable,this._localIndex?r<this._localIndex.length&&(this.cellAttributes[this._itemToUID(this._localIndex[r])+","+n]=o):r<this._list.getLength()&&(this.cellAttributes[this._itemToUID(this._list.getItemAt(r))+","+n]=o)}},na.prototype._registCellAttributeAt=function(t,e,i,s){if(s._type=1,1==s.rowSpan&&1==s.colSpan)this.cellAttributes[i+","+e]=s;else for(var r=t;r<t+s.rowSpan;r++)for(var n=e;n<e+s.colSpan;n++)if(r==t&&n==e)this.cellAttributes[i+","+e]=s;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=s._oItem,o._rowGap=r-t,o.rowSpan=s.rowSpan,o.colSpan=s.colSpan,o.styleName=s.styleName,o.backgroundColor=s.backgroundColor,o.formatString=s.formatString,o.editable=s.editable,this._localIndex?r<this._localIndex.length&&(this.cellAttributes[this._itemToUID(this._localIndex[r])+","+n]=o):r<this._list.getLength()&&(this.cellAttributes[this._itemToUID(this._list.getItemAt(r))+","+n]=o)}},na.prototype._setCellAttributeObject=function(t,e,i,s,r){var n;if(r){if(!r[i+this._cellAttributeFieldSuffix])return;n=r}else{if(!s[i+this._cellAttributeFieldSuffix])return;n=s}r=this._itemToUID(s),this.cellAttributes[r+","+e]&&delete this.cellAttributes[r+","+e];var o=new ib;i=n[i+this._cellAttributeFieldSuffix];for(var a in i)switch(a){case"rowSpan":o.rowSpan=i[a];break;case"colSpan":o.colSpan=i[a];break;case"styleName":o.styleName=i[a];break;case"backgroundColor":o.backgroundColor=i[a];break;case"formatString":o.formatString=i[a];break;case"editable":o.editable=i[a];break;default:o[a]=i[a]}o.colNo=e,o._oItem=s,this._registCellAttributeAt(t,e,r,o)},na.prototype._setAttribute=function(t,e){var i=this._spanColumns.length;this._setRowAttributeObject(t,e);for(var s=0;s<i;s++){var r=this._spanColumns[s];if(r.getDataField()){var n=this._grid._getHeaderInfo(r);null!=n.internalLabelFunction?(n=n.internalLabelFunction(e,r))&&this._setCellAttributeObject(t,r.colNum,r.getDataField(),e,n):e&&this._setCellAttributeObject(t,r.colNum,r.getDataField(),e)}}},na.prototype._internalDispatchEvent=function(t,e,i){if(i=2<arguments.length?i:-1,this.dispatchEventEnabled&&this.hasEventListener(y.COLLECTION_CHANGE)){var s=new y(y.COLLECTION_CHANGE);s.kind=t,e&&s.items.push(e),s.location=i,this.dispatchEvent(s)}},na.prototype.extractAttributes=function(t,e){if(e=!(1<arguments.length)||e,t)this._grid=t;else if(!this._grid)return;if(this._grid._spanColumns&&0<this._grid._spanColumns.length){if(this._spanColumns=this._grid._spanColumns,this.extractable&&(this.cellAttributes||(this.cellAttributes={}),this.rowAttributes||(this.rowAttributes={}),this._list)){var i,s;if(this._localIndex)for(s=this._localIndex.length,i=0;i<s;i++)this._setAttribute(i,this._localIndex[i]);else for(s=this._list.getLength(),i=0;i<s;i++)this._setAttribute(i,this._list.getItemAt(i));e&&this._internalDispatchEvent("reset")}}else this._spanColumns=[]},na.prototype.getCellAttribute=function(t,e){if(!t||!this.cellAttributes)return null;var i=this.cellAttributes[this._itemToUID(t)+","+e];if(i&&this._localIndex&&this.autoResetRowSpan&&1<i.rowSpan){if(2==i._type&&0<i._rowGap)return null;var s,r=new ib;for(s in i)r[s]=i[s];return r.rowSpan=1,r}return i},na.prototype.getCellAttributeAt=function(t,e){if(0>t||t>=this._list.getLength()||!this.cellAttributes)return null;if(this._localIndex){if(t>=this._localIndex.length)return null}else if(t>=this._list.getLength())return null;return this._localIndex?this.getCellAttribute(this._localIndex[t],e):this.getCellAttribute(this._list.getItemAt(t),e)},na.prototype.getRowAttribute=function(t){return t&&this.rowAttributes?this.rowAttributes[this._itemToUID(t)]:null},na.prototype.getRowAttributeAt=function(t){if(0>t||!this.rowAttributes)return null;if(this._localIndex){if(t>=this._localIndex.length)return null}else if(t>=this._list.getLength())return null;return this._localIndex?this.getRowAttribute(this._localIndex[t]):this.getRowAttribute(this._list.getItemAt(t))},na.prototype.getRowAttributeUID=function(t){return t&&this.rowAttributes?this.rowAttributes[t]:null},na.prototype.addCellAttribute=function(t,e){return!!t&&(this.cellAttributes||(this.cellAttributes={}),e._oItem=t,this._registCellAttribute(t,e.colNo,e),this._internalDispatchEvent("replace",t),!0)},na.prototype.addCellAttributeAt=function(t,e){if(0>t||!this.cellAttributes)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttribute(this._localIndex[t],e):this.addCellAttribute(this._list.getItemAt(t),e)},na.prototype.addCellAttributeDetail=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,!t)return!1;this.cellAttributes||(this.cellAttributes={});var l=new ib;return l.colNo=e,l._type=1,l._oItem=t,l.rowSpan=i,l.colSpan=s,l.styleName=r,l.backgroundColor=n,l.formatString=o,l.editable=a,this._registCellAttribute(t,e,l),this._internalDispatchEvent("replace",t),!0},na.prototype.addCellAttributeDetailAt=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttributeDetail(this._localIndex[t],e,i,s,r,n,o,a):this.addCellAttributeDetail(this._list.getItemAt(t),e,i,s,r,n,o,a)},na.prototype.addCellAttributeExtend=function(t,e,i,s,r){if(!t)return!1;this.cellAttributes||(this.cellAttributes={}),i=new ib;for(var n in r)switch(n){case"backgroundColor":i.backgroundColor=r[n];break;default:i[n]=r[n]}return i.colNo=e,i._oItem=t,this._registCellAttribute(t,e,i),this._internalDispatchEvent("replace",t),!0},na.prototype.addCellAttributeExtendAt=function(t,e,i,s,r){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttributeExtend(this._localIndex[t],e,i,s,r):this.addCellAttributeExtend(this._list.getItemAt(t),e,i,s,r)},na.prototype._removeCellAttributeInternal=function(t,e,i){if(i=2<arguments.length?i:-1,!this.cellAttributes)return!1;var s=this._itemToUID(t),r=this.getCellAttribute(t,e);if(!r)return!1;if(1==r._type&&(1<r.rowSpan||1<r.colSpan))if(1<r.rowSpan){var n=i;0>n&&(n=this._findItemRowNo(t));for(var o=n;o<n+r.rowSpan;o++){try{s=this._localIndex?this._itemToUID(this._localIndex[o]):this._itemToUID(this._list.getItemAt(o))}catch(a){continue}for(var l=e;l<e+r.colSpan;l++)this.cellAttributes[s+","+l]&&delete this.cellAttributes[s+","+l]}}else for(l=e;l<e+r.colSpan;l++)this.cellAttributes[s+","+l]&&delete this.cellAttributes[s+","+l];else{if(!this.cellAttributes[s+","+e])return!1;delete this.cellAttributes[s+","+e]}return this._internalDispatchEvent("replace",t),!0},na.prototype.removeCellAttribute=function(t,e){return this._removeCellAttributeInternal(t,e)},na.prototype.removeCellAttributeAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this._removeCellAttributeInternal(this._localIndex[t],e,t):this._removeCellAttributeInternal(this._list.getItemAt(t),e,t)},na.prototype.addRowAttribute=function(t,e){return!!t&&(this.rowAttributes||(this.rowAttributes={}),this.rowAttributes[this._itemToUID(t)]=e,this._internalDispatchEvent("replace",t),!0)},na.prototype.addRowAttributeAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttribute(this._localIndex[t],e):this.addRowAttribute(this._list.getItemAt(t),e)},na.prototype.addRowAttributeDetail=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,!t)return!1;this.rowAttributes||(this.rowAttributes={});var o=new xc;return o.styleName=e,o.backgroundColor=i,o.formatString=s,o.editable=r,o.rowHeight=n,this.rowAttributes[this._itemToUID(t)]=o,this._internalDispatchEvent("replace",t),!0},na.prototype.addRowAttributeDetailAt=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttributeDetail(this._localIndex[t],e,i,s,r,n):this.addRowAttributeDetail(this._list.getItemAt(t),e,i,s,r,n)},na.prototype.addRowAttributeExtend=function(t,e){if(!t)return!1;this.rowAttributes||(this.rowAttributes={});var i,s=new xc;for(i in e)switch(i){case"rowHeight":s.rowHeight=parseInt(e[i]);break;default:s[i]=e[i]}return this.rowAttributes[this._itemToUID(t)]=s,this._internalDispatchEvent("replace",t),!0},na.prototype.addRowAttributeExtendAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttributeExtend(this._localIndex[t],e):this.addRowAttributeExtend(this._list.getItemAt(t),e)},na.prototype.removeRowAttribute=function(t){var e=this._itemToUID(t);return!(!this.rowAttributes||!this.rowAttributes[e])&&(delete this.rowAttributes[e],this._internalDispatchEvent("replace",t),!0)},na.prototype.removeRowAttributeAt=function(t){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.removeRowAttribute(this._localIndex[t]):this.removeRowAttribute(this._list.getItemAt(t))},na.prototype.removeAllAttribute=function(){return this.cellAttributes={},this.rowAttributes={},this._internalDispatchEvent("update"),!0},na.prototype.setItemAt=function(t,e){var i,s=na._super.setItemAt.call(this,t,e);if(s&&(this.removeRowAttribute(s),this._spanColumns))for(i=0;i<this._spanColumns.length;i++)this._removeCellAttributeInternal(s,this._spanColumns[i].colNum,e);return this._spanColumns&&(this.rowAttributes||(this.rowAttributes={}),this.cellAttributes||(this.cellAttributes={}),this._setAttribute(e,t)),s},na.prototype.addItemAt=function(t,e){na._super.addItemAt.call(this,t,e),this._spanColumns&&(this.rowAttributes||(this.rowAttributes={}),this._cellAttributes||(this._cellAttributes={}),this._setAttribute(e,t))},na.prototype.addAll=function(t){na._super.addAll.call(this,t),this.extractAttributes(null,!1)},na.prototype.removeItemAt=function(t){var e=t;if(this._localIndex&&(e=this._list.getItemIndex(this._localIndex[t])),this.removeRowAttributeAt(e),this._spanColumns){var i,s=this._list.getItemAt(e);for(i=0;i<this._spanColumns.length;i++){var r=this.getCellAttribute(s,this._spanColumns[i].colNum),n=null;r&&1<r.rowSpan&&2==r._type&&0<r._rowGap&&r.colNo==this._spanColumns[i].colNum&&(n=this.getCellAttribute(r._oItem,this._spanColumns[i].colNum)),this._removeCellAttributeInternal(s,this._spanColumns[i].colNum,e),n&&(n.rowSpan--,this._registCellAttribute(r._oItem,this._spanColumns[i].colNum,n))}}return na._super.removeItemAt.call(this,t)},na.prototype.removeAll=function(){na._super.removeAll.call(this),this.removeAllAttribute()},na.prototype._gridIndexChangedHandler=function(t){this.extractAttributes()};var ib=function(t,e,i,s,r,n,o){this.colNo=0<arguments.length?t:NaN,this.rowSpan=1<arguments.length?e:1,this.colSpan=2<arguments.length?i:1,this.styleName=3<arguments.length?s:null,this.backgroundColor=4<arguments.length?r:null,this.formatString=5<arguments.length?n:null,this.editable=!(6<arguments.length)||o,this._type=1,this._oItem=void 0,this._rowGap=0};ib.prototype.clone=function(){return new ib(this.colNo,this.rowSpan,this.colSpan,this.styleName,this.backgroundColor,this.formatString,this.editable)};var ea=function(t){la.call(this),this._sourceIsXML=!1,this._cellAttributeFieldSuffix="_attr",this._rowAttributeField="_rattr",this.extractable=this.dispatchEventEnabled=this.autoResetRowSpan=!0,arguments.length?this.setSource(t):this.setSource(null)};ea._defaultProperty="source",z(ea,la),ea.prototype.getCellAttributeFieldSuffix=function(){return this._cellAttributeFieldSuffix},ea.prototype.setCellAttributeFieldSuffix=function(t){this._cellAttributeFieldSuffix=t,this.cellAttributes&&(this.cellAttributes={},this.extractAttributes())},ea.prototype.getGrid=function(){return this._grid},ea.prototype.setGrid=function(t){this._grid!=t?(this._grid&&this._grid.removeEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this),this._grid=t,this._grid.addEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this,!1,0),this._spanColumns=this._grid._spanColumns,this.extractAttributes()):this._spanColumns!=this._grid._spanColumns&&(this._spanColumns=this._grid._spanColumns,this.extractAttributes())},ea.prototype.getRowAttributeField=function(){return this._rowAttributeField},ea.prototype.setRowAttributeField=function(t){this._rowAttributeField=t,this.rowAttributes&&(this.rowAttributes={},this.extractAttributes())},ea.prototype.getSource=function(){return this._list&&(this._list instanceof Gb||this._list instanceof yb)?this._list.getSource():null},ea.prototype.setSource=function(t){ha(t)?(this.setList(new Gb(t)),this._sourceIsXML=!1):E(t)&&(this.setList(new yb(t)),this._sourceIsXML=!0),this.cellAttributes={},this.rowAttributes={},this._notRegistedCellAttributes=null,this.extractAttributes()},ea.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},ea.prototype._setRowAttributeXML=function(t,e){if(e&&!(0>=e.attributes.length)){var i,s=new xc,r=e.attributes;for(i=0;i<r.length;i++)switch(r[i].name){case"styleName":s.styleName=r[i].value;break;case"backgroundColor":s.backgroundColor=r[i].value;break;case"formatString":s.formatString=r[i].value;break;case"editable":s.editable="true"==r[i].value;break;case"rowHeight":s.rowHeight=r[i].value;break;case"rm_internal_uid":break;default:s[r[i].name]=r[i].value}i=this._itemToUID(e),this.rowAttributes[i]&&delete this.rowAttributes[i],this.rowAttributes[i]=s}},ea.prototype._setRowAttributeObject=function(t,e){if(e&&e[this._rowAttributeField]){var i,s=new xc,r=e[this._rowAttributeField];for(i in r)switch(i){case"styleName":s.styleName=r[i];break;case"backgroundColor":s.backgroundColor=r[i];break;case"formatString":s.formatString=r[i];break;case"editable":s.editable=r[i];break;case"rowHeight":s.rowHeight=r[i];break;default:s[i]=r[i]}r=this._itemToUID(e),this.rowAttributes[r]&&delete this.rowAttributes[r],this.rowAttributes[r]=s}},ea.prototype._findItemRowNo=function(t){return this._localIndex?Ra.indexOf(this._localIndex,t):this._list?this._list.getItemIndex(t):-1},ea.prototype._addRowAttributeToItem=function(t,e){if(E(t))e.styleName&&t.setAttribute("styleName",e.styleName),e.backgroundColor&&t.setAttribute("backgroundColor",e.backgroundColor),e.formatString&&t.setAttribute("formatString",e.formatString),
t.setAttribute("editable",e.editable),Xa(e.rowHeight)&&t.setAttribute("rowHeight",e.rowHeight);else{var i=t[this._rowAttributeField]?t[this._rowAttributeField]:{};e.styleName&&(i.styleName=e.styleName),e.backgroundColor&&(i.backgroundColor=e.backgroundColor),e.formatString&&(i.formatString=e.formatString),i.editable=e.editable,O(e.rowHeight)||(i.rowHeight=e.rowHeight),t[this._rowAttributeField]=i}},ea.prototype._removeRowAttributeFromItem=function(t,e){E(t)?(t.removeAttribute("styleName"),t.removeAttribute("backgroundColor"),t.removeAttribute("formatString"),t.removeAttribute("editable"),t.removeAttribute("rowHeight")):delete t[this._rowAttributeField]},ea.prototype._addCellAttributeToItem=function(t,e,i){if(t&&this._spanColumns&&!(e>=this._spanColumns.length))if(e=this._spanColumns[e].getDataField(),E(t))(t=G.getFirstElementChild(t,e))&&(t.setAttribute("rowSpan",i.rowSpan),t.setAttribute("colSpan",i.colSpan),i.styleName&&t.setAttribute("styleName",i.styleName),i.backgroundColor&&t.setAttribute("backgroundColor",i.backgroundColor),i.formatString&&t.setAttribute("formatString",i.formatString));else{e+=this._cellAttributeFieldSuffix;var s=t[e]?t[e]:{};s.rowSpan=i.rowSpan,s.colSpan=i.colSpan,s.styleName=i.styleName,s.backgroundColor=i.backgroundColor,s.formatString=i.formatString,t[e]=s}},ea.prototype._removeCellAttributeFromItem=function(t,e){if(t&&this._spanColumns&&!(e>=this._spanColumns.length)){var i=this._spanColumns[e].getDataField();try{if(E(t)){var s=G.getFirstElementChild(t,i);s&&(s.removeAttribute("rowSpan"),s.removeAttribute("colSpan"),s.removeAttribute("styleName"),s.removeAttribute("backgroundColor"),s.removeAttribute("formatString"))}else delete t[i+this._cellAttributeFieldSuffix]}catch(r){}}},ea.prototype._registCellAttribute=function(t,e,i){var s=this._itemToUID(t);if(i._type=1,1==i.rowSpan&&1==i.colSpan)this.cellAttributes[s+","+e]=i;else{var r,n=this._findItemRowNo(t);if(!(0>n))for(t=n;t<n+i.rowSpan;t++)for(r=e;r<e+i.colSpan;r++)if(t==n&&r==e)this.cellAttributes[s+","+e]=i;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=i._oItem,o._rowGap=t-n,o.rowSpan=i.rowSpan,o.colSpan=i.colSpan,o.styleName=i.styleName,o.backgroundColor=i.backgroundColor,o.formatString=i.formatString,o.editable=i.editable,this._localIndex?t<this._localIndex.length?this.cellAttributes[this._itemToUID(this._localIndex[t])+","+r]=o:(this._notRegistedCellAttributes||(this._notRegistedCellAttributes=[]),this._notRegistedCellAttributes.push({rno:t,cno:r,ca:o})):t<this._list.getLength()?this.cellAttributes[this._itemToUID(this._list.getItemAt(t))+","+r]=o:(this._notRegistedCellAttributes||(this._notRegistedCellAttributes=[]),this._notRegistedCellAttributes.push({rno:t,cno:r,ca:o}))}}},ea.prototype._registCellAttributeAt=function(t,e,i,s){var r,n;if(s._type=1,1==s.rowSpan&&1==s.colSpan)this.cellAttributes[i+","+e]=s;else for(r=t;r<t+s.rowSpan;r++)for(n=e;n<e+s.colSpan;n++)if(r==t&&n==e)this.cellAttributes[i+","+e]=s;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=s._oItem,o._rowGap=r-t,o.rowSpan=s.rowSpan,o.colSpan=s.colSpan,o.styleName=s.styleName,o.backgroundColor=s.backgroundColor,o.formatString=s.formatString,o.editable=s.editable,this._localIndex?r<this._localIndex.length?this.cellAttributes[this._itemToUID(this._localIndex[r])+","+n]=o:(this._notRegistedCellAttributes||(this._notRegistedCellAttributes=[]),this._notRegistedCellAttributes.push({rno:r,cno:n,ca:o})):r<this._list.getLength()?this.cellAttributes[this._itemToUID(this._list.getItemAt(r))+","+n]=o:(this._notRegistedCellAttributes||(this._notRegistedCellAttributes=[]),this._notRegistedCellAttributes.push({rno:r,cno:n,ca:o}))}},ea.prototype._setCellAttributeXML=function(t,e,i,s,r){var n;if(r){if((n=G.getElement(r,i))&&n.attributes&&0>=n.attributes.length)return;n=r}else{if((n=G.getElement(s,i))&&n.attributes&&0>=n.attributes.length)return;n=s}r=this._itemToUID(s),this.cellAttributes[r+","+e]&&delete this.cellAttributes[r+","+e];var o=new ib;if((n=G.getElement(n,i))&&(n=n.attributes))for(i=0;i<n.length;i++)switch(n[i].name){case"rowSpan":o.rowSpan=parseInt(n[i].value);break;case"colSpan":o.colSpan=parseInt(n[i].value);break;case"styleName":o.styleName=n[i].value;break;case"backgroundColor":o.backgroundColor=n[i].value;break;case"formatString":o.formatString=n[i].value;break;case"editable":o.editable="true"==n[i].value;break;default:o.setAttribute(n[i].name,n[i].value)}o.colNo=e,o._oItem=s,this._registCellAttributeAt(t,e,r,o)},ea.prototype._setCellAttributeObject=function(t,e,i,s,r){var n;if(r){if(!r[i+this._cellAttributeFieldSuffix])return;n=r}else{if(!s[i+this._cellAttributeFieldSuffix])return;n=s}r=this._itemToUID(s),this.cellAttributes[r+","+e]&&delete this.cellAttributes[r+","+e];var o=new ib;i=n[i+this._cellAttributeFieldSuffix];for(var a in i)switch(a){case"rowSpan":o.rowSpan=i[a];break;case"colSpan":o.colSpan=i[a];break;case"styleName":o.styleName=i[a];break;case"backgroundColor":o.backgroundColor=i[a];break;case"formatString":o.formatString=i[a];break;case"editable":o.editable=i[a];break;default:o[a]=i[a]}o.colNo=e,o._oItem=s,this._registCellAttributeAt(t,e,r,o)},ea.prototype._setAttribute=function(t,e){if(this._spanColumns){this._sourceIsXML?this._setRowAttributeXML(t,e):this._setRowAttributeObject(t,e);var i,s,r,n=this._spanColumns.length;for(i=0;i<n;i++)s=this._spanColumns[i],s.getDataField()&&(r=this._grid._getHeaderInfo(s),null!=r.internalLabelFunction?(r=r.internalLabelFunction(e,s))&&(this._sourceIsXML?this._setCellAttributeXML(t,s.colNum,s.getDataField(),e,r):this._setCellAttributeObject(t,s.colNum,s.getDataField(),e,r)):e&&(this._sourceIsXML?this._setCellAttributeXML(t,s.colNum,s.getDataField(),e):this._setCellAttributeObject(t,s.colNum,s.getDataField(),e)))}},ea.prototype._internalDispatchEvent=function(t,e,i){if(i=2<arguments.length?i:-1,this.dispatchEventEnabled&&this.hasEventListener(y.COLLECTION_CHANGE)){var s=new y(y.COLLECTION_CHANGE);s.kind=t,e&&s.items.push(e),s.location=i,this.dispatchEvent(s)}},ea.prototype.extractAttributes=function(t,e){e=!(1<arguments.length)||e;var i,s;if(t)this._grid=t;else if(!this._grid)return;if(this._grid._spanColumns&&0<this._grid._spanColumns.length){if(this._spanColumns=this._grid._spanColumns,this.extractable&&(this.cellAttributes||(this.cellAttributes={}),this.rowAttributes||(this.rowAttributes={}),this._list)){if(this._localIndex)for(s=this._localIndex.length,i=0;i<s;i++)this._setAttribute(i,this._localIndex[i]);else for(s=this._list.getLength(),i=0;i<s;i++)this._setAttribute(i,this._list.getItemAt(i));e&&this._internalDispatchEvent("reset")}}else this._spanColumns=[]},ea.prototype.getCellAttribute=function(t,e){if(!t||!this.cellAttributes)return null;var i=this.cellAttributes[this._itemToUID(t)+","+e];if(i&&this._localIndex&&this.autoResetRowSpan&&1<i.rowSpan){if(2==i._type&&0<i._rowGap)return null;var s,r=new ib;for(s in i)r[s]=i[s];return r.rowSpan=1,r}return i},ea.prototype.getCellAttributeAt=function(t,e){if(0>t||t>=this._list.getLength()||!this.cellAttributes)return null;if(this._localIndex){if(t>=this._localIndex.length)return null}else if(t>=this._list.getLength())return null;return this._localIndex?this.getCellAttribute(this._localIndex[t],e):this.getCellAttribute(this._list.getItemAt(t),e)},ea.prototype.getRowAttribute=function(t){return t&&this.rowAttributes?this.rowAttributes[this._itemToUID(t)]:null},ea.prototype.getRowAttributeAt=function(t){if(0>t||!this.rowAttributes)return null;if(this._localIndex){if(t>=this._localIndex.length)return null}else if(t>=this._list.getLength())return null;return this._localIndex?this.getRowAttribute(this._localIndex[t]):this.getRowAttribute(this._list.getItemAt(t))},ea.prototype.getRowAttributeUID=function(t){return t&&this.rowAttributes?this.rowAttributes[t]:null},ea.prototype.addCellAttribute=function(t,e){return!!t&&(this.cellAttributes||(this.cellAttributes={}),e._oItem=t,this._registCellAttribute(t,e.colNo,e),this._addCellAttributeToItem(t,e.colNo,e),this._internalDispatchEvent("replace",t),!0)},ea.prototype.addCellAttributeAt=function(t,e){if(0>t||!this.cellAttributes)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttribute(this._localIndex[t],e):this.addCellAttribute(this._list.getItemAt(t),e)},ea.prototype.addCellAttributeDetail=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,!t)return!1;this.cellAttributes||(this.cellAttributes={});var l=new ib;return l.colNo=e,l._type=1,l._oItem=t,l.rowSpan=i,l.colSpan=s,l.styleName=r,l.backgroundColor=n,l.formatString=o,l.editable=a,this._registCellAttribute(t,e,l),this._addCellAttributeToItem(t,l.colNo,l),this._internalDispatchEvent("replace",t),!0},ea.prototype.addCellAttributeDetailAt=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttributeDetail(this._localIndex[t],e,i,s,r,n,o,a):this.addCellAttributeDetail(this._list.getItemAt(t),e,i,s,r,n,o,a)},ea.prototype.addCellAttributeExtend=function(t,e,i,s,r){if(!t)return!1;this.cellAttributes||(this.cellAttributes={}),i=new ib;for(var n in r)switch(n){case"backgroundColor":i.backgroundColor=r[n];break;default:i[n]=r[n]}return i.colNo=e,i._oItem=t,this._registCellAttribute(t,e,i),this._addCellAttributeToItem(t,i.colNo,i),this._internalDispatchEvent("replace",t),!0},ea.prototype.addCellAttributeExtendAt=function(t,e,i,s,r){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttributeExtend(this._localIndex[t],e,i,s,r):this.addCellAttributeExtend(this._list.getItemAt(t),e,i,s,r)},ea.prototype._removeCellAttributeInternal=function(t,e,i){if(i=2<arguments.length?i:-1,!this.cellAttributes)return!1;var s=this._itemToUID(t),r=this.getCellAttribute(t,e);if(!r)return!1;if(1==r._type&&(1<r.rowSpan||1<r.colSpan))if(1<r.rowSpan){var n=i;0>n&&(n=this._findItemRowNo(t));for(var o=n;o<n+r.rowSpan;o++){try{s=this._localIndex?this._itemToUID(this._localIndex[o]):this._itemToUID(this._list.getItemAt(o))}catch(a){continue}for(var l=e;l<e+r.colSpan;l++)this.cellAttributes[s+","+l]&&delete this.cellAttributes[s+","+l]}}else for(l=e;l<e+r.colSpan;l++)this.cellAttributes[s+","+l]&&delete this.cellAttributes[s+","+l];else{if(!this.cellAttributes[s+","+e])return!1;delete this.cellAttributes[s+","+e]}return this._removeCellAttributeFromItem(t,e),this._internalDispatchEvent("replace",t),!0},ea.prototype.removeCellAttribute=function(t,e){return this._removeCellAttributeInternal(t,e)},ea.prototype.removeCellAttributeAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this._removeCellAttributeInternal(this._localIndex[t],e,t):this._removeCellAttributeInternal(this._list.getItemAt(t),e,t)},ea.prototype.addRowAttribute=function(t,e){return!!t&&(this.rowAttributes||(this.rowAttributes={}),this.rowAttributes[this._itemToUID(t)]=e,this._addRowAttributeToItem(t,e),this._internalDispatchEvent("replace",t),!0)},ea.prototype.addRowAttributeAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttribute(this._localIndex[t],e):this.addRowAttribute(this._list.getItemAt(t),e)},ea.prototype.addRowAttributeDetail=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,!t)return!1;this.rowAttributes||(this.rowAttributes={});var o=new xc;return o.styleName=e,o.backgroundColor=i,o.formatString=s,o.editable=r,o.rowHeight=n,this.rowAttributes[this._itemToUID(t)]=o,this._addRowAttributeToItem(t,o),this._internalDispatchEvent("replace",t),!0},ea.prototype.addRowAttributeDetailAt=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttributeDetail(this._localIndex[t],e,i,s,r,n):this.addRowAttributeDetail(this._list.getItemAt(t),e,i,s,r,n)},ea.prototype.addRowAttributeExtend=function(t,e){if(!t)return!1;this.rowAttributes||(this.rowAttributes={});var i,s=new xc;for(i in e)switch(i){case"backgroundColor":s.backgroundColor=e[i];break;default:s[i]=e[i]}return this.rowAttributes[this._itemToUID(t)]=s,this._addRowAttributeToItem(t,s),this._internalDispatchEvent("replace",t),!0},ea.prototype.addRowAttributeExtendAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttributeExtend(this._localIndex[t],e):this.addRowAttributeExtend(this._list.getItemAt(t),e)},ea.prototype.removeRowAttribute=function(t){var e=this._itemToUID(t);return!(!this.rowAttributes||!this.rowAttributes[e])&&(delete this.rowAttributes[e],this._removeRowAttributeFromItem(t),this._internalDispatchEvent("replace",t),!0)},ea.prototype.removeRowAttributeAt=function(t){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.removeRowAttribute(this._localIndex[t]):this.removeRowAttribute(this._list.getItemAt(t))},ea.prototype.removeAllAttribute=function(){return this.cellAttributes={},this.rowAttributes={},this._internalDispatchEvent("update"),!0},ea.prototype.setItemAt=function(t,e){var i,s=ea._super.setItemAt.call(this,t,e);if(s&&(this.removeRowAttribute(s),this._spanColumns))for(i=0;i<this._spanColumns.length;i++)this._removeCellAttributeInternal(s,this._spanColumns[i].colNum,e);return this._spanColumns&&(this.rowAttributes||(this.rowAttributes={}),this.cellAttributes||(this.cellAttributes={}),this._setAttribute(e,this._sourceIsXML?this.getItemAt(e):t)),s},ea.prototype.addItemAt=function(t,e){ea._super.addItemAt.call(this,t,e),this._spanColumns&&(this.rowAttributes||(this.rowAttributes={}),this.cellAttributes||(this.cellAttributes={}),this._setAttribute(e,this._sourceIsXML?this.getItemAt(e):t))},ea.prototype.addAll=function(t){ea._super.addAll.call(this,t),this.extractAttributes(null,!1)},ea.prototype.removeItemAt=function(t){var e=t;if(this._localIndex&&(e=this._list.getItemIndex(this._localIndex[t])),this.removeRowAttributeAt(e),this._spanColumns){var i,s=this._list.getItemAt(e);for(i=0;i<this._spanColumns.length;i++){var r=this.getCellAttribute(s,this._spanColumns[i].colNum),n=null;r&&1<r.rowSpan&&2==r._type&&0<r._rowGap&&r.colNo==this._spanColumns[i].colNum&&(n=this.getCellAttribute(r._oItem,this._spanColumns[i].colNum)),this._removeCellAttributeInternal(s,this._spanColumns[i].colNum,e),n&&(n.rowSpan--,this._registCellAttribute(r._oItem,this._spanColumns[i].colNum,n))}}return ea._super.removeItemAt.call(this,t)},ea.prototype.removeAll=function(){ea._super.removeAll.call(this),this.removeAllAttribute()},ea.prototype.getProperty=function(t,e){return null==t?null:E(t)?G.getProperty(t,e):t[e]},ea.prototype.setProperty=function(t,e,i){if(null!=t)if(E(t))if(-1!=e.indexOf("@"))t.setAttribute(e.split("@")[1],i);else{var s=t.getElementsByTagName(e);s&&0<s.length?I(s[0].textContent)?s[0].text=i:s[0].textContent=i:(e=9===t.nodeType?t.createElement(e):t.ownerDocument.createElement(e),I(e.textContent)?e.text=i:e.textContent=i,t.appendChild(e))}else t[e]=i},ea.prototype.getPropertyAt=function(t,e){var i=this.getItemAt(t);return null==i?null:E(i)?G.getProperty(i,e):i[e]},ea.prototype.setPropertyAt=function(t,e,i){if(t=this.getItemAt(t),null!=t)if(E(t))if(-1!=e.indexOf("@"))t.setAttribute(e.split("@")[1],i);else{var s=t.getElementsByTagName(e);s&&0<s.length?I(s[0].textContent)?s[0].text=i:s[0].textContent=i:(e=9===t.nodeType?t.createElement(e):t.ownerDocument.createElement(e),I(e.textContent)?e.text=i:e.textContent=i,t.appendChild(e))}else t[e]=i},ea.prototype._gridIndexChangedHandler=function(t){this.extractAttributes()};var ga=function(t,e){T.apply(this,arguments),this._sourceIsXML=!1,this._cellAttributeFieldSuffix="_attr",this._rowAttributeField="_rattr",this.autoResetRowSpan=null,this.extractable=this.dispatchEventEnabled=!0};z(ga,T),ga.prototype.getCellAttributeFieldSuffix=function(){return this._cellAttributeFieldSuffix},ga.prototype.setCellAttributeFieldSuffix=function(t){this._cellAttributeFieldSuffix=t,this.getCellAttributes()&&(this.setCellAttributes({}),this.extractAttributes())},ga.prototype.getCellAttributes=function(){return this.getSource().hasOwnProperty("cellAttributes")?this.getSource().cellAttributes:null},ga.prototype.setCellAttributes=function(t){this.getSource().hasOwnProperty("cellAttributes")&&(this.getSource().cellAttributes=t)},ga.prototype.getGrid=function(){return this._grid},ga.prototype.setGrid=function(t){this._grid!=t?(this._grid&&this._grid.removeEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this),this._grid=t,this._grid.addEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this,!1,0),this._spanColumns=this._grid._spanColumns,this.extractAttributes()):this._spanColumns!=this._grid._spanColumns&&(this._spanColumns=this._grid._spanColumns,this.extractAttributes())},ga.prototype.getRowAttributeField=function(){return this._rowAttributeField},ga.prototype.setRowAttributeField=function(t){this._rowAttributeField=t,this.getRowAttributes()&&(this.setRowAttributes({}),this.extractAttributes())},ga.prototype.getRowAttributes=function(){return this.getSource().hasOwnProperty("rowAttributes")?this.getSource().rowAttributes:null},ga.prototype.setRowAttributes=function(t){this.getSource().hasOwnProperty("rowAttributes")&&(this.getSource().rowAttributes=t)},ga.prototype.setSource=function(t){ga._super.setSource.call(this,t),(t=this.getSource())&&(t=t.getSource()),t instanceof Hb||Uc(t)||E(t)?this._sourceIsXML=!0:this._sourceIsXML=!1,this.setCellAttributes({}),this.setRowAttributes({}),this.extractAttributes()},ga.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},ga.prototype._setRowAttributeXML=function(t,e){if(e&&e.attributes&&!(0>=e.attributes.length)){for(var i=new xc,s=e.attributes,r=0,n=0;n<s.length;n++)switch(s[n].name){case"styleName":i.styleName=s[n].value,r++;break;case"backgroundColor":i.backgroundColor=s[n].value,r++;break;case"formatString":i.formatString=s[n].value,r++;break;case"editable":i.editable="true"==s[n].value,r++;break;case"rowHeight":i.rowHeight=s[n].value,r++}0!=r&&(s=this._itemToUID(e),this.getRowAttributes()[s]&&delete this.getRowAttributes()[s],this.getRowAttributes()[s]=i)}},ga.prototype._setRowAttributeObject=function(t,e){if(e&&e[this._rowAttributeField]){var i,s=new xc,r=e[this._rowAttributeField];for(i in r)switch(i){case"styleName":s.styleName=r[i];break;case"backgroundColor":s.backgroundColor=r[i];break;case"formatString":s.formatString=r[i];break;case"editable":s.editable=r[i];break;case"rowHeight":s.rowHeight=r[i];break;default:s[i]=r[i]}r=this._itemToUID(e),this.getRowAttributes()[r]&&delete this.getRowAttributes()[r],this.getRowAttributes()[r]=s}},ga.prototype._findItemRowNo=function(t){return Ra.indexOf(this._currentData,t)},ga.prototype._registCellAttribute=function(t,e,i){var s=this._itemToUID(t);if(i._type=1,1==i.rowSpan&&1==i.colSpan)this.getCellAttributes()[s+","+e]=i;else if(t=this._findItemRowNo(t),!(0>t))for(var r=t;r<t+i.rowSpan;r++)for(var n=e;n<e+i.colSpan;n++)if(r==t&&n==e)this.getCellAttributes()[s+","+e]=i;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=i._oItem,o._rowGap=r-t,o.rowSpan=i.rowSpan,o.colSpan=i.colSpan,o.styleName=i.styleName,o.backgroundColor=i.backgroundColor,o.formatString=i.formatString,o.editable=i.editable,r<this._currentData.length&&(this.getCellAttributes()[this._itemToUID(this._currentData[r])+","+n]=o)}},ga.prototype._registCellAttributeAt=function(t,e,i,s){if(s._type=1,1==s.rowSpan&&1==s.colSpan)this.getCellAttributes()[i+","+e]=s;else for(var r=t;r<t+s.rowSpan;r++)for(var n=e;n<e+s.colSpan;n++)if(r==t&&n==e)this.getCellAttributes()[i+","+e]=s;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=s._oItem,o._rowGap=r-t,o.rowSpan=s.rowSpan,o.colSpan=s.colSpan,o.styleName=s.styleName,o.backgroundColor=s.backgroundColor,o.formatString=s.formatString,o.editable=s.editable,r<this._currentData.length&&(this.getCellAttributes()[this._itemToUID(this._currentData[r])+","+n]=o)}},ga.prototype._setCellAttributeXML=function(t,e,i,s,r){if((t=r?G.getElement(r,i):G.getElement(s,i))&&t.attributes&&!(0>=t.attributes.length)&&(s=this._itemToUID(s),this.getCellAttributes()[s+","+e]&&delete this.getCellAttributes()[s+","+e],e=new ib,s=t.attributes))for(t=0;t<s.length;t++)switch(s[t].name){case"rowSpan":e.rowSpan=parseInt(s[t].value);break;case"colSpan":e.colSpan=parseInt(s[t].value);break;case"styleName":e.styleName=s[t].value;break;case"backgroundColor":e.backgroundColor=s[t].value;break;case"formatString":e.formatString=s[t].value;break;case"editable":e.editable="true"==s[t].value;break;default:e.setAttribute(s[t].name,s[t].value)}},ga.prototype._setCellAttributeObject=function(t,e,i,s,r){var n;if(r){if(!r[i+this._cellAttributeFieldSuffix])return;n=r}else{if(!s[i+this._cellAttributeFieldSuffix])return;n=s}r=this._itemToUID(s),this.getCellAttributes()[r+","+e]&&delete this.getCellAttributes()[r+","+e];var o=new ib;i=n[i+this._cellAttributeFieldSuffix];for(var a in i)switch(a){case"rowSpan":o.rowSpan=i[a];break;case"colSpan":o.colSpan=i[a];break;case"styleName":o.styleName=i[a];break;case"backgroundColor":o.backgroundColor=i[a];break;case"formatString":o.formatString=i[a];break;case"editable":o.editable=i[a];break;default:o[a]=i[a]}o.colNo=e,o._oItem=s,this._registCellAttributeAt(t,e,r,o)},ga.prototype._setAttribute=function(t,e){var i=this._spanColumns.length;this._sourceIsXML?this._setRowAttributeXML(t,e):this._setRowAttributeObject(t,e);for(var s=0;s<i;s++){var r=this._spanColumns[s];if(r.getDataField()){var n=this._grid._getHeaderInfo(r);null!=n.internalLabelFunction?(n=n.internalLabelFunction(e,r))&&(this._sourceIsXML?this._setCellAttributeXML(t,r.colNum,r.getDataField(),e,n):this._setCellAttributeObject(t,r.colNum,r.getDataField(),e,n)):e&&(this._sourceIsXML?this._setCellAttributeXML(t,r.colNum,r.getDataField(),e):this._setCellAttributeObject(t,r.colNum,r.getDataField(),e))}}},ga.prototype._getRowData=function(t){return this._currentData[t]},ga.prototype._internalDispatchEvent=function(t,e,i){if(i=2<arguments.length?i:-1,this.dispatchEventEnabled&&this.hasEventListener(y.COLLECTION_CHANGE)){var s=new y(y.COLLECTION_CHANGE);s.kind=t,s.items.push(e),s.location=i,this.dispatchEvent(s)}},ga.prototype.extractAttributes=function(e,i){if(i=!(1<arguments.length)||i,this.getSource().hasOwnProperty("cellAttributes")){if(e)this._grid=e;else if(!this._grid)return;if(this._grid._spanColumns&&0<this._grid._spanColumns.length){if(this._spanColumns=this._grid._spanColumns,this.extractable&&(this.getCellAttributes()||this.setCellAttributes({}),this.getRowAttributes()||this.setRowAttributes({}),this.getSource())){this._currentData=[];for(var s=this.createCursor(),r=0;!s.getAfterLast();){this._currentData[r]=s.getCurrent();try{s.moveNext()}catch(n){return}r++}for(s.seek(t.getFIRST()),r=0;!s.getAfterLast();){this._setAttribute(r,s.getCurrent());try{s.moveNext()}catch(n){return}r++}i&&this._internalDispatchEvent("reset")}}else this._spanColumns=[]}},ga.prototype.getCellAttribute=function(t,e){if(!t||!this.getCellAttributes())return null;var i=this.getCellAttributes()[this._itemToUID(t)+","+e];if(i&&(this.filterFunction||this._sort)&&this.autoResetRowSpan&&1<i.rowSpan){if(2==i._type&&0<i._rowGap)return null;var s,r=new ib;for(s in i)r[s]=i[s];return r.rowSpan=1,r}return i},ga.prototype.getCellAttributeAt=function(t,e){return 0>t||t>=this.getLength()||!this.getCellAttributes()?null:this.getCellAttribute(this._getRowData(t),e)},ga.prototype.getRowAttribute=function(t){return t&&this.getRowAttributes()?this.getRowAttributes()[this._itemToUID(t)]:null},ga.prototype.getRowAttributeAt=function(t){return 0>t||t>=this.getLength()||!this.getRowAttributes()?null:this.getRowAttribute(this._getRowData(t))},ga.prototype.getRowAttributeUID=function(t){return t&&this.getRowAttributes()?this.getRowAttributes()[t]:null},ga.prototype.addCellAttribute=function(t,e){return!!t&&(this.getCellAttributes()||this.setCellAttributes({}),e._oItem=t,this._registCellAttribute(t,e.colNo,e),this._internalDispatchEvent("replace",t),!0)},ga.prototype.addCellAttributeAt=function(t,e){return!(0>t||t>=this.getLength())&&(this.getCellAttributes()||this.setCellAttributes({}),e._oItem=this._getRowData(t),this._registCellAttributeAt(t,e.colNo,this._itemToUID(e._oItem),e),this._internalDispatchEvent("replace",e._oItem,t),!0)},ga.prototype.addCellAttributeDetail=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,!t)return!1;this.getCellAttributes()||this.setCellAttributes({});var l=new ib;return l.colNo=e,l._type=1,l._oItem=t,l.rowSpan=i,l.colSpan=s,l.styleName=r,l.backgroundColor=n,l.formatString=o,l.editable=a,this._registCellAttribute(t,e,l),this._internalDispatchEvent("replace",t),!0},ga.prototype.addCellAttributeDetailAt=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,0>t||t>=this.getLength())return!1;this.getCellAttributes()||this.setCellAttributes({});var l=new ib;return l.colNo=e,l._type=1,l._oItem=this._getRowData(t),l.rowSpan=i,l.colSpan=s,l.styleName=r,l.backgroundColor=n,l.formatString=o,l.editable=a,this._registCellAttributeAt(t,e,this._itemToUID(l._oItem),l),this._internalDispatchEvent("replace",l._oItem,t),!0},ga.prototype.addCellAttributeExtend=function(t,e,i,s,r){if(!t)return!1;this.getCellAttributes()||this.setCellAttributes({}),i=new ib;for(var n in r)switch(n){case"backgroundColor":i.backgroundColor=r[n];break;default:i[n]=r[n]}return i.colNo=e,i._oItem=t,this._registCellAttribute(t,e,i),this._internalDispatchEvent("replace",t),!0},ga.prototype.addCellAttributeExtendAt=function(t,e,i,s,r){if(0>t||t>=this.getLength())return!1;this.getCellAttributes()||this.setCellAttributes({}),i=new ib;for(var n in r)switch(n){case"backgroundColor":i.backgroundColor=r[n];break;default:i[n]=r[n]}return i.colNo=e,i._oItem=this._getRowData(t),this._registCellAttributeAt(t,e,this._itemToUID(i._oItem),i),this._internalDispatchEvent("replace",i._oItem,t),!0},ga.prototype._removeCellAttributeInternal=function(t,e,i){if(i=2<arguments.length?i:-1,!this.getCellAttributes())return!1;var s=this._itemToUID(t),r=this.getCellAttribute(t,e);if(!r)return!1;var n=this.getCellAttributes();if(1<r.rowSpan||1<r.colSpan)if(1<r.rowSpan){var o=i;0>o&&(o=this._findItemRowNo(t));for(var a=o;a<o+r.rowSpan;a++)for(var s=this._itemToUID(this._getRowData(a)),l=e;l<e+r.colSpan;l++)n[s+","+l]&&delete n[s+","+l]}else for(l=e;l<e+r.colSpan;l++)n[s+","+l]&&delete n[s+","+l];else{if(!n[s+","+e])return!1;delete n[s+","+e]}return this._internalDispatchEvent("replace",t),!0},ga.prototype.removeCellAttribute=function(t,e){return this._removeCellAttributeInternal(t,e)},ga.prototype.removeCellAttributeAt=function(t,e){return!(0>t||t>=this.getLength())&&this._removeCellAttributeInternal(this._getRowData(t),e,t)},ga.prototype.addRowAttribute=function(t,e){return!!t&&(this.getRowAttributes()||this.setRowAttributes({}),this.getRowAttributes()[this._itemToUID(t)]=e,this._internalDispatchEvent("replace",t),!0)},ga.prototype.addRowAttributeAt=function(t,e){return!(0>t||t>=this.getLength())&&this.addRowAttribute(this._getRowData(t),e)},ga.prototype.addRowAttributeDetail=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,!t)return!1;this.getRowAttributes()||this.setRowAttributes({});var o=this._itemToUID(t),a=new xc;return a.styleName=e,a.backgroundColor=i,a.formatString=s,a.editable=r,a.rowHeight=n,this.getRowAttributes()[o]=a,this._internalDispatchEvent("replace",t),!0},ga.prototype.addRowAttributeDetailAt=function(t,e,i,s,r,n){return r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,!(0>t||t>=this.getLength())&&this.addRowAttributeDetail(this._getRowData(t),e,i,s,r,n)},ga.prototype.addRowAttributeExtend=function(t,e){if(!t)return!1;this.getRowAttributes()||this.setRowAttributes({});var i,s=new xc;for(i in e)switch(i){case"backgroundColor":s.backgroundColor=e[i];break;default:s[i]=e[i]}return this.getRowAttributes()[this._itemToUID(t)]=s,this._internalDispatchEvent("replace",t),!0},ga.prototype.addRowAttributeExtendAt=function(t,e){return!(0>t||t>=this.getLength())&&this.addRowAttributeExtend(this._getRowData(t),e)},ga.prototype.removeRowAttribute=function(t){var e=this._itemToUID(t);return!(!this.getRowAttributes()||!this.getRowAttributes()[e])&&(delete this.getRowAttributes()[e],this._internalDispatchEvent("replace",t),!0)},ga.prototype.removeRowAttributeAt=function(t){return!(0>t||t>=this.getLength())&&this.removeRowAttribute(this._getRowData(t))},ga.prototype.removeAllAttribute=function(){return this.setCellAttributes({}),this.setRowAttributes({}),this._internalDispatchEvent("update"),!0},ga.prototype.setOpenNodes=function(t){ga._super.setOpenNodes.call(this,t),this.extractAttributes(null,!1)},ga.prototype.openNode=function(t){ga._super.openNode.call(this,t),this.extractAttributes(null,!1)},ga.prototype.addChildAt=function(t,e,i){return t=ga._super.addChildAt.call(this,t,e,i),this.extractAttributes(null,!1),t},ga.prototype.removeChildAt=function(t,e){var i=ga._super.removeChildAt.call(this,t,e);return this.extractAttributes(null,!1),i},ga.prototype.removeChild=function(t,e){var i=ga._super.removeChild.call(this,t,e);return this.extractAttributes(null,!1),i},ga.prototype.refresh=function(){var t=ga._super.refresh.call(this);return this.extractAttributes(null,!1),t},ga.prototype._gridIndexChangedHandler=function(t){this.extractAttributes(null,!1)},ga.prototype.collectionChangeHandler=function(t){ga._super.collectionChangeHandler.call(this,t)};var ke=function(t){pb.call(this,t),this.rowAttributes=this.cellAttributes=void 0};z(ke,pb);var ja=function(){ke.call(this),this.async=!1,this.grouping=this.summaries=void 0,this.beforeSorting=!0,this._newCollection=new P,ja._super.setSource.call(this,this._newCollection.getSource()),this._objectSummaryMap={},this._parentMap={},this._prepared=this._dispatchCollectionEvents=!1,this._currentPosition=t.getFIRST(),this._optimizeSummaries=!1};ja._defaultProperty="grouping",ja._propertyType={summaries:Array},z(ja,ke),ja.prototype.getSource=function(){return this._sourceCol},ja.prototype.setSource=function(t){this._sourceCol&&this._sourceCol.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),this.cellAttributes={},this.rowAttributes={},t?(this._sourceCol=this._getCollection(t),this._sourceCol instanceof xb&&this._sourceCol.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this)):this._sourceCol=null},ja.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},ja.prototype.getChildren=function(t){var e,i,s=ja._super.getChildren.call(this,t);if(null!=s){if(!(s instanceof xb))return null;for(i=s.createCursor();!i.getAfterLast();)e=V.getUID(i.getCurrent()),this._parentMap[e]=t,i.moveNext()}return s},ja.prototype.getRoot=function(){return ja._super.getSource.call(this)},ja.prototype.refresh=function(t,e){e=1<arguments.length&&e;var i;return bb(t)&&(this.async=t),this._dispatchCollectionEvents=!!this.async||e,!this.grouping||!this.grouping.fields||1>this.grouping.fields.length?(ja._super.setSource.call(this,this.getSource()),i=new y(y.COLLECTION_CHANGE),i.kind="reset",this.dispatchEvent(i),!0):(ja._super.setSource.call(this,this._newCollection),i=new y(y.COLLECTION_CHANGE),i.kind="reset",this.dispatchEvent(i),this._parentMap={},this._objectSummaryMap={},this._summariesTracker=null,this._summaryPresent=!1,this._prepareSummaryFields(),this.getSource()&&this.grouping?i=this._makeGroupedCollection():(this._initialize(),this._newCollection.removeAll(),i=new y(y.COLLECTION_CHANGE),i.kind="reset",this.dispatchEvent(i),i=!0),i)},ja.prototype.cancelRefresh=function(){
this._timer&&(clearInterval(this._timer),this._timer=null,this._cleanUp())},ja.prototype._addItem=function(t,e){for(var i=ja._super.getSource.call(this),s=null,r=0;r<this.grouping.fields.length;){var n=this._checkForParentExistence(i,t,r);if(!n)break;(s=n)&&(i=this.getChildren(s),r++)}s?(i=this.getChildren(s),r<=this.grouping.fields.length-1?(this._createGroupsAndInsertItem(i,t,r),this._updateSummary(t)):U(i.addItem)&&(i.addItem(t),this._updateParentMap(s,t),this._updateSummary(t))):(this._createGroupsAndInsertItem(ja._super.getSource.call(this),t),this._updateSummary(t))},ja.prototype._checkForParentExistence=function(t,e,i){for(t=t.createCursor(),e=this._getDataLabel(e,this.grouping.fields[i]);!t.getAfterLast();){if(i=t.getCurrent(),i.hasOwnProperty(this.grouping.label)&&i[this.grouping.label]==e)return i;t.moveNext()}return null},ja.prototype._createGroupsAndInsertItem=function(t,e,i){i=2<arguments.length?i:0;var s,r,n=this.grouping.fields.length;for(s=i;s<n;s++){var o,a=this._getDataLabel(e,this.grouping.fields[s]);if(!a)break;if(o=null!=this.grouping.fields[s].groupingObjectFunction?this.grouping.fields[s].groupingObjectFunction(a):null!=this.grouping.groupingObjectFunction?this.grouping.groupingObjectFunction(a):{},o[this.childrenField]=new P,o[this.grouping.label]=a,U(t.addItem)&&(t.addItem(o),r=null!=r?r:this._getParent(t.createCursor().getCurrent()),this._updateParentMap(r,o),t=this.getChildren(o),r=o,s==n-1)){t.addItem(e),this._updateParentMap(o,e);break}}},ja.prototype._getCollection=function(t){if(E(t))return new Hb(t);if(t instanceof xb)return t;if(ha(t))return new P(t);if(Ea(t)){var e=[];return e.push(t),new P(e)}return new P},ja.prototype._getDataLabel=function(t,e){return null!=e.groupingFunction?e.groupingFunction(t,e):E(t)?G.hasElementProperty(t,e.name)?G.getProperty(t,e.name):"Not Available":t.hasOwnProperty(e.name)?t[e.name]:"Not Available"},ja.prototype._getParent=function(t){if(t=V.getUID(t),this._parentMap.hasOwnProperty(t))return this._parentMap[t]},ja.prototype._generateRootSummaries=function(t){t=ja._super.getSource.call(this),this._getSummaries(t,-1)},ja.prototype._getSummariesForRow=function(t,e,i){e=new pb(e),e.childrenField=this.childrenField,i=new T(e,{});var s=new pc(i,i,e);e=this._summaryFields.length;var r,n,o=new Tc,a={};for(i=0;i<e;i++)r=this._summaryFields[i],n=!F(r.summaryOperation)&&r.summaryOperation instanceof Sc?r.summaryOperation:o,a[r.uno]=n.summaryCalculationBegin(r);for(;!s.getAfterLast();){for(i=0;i<e;i++)r=this._summaryFields[i],n=!F(r.summaryOperation)&&r.summaryOperation instanceof Sc?r.summaryOperation:o,n.calculateSummary(a[r.uno],r,s.getCurrent());s.moveNext()}for(i=0;i<e;i++)r=this._summaryFields[i],n=!F(r.summaryOperation)&&r.summaryOperation instanceof Sc?r.summaryOperation:o,s=n.returnSummary(a[r.uno],r),this._populateSummary(t,r,a[r.uno],s)},ja.prototype._populateSummary=function(t,e,i,s){var r=e.summaryOperation.toString();t=V.getUID(t),p(this._summariesTracker)&&(this._summariesTracker={}),I(this._summariesTracker[t])&&(this._summariesTracker[t]={}),I(this._summariesTracker[t][r])&&(this._summariesTracker[t][r]={}),I(this._summariesTracker[t][r][e.dataField])&&(this._summariesTracker[t][r][e.dataField]={}),this._summariesTracker[t][r][e.dataField]={summaryObject:i,value:s}},ja.prototype._getSummary=function(t,e){var i=e.summaryOperation.toString(),s=V.getUID(t);return p(this._summariesTracker)||I(this._summariesTracker[s])||I(this._summariesTracker[s][i])||I(this._summariesTracker[s][i][e.dataField])?null:this._summariesTracker[s][i][e.dataField]},ja.prototype._registCellAttribute=function(t,e,i){for(var s=e;s<e+i.colSpan;s++){var r=i.clone();r._oItem=t,r._type=s==e?1:2,this.cellAttributes[this._itemToUID(t)+","+s]=r}},ja.prototype._getSummaries=function(t,e){if(!(e>this.grouping.fields.length-1)){var i=this.getChildren(t);if(t==ja._super.getSource.call(this)&&(i=t),i&&0!=i.getLength()){if(e==this.grouping.fields.length-1)this._getSummariesForRow(t,i,e);else{for(var s,r,n=i.createCursor(),o=!0,i=new Tc,a={};!n.getAfterLast();){var l=n.getCurrent();if(!(l instanceof Pd)){var h,d=this._summaryFields.length;for(h=0;h<d;h++){s=this._summaryFields[h],r=!F(s.summaryOperation)&&s.summaryOperation instanceof Sc?s.summaryOperation:i;var c=this._getSummary(l,s);o?a[s.uno]=r.summaryOfSummaryCalculationBegin(c.summaryObject,s):r.calculateSummaryOfSummary(a[s.uno],c.summaryObject,s)}}o=!1,n.moveNext()}if(!o)for(h=0;h<d;h++)s=this._summaryFields[h],r=!F(s.summaryOperation)&&s.summaryOperation instanceof Sc?s.summaryOperation:i,n=r.returnSummaryOfSummary(a[s.uno],s),this._populateSummary(t,s,a[s.uno],n)}-1==e?this._insertSummaries(ja._super.getSource.call(this),-1,!0):this._insertSummaries(t,e)}}},ja.prototype._insertSummaries=function(t,e,i){i=2<arguments.length&&i;var s=this.summaries;if(i||(s=this.grouping.fields[e].summaries),s){var r,n=[],o=s.length;for(r=0;r<o;r++){var a=s[r];n[r]=null!=a.summaryObjectFunction?a.summaryObjectFunction():new Pd;var l,h=a.fields.length;for(l=0;l<h;l++){var d,c=a.fields[l],_=c.label?c.label:c.dataField;if(c instanceof Ge){var u=c;u.cellAttribute&&(d=0<=u.colNum?u.colNum:isNaN(u.cellAttribute.colNo)?l:u.cellAttribute.colNo,this._registCellAttribute(n[r],d,u.cellAttribute))}d=this._getSummary(t,c),null!=d&&(d=d.value,n[r][_]=d)}a instanceof He&&(a.rowAttribute&&(this.rowAttributes[this._itemToUID(n[r])]=a.rowAttribute.clone()),a.label&&a.labelDataField&&(n[r][a.labelDataField]=null!=a.labelFunction?a.labelFunction(n[r],a):a.label),a.cellAttribute&&(d=0<=a.cellAttribute.colNo?a.cellAttribute.colNo:0,this._registCellAttribute(n[r],d,a.cellAttribute))),a=V.getUID(t),void 0==this._objectSummaryMap[a]&&(this._objectSummaryMap[a]=[]),this._objectSummaryMap[a].push(n[r])}i?this._insertRootSummary(n):this._insertSummary(t,n,s)}},ja.prototype._initialize=function(){this._currentData=null,this._currentGroups=[],this._currentGroupLabels=[],this._currentIndices=[],this._childrenArray=null},ja.prototype._insertRootSummary=function(t){var e=ja._super.getSource.call(this);if(U(e.addItemAt)){var i,s=t.length;for(i=0;i<s;i++){var r=this.summaries[i];-1!=r.summaryPlacement.indexOf("first")&&e.addItemAt(t[i],0),-1!=r.summaryPlacement.indexOf("last")&&e.addItem(t[i])}}},ja.prototype._insertSummary=function(t,e,i){var s,r,n=i.length;for(s=0;s<n;s++){var o,a=i[s];if(-1!=a.summaryPlacement.indexOf("group")){var l=this._itemToUID(e[s]);o=l+",";var h=this._itemToUID(t);this.rowAttributes[l]&&(this.rowAttributes[h]=this.rowAttributes[l]);for(r in this.cellAttributes)0<=r.indexOf(o)&&(l=r.substring(r.indexOf(",")+1))&&(this.cellAttributes[h+","+l]=this.cellAttributes[r]);for(r in e[s])"rm_internal_uid"!=r&&"constructor"!=r&&(t[r]=e[s][r])}-1!=a.summaryPlacement.indexOf("first")&&(o=this.getChildren(t))&&o.addItemAt(e[s],0),-1!=a.summaryPlacement.indexOf("last")&&(o=this.getChildren(t))&&o.addItem(e[s])}},ja.prototype._makeGroupedCollection=function(){var t,e=this,i=[],s=e.grouping.fields.length;if(e._oldSort=e.getSource().getSort(),e.beforeSorting){for(t=0;t<s;t++){var r=e.grouping.fields[t],n=new sb(r.name,r.caseInsensitive,r.descending,r.numeric);n.compareFunction=r.compareFunction,i.push(n)}if(e.getSource().setSort(new Ac),null!=e.grouping.compareFunction&&e.getSource().getSort().setCompareFunction(e.grouping.compareFunction),e.getSource().getSort().setFields(i),i=e.getSource().refresh(),!i)return i}return e.async?(e._timer&&clearInterval(e._timer),e._timer=setInterval(function(){e._timerHandler()},10),!0):e._buildGroups()},ja.prototype._timerHandler=function(){this._buildGroups()&&(clearInterval(this._timer),this._timer=null)},ja.prototype._buildGroups=function(){var e=this;if(!e._prepared){var i={};if(e._initialize(),e._newCollection.removeAll(),!e.getSource()||0==e.getSource().getLength())return!1;if(e._dispatchCollectionEvents){var s=new pb(e._newCollection);s.childrenField=e.childrenField,e._hView=new T(s,i)}if(e.cellAttributes={},e.rowAttributes={},e._rowCellAttributes={},e._flatView=e.getSource(),e._flatCursor=e._flatView.createCursor(!0),e._gf=e.grouping.fields,e._fieldCount=e._gf.length,e._gf&&(e._prepared=!0,e.async))return!1;if(e.async)return!0}for(e._flatCursor.seek(e._currentPosition);!e._flatCursor.getAfterLast()&&e._currentPosition!=t.getLAST();){e._currentData=e._flatCursor.getCurrent();for(var r,n,s=0,i=0;i<e._fieldCount;++i){if(r=e._getDataLabel(e._currentData,e._gf[i]),r!=e._currentGroupLabels[i]){if(e._rowCellAttributes[e._gf[i].uno])for(s=0;s<e._rowCellAttributes[e._gf[i].uno].length;s++)n=e._rowCellAttributes[e._gf[i].uno][s],n._rowGap=s,n.rowSpan=e._rowCellAttributes[e._gf[i].uno].length,n._oItem=e._rowCellAttributes[e._gf[i].uno][0]._oItem;if(e._childrenArray&&e._childrenArray.length&&(e._currentGroups[e._fieldCount-1][e.childrenField].setSource(e._childrenArray),e._childrenArray=[]),e._summaryPresent)for(s=e._currentGroups.length-1;s>=i;s--)e._getSummaries(e._currentGroups[s],s);if(e._currentGroupLabels.splice(i+1,e._currentGroupLabels.length-i-1),e._currentGroups.splice(i+1,e._currentGroups.length-i-1),e._currentIndices.splice(i+1,e._currentIndices.length-i-1),e._currentGroupLabels[i]=r,e._currentGroups[i]=null!=e._gf[i].groupingObjectFunction?e._gf[i].groupingObjectFunction(r):null!=e.grouping.groupingObjectFunction?e.grouping.groupingObjectFunction(r):{},e._currentGroups[i][e.childrenField]=new P,e._currentGroups[i][e.grouping.label]=e._currentGroupLabels[i],e._itemIndex=e._currentIndices[i-1]?e._currentIndices[i-1]:0,e._dispatchCollectionEvents?e._hView.addChild(e._currentGroups[i-1],e._currentGroups[i]):0<i?e._currentGroups[i-1][e.childrenField].getSource().push(e._currentGroups[i]):e._newCollection.getSource().push(e._currentGroups[i]),e._gf[i]instanceof Yd){if(r=e._gf[i],r.treeCellAttribute){var o=e._itemToUID(e._currentGroups[i]);if(n=r.treeCellAttribute.clone(),n.colNo=0<=r.colNum?r.colNum:i,n._oItem=e._currentGroups[i],n._type=1,e.cellAttributes[o+","+i]=n,1<n.colSpan)for(n=r.treeCellAttribute.clone(),n.colNo=0<=r.colNum?r.colNum:i,n._oItem=e._currentGroups[i],n._type=2,s=1;s<n.colSpan;s++)e.cellAttributes[o+","+(i+s)]=n}r.getRowSpanable()?(e._rowCellAttributes[r.uno]=[],n=new ib,n.colNo=0<=r.colNum?r.colNum:i,n.colSpan=1,n._oItem=e._currentData,n._rowGap=0,n.rowSpan=1,n._type=1,r.cellAttribute&&(n.styleName=r.cellAttribute.styleName,n.backgroundColor=r.cellAttribute.backgroundColor,n.formatString=r.cellAttribute.formatString,n.editable=r.cellAttribute.editable),e.cellAttributes[e._itemToUID(e._currentData)+","+i]=n,e._rowCellAttributes[r.uno].push(n)):r.cellAttribute&&(n=r.cellAttribute.clone(),e.cellAttributes[e._itemToUID(e._currentData)+","+i]=n)}e._currentIndices[i-1]=++e._itemIndex}else e._gf[i]instanceof Yd&&(r=e._gf[i],r.getRowSpanable()?(n=new ib,n.colNo=0<=r.colNum?r.colNum:i,n.colSpan=1,n._oItem=e._currentData,n._rowGap=0,n.rowSpan=1,n._type=2,r.cellAttribute&&(n.styleName=r.cellAttribute.styleName,n.backgroundColor=r.cellAttribute.backgroundColor,n.formatString=r.cellAttribute.formatString,n.editable=r.cellAttribute.editable),e.cellAttributes[e._itemToUID(e._currentData)+","+i]=n,e._rowCellAttributes[e._gf[i].uno].push(n)):r.cellAttribute&&(n=r.cellAttribute.clone(),e.cellAttributes[e._itemToUID(e._currentData)+","+i]=n));i==e._fieldCount-1&&(e._itemIndex=e._currentIndices[i]?e._currentIndices[i]:0,e._childrenArray||(e._childrenArray=[]),e._childrenArray.push(e._currentData),e._currentIndices[i]=++e._itemIndex)}try{if(e._flatCursor.moveNext(),e._currentPosition=e._flatCursor.getBookmark(),e.async)return!1}catch(a){a instanceof ca&&(e._cleanUp(),a.addResponder(new S(function(t,i){e._makeGroupedCollection()},function(t,e){})))}}if(e._currentPosition==t.getLAST()){if(e._childrenArray&&e._childrenArray.length){for(e._currentGroups[e._fieldCount-1][e.childrenField].setSource(e._childrenArray),i=0;i<e._fieldCount;++i)if(e._rowCellAttributes[e._gf[i].uno])for(s=0;s<e._rowCellAttributes[e._gf[i].uno].length;s++)n=e._rowCellAttributes[e._gf[i].uno][s],n._rowGap=s,n.rowSpan=e._rowCellAttributes[e._gf[i].uno].length,n._oItem=e._rowCellAttributes[e._gf[i].uno][0]._oItem;if(e._summaryPresent)for(s=e._fieldCount-1;0<=s;s--)e._getSummaries(e._currentGroups[s],s)}e.getSource()&&e.summaries&&(ja._super.getSource.call(e)||ja._super.setSource.call(e,new P([e.getSource()])),e._generateRootSummaries(p(e.grouping))),e._newCollection.refresh(),i=new y(y.COLLECTION_CHANGE),i.kind="refresh",e.dispatchEvent(i),e._cleanUp()}return!0},ja.prototype._prepareSummaryFields=function(){this._summaryFields=[];var t,e,i,s;if(null!=this.grouping.fields)for(t=0;t<this.grouping.fields.length;t++){var r=this.grouping.fields[t];if(null!=r.summaries)for(e=0;e<r.summaries.length;e++)if(s=r.summaries[e],null!=s.fields)for(i=0;i<s.fields.length;i++)this._summaryPresent=!0,this._summaryFields.push(s.fields[i])}if(null!=this.summaries)for(t=0;t<this.summaries.length;t++)if(s=this.summaries[t],null!=s.fields)for(e=0;e<s.fields.length;e++)this._summaryPresent=!0,this._summaryFields.push(s.fields[e])},ja.prototype._cleanUp=function(){this.getSource().setSort(this._oldSort),this.getSource().refresh(),this._prepared=!1,this._currentPosition=t.getFIRST(),this._oldSort=null,this._flatCursor.removeListener(),this._flatCursor=null},ja.prototype._applyFunctionForParentNodes=function(t,e,i){if(i=2<arguments.length?i:0,0<t.getLength())for(var s=t.createCursor();!s.getAfterLast();){var r=this.getChildren(s.getCurrent());if(r instanceof P)for(var n=r.createCursor();!n.getAfterLast();){var o=n.getCurrent();if(this.hasChildren(o)){this._applyFunctionForParentNodes(r,e,i+1);break}n.moveNext()}e.call(this,s.getCurrent(),i),s.moveNext()}},ja.prototype._regenerateRootSummaries=function(){if(this.summaries){var t=ja._super.getSource.call(this);this.grouping||(t=t.createCursor().getCurrent());var e=V.getUID(t),i=this._objectSummaryMap[e];if(i&&U(t.getItemIndex)){var s,r=i.length;for(s=0;s<r;s++){var n=t.getItemIndex(i[s]);-1!=n&&t.removeItemAt(n)}delete this._objectSummaryMap[e],this._generateRootSummaries(null==this.grouping)}}},ja.prototype._removeAllSummaries=function(){this._applyFunctionForParentNodes(ja._super.getSource.call(this),this._removeSummary)},ja.prototype._removeItemAndSummaries=function(t,e,i){i=2<arguments.length&&i;for(var s=[],r=this.getParent(e);null!=r;){var n,o=!0,a=this.getChildren(r);if(a){if(a.contains(e)&&U(a.getItemIndex)){i&&(n=a.getItemIndex(e),-1!=n&&(a.removeItemAt(n),n=V.getUID(e),this._parentMap[n]&&delete this._parentMap[n]));var l=V.getUID(r);if(this._objectSummaryMap[l]){var h,d=this._objectSummaryMap[l],c=d.length;for(h=0;h<c;h++)n=a.getItemIndex(d[h]),-1!=n&&a.removeItemAt(n);delete this._objectSummaryMap[l]}null!=this._summariesTracker&&this._summariesTracker[l]&&(this._summariesTracker[l]={}),i&&(0==a.length&&null!=this._getParent(r)?o=!1:i=!1)}if(o&&s.push(r),e=r,r=this._getParent(r),!r){if(1==s.length&&0==this.getChildren(s[0]).getLength()&&U(t.getItemIndex)&&(n=t.getItemIndex(e),-1!=n)){t.removeItemAt(n);break}return s.reverse()}}}return null},ja.prototype._removeSummary=function(t,e){var i=this.getChildren(t);i&&this._removeItemAndSummaries(ja._super.getSource.call(this),i.createCursor().getCurrent())},ja.prototype._updateParentMap=function(t,e){var i=V.getUID(e);this._parentMap[i]=t},ja.prototype._updateSummary=function(t,e){e=1<arguments.length&&e;var i;i=ja._super.getSource.call(this);var s;if((this._summaryPresent||e)&&(s=this._removeItemAndSummaries(i,t,e)),this._summaryPresent&&s)for(i=s.length,--i;0<=i;i--)this._getSummaries(s[i],i)},ja.prototype._collectionChangeHandler=function(t){if(this.grouping){var e,i,s,r,n;if("update"==t.kind)for(r=t.items.length,i=0;i<r;i++){var o;if(e=t.items[i].source){for(n=this.grouping.fields.length,s=0;s<n;s++)if(t.items[i].property==this.grouping.fields[s].name){o=!0,this._updateSummary(e,!0),this._addItem(e);break}o||this._updateSummary(e)}}if("add"==t.kind)for(r=t.items.length,i=0;i<r;i++)e=t.items[i],this._addItem(e);if("remove"==t.kind)for(r=t.items.length,i=0;i<r;i++)e=t.items[i],this._updateSummary(e,!0);if("replace"==t.kind)for(r=t.items.length,i=0;i<r;i++)e=t.items[i].newValue,this._updateSummary(t.items[i].oldValue,!0),this._addItem(e);this._regenerateRootSummaries()}};var Yd=function(t,e,i,s){ie.apply(this,arguments),this._rowSpanable=!0,this.colNum=-1,this.treeCellAttribute=this.cellAttribute=void 0};z(Yd,ie),Yd.prototype.getRowSpanable=function(){return this._rowSpanable},Yd.prototype.setRowSpanable=function(t){this._rowSpanable!=t&&(this._rowSpanable=t)};var Ge=function(t,e){t=0<arguments.length?t:null,e=1<arguments.length?e:"SUM",Fe.call(this,t,e),this.cellAttribute=void 0,this.colNum=-1};z(Ge,Fe);var He=function(){je.call(this),this.cellAttribute=void 0,this.labelFunction=this.labelDataField=this.label=null,this.rowAttribute=void 0};z(He,je);var Ie=function(t,e){this.uno=Sa.elementNo++,this.name=0<arguments.length?t:null,this.caseInsensitive=1<arguments.length&&e,this.mergingFunction=void 0,this.rowSpanable=!0,this.summaries=void 0,this.colNum=-1};Ie._defaultProperty="summaries",Ie._propertyType={summaries:Array};var xc=function(t,e,i,s,r){this.styleName=0<arguments.length?t:null,this.backgroundColor=1<arguments.length?e:null,this.formatString=2<arguments.length?i:null,this.editable=!(3<arguments.length)||s,this.rowHeight=4<arguments.length?r:NaN};xc.prototype.clone=function(){return new xc(this.styleName,this.backgroundColor,this.formatString,this.editable,this.rowHeight)};var va=function(e){ea.call(this),this.async=!1,this.mergingFields=null,this.summaries=void 0,this._newCollection=new P,va._super.setSource.call(this,this._newCollection.getSource()),this._prepared=!1,this._currentPosition=t.getFIRST(),arguments.length?this.setSource(e):this.setSource(null)};va._defaultProperty="mergingFields",va._propertyType={summaries:Array,mergingFields:Array},z(va,ea),va.prototype.getFilterFunction=function(){return this._sourceCol?this._sourceCol.filterFunction:null},va.prototype.setFilterFunction=function(t){this._sourceCol&&(this._sourceCol.filterFunction=t)},va.prototype.getSort=function(){return this._sourceCol?this._sourceCol.getSort():null},va.prototype.setSort=function(t){this._sourceCol&&this._sourceCol.setSort(t)},va.prototype.getSource=function(){return this._sourceCol},va.prototype.setSource=function(t){if(this._sourceCol&&this._sourceCol.removeEventListener(y.COLLECTION_CHANGE,this._sourceCollectionChangeHandler,this),this.cellAttributes={},this.rowAttributes={},t){this._sourceCol=this._getCollection(t);var e=new y(y.COLLECTION_CHANGE);e.kind="reset",this.dispatchEvent(e),(this._sourceCol||t)&&this._summary(),this._sourceCol instanceof xb&&this._sourceCol.addEventListener(y.COLLECTION_CHANGE,this._sourceCollectionChangeHandler,this)}else this._sourceCol=null},va.prototype.createCursor=function(){return new Je(this)},va.prototype._getCollection=function(t){if(E(t))return new Hb(t);if(t instanceof xb)return t;if(ha(t))return new P(t);if(Ea(t)){var e=[];return e.push(t),new P(e)}return new P},va.prototype.refresh=function(){if(this._sourceCol)return this._sourceCol.getSort()||null!=this._sourceCol.filterFunction||this._sourceCol._localIndex?this._sourceCol.refresh():this._summary();this._initialize(),this._newCollection.removeAll();var t=new y(y.COLLECTION_CHANGE);return t.kind="reset",this.dispatchEvent(t),!0},va.prototype.cancelRefresh=function(){this._timer&&(clearInterval(this._timer),this._timer=null,this._cleanUp())},va.prototype._makeMergedCollection=function(){var t=this;return t.async?(t._timer&&clearInterval(t._timer),t._timer=setInterval(function(){t._timerHandler()},2),!0):t._buildMergingRows()},va.prototype._buildMergingRows=function(){var e,i,s,r=this;if(!r._prepared){if(r._initialize(),r._newCollection.removeAll(),!r._sourceCol||0==r._sourceCol.getLength())return!1;if(new Tc,r._flatView=r._sourceCol,r._flatCursor=r._flatView.createCursor(!0),!(r.mergingFields&&0!=r.mergingFields.length||r.summaries&&0!=r.summaries.length))return!1;for(r._fieldCount=r.mergingFields&&0!=r.mergingFields.length?r.mergingFields.length:0,r.summaries&&r._addFirstSummaryRow(r.summaries,0),e=0;e<r._fieldCount;e++)i=r.mergingFields[e],r._currentMergingLabels[e]=r._getDataLabel(r._flatCursor.getCurrent(),i),r._mergeFieldRowSpan[i.uno]=0,r._mergeFieldRow[i.uno]=r._flatCursor.getCurrent(),i.summaries&&r._addFirstSummaryRow(i.summaries,e);if(r.dispatchEventEnabled=!1,(r.mergingFields||r.summaries)&&(r._prepared=!0,r.async))return!1;if(r.async)return!0}for(r._flatCursor.seek(r._currentPosition);!r._flatCursor.getAfterLast()&&r._currentPosition!=t.getLAST();){for(r._currentData=r._flatCursor.getCurrent(),r.summaries&&r._calcSummary(r.summaries,r._currentData),e=0;e<r._fieldCount;e++){if(i=r.mergingFields[e],r._getDataLabel(r._currentData,i)!=r._currentMergingLabels[e]){for(i=r._fieldCount-1;i>=e;i--){var n=r.mergingFields[i];if(n.summaries&&(r._addedSummaryRow=r._addSummaryRow(n.summaries,r._mergeFieldRow[n.uno]),0<r._addedSummaryRow))for(s=0;s<i;s++)r._mergeFieldRowSpan[r.mergingFields[s].uno]+=1;n.rowSpanable&&(1<r._mergeFieldRowSpan[n.uno]?r.addCellAttributeDetail(r._mergeFieldRow[n.uno],0<=n.colNum?n.colNum:i,r._mergeFieldRowSpan[n.uno],1):r.removeCellAttribute(r._mergeFieldRow[n.uno],0<=n.colNum?n.colNum:i)),r._mergeFieldRowSpan[n.uno]=1,r._mergeFieldRow[n.uno]=r._currentData,r._currentMergingLabels[i]=r._getDataLabel(r._currentData,n),n.summaries&&r._calcSummary(n.summaries,r._currentData,!0)}for(i=e;i<r._fieldCount;i++)n=r.mergingFields[i],n.summaries&&r._addFirstSummaryRow(n.summaries,i);break}i.summaries&&r._calcSummary(i.summaries,r._currentData),r._mergeFieldRowSpan[i.uno]+=1}r._newCollection.addItem(r._currentData),r._setAttribute(r._currentRowIndex,r._currentData),r._currentRowIndex++;try{if(r._flatCursor.moveNext(),r._currentPosition=r._flatCursor.getBookmark(),r.async&&0==r._currentRowIndex%100)return!1}catch(o){if(o instanceof ca){r._cleanUp(),o.addResponder(new S(function(t,e){r._makeMergedCollection()},function(t,e){}));break}}}if(r._currentPosition==t.getLAST()){for(e=r._fieldCount-1;0<=e;e--){if(n=r.mergingFields[e],n.summaries&&(r._addedSummaryRow=r._addSummaryRow(n.summaries,r._mergeFieldRow[n.uno]),0<r._addedSummaryRow))for(i=0;i<e;i++)r._mergeFieldRowSpan[r.mergingFields[i].uno]+=1;n.rowSpanable&&(1<r._mergeFieldRowSpan[n.uno]?r.addCellAttributeDetail(r._mergeFieldRow[n.uno],0<=n.colNum?n.colNum:e,r._mergeFieldRowSpan[n.uno],1):r.removeCellAttribute(r._mergeFieldRow[n.uno],0<=n.colNum?n.colNum:e)),r._mergeFieldRowSpan[n.uno]=1,r._mergeFieldRow[n.uno]=r._currentData,r._currentMergingLabels[e]=r._getDataLabel(r._currentData,n),n.summaries&&r._calcSummary(n.summaries,r._currentData,!0)}if(r._sourceCol&&r.summaries&&r._addSummaryRow(r.summaries,r._currentData),r._notRegistedCellAttributes)for(e=0;e<r._notRegistedCellAttributes.length;e++)r._localIndex?r._notRegistedCellAttributes[e].rno<r._localIndex.length&&(r.cellAttributes[r._itemToUID(r._localIndex[r._notRegistedCellAttributes[e].rno])+","+r._notRegistedCellAttributes[e].cno]=r._notRegistedCellAttributes[e].ca):r._notRegistedCellAttributes[e].rno<r._list.getLength()&&(r.cellAttributes[r._itemToUID(r._list.getItemAt(r._notRegistedCellAttributes[e].rno))+","+r._notRegistedCellAttributes[e].cno]=r._notRegistedCellAttributes[e].ca);e=new y(y.COLLECTION_CHANGE),e.kind="refresh",r.dispatchEvent(e),r._cleanUp()}return!0},va.prototype._addFirstSummaryRow=function(t,e){var i,s,r;for(i=0;i<t.length;i++)s=t[i],"first"==s.summaryPlacement&&(r=null!=s.summaryObjectFunction?s.summaryObjectFunction():new Pd,this._summaryObjectMap[s.uno]=r,this._summaryObjectMapIndex[s.uno]=this._currentRowIndex,this._newCollection.addItemAt(r,this._currentRowIndex),this._currentRowIndex++,0<e&&(s=this.mergingFields[e-1],this._mergeFieldRow[s.uno]instanceof Pd||(r[s.name]=this._getDataLabel(this._mergeFieldRow[s.uno],s),this._mergeFieldRow[s.uno]=r)))},va.prototype._calcSummary=function(t,e,i){i=2<arguments.length&&i;var s,r,n,o,a,l;for(s=0,n=t.length;s<n;s++)for(a=t[s],r=0,o=a.fields.length;r<o;r++)l=a.fields[r],this._summaryFieldMap[l.uno]&&!i||(this._summaryFieldMap[l.uno]=this._summaryFieldsCalculator[l.uno].summaryCalculationBegin(l)),this._summaryFieldsCalculator[l.uno].calculateSummary(this._summaryFieldMap[l.uno],l,e)},va.prototype._addSummaryRow=function(t,e){var i,s,r,n,o,a,l=0;for(i=0;i<t.length;i++)for(r=t[i],"first"==r.summaryPlacement?(o=this._summaryObjectMap[r.uno],a=this._summaryObjectMapIndex[r.uno]):(o=null!=r.summaryObjectFunction?r.summaryObjectFunction():new Pd,this._newCollection.addItem(o),this._currentRowIndex++),l++,r.label&&r.labelDataField&&(o[r.labelDataField]=null!=r.labelFunction?r.labelFunction(e,r):r.label),r.rowAttribute&&("first"==r.summaryPlacement?this.addRowAttributeAt(a,r.rowAttribute.clone()):this.addRowAttributeAt(this._newCollection.getLength()-1,r.rowAttribute.clone())),r.cellAttribute&&("first"==r.summaryPlacement?this.addCellAttributeAt(a,r.cellAttribute.clone()):this.addCellAttributeAt(this._newCollection.getLength()-1,r.cellAttribute.clone())),s=0;s<r.fields.length;s++){if(n=r.fields[s],this._summaryFieldMap[n.uno]){var h=this._summaryFieldsCalculator[n.uno].returnSummary(this._summaryFieldMap[n.uno],n);n.targetDataField?o[n.targetDataField]=h:o[n.dataField]=h}n.cellAttribute&&("first"==r.summaryPlacement?this.addCellAttributeAt(a,n.cellAttribute.clone()):this.addCellAttributeAt(this._newCollection.getLength()-1,n.cellAttribute.clone()))}return l},va.prototype._summary=function(){return this._prepareSummaryFields(),this._makeMergedCollection()},va.prototype._prepareSummaryFields=function(){this._summaryFieldsCalculator={};var t,e,i,s,r,n,o=new Tc;if(this.mergingFields)for(i=0;i<this.mergingFields.length;i++)if(n=this.mergingFields[i],n.summaries)for(s=0;s<n.summaries.length;s++)if(t=n.summaries[s],t.fields)for(r=0;r<t.fields.length;r++)e=t.fields[r],!F(e.summaryOperation)&&e.summaryOperation instanceof Sc?this._summaryFieldsCalculator[e.uno]=e.summaryOperation:this._summaryFieldsCalculator[e.uno]=o;if(this.summaries)for(i=0;i<this.summaries.length;i++)if(t=this.summaries[i],t.fields)for(s=0;s<t.fields.length;s++)e=t.fields[s],!F(e.summaryOperation)&&e.summaryOperation instanceof Sc?this._summaryFieldsCalculator[e.uno]=e.summaryOperation:this._summaryFieldsCalculator[e.uno]=o},va.prototype._initialize=function(){this._currentData=null,this._currentMergingLabels=[],this._currentRowIndex=0,this._summaryFieldMap={},this._summaryObjectMap={},this._summaryObjectMapIndex={},this._mergeFieldRowSpan={},this._mergeFieldRow={},this.cellAttributes={},this.rowAttributes={},this._notRegistedCellAttributes=null},va.prototype._getDataLabel=function(t,e){if(null!=e.mergingFunction)return e.mergingFunction(t,e);var i;return i=E(t)?G.hasElementProperty(t,e.name)?G.getProperty(t,e.name):"Not Available":t.hasOwnProperty(e.name)?t[e.name]:"Not Available",e.caseInsensitive&&(i=i.toLowerCase()),i},va.prototype._cleanUp=function(){this._prepared=!1,this._currentPosition=t.getFIRST(),this._flatCursor.removeListener(),this._notRegistedCellAttributes=this._flatCursor=null,this.dispatchEventEnabled=!0},va.prototype.getItemIndex=function(t){return this._list.getItemIndex(t)},va.prototype.removeAll=function(){this._sourceCol&&this._sourceCol.removeAll()},va.prototype.addAll=function(t){throw Error("function addAll not supported")},va.prototype.addAllAt=function(t,e){throw Error("function addAllAt not supported")},va.prototype.addItem=function(t){throw Error("function addItem not supported")},va.prototype.addItemAt=function(t,e){throw Error("function addItemAt not supported")},va.prototype.removeItemAt=function(t){throw Error("function removeItemAt not supported")},va.prototype.setItemAt=function(t,e){throw Error("function setItemAt not supported")},va.prototype._timerHandler=function(){this._buildMergingRows()&&(clearInterval(this._timer),this._timer=null)},va.prototype._sourceCollectionChangeHandler=function(t){if("refresh"==t.kind)(this.getSort()||null!=this.getFilterFunction())&&this.removeAllAttribute();else if("update"==t.kind){if(t.items&&ha(t.items)&&0<t.items.length&&t.items[0]instanceof wc&&"update"==t.items[0].kind&&null==t.items[0].newValue&&null==t.items[0].oldValue&&null==t.items[0].property)return}else this.removeAllAttribute();this.dispatchEvent(t),this._summary()};var Je=function(t){if(Na.call(this,t),this._view=t,this._view.addEventListener(y.COLLECTION_CHANGE,this._collectionEventHandler,this),this._currentIndex=0<this._view.getLength()?0:Na.AFTER_LAST_INDEX,0===this._currentIndex)try{this._setCurrent(this._view.getItemAt(0),!1)}catch(e){e instanceof ca&&(this._currentIndex=Na.BEFORE_FIRST_INDEX,this._setCurrent(null,!1))}};z(Je,Na),Je.prototype._collectionEventHandler=function(t){switch(t.kind){case"add":t.location<=this._currentIndex&&(this._currentIndex+=t.items.length);break;case"remove":if(t.location<this._currentIndex)this._currentIndex-=t.items.length;else if(t.location==this._currentIndex)if(this._currentIndex<this._view.getLength())try{this._setCurrent(this._view.getItemAt(this._currentIndex))}catch(e){this._setCurrent(null,!1)}else this._currentIndex=Na.AFTER_LAST_INDEX,this._setCurrent(null);break;case"move":t.oldLocation==this._currentIndex?this._currentIndex=t.location:(t.oldLocation<this._currentIndex&&(this._currentIndex-=t.items.length),t.location<=this._currentIndex&&(this._currentIndex+=t.items.length));break;case"refresh":if(!this.getBeforeFirst()&&!this.getAfterLast()){try{this._currentIndex=this._view.getItemIndex(this._currentValue)}catch(e){}-1==this._currentIndex&&this._setCurrent(null)}break;case"replace":if(t.location==this._currentIndex)try{this._setCurrent(this._view.getItemAt(this._currentIndex))}catch(e){this._setCurrent(null,!1)}break;case"reset":this._currentIndex=Na.BEFORE_FIRST_INDEX,this._setCurrent(null)}};var Pd=function(){};z(Pd,ic);var xe=function(){this.uno=Sa.elementNo++,this.cellAttribute=this.fields=void 0,this.labelFunction=this.labelDataField=this.label=null,this.rowAttribute=void 0,this.summaryPlacement="last",this.summaryObjectFunction=void 0};xe._defaultProperty="fields",xe._propertyType={fields:Array};var xa=function(t){Hb.call(this),this._source=null,arguments.length?this.setSource(t):this.setSource(null),this.autoResetRowSpan=!0,this.cellAttributes=void 0,this.extractable=this.dispatchEventEnabled=!0,this.rowAttributes=void 0};z(xa,Hb),xa.prototype.getGrid=function(){return this._grid},xa.prototype.setGrid=function(t){this._grid!=t?(this._grid&&this._grid.removeEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this),this._grid=t,this._grid.addEventListener(ac.HEADER_SHIFT,this._gridIndexChangedHandler,this,!1,0),this._spanColumns=this._grid._spanColumns,this.extractAttributes()):this._spanColumns!=this._grid._spanColumns&&(this._spanColumns=this._grid._spanColumns,this.extractAttributes())},xa.prototype.setList=function(t){xa._super.setList.call(this,t),this.cellAttributes={},this.rowAttributes={},this.extractAttributes()},xa.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},xa.prototype._setRowAttributeXML=function(t,e){if(e&&e.attributes&&!(0>=e.attributes.length)){for(var i=new xc,s=e.attributes,r=0;r<s.length;r++)switch(s[r].name){case"styleName":i.styleName=s[r].value;break;case"backgroundColor":i.backgroundColor=s[r].value;break;case"formatString":i.formatString=s[r].value;break;case"editable":i.editable="true"==s[r].value;break;case"rowHeight":i.rowHeight=s[r].value;break;default:i[s[r].name]=s[r].value}s=this._itemToUID(e),this.rowAttributes[s]&&delete this.rowAttributes[s],this.rowAttributes[s]=i}},xa.prototype._findItemRowNo=function(t){return this._localIndex?Ra.indexOf(this._localIndex,t):this._list?this._list.getItemIndex(t):-1},xa.prototype._registCellAttribute=function(t,e,i){var s=this._itemToUID(t);if(i._type=1,1==i.rowSpan&&1==i.colSpan)this.cellAttributes[s+","+e]=i;else if(t=this._findItemRowNo(t),!(0>t))for(var r=t;r<t+i.rowSpan;r++)for(var n=e;n<e+i.colSpan;n++)if(r==t&&n==e)this.cellAttributes[s+","+e]=i;else{
var o=new ib;o.colNo=e,o._type=2,o._oItem=i._oItem,o._rowGap=r-t,o.rowSpan=i.rowSpan,o.colSpan=i.colSpan,o.styleName=i.styleName,o.backgroundColor=i.backgroundColor,o.formatString=i.formatString,o.editable=i.editable,this._localIndex?r<this._localIndex.length&&(this.cellAttributes[this._itemToUID(this._localIndex[r])+","+n]=o):r<this._list.getLength()&&(this.cellAttributes[this._itemToUID(this._list.getItemAt(r))+","+n]=o)}},xa.prototype._registCellAttributeAt=function(t,e,i,s){if(s._type=1,1==s.rowSpan&&1==s.colSpan)this.cellAttributes[i+","+e]=s;else for(var r=t;r<t+s.rowSpan;r++)for(var n=e;n<e+s.colSpan;n++)if(r==t&&n==e)this.cellAttributes[i+","+e]=s;else{var o=new ib;o.colNo=e,o._type=2,o._oItem=s._oItem,o._rowGap=r-t,o.rowSpan=s.rowSpan,o.colSpan=s.colSpan,o.styleName=s.styleName,o.backgroundColor=s.backgroundColor,o.formatString=s.formatString,o.editable=s.editable,this._localIndex?r<this._localIndex.length&&(this.cellAttributes[this._itemToUID(this._localIndex[r])+","+n]=o):r<this._list.getLength()&&(this.cellAttributes[this._itemToUID(this._list.getItemAt(r))+","+n]=o)}},xa.prototype._setCellAttributeXML=function(t,e,i,s,r){var n;if((n=r?G.getElement(r,i):G.getElement(s,i))&&n.attributes&&!(0>=n.attributes.length)){if(i=this._itemToUID(s),this.cellAttributes[i+","+e]&&delete this.cellAttributes[i+","+e],r=new ib,n=n.attributes)for(var o=0;o<n.length;o++)switch(n[o].name){case"rowSpan":r.rowSpan=parseInt(n[o].value);break;case"colSpan":r.colSpan=parseInt(n[o].value);break;case"styleName":r.styleName=n[o].value;break;case"backgroundColor":r.backgroundColor=n[o].value;break;case"formatString":r.formatString=n[o].value;break;case"editable":r.editable="true"==n[o].value;break;default:r.setAttribute(n[o].name,n[o].value)}r.colNo=e,r._oItem=s,this._registCellAttributeAt(t,e,i,r)}},xa.prototype._setAttribute=function(t,e){var i=this._spanColumns.length;this._setRowAttributeXML(t,e);for(var s=0;s<i;s++){var r=this._spanColumns[s];if(r.getDataField()){var n=this._grid._getHeaderInfo(r);null!=n.internalLabelFunction?(n=n.internalLabelFunction(e,r))&&this._setCellAttributeXML(t,r.colNum,r.getDataField(),e,n):e&&this._setCellAttributeXML(t,r.colNum,r.getDataField(),e)}}},xa.prototype._internalDispatchEvent=function(t,e,i){if(i=2<arguments.length?i:-1,this.dispatchEventEnabled&&this.hasEventListener(y.COLLECTION_CHANGE)){var s=new y(y.COLLECTION_CHANGE);s.kind=t,e&&s.items.push(e),s.location=i,this.dispatchEvent(s)}},xa.prototype.extractAttributes=function(t,e){if(e=!(1<arguments.length)||e,t)this._grid=t;else if(!this._grid)return;if(this._grid._spanColumns&&0<this._grid._spanColumns.length){if(this._spanColumns=this._grid._spanColumns,this.extractable&&(this.cellAttributes||(this.cellAttributes={}),this.rowAttributes||(this.rowAttributes={}),this._list)){var i,s;if(this._localIndex)for(s=this._localIndex.length,i=0;i<s;i++)this._setAttribute(i,this._localIndex[i]);else for(s=this._list.getLength(),i=0;i<s;i++)this._setAttribute(i,this._list.getItemAt(i));e&&this._internalDispatchEvent("reset")}}else this._spanColumns=[]},xa.prototype.getCellAttribute=function(t,e){if(!t||!this.cellAttributes)return null;var i=this.cellAttributes[this._itemToUID(t)+","+e];if(i&&this._localIndex&&this.autoResetRowSpan&&1<i.rowSpan){if(2==i._type&&0<i._rowGap)return null;var s,r=new ib;for(s in i)r[s]=i[s];return r.rowSpan=1,r}return i},xa.prototype.getCellAttributeAt=function(t,e){if(0>t||t>=this._list.getLength()||!this.cellAttributes)return null;if(this._localIndex){if(t>=this._localIndex.length)return null}else if(t>=this._list.getLength())return null;return this._localIndex?this.getCellAttribute(this._localIndex[t],e):this.getCellAttribute(this._list.getItemAt(t),e)},xa.prototype.getRowAttribute=function(t){return t&&this.rowAttributes?this.rowAttributes[this._itemToUID(t)]:null},xa.prototype.getRowAttributeAt=function(t){if(0>t||!this.rowAttributes)return null;if(this._localIndex){if(t>=this._localIndex.length)return null}else if(t>=this._list.getLength())return null;return this._localIndex?this.getRowAttribute(this._localIndex[t]):this.getRowAttribute(this._list.getItemAt(t))},xa.prototype.getRowAttributeUID=function(t){return t&&this.rowAttributes?this.rowAttributes[t]:null},xa.prototype.addCellAttribute=function(t,e){return!!t&&(this.cellAttributes||(this.cellAttributes={}),e._oItem=t,this._registCellAttribute(t,e.colNo,e),this._internalDispatchEvent("replace",t),!0)},xa.prototype.addCellAttributeAt=function(t,e){if(0>t||!this.cellAttributes)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttribute(this._localIndex[t],e):this.addCellAttribute(this._list.getItemAt(t),e)},xa.prototype.addCellAttributeDetail=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,!t)return!1;this.cellAttributes||(this.cellAttributes={});var l=new ib;return l.colNo=e,l._type=1,l._oItem=t,l.rowSpan=i,l.colSpan=s,l.styleName=r,l.backgroundColor=n,l.formatString=o,l.editable=a,this._registCellAttribute(t,e,l),this._internalDispatchEvent("replace",t),!0},xa.prototype.addCellAttributeDetailAt=function(t,e,i,s,r,n,o,a){if(a=!(7<arguments.length)||a,0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttributeDetail(this._localIndex[t],e,i,s,r,n,o,a):this.addCellAttributeDetail(this._list.getItemAt(t),e,i,s,r,n,o,a)},xa.prototype.addCellAttributeExtend=function(t,e,i,s,r){if(!t)return!1;this.cellAttributes||(this.cellAttributes={}),i=new ib;for(var n in r)switch(n){case"backgroundColor":i.backgroundColor=r[n];break;default:i[n]=r[n]}return i.colNo=e,i._oItem=t,this._registCellAttribute(t,e,i),this._internalDispatchEvent("replace",t),!0},xa.prototype.addCellAttributeExtendAt=function(t,e,i,s,r){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addCellAttributeExtend(this._localIndex[t],e,i,s,r):this.addCellAttributeExtend(this._list.getItemAt(t),e,i,s,r)},xa.prototype._removeCellAttributeInternal=function(t,e,i){if(i=2<arguments.length?i:-1,!this.cellAttributes)return!1;var s=this._itemToUID(t),r=this.getCellAttribute(t,e);if(!r)return!1;if(1==r._type&&(1<r.rowSpan||1<r.colSpan))if(1<r.rowSpan){var n=i;0>n&&(n=this._findItemRowNo(t));for(var o=n;o<n+r.rowSpan;o++){try{s=this._localIndex?this._itemToUID(this._localIndex[o]):this._itemToUID(this._list.getItemAt(o))}catch(a){continue}for(var l=e;l<e+r.colSpan;l++)this.cellAttributes[s+","+l]&&delete this.cellAttributes[s+","+l]}}else for(l=e;l<e+r.colSpan;l++)this.cellAttributes[s+","+l]&&delete this.cellAttributes[s+","+l];else{if(!this.cellAttributes[s+","+e])return!1;delete this.cellAttributes[s+","+e]}return this._internalDispatchEvent("replace",t),!0},xa.prototype.removeCellAttribute=function(t,e){return this._removeCellAttributeInternal(t,e)},xa.prototype.removeCellAttributeAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this._removeCellAttributeInternal(this._localIndex[t],e,t):this._removeCellAttributeInternal(this._list.getItemAt(t),e,t)},xa.prototype.addRowAttribute=function(t,e){return!!t&&(this.rowAttributes||(this.rowAttributes={}),this.rowAttributes[this._itemToUID(t)]=e,this._internalDispatchEvent("replace",t),!0)},xa.prototype.addRowAttributeAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttribute(this._localIndex[t],e):this.addRowAttribute(this._list.getItemAt(t),e)},xa.prototype.addRowAttributeDetail=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,!t)return!1;this.rowAttributes||(this.rowAttributes={});var o=new xc;return o.styleName=e,o.backgroundColor=i,o.formatString=s,o.editable=r,o.rowHeight=n,this.rowAttributes[this._itemToUID(t)]=o,this._internalDispatchEvent("replace",t),!0},xa.prototype.addRowAttributeDetailAt=function(t,e,i,s,r,n){if(r=!(4<arguments.length)||r,n=5<arguments.length?n:NaN,0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttributeDetail(this._localIndex[t],e,i,s,r,n):this.addRowAttributeDetail(this._list.getItemAt(t),e,i,s,r,n)},xa.prototype.addRowAttributeExtend=function(t,e){if(!t)return!1;this.rowAttributes||(this.rowAttributes={});var i,s=new xc;for(i in e)switch(i){case"backgroundColor":s.backgroundColor=e[i];break;default:s[i]=e[i]}return this.rowAttributes[this._itemToUID(t)]=s,this._internalDispatchEvent("replace",t),!0},xa.prototype.addRowAttributeExtendAt=function(t,e){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.addRowAttributeExtend(this._localIndex[t],e):this.addRowAttributeExtend(this._list.getItemAt(t),e)},xa.prototype.removeRowAttribute=function(t){var e=this._itemToUID(t);return!(!this.rowAttributes||!this.rowAttributes[e])&&(delete this.rowAttributes[e],this._internalDispatchEvent("replace",t),!0)},xa.prototype.removeRowAttributeAt=function(t){if(0>t)return!1;if(this._localIndex){if(t>=this._localIndex.length)return!1}else if(t>=this._list.getLength())return!1;return this._localIndex?this.removeRowAttribute(this._localIndex[t]):this.removeRowAttribute(this._list.getItemAt(t))},xa.prototype.removeAllAttribute=function(){return this.cellAttributes={},this.rowAttributes={},this._internalDispatchEvent("update"),!0},xa.prototype.setItemAt=function(t,e){var i,s=xa._super.setItemAt.call(this,t,e);if(s&&(this.removeRowAttribute(s),this._spanColumns))for(i=0;i<this._spanColumns.length;i++)this._removeCellAttributeInternal(s,this._spanColumns[i].colNum,e);return this._spanColumns&&(this.rowAttributes||(this.rowAttributes={}),this.cellAttributes||(this.cellAttributes={}),this._setAttribute(e,this.getItemAt(e))),s},xa.prototype.addItemAt=function(t,e){xa._super.addItemAt.call(this,t,e),this._spanColumns&&(this.rowAttributes||(this.rowAttributes={}),this._cellAttributes||(this._cellAttributes={}),this._setAttribute(e,this.getItemAt(e)))},xa.prototype.addAll=function(t){xa._super.addAll.call(this,t),this.extractAttributes(null,!1)},xa.prototype.removeItemAt=function(t){var e=t;if(this._localIndex&&(e=this._list.getItemIndex(this._localIndex[t])),this.removeRowAttributeAt(e),this._spanColumns){var i,s=this._list.getItemAt(e);for(i=0;i<this._spanColumns.length;i++){var r=this.getCellAttribute(s,this._spanColumns[i].colNum),n=null;r&&1<r.rowSpan&&2==r._type&&0<r._rowGap&&r.colNo==this._spanColumns[i].colNum&&(n=this.getCellAttribute(r._oItem,this._spanColumns[i].colNum)),this._removeCellAttributeInternal(s,this._spanColumns[i].colNum,e),n&&(n.rowSpan--,this._registCellAttribute(r._oItem,this._spanColumns[i].colNum,n))}}return xa._super.removeItemAt.call(this,t)},xa.prototype.removeAll=function(){xa._super.removeAll.call(this),this.removeAllAttribute()},xa.prototype._gridIndexChangedHandler=function(t){this.extractAttributes()},z(Ub,u),Ub.prototype.getData=function(){return this._data},Ub.prototype.setData=function(t){this._data=t},Ub.prototype.getListData=function(){return this._listData},Ub.prototype.setListData=function(t){t&&(this._listData=t,this._grid=this._listData.owner,this._dataField=this._listData.dataField),this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},Ub.prototype.getSelected=function(){return this._checkBox.getSelected()},Ub.prototype.setSelected=function(t){this._checkBox.setSelected(t)},Ub.prototype.getText=function(){return this._checkBox.getSelected().toString()},Ub.prototype.createChildren=function(){Ub._super.createChildren.call(this),this._checkBox||(this._checkBox=new Ka,this.addChild(this._checkBox))},Ub.prototype.commitProperties=function(){if(Ub._super.commitProperties.call(this),this._data&&this._listData){var t,e=this._grid._columns[this._listData.columnIndex];if(p(e.trueValue)||(this._checkBox.trueValue=e.trueValue),p(e.falseValue)||(this._checkBox.falseValue=e.falseValue),E(this._data)){try{t=G.getProperty(this._data,this._dataField)}catch(i){}F(t)&&"true"==t?this._checkBox.setSelected(!0):this._checkBox.setSelected(t)}else this._checkBox.setSelected(this._data[this._dataField]);this._checkBox._label=" "}},Ub.prototype.measure=function(){Ub._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");isNaN(this._explicitWidth)?t=this._checkBox.getExplicitOrMeasuredWidth():(t=this._explicitWidth,this._checkBox.setWidth(t-i-s)),e=this._checkBox.getExplicitOrMeasuredHeight(),this.measuredMinWidth=this.measuredWidth=t+(i+s),this.measuredMinHeight=this.measuredHeight=e+(r+n)},Ub.prototype.updateDisplayList=function(t,e){if(Ub._super.updateDisplayList.call(this,t,e),0!=t&&0!=e&&this._listData){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._checkBox.measuredMinWidth,a=t-i-s;0>a&&(a=0),a<o&&(o=a);var a=this._checkBox.measuredMinHeight,l=e-r-n;l<a&&(a=l),this._checkBox.setActualSize(o,a),l=this.getStyle("textAlign"),i=Math.max("center"==l?(t-o-i-s)/2+i:"right"==l?t-s-o:i,0),s=this._grid.getStyle("verticalAlign"),r=Math.max("middle"==s?(e-a-n-r)/2+r:"bottom"==s?e-a-n+2:r,0),this._checkBox.setX(Math.round(i)),this._checkBox.setY(Math.round(r))}},Ub.prototype.focus=function(){this._checkBox?this._checkBox.focus():Ub._super.focus.call(this)},Ub.prototype.getCheckBox=function(){return this._checkBox},z(Ab,qa),Ab.prototype.setData=function(t){this._data=t,this._checkDataField(),this.invalidateProperties(),this.dispatchEvent(new w("dataChange"))},Ab.prototype.getSortItemRenderer=function(){return this._sortItemRenderer},Ab.prototype.setSortItemRenderer=function(t){this._sortItemRenderer=t,this._sortItemRendererChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},Ab.prototype.getListData=function(){return this._listData},Ab.prototype.setListData=function(t){t&&(this._listData=t,this._grid=this._listData.owner,this._dataField=this._listData.dataField),this.invalidateProperties()},Ab.prototype.createChildren=function(){Ab._super.createChildren.call(this),this._checkBox||(this._checkBox=new Ka,this._checkBox.setStyle("whiteSpace","nowrap"),this._checkBox.setStyle("overflow","hidden"),this.addChild(this._checkBox),this._checkBox.addEventListener("change",this._checkBoxChangeHandler,this),this._checkBox.addEvent("mousedown",this._checkBoxMouseUpDownHandler,this),this._checkBox.addEvent("mouseup",this._checkBoxMouseUpDownHandler,this),this._checkBox.setTabIndex(-1))},Ab.prototype.commitProperties=function(){if(this._listData){Ab._super.commitProperties.call(this),this._initialized||this._checkBox.setStyleName(this),this._sortItemRendererInstance&&!this._sortItemRendererChanged||(this._sortItemRenderer||(this._sortItemRenderer=this._grid.getSortItemRenderer()),this._sortItemRenderer&&(this._sortItemRendererInstance=this._sortItemRenderer.newInstance(),this.addChild(this._sortItemRendererInstance)),this._sortItemRendererChanged=!1);var t=this._partsSeparatorSkinClass;this._partsSeparatorSkinClass&&this._partsSeparatorSkinClass==this._grid.getStyle("headerSortSeparatorSkin")||(this._partsSeparatorSkinClass=this._grid.getStyle("headerSortSeparatorSkin")),(this._grid.getSortExpertMode()||this._partsSeparatorSkinClass!=t)&&(this._partsSeparatorSkin&&this.removeChild(this._partsSeparatorSkin),this._grid.getSortExpertMode()||(this._partsSeparatorSkin=new this._partsSeparatorSkinClass,this.addChild(this._partsSeparatorSkin))),this._partsSeparatorSkin&&this._partsSeparatorSkin.setVisible(!(this._data instanceof fb));var e;null!=this._data?(this._checkBox.setLabel(this._listData.label?this._listData.label:""),this._data instanceof C&&(this._column=t=this._data,p(t.trueValue)||(this._checkBox.trueValue=t.trueValue),p(t.falseValue)||(this._checkBox.falseValue=t.falseValue),this._checkBox.setEnabled(this._grid.getEnabled()&&this._grid.getEditable().length&&t.editable),e=this._grid.getShowDataTips(),1==t.getShowDataTips()&&(e=!0),0==t.getShowDataTips()&&(e=!1),e=e&&(t.getDataTipFunction()||t.getDataTipField()||this._grid.getDataTipFunction()||this._grid.getDataTipField())?t.itemToDataTip(this._data):null,t.getDataField()&&1==t.filterable?(this._filterIcon||(this._filterIcon=new Ua,this._filterIcon.setAlt(B.getString("datagrid","columnFiltering")),this.addChild(this._filterIcon)),this._filterIcon.setVisible(!0),this._filterIcon.setSrc(Ma+"funnel.png")):this._filterIcon&&(this._filterIcon.setVisible(!1),this._filterIcon.setSrc(null)),Xb&&(this.setAttr("aria-label",B.getString("datagrid","ariaSelectAll")),this._checkBox._chkBoxElm.setAttr("aria-label",B.getString("datagrid","ariaSelectAll")))),(this.element.draggable=this._grid.headerDragEnabled)?(this.element.style.webkitUserDrag="element",this.addEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.addEvent("selectstart",this._selectStartHandler,this)):(this.element.style.webkitUserDrag="none",this.removeEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.removeEvent("selectstart",this._selectStartHandler,this))):e=null,U(this._sortItemRendererInstance.invalidateProperties)&&this._sortItemRendererInstance.invalidateProperties(),e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title="")}},Ab.prototype.measure=function(){if(this._listData){Ab._super.measure.call(this);var t=this.getSizeStyle("paddingLeft"),e=this.getSizeStyle("paddingRight"),i=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredWidth():0,s=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredHeight():0;this._grid.getSortExpertMode()&&null==this._getFieldSortInfo()&&(s=i=0);var r=this.getSizeStyle("horizontalGap"),n=0;this._filterIcon&&this._filterIcon.getVisible()&&(n=16),0==i&&0==n&&(r=0);var o,a;isNaN(this._explicitWidth)?(o=this._checkBox.getExplicitOrMeasuredWidth(),a=this._checkBox.getExplicitOrMeasuredHeight(),i=o+n+r+(this._partsSeparatorSkin?this._partsSeparatorSkin.getWidth():0)+i):(i=this._explicitWidth,this._partsSeparatorSkin&&this._partsSeparatorSkin.getWidth(),a=this._checkBox.getExplicitOrMeasuredHeight()),s=Math.max(a,s),s=Math.max(s,this._partsSeparatorSkin?this._partsSeparatorSkin.getHeight():0),this.measuredMinWidth=this.measuredWidth=i+(t+e),this.measuredMinHeight=this.measuredHeight=s+0}},Ab.prototype.updateDisplayList=function(t,e){if(this._listData&&(Ab._super.updateDisplayList.call(this,t,e),0!=t)){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredWidth():0,n=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredHeight():0;this._sortItemRendererInstance&&this._sortItemRendererInstance.setActualSize(r,n),this._grid.getSortExpertMode()&&null==this._getFieldSortInfo()&&(n=r=0);var o=this.getSizeStyle("horizontalGap"),a=0,l=0;this._filterIcon&&this._filterIcon.getVisible()&&(l=a=16),0==r&&0==a&&(o=0);var h=this._checkBox.measuredMinWidth,d=t-r-a-o-i-s;0>d&&(d=0),d<h&&(h=d);var d=this._checkBox.measuredMinHeight,c=e-0-0;c<d&&(d=c),this._checkBox.setActualSize(h,d),c=this.getStyle("horizontalAlign"),i=Math.max("left"==c?i:"right"==c?t-s-r-a-o-h:(t-h-i-s-o-r-a)/2+i,0),h=this.getStyle("verticalAlign"),d=Math.max("top"==h?0:"bottom"==h?e-d-0+2:(e-d-0-0)/2+0,0),this._checkBox.setX(Math.round(i)),this._checkBox.setY(Math.round(d)),this._sortItemRendererInstance&&(n=(e-n-0-0)/2+0,this._sortItemRendererInstance.setX(Math.round(t-r-s)),this._sortItemRendererInstance.setY(Math.round(n))),this._filterIcon&&this._filterIcon.getVisible()&&(s=t-r-a-s,l=(e-l-0-0)/2,(r=this._getFieldFilterInfo())?(this._filterIcon.setToolTip(r.str),this._filterIcon.setSrc(Ma+"funnelS.png")):(this._filterIcon.setToolTip(null),this._filterIcon.setSrc(Ma+"funnel.png")),this._filterIcon.setX(Math.round(s)),this._filterIcon.setY(Math.round(l))),this._sortItemRendererInstance&&(this._grid.getSortExpertMode()||this._data instanceof fb?this._ldiv&&this._ldiv.setVisibility(!1):this._partsSeparatorSkinClass?(this._partsSeparatorSkin.setX(this._sortItemRendererInstance.getX()-o-this._partsSeparatorSkin.getWidth()),this._partsSeparatorSkin.y=(e-this._partsSeparatorSkin.getHeight())/2):(this._ldiv?this._ldiv.setVisibility(!0):(this._ldiv=new A("div","DataGridLineV"),this.addChild(this._ldiv)),this._ldiv.setStyle("borderColor",this.getStyle("separatorColor")?this.getStyle("separatorColor"):"#CCCCCC"),this._ldiv.setX(this._sortItemRendererInstance.getX()-1),this._ldiv.setY(1),this._ldiv.setHeightInline(e-1)))}},Ab.prototype.mouseEventToHeaderPart=function(t){return Wa.prototype.mouseEventToHeaderPart.call(this,t)},Ab.prototype._getFieldSortInfo=function(){return Wa.prototype._getFieldSortInfo.call(this)},Ab.prototype._getFieldFilterInfo=function(){return Wa.prototype._getFieldFilterInfo.call(this)},Ab.prototype._getCheckBox=function(){return this._checkBox},Ab.prototype._checkDataField=function(){if(this._listData){var t,e,i,s,r=0,n=this._grid.getDataProvider();if(null!=n){var o=n.getLength();for(t=0,e=n.getLength();t<e;t++)if(i=n.getItemAt(t),this._data instanceof C&&null!=this._data.getSecondLabelFunction()&&!this._data.itemToSecondLabel(i))o--;else{if(E(i))try{s=G.getProperty(i,this._dataField)}catch(a){s=!1}else s=i[this._dataField];if(F(s)&&"true"==s)r++;else{if(!this._checkBox._convertToBool(s))break;r++}}0<r&&r==o?this._checkBox.setSelected(!0):this._checkBox.setSelected(!1)}}},Ab.prototype._dragStartHandler=function(t){Wa.prototype._dragStartHandler.call(this,t)},Ab.prototype._selectStartHandler=function(t){Wa.prototype._selectStartHandler.call(this,t)},Ab.prototype._checkBoxMouseUpDownHandler=function(t){t.stopImmediatePropagation()},Ab.prototype._checkBoxChangeHandler=function(t){if(this._enabled){var e,i,s,r,n=this._checkBox.getSelected(),o=n.toString(),a=!1,l=this._grid.getDataProvider();if(null!=l){for(i=l.getLength(),e=0;e<i;e++)s=l.getItemAt(e),this._data instanceof C&&null!=this._data.getSecondLabelFunction()&&!this._data.itemToSecondLabel(s)||(E(s)?(r=G.getProperty(s,this._dataField),r!=o&&(G.setProperty(s,this._dataField,o),this._grid.dispatchEvent(new K(K.ITEM_VALUE_CHANGE,(!1),(!1),this._listData.columnIndex,this._dataField,e,"other",this,NaN,(!1),(!1),s,t)),a=!0)):(r=s[this._dataField],I(r)?(s[this._dataField]=n,this._grid.dispatchEvent(new K(K.ITEM_VALUE_CHANGE,(!1),(!1),this._listData.columnIndex,this._dataField,e,"other",this,NaN,(!1),(!1),s,t)),a=!0):bb(r)?r!=n&&(s[this._dataField]=n,this._grid.dispatchEvent(new K(K.ITEM_VALUE_CHANGE,(!1),(!1),this._listData.columnIndex,this._dataField,e,"other",this,NaN,(!1),(!1),s,t)),a=!0):r!=o&&(s[this._dataField]=o,this._grid.dispatchEvent(new K(K.ITEM_VALUE_CHANGE,(!1),(!1),this._listData.columnIndex,this._dataField,e,"other",this,NaN,(!1),(!1),s,t)),a=!0)));a&&(this._grid.invalidateList(),l.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"update")),this._data instanceof C&&(e=new Bc(Bc.HEADER_CHANGE,(!1),(!1),this._listData.columnIndex,(-1),null,this._checkBox),this._data.dispatchEvent(e)))}}t.stopImmediatePropagation()},z(tb,u),tb.prototype.getData=function(){return this._data},tb.prototype.setData=function(t){this._data=t,this._checkDataField()},tb.prototype.getSortItemRenderer=function(){return this._sortItemRenderer},tb.prototype.setSortItemRenderer=function(t){this._sortItemRenderer=t,this._sortItemRendererChanged=!0,this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("sortItemRendererChanged"))},tb.prototype.getListData=function(){return this._listData},tb.prototype.setListData=function(t){t&&(this._listData=t,this._grid=this._listData.owner),this.invalidateProperties()},tb.prototype.createChildren=function(){tb._super.createChildren.call(this),this._checkBox||(this._checkBox=new Ka,this.addChild(this._checkBox),this._checkBox.setStyleName(this),this._checkBox.addEventListener("change",this._checkBoxChangeHandler,this),this._checkBox._chkBoxElm.addEvent("mousedown",this._checkBoxMouseUpDownHandler,this),this._checkBox._chkBoxElm.addEvent("mouseup",this._checkBoxMouseUpDownHandler,this),this._checkBox.setTabIndex(-1))},tb.prototype.commitProperties=function(){if(tb._super.commitProperties.call(this),null!=this._data&&(this._checkBox.setLabel(this._listData.label?this._listData.label:""),this._data instanceof Aa)){this._column=this._data;var t=this._grid.getShowDataTips();1==this._column.getShowDataTips()&&(t=!0),0==this._column.getShowDataTips()&&(t=!1),t&&(this._column.getDataTipFunction()||this._column.getDataTipField()||this._grid.getDataTipFunction()||this._grid.getDataTipField())&&this._column.itemToDataTip(this._data),Xb&&(this.setAttr("aria-label",B.getString("datagrid","ariaSelectAll")),this._checkBox._chkBoxElm.setAttr("aria-label",B.getString("datagrid","ariaSelectAll")))}this._sortItemRendererInstance&&U(this._sortItemRendererInstance.invalidateProperties)&&this._sortItemRendererInstance.invalidateProperties()},tb.prototype.measure=function(){tb._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._checkBox.getExplicitOrMeasuredWidth():this._explicitWidth,e=this._checkBox.getExplicitOrMeasuredHeight(),e=Math.max(e,0),this.measuredMinWidth=this.measuredWidth=t+(i+s),this.measuredMinHeight=this.measuredHeight=e+(r+n)},tb.prototype.updateDisplayList=function(t,e){if(tb._super.updateDisplayList.call(this,t,e),0!=t){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._checkBox.measuredMinWidth,a=t-i-s;0>a&&(a=0),a<o&&(o=a);var a=this._checkBox.measuredMinHeight,l=e-r-n;l<a&&(a=l),this._checkBox.setActualSize(o,a),l=this.getStyle("horizontalAlign"),i=Math.max("left"==l?i:"right"==l?t-s-o:(t-o-i-s)/2+i,0),s=this.getStyle("verticalAlign"),r=Math.max("top"==s?r:"bottom"==s?e-a-n+2:(e-a-n-r)/2+r,0),this._checkBox.setX(Math.round(i)),this._checkBox.setY(Math.round(r)),this._data&&this.getParent()&&(r=this._enabled?this._grid.isItemHighlighted(this._listData.uid)?this._grid.getStyle("textRollOverColor"):this._grid.isItemSelected(this._listData.uid)?this._grid.getStyle("textSelectedColor"):this.getStyle("color"):this.getStyle("disabledColor"),this._checkBox.setStyle("color",r))}},tb.prototype.focus=function(){this._checkBox?this._checkBox.focus():Ub._super.focus.call(this)},tb.prototype.mouseEventToHeaderPart=function(t){return t=new ra(t.pageX,t.pageY),t=this.globalToLocal(t),t.x<this._sortItemRendererInstance.getX()?"headerTextPart":"headerIconPart"},tb.prototype._getFieldSortInfo=function(){return this._grid.getFieldSortInfo(this._grid._columns[this._listData.columnIndex])},tb.prototype._checkDataField=function(){this._column&&this._checkBox.setSelected(this._column.getAllItemSelected())},tb.prototype._getCheckBox=function(){return this._checkBox},tb.prototype._checkBoxMouseUpDownHandler=function(t){t.stopImmediatePropagation()},tb.prototype._checkBoxChangeHandler=function(t){this._enabled&&this._column&&this._column.setAllItemSelected(this._checkBox.getSelected()),t.stopImmediatePropagation()},z(nc,qa),nc.prototype.getListData=function(){return this._listData},nc.prototype.setListData=function(t){this._listData!=t&&(this._listData=t,this._listDataChanged=!0,this.invalidateProperties())},nc.prototype.getSelected=function(){return this._checkBox.getSelected()},nc.prototype.setSelected=function(t){this._checkBox.setSelected(t),this.invalidateProperties()},nc.prototype.createChildren=function(){nc._super.createChildren.call(this),this._checkBox||(this._checkBox=new Ka,this._checkBox.setStyleName(this),this.addChild(this._checkBox),this._checkBox.addEventListener("change",this._checkBoxChangeHandler,this),this._checkBox.setTabIndex(-1))},nc.prototype.commitProperties=function(){if(nc._super.commitProperties.call(this),this._listDataChanged){if(this._listData){var t,e=this._listData.owner,i=e.getColumns()[this._listData.columnIndex],s=i.getDataField();if(p(i.trueValue)||(this._checkBox.trueValue=i.trueValue),p(i.falseValue)||(this._checkBox.falseValue=i.falseValue),E(this._data))try{t=G.getProperty(this._data,s)}catch(r){t=!1}else t=this._data[s];F(t)&&"true"==t&&(t=!0),this._checkBox.getSelected()!=t&&this._checkBox.setSelected(t),t=!0,(null!=i.getSecondLabelFunction()||i.getSecondDataField())&&(t=i.itemToSecondLabel(this._data)),this._checkBox.setEnabled(e.getEnabled()&&e.getEditable().length&&i.editable&&t&&!e.isItemDeleted(this._listData.uid)),this.setEnabled(this._checkBox.getEnabled()),t=e.getShowDataTips();var n;i&&1==i.getShowDataTips()&&(t=!0),i&&0==i.getShowDataTips()&&(t=!1),t&&!this._data&&(i.getDataTipFunction()||i.getDataTipField()||e.getDataTipFunction()||e.getDataTipField())&&(n=i.itemToDataTip(this._data)),n?this.element.title!=n&&(this.element.title=n):""!=this.element.title&&(this.element.title="")}this._listDataChanged=!1}},nc.prototype.measure=function(){nc._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._checkBox.getExplicitOrMeasuredWidth():this._explicitWidth-i-s,e=this._checkBox.getExplicitOrMeasuredHeight(),t=Number(t)+i+s,i=Number(e)+r+n,this.measuredMinWidth=this.measuredWidth=t,this.measuredMinHeight=this.measuredHeight=i},nc.prototype.updateDisplayList=function(t,e){nc._super.updateDisplayList.call(this,t,e);var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._checkBox.measuredMinWidth,a=t-i-s;a<o&&(o=a);var a=this._checkBox.measuredMinHeight,l=e-r-n;l<a&&(a=l),l=this.getStyle("textAlign"),i="center"==l?(t-o-i-s)/2+i:"right"==l?t-s-o:i,this._checkBox.setStyle("textAlign",l),i=Math.max(i,0),r=Math.max((e-a-r-n)/2+r,0),this._checkBox.setX(Math.round(i)),this._checkBox.setY(Math.round(r))},nc.prototype.focus=function(){this._checkBox?this._checkBox.focus():nc._super.focus.call(this)},nc.prototype._reset=function(){this._listDataChanged=!0,this.invalidateProperties()},nc.prototype._checkBoxChangeHandler=function(t){var e=this;if(e._enabled){if(e._listData&&e._listData.owner.itemEditorInstance&&e._listData.owner.itemEditorInstance!=e&&(e._reset(),t.stopImmediatePropagation()),e._listData&&(t=e._listData.owner._columns[e._listData.columnIndex])&&t.updateImmediatelyAfterChange){var i=e._listData.owner.getEditedItemPosition();i?(e._listData.owner._endEdit("other"),e._listData.owner.setEditedItemPosition(i)):e.callLater(function(){i=e._listData.owner.getEditedItemPosition(),e._listData.owner._endEdit("other"),e._listData.owner.setEditedItemPosition(i)})}}else t.stopImmediatePropagation()},z(Vb,qa),Vb.prototype.getListData=function(){return this._listData},Vb.prototype.setListData=function(t){(this._listData=t)&&(this._dataGrid=t.owner,this._column=this._dataGrid._columns[this._listData.columnIndex]),this._listDataChanged=!0,this.invalidateProperties()},Vb.prototype.getSelected=function(){return this._checkBox.getSelected()},Vb.prototype.setSelected=function(t){this._checkBox.setSelected(t),this.invalidateProperties()},Vb.prototype.createChildren=function(){Vb._super.createChildren.call(this),this._checkBox||(this._checkBox=new Ka,this._checkBox.setStyleName(this),this.addChild(this._checkBox),this._checkBox.addEventListener("change",this._checkBoxChangeHandler,this),
this._checkBox.setTabIndex(-1))},Vb.prototype.commitProperties=function(){if(Vb._super.commitProperties.call(this),this._listData){if(this._listDataChanged){if(this._checkBox.hasEventListener("change")&&this._checkBox.removeEventListener("change",this._checkBoxChangeHandler,this),this._checkBox.addEventListener("change",this._checkBoxChangeHandler,this),Xb){var t,e;this._column&&0==this._column.colNum?(t="rowheader",e=this._dataGrid._getRowItemIds(this._listData.rowIndex),this._checkBox._chkBoxElm.setAttr("aria-labelledby",e),this.setAttr("aria-labelledby",e)):(t="gridcell",this._checkBox._chkBoxElm.setAttr("aria-label",B.getString("datagrid","ariaRowSelect")),this.setAttr("aria-label",B.getString("datagrid","ariaRowSelect"))),this.setAttr("id",this.name),this.setAttr("role",t),this._checkBox.setAttr("role",t)}this._listDataChanged=!1}null!=this._column.getSecondLabelFunction()?this._checkBox.setEnabled(this._column.itemToSecondLabel(this._data)):this._checkBox.setEnabled(!0),this.setEnabled(this._checkBox.getEnabled()),this._checkBox.getEnabled()?this._checkBox.setSelected(this._column.isItemSelectedByUID(this._listData.uid)):this._checkBox.setSelected(!1);var i;t=this._dataGrid.getShowDataTips(),1==this._column.getShowDataTips()&&(t=!0),0==this._column.getShowDataTips()&&(t=!1),t&&(this._data instanceof C||!(this._column.getDataTipFunction()||this._column.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(i=this._column.itemToDataTip(this._data)),i?this.element.title!=i&&(this.element.title=i):""!=this.element.title&&(this.element.title=""))}},Vb.prototype.measure=function(){Vb._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._checkBox.getExplicitOrMeasuredWidth():this._explicitWidth,e=this._checkBox.getExplicitOrMeasuredHeight(),this.measuredMinWidth=this.measuredWidth=t+(i+s),this.measuredMinHeight=this.measuredHeight=e+(r+n)},Vb.prototype.updateDisplayList=function(t,e){Vb._super.updateDisplayList.call(this,t,e);var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._checkBox.measuredMinWidth,a=t-i-s;a<o&&(o=a),a=this._checkBox.measuredMinHeight,r=e-r-n,r<a&&(a=r),this._checkBox.setActualSize(o,a),r=this.getStyle("textAlign"),i=Math.max("center"==r?(t-o-i-s)/2+i:"right"==r?t-s-o:i,0),this._checkBox.setStyle("textAlign",r),this._checkBox.setX(Math.round(i))},Vb.prototype.focus=function(){this._checkBox?this._checkBox.focus():Vb._super.focus.call(this)},Vb.prototype._checkBoxChangeHandler=function(t){this._enabled?this._checkBox.getSelected()?this._column._addSelectedItem(this._listData.uid,this._listData.item,this._listData.rowIndex,this):this._column._removeSelectedItem(this._listData.uid,this):t.stopImmediatePropagation()},z(rd,za),rd.prototype.getData=function(){return this._data},rd.prototype.setData=function(t){this._data=t,this._dataChanged=!0,this.invalidateProperties()},rd.prototype.setListData=function(t){t&&(this._listData=t,this._dataGrid=t.owner,this._dataField=t.dataField),this.invalidateProperties(),this.invalidateSize()},rd.prototype.getSelectedDataField=function(){if(this._listData&&this._selectedItem){var t=this._dataGrid._columns[this._listData.columnIndex];if(t instanceof C)return t.getItemRendererDataField()?E(this._selectedItem)?G.hasElementProperty(this._selectedItem,t.getItemRendererDataField())?G.getProperty(this._selectedItem,t.getItemRendererDataField()):this.getSelectedLabel():this._selectedItem.hasOwnProperty(t.getItemRendererDataField())?this._selectedItem[t.getItemRendererDataField()]:this.getSelectedLabel():this.getSelectedLabel()}return this._data?this._data[this._dataField]:this.getSelectedLabel()},rd.prototype.commitProperties=function(){var t=this._listData;if(t&&(t=this._dataGrid.getColumns()[t.columnIndex],this._dataChanged)){var e=!1;if(t instanceof C){if(t.getItemRendererLabelField()&&this.setLabelField(t.getItemRendererLabelField()),t.getItemRendererDataProvider())this.setDataProvider(t.getItemRendererDataProvider()),e=!0;else if(t.getItemRendererDataProviderField())if(E(this._data)){var i=G.getElement(this._data,t.getItemRendererDataProviderField());i&&(this.setDataProvider(i),e=!0)}else this.setDataProvider(this._data[t.getItemRendererDataProviderField()]),e=!0;if(e){var s=t.itemToData(this._data);if(t.getItemRendererDataField()){for(i=0;i<this.getDataProvider().getLength();i++)if(this.getDataProvider().getPropertyAt(i,t.getItemRendererDataField())==s){this.setSelectedIndex(i);break}}else if(this.setSelectedItem(s),0>this.getSelectedIndex())for(i=0;i<this.getDataProvider().getLength();i++)if(this.itemToLabel(this.getDataProvider().getItemAt(i))==s){this.setSelectedIndex(i);break}}}e||this.setDataProvider(t.itemToData(this._data)),this._dataChanged=!1}rd._super.commitProperties.call(this)},z(vb,qa),vb.prototype.setData=function(t){this._data=t,this._dataChanged=!0,this.invalidateProperties(),this.dispatchEvent(new w("dataChange"))},vb.prototype.getSortItemRenderer=function(){return this._sortItemRenderer},vb.prototype.setSortItemRenderer=function(t){this._sortItemRenderer=t,this._sortItemRendererChanged=!0,this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("sortItemRendererChanged"))},vb.prototype.getListData=function(){return this._listData},vb.prototype.setListData=function(t){t&&(this._listData=t,this._grid=this._listData.owner,this._dataField=this._listData.dataField),this._listDataChanged=!0,this.invalidateProperties()},vb.prototype.getSelectedIndex=function(){return this._comboBox.getSelectedIndex()},vb.prototype.getSelectedItem=function(){return this._comboBox.getSelectedItem()},vb.prototype.getSelectedLabel=function(){return this._comboBox.getSelectedLabel()},vb.prototype.createChildren=function(){vb._super.createChildren.call(this),this._comboBox||(this._comboBox=new za,this._comboBox.setTabIndex(-1),this._comboBox.setStyle("position","absolute"),this._comboBox.addEventListener("change",this._comboBoxChangeHandler,this),this._comboBox.addEvent("mousedown",this._comboBoxMouseEventHandler,this),this._comboBox.addEvent("mouseup",this._comboBoxMouseEventHandler,this),this.addChild(this._comboBox))},vb.prototype.commitProperties=function(){if(this._listData){vb._super.commitProperties.call(this),this._initialized||this._comboBox.setStyleName(this),this._sortItemRendererInstance&&!this._sortItemRendererChanged||(this._sortItemRenderer||(this._sortItemRenderer=this._grid._sortItemRenderer),this._sortItemRenderer&&(this._sortItemRendererInstance=this._sortItemRenderer.newInstance(),this.addChild(this._sortItemRendererInstance)),this._sortItemRendererChanged=!1);var t=this._partsSeparatorSkinClass;this._partsSeparatorSkinClass&&this._partsSeparatorSkinClass==this._grid.getStyle("headerSortSeparatorSkin")||(this._partsSeparatorSkinClass=this._grid.getStyle("headerSortSeparatorSkin")),(this._grid.getSortExpertMode()||this._partsSeparatorSkinClass!=t)&&(this._partsSeparatorSkin&&this.removeChild(this._partsSeparatorSkin),this._grid.getSortExpertMode()||(this._partsSeparatorSkin=new this._partsSeparatorSkinClass,this.addChild(this._partsSeparatorSkin))),this._partsSeparatorSkin&&this._partsSeparatorSkin.setVisible(!(this._data instanceof fb));var e;this._data?(this._data instanceof C&&(this._column=t=this._data,(this._dataChanged||this._listDataChanged)&&(e=t._rendererData&&t._rendererData.ComboBoxHeaderRenderer?t._rendererData.ComboBoxHeaderRenderer:0,this._data instanceof C&&this._data._headerRendererDataProvider?this._comboBox.getDataProvider()!=this._data._headerRendererDataProvider&&(this._comboBox.setDataProvider(this._data._headerRendererDataProvider),this._data._headerRendererLabelField&&this._comboBox.setLabelField(this._data._headerRendererLabelField),this._comboBox.setSelectedIndex(e)):I(this._comboBox.getDataProvider())&&this.getListData()&&(0<=this.getListData().label.indexOf(",")?(this._comboBox.setDataProvider(this.getListData().label.split(",")),this._comboBox.setSelectedIndex(e)):" "!=this.getListData().label&&(this._comboBox.setDataProvider(this.getListData().label?this.getListData().label:[]),this._comboBox.setSelectedIndex(e))),t.getDataField()&&1==t.filterable?(this._filterIcon||(this._filterIcon=new Ua,this._filterIcon.setAlt(B.getString("datagrid","columnFiltering")),this.addChild(this._filterIcon)),this._filterIcon.setVisible(!0),this._filterIcon.setSrc(Ma+"funnel.png")):this._filterIcon&&(this._filterIcon.setVisible(!1),this._filterIcon.setSrc(null)),this._listDataChanged=this._dataChanged=!1),e=this._grid.getShowDataTips(),1==t.getShowDataTips()&&(e=!0),0==t.getShowDataTips()&&(e=!1),e=e&&(t.getDataTipFunction()||t.getDataTipField()||this._grid.getDataTipFunction()||this._grid.getDataTipField())?t.itemToDataTip(this._data):null),(this.element.draggable=this._grid.headerDragEnabled)?(this.element.style.webkitUserDrag="element",this.addEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.addEvent("selectstart",this._selectStartHandler,this)):(this.element.style.webkitUserDrag="none",this.removeEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.removeEvent("selectstart",this._selectStartHandler,this))):e=null,U(this._sortItemRendererInstance.invalidateProperties)&&this._sortItemRendererInstance.invalidateProperties(),e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title="")}},vb.prototype.measure=function(){if(this._listData){vb._super.measure.call(this);var t=this.getSizeStyle("paddingLeft"),e=this.getSizeStyle("paddingRight"),i=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredWidth():0,s=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredHeight():0;this._grid.getSortExpertMode()&&null==this._getFieldSortInfo()&&(s=i=0);var r=this.getSizeStyle("horizontalGap"),n=0;this._filterIcon&&this._filterIcon.getVisible()&&(n=16),0==i&&0==n&&(r=0);var o,a;isNaN(this._explicitWidth)?(o=this._comboBox.getExplicitOrMeasuredWidth(),a=this._comboBox.getExplicitOrMeasuredHeight(),i=o+n+r+(this._partsSeparatorSkin?this._partsSeparatorSkin.width:0)+i):(i=this._explicitWidth,a=this._comboBox.getExplicitOrMeasuredHeight()),s=Math.max(a,s),s=Math.max(s,this._partsSeparatorSkin?this._partsSeparatorSkin.height:0),this.measuredMinWidth=this.measuredWidth=i+(t+e),this.measuredMinHeight=this.measuredHeight=s+0}},vb.prototype.updateDisplayList=function(t,e){if(this._listData&&(vb._super.updateDisplayList.call(this,t,e),0!=t)){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredWidth():0,n=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredHeight():0;this._sortItemRendererInstance&&this._sortItemRendererInstance.setActualSize(r,n),this._grid.getSortExpertMode()&&null==this._getFieldSortInfo()&&(n=r=0);var o=this.getSizeStyle("horizontalGap"),a=0,l=0;this._filterIcon&&this._filterIcon.getVisible()&&(l=a=16),0==r&&0==a&&(o=0);var h=this._comboBox.measuredWidth,d=t-r-a-o-i-s;0>d&&(d=0),d<h&&(h=d);var d=this._comboBox.measuredHeight,c=e-0-0;c<d&&(d=c),this._comboBox.setActualSize(h,d),c=this.getStyle("horizontalAlign"),i=Math.max("left"==c?i:"right"==c?t-s-r-a-o-h:(t-h-i-s-o-r-a)/2+i,0),h=this.getStyle("verticalAlign"),d=Math.max("top"==h?0:"bottom"==h?e-d-0+2:(e-d-0-0)/2+0,0),this._comboBox.setX(Math.round(i)),this._comboBox.setY(Math.floor(d)),this._sortItemRendererInstance&&(n=(e-n-0-0)/2+0,this._sortItemRendererInstance.setX(Math.round(t-r-s)),this._sortItemRendererInstance.setY(Math.round(n))),this._filterIcon&&this._filterIcon.getVisible()&&(s=t-r-a-s,l=(e-l-0-0)/2,(r=this._getFieldFilterInfo())?(this._filterIcon.setToolTip(r.str),this._filterIcon.setSrc(Ma+"funnelS.png")):(this._filterIcon.setToolTip(null),this._filterIcon.setSrc(Ma+"funnel.png")),this._filterIcon.setX(Math.round(s)),this._filterIcon.setY(Math.round(l))),this._sortItemRendererInstance&&(this._grid.getSortExpertMode()||this._data instanceof fb?this._ldiv&&this._ldiv.setVisibility(!1):this._partsSeparatorSkinClass?(this._partsSeparatorSkin.setX(this._sortItemRendererInstance.getX()-o-this._partsSeparatorSkin.getWidth()),this._partsSeparatorSkin.setY((e-this._partsSeparatorSkin.getHeight())/2)):(this._ldiv?this._ldiv.setVisibility(!0):(this._ldiv=new A("div","DataGridLineV"),this.addChild(this._ldiv)),this._ldiv.setStyle("borderColor",this.getStyle("separatorColor")?this.getStyle("separatorColor"):"#CCCCCC"),this._ldiv.setX(this._sortItemRendererInstance.getX()-1),this._ldiv.setY(1),this._ldiv.setHeightInline(e-1)))}},vb.prototype.mouseEventToHeaderPart=function(t){return Wa.prototype.mouseEventToHeaderPart.call(this,t)},vb.prototype._getFieldSortInfo=function(){return Wa.prototype._getFieldSortInfo.call(this)},vb.prototype._getFieldFilterInfo=function(){return Wa.prototype._getFieldFilterInfo.call(this)},vb.prototype._getComboBox=function(){return this._comboBox},vb.prototype._dragStartHandler=function(t){Wa.prototype._dragStartHandler.call(this,t)},vb.prototype._selectStartHandler=function(t){Wa.prototype._selectStartHandler.call(this,t)},vb.prototype._comboBoxMouseEventHandler=function(t){t.stopImmediatePropagation()},vb.prototype._comboBoxChangeHandler=function(t){if(this._enabled){if(this._data instanceof C){t=new Bc(Bc.HEADER_LIST_CHANGE,(!1),(!1),this._listData.columnIndex,this._comboBox._selectedIndex,null,this._comboBox);var e=this._data;e._rendererData&&(e._rendererData[this.className]=this._comboBox._selectedIndex),e.dispatchEvent(t)}}else t.stopImmediatePropagation()},z(Qb,qa),Qb.prototype.getData=function(){return this._data},Qb.prototype.setData=function(t){this._data=t,this._dataChanged=!0,this.invalidateProperties()},Qb.prototype.getListData=function(){return this._listData},Qb.prototype.setListData=function(t){this._listData!=t&&((this._listData=t)&&(this._dataGrid=t.owner,this._dataField=t.dataField),this._listDataChanged=!0,this.invalidateProperties())},Qb.prototype.getSelectedDataField=function(){if(this._listData&&this._comboBox.getSelectedItem()){var t=this._dataGrid.getColumns()[this._listData.columnIndex];if(t)return t.getItemRendererDataField()?E(this._comboBox.getSelectedItem())?G.hasElementProperty(this._comboBox.getSelectedItem(),t.getItemRendererDataField())?G.getProperty(this._comboBox.getSelectedItem(),t.getItemRendererDataField()):this._comboBox.getSelectedLabel():this._comboBox.getSelectedItem().hasOwnProperty(t.getItemRendererDataField())?this._comboBox.getSelectedItem()[t.getItemRendererDataField()].toString():this._comboBox.getSelectedLabel():this._comboBox.getSelectedLabel()}return this._data?this._data[this._dataField]:this._comboBox.getSelectedLabel()},Qb.prototype.getText=function(){return this._comboBox.getSelectedLabel()},Qb.prototype.createChildren=function(){Qb._super.createChildren.call(this),this._comboBox||(this._comboBox=new za,this._comboBox.setTabIndex(-1),this._comboBox.setStyleName(this),this.addChild(this._comboBox))},Qb.prototype.commitProperties=function(){var t;if(Qb._super.commitProperties.call(this),this._dataChanged||this._listDataChanged){if(this._listData){var e=this._dataGrid._columns[this._listData.columnIndex];this._dataChanged&&(this._comboBox.hasEventListener(L.CHANGE)&&this._comboBox.removeEventListener(L.CHANGE,this.comboBoxListChangeHandler,this),this._comboBox.addEventListener(L.CHANGE,this.comboBoxListChangeHandler,this),this._dataChanged=!1);var i,s=!1;if(e instanceof C)if(e.getItemRendererLabelField()&&this._comboBox.setLabelField(e.getItemRendererLabelField()),e.getItemRendererDataProvider()?(this._comboBoxDataprovider!=e.getItemRendererDataProvider()&&this._comboBox.setDataProvider(e.getItemRendererDataProvider()),this._comboBoxDataprovider=e.getItemRendererDataProvider(),s=!0):e.getItemRendererDataProviderField()&&(i=E(this._data)?G.getElement(this._data,e.getItemRendererDataProviderField()):this._data[e.getItemRendererDataProviderField()])&&(this._comboBox.setDataProvider(i),s=!0),s){var s=e.itemToData(this._data),r=!1;if(e.getItemRendererDataField()){for(i=0;i<this._comboBox.getDataProvider().getLength();i++)if(this._comboBox.getDataProvider().getPropertyAt(i,e.getItemRendererDataField())==s){this._comboBox.getSelectedIndex()!=i&&this._comboBox.setSelectedIndex(i),r=!0;break}}else if(this._comboBox.getSelectedLabel()!=s){for(i=0;i<this._comboBox.getDataProvider().getLength();i++)if(this._comboBox.itemToLabel(this._comboBox.getDataProvider().getItemAt(i))==s){this._comboBox.getSelectedIndex()!=i&&this._comboBox.setSelectedIndex(i),r=!0;break}}else r=!0;r||this._comboBox.setSelectedIndex(-1)}else this._comboBox.setDataProvider(e.itemToData(this._data));i=!0,(null!=e.getSecondLabelFunction()||e.getSecondDataField())&&(i=e.itemToSecondLabel(this._data)),this._comboBox.setEnabled(this._dataGrid.getEnabled()&&this._dataGrid.getEditable().length&&e.editable&&i&&!this._dataGrid.isItemDeleted(this._listData.uid)),i=this._dataGrid.getShowDataTips(),1==e.getShowDataTips()&&(i=!0),0==e.getShowDataTips()&&(i=!1),i&&(this._data instanceof C||!(e.getDataTipFunction()||e.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(t=this._comboBox.getSelectedLabel()))}t?this.element.title!=t&&(this.element.title=t):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},Qb.prototype.measure=function(){if(this._comboBox){Qb._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._comboBox.getExplicitOrMeasuredWidth():this._explicitWidth-i-s,e=this._comboBox.getExplicitOrMeasuredHeight(),this.measuredMinWidth=this.measuredWidth=t+(i+s),this.measuredMinHeight=this.measuredHeight=e+(r+n)}},Qb.prototype.updateDisplayList=function(t,e){if(this._comboBox){Qb._super.updateDisplayList.call(this,t,e);var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight");this._comboBox.setActualSize(t-i-s,e),this._comboBox.setX(i)}},Qb.prototype.focus=function(){this._comboBox?this._comboBox.element!=document.activeElement&&this._comboBox.element.querySelector&&this._comboBox.element.parentElement.querySelector(":hover")!=this._comboBox.element&&this._comboBox.focus():Qb._super.focus.call(this)},Qb.prototype._reset=function(){this._listDataChanged=!0,this.invalidateProperties()},Qb.prototype.comboBoxListChangeHandler=function(t){this._enabled?(this._dataGrid&&this._dataGrid.itemEditorInstance&&this._dataGrid.itemEditorInstance!=this&&(this._reset(),t.stopImmediatePropagation()),this._listData&&(t=this._listData.owner._columns[this._listData.columnIndex])&&t.updateImmediatelyAfterChange&&(t=this._listData.owner.getEditedItemPosition(),this._listData.owner._endEdit("other"),this._listData.owner.setEditedItemPosition(t))):t.stopImmediatePropagation()};var Bb=function(t){this.element=this.element?this.element:"div",this.className=this.className?this.className:"DataGridBaseContentHolder",u.call(this,this.element,this.className),this._useDelayInvalidate=!0,this.bottomOffset=this.rightOffset=this.topOffset=this.leftOffset=0,this._parentList=0<arguments.length?t:void 0,this._allowItemSizeChangeNotification=!0,"DataGridBaseContentHolder"==this.className&&(this.element.style.backgroundColor="",this.element.style.borderStyle="none"),this.element.style.position="absolute",this.element.style.overflow="hidden"};z(Bb,u),Bb.prototype.setFocusPane=function(t){t?(this._maskShape||(this._maskShape=new A,this._maskShape.name="mask",this.addChild(this._maskShape)),this._maskShape.visible=!1,t.mask=this._maskShape):this._parentList.getFocusPane().mask==this._maskShape&&(this._parentList.getFocusPane().mask=null),this._parentList.setFocusPane(t),t.x=this.getX(),t.y=this.getY()},Bb.prototype.getScrollRect=function(){return this._scrollRect},Bb.prototype.setScrollRect=function(t){var e=this.element,i=m;if(this._scrollRect!=t){if(this._scrollRect=t){this._oriWidth!=t.width&&i.setPxStyle(e,"width",t.width),this._oriHeight!=t.height&&i.setPxStyle(e,"height",t.height);var i=e.clientWidth,s=e.scrollHeight,r=e.clientHeight;e.scrollWidth-i<t.x&&this._setScroller(t.x+i,null),e.scrollLeft=t.x,s-r<t.y&&this._setScroller(null,t.y+r),e.scrollTop=t.y}else e.scrollLeft=0,e.scrollTop=0,this._resetScroller(),p(this._oriWidth)||i.setPxStyle(e,"width",this._oriWidth),p(this._oriHeight)||i.setPxStyle(e,"height",this._oriHeight);this.invalidateDisplayList()}},Bb.prototype.getWidth=function(){return p(this._oriWidth)?Bb._super.getWidthInline.call(this):this._oriWidth},Bb.prototype.setWidth=function(t){return this._oriWidth=t,Bb._super.setWidthInline.call(this,t)},Bb.prototype.getHeight=function(){return p(this._oriHeight)?Bb._super.getHeightInline.call(this):this._oriHeight},Bb.prototype.setHeight=function(t){return this._oriHeight=t,Bb._super.setHeight.call(this,t)},Bb.prototype._getParentList=function(){return this._parentList},Bb.prototype._setScroller=function(t,e){this._scroller||(this._scroller=new A,this._scroller.setStyle("position","absolute"),this._scroller.setWidth(1),this._scroller.setHeight(1),this.addChild(this._scroller)),p(t)||this._scroller.setX(t-1),p(e)||this._scroller.setY(e-1)},Bb.prototype._resetScroller=function(){this._scroller&&(this._scroller.setX(0),this._scroller.setY(0))},Bb.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i=m,s=!1;this.getHeight()!=e&&(i.setPxStyle(this,"height",e),s=!0),this.getWidth()!=t&&(i.setPxStyle(this,"width",t),s=!0),this._oriWidth=t,this._oriHeight=e,s&&this.invalidateDisplayList()}},Bb.prototype.invalidateSize=function(){this._allowItemSizeChangeNotification&&this._parentList&&this._parentList.invalidateList()},Bb.prototype.updateDisplayList=function(t,e){Bb._super.updateDisplayList.call(this,t,e),this._maskShape&&(this._maskShape.setWidth(t),this._maskShape.setHeight(e))},Bb.prototype.getHeightExcludingOffsets=function(){return this.getHeight()+this.topOffset-this.bottomOffset},Bb.prototype.getWidthExcludingOffsets=function(){return this.getWidth()+this.leftOffset-this.rightOffset};var ye=function(t,e,i,s){this.approximate=s,this.data=t,this.rowIndex=e,this.columnIndex=i},Se=function(t,e,i,s,r,n,o,a,l){this.index=t,this.anchorIndex=e,this.columnIndex=i,this.stopData=r,this.transition=n,this.placeHolder=o,this.bookmark=a,this.offset=l};C._defaultStyles={editableIcon:"editable",paddingLeft:"8px",paddingRight:"8px",iconPlacement:void 0,icon:void 0},z(C,kc),C.prototype.getItemRenderer=function(){return this._itemRenderer},C.prototype.setItemRenderer=function(t){this._itemRenderer=t,this.owner&&(this.owner.invalidateList(),this.owner._columnRendererChanged(this))},C.prototype.getDataField=function(){return this._dataField},C.prototype.setDataField=function(t){this._dataField=t,this.owner&&this.owner.invalidateList()},C.prototype.getDataTipField=function(){return this._dataTipField},C.prototype.setDataTipField=function(t){this._dataTipField=t,this.owner&&this.owner.invalidateList()},C.prototype.getDataTipFunction=function(){return this._dataTipFunction},C.prototype.setDataTipFunction=function(t){this._dataTipFunction=t,this.owner&&this.owner.invalidateList()},C.prototype.getFormatter=function(){return this._formatter},C.prototype.setFormatter=function(t){this._formatter=t,this.owner&&this.owner.invalidateList()},C.prototype.getHeaderColSpan=function(){return this._headerColSpan},C.prototype.setHeaderColSpan=function(t){this._headerColSpan=t,this.owner&&(this.owner._columnsInvalid=!0,this.owner.invalidateProperties(),this.owner.invalidateSize(),this.owner.invalidateList())},C.prototype.getHeaderLabelFunction=function(){return this._headerLabelFunction},C.prototype.setHeaderLabelFunction=function(t){this._headerLabelFunction=t,this.owner&&this.owner.invalidateList()},C.prototype.getHeaderRenderer=function(){return this._headerRenderer},C.prototype.setHeaderRenderer=function(t){this._headerRenderer=t,this.owner&&(this.owner.invalidateList(),this.owner._columnRendererChanged(this))},C.prototype.getHeaderText=function(){return this._headerText},C.prototype.setHeaderText=function(t){this._headerText=t,this.owner&&this.owner.invalidateList()},C.prototype.getHeaderWordWrap=function(){return this._headerWordWrap},C.prototype.setHeaderWordWrap=function(t){this._headerWordWrap=t,this.owner&&this.owner.invalidateList()},C.prototype.getHeaderRendererDataProvider=function(){return this._headerRendererDataProvider},C.prototype.setHeaderRendererDataProvider=function(t){this._headerRendererDataProvider=t,this.owner&&this.owner.invalidateList()},C.prototype.getHeaderRendererLabelField=function(){return this._headerRendererLabelField},C.prototype.setHeaderRendererLabelField=function(t){this._headerRendererLabelField=t,this.owner&&this.owner.invalidateList()},C.prototype.getItemRendererDataField=function(){return this._itemRendererDataField},C.prototype.setItemRendererDataField=function(t){this._itemRendererDataField=t,this.owner&&this.owner.invalidateList()},C.prototype.getItemRendererDataProvider=function(){return this._itemRendererDataProvider},C.prototype.setItemRendererDataProvider=function(t){this._itemRendererDataProvider=t,this.owner&&this.owner.invalidateList()},C.prototype.getItemRendererDataProviderField=function(){return this._itemRendererDataProviderField},C.prototype.setItemRendererDataProviderField=function(t){this._itemRendererDataProviderField=t,this.owner&&this.owner.invalidateList()},C.prototype.getItemRendererLabelField=function(){return this._itemRendererLabelField},C.prototype.setItemRendererLabelField=function(t){this._itemRendererLabelField=t,this.owner&&this.owner.invalidateList()},C.prototype.getLabelFunction=function(){return this._labelFunction},C.prototype.setLabelFunction=function(t){this._labelFunction=t,this.owner&&this.owner.invalidateList()},C.prototype.getMinWidth=function(){return this._minWidth},C.prototype.setMinWidth=function(t){this._minWidth=Number(t),this.owner&&this.owner.invalidateList(),this._width<t&&(this._width=t)},C.prototype.getSecondDataField=function(){return this._secondDataField},C.prototype.setSecondDataField=function(t){this._secondDataField=t,this.owner&&this.owner.invalidateList(),this.dispatchEvent(new w("dataFieldChanged"))},C.prototype.getSecondLabelFunction=function(){return this._secondLabelFunction},C.prototype.setSecondLabelFunction=function(t){this._secondLabelFunction=t,this.owner&&this.owner.invalidateList(),this.dispatchEvent(new w("dataFieldChanged"))},C.prototype.getShowDataTips=function(){return this._showDataTips},C.prototype.setShowDataTips=function(t){this._showDataTips=t,this.owner&&this.owner.invalidateList()},C.prototype.getSortCompareFunction=function(){return this._sortCompareFunction},C.prototype.setSortCompareFunction=function(t){this._sortCompareFunction=t},C.prototype.getSpanable=function(){return this._spanable},C.prototype.setSpanable=function(t){this._spanable=t,this.owner&&this.owner.invalidateList()},C.prototype.getStyleFunction=function(){return this._styleFunction},C.prototype.setStyleFunction=function(t){this._styleFunction=t,this.owner&&this.owner.invalidateList()},C.prototype.getTruncateToFit=function(){return this._truncateToFit},C.prototype.setTruncateToFit=function(t){this._truncateToFit=t,this.owner&&this.owner.invalidateList()},C.prototype.getVisible=function(){return this._visible},C.prototype.setVisible=function(t){this._visible!=t&&(this._visible=t,this.owner&&(this.owner._columnsInvalid=!0,this.owner.invalidateProperties(),this.owner.invalidateSize(),this.owner.invalidateList()))},C.prototype.getWidth=function(){return this._width},C.prototype.setWidth=function(t){if(this._preferredWidth=this._explicitWidth=t,null!=this.owner){var e=this.resizable;this.resizable=!1,this.owner._resizeColumn(this.colNum,t),this.resizable=e}else this._width=t},C.prototype._setWidthInternal=function(t){this._width=t},C.prototype.getWordWrap=function(){return this._wordWrap},C.prototype.setWordWrap=function(t){this._wordWrap=t,this.owner&&this.owner.invalidateList()},C.prototype._addStyleToHeaderItem=function(t){var e=this.owner;if(t.getData()&&t.getData()instanceof C){var i=e.getStyle("oldHeaderStyleName");i&&(F(i)?m.removeClass(t.element,i):i instanceof kc&&m.removeClass(t.element,i._cssName)),(e=e.getStyle("headerStyleName"))&&(F(e)?m.addClass(t.element,e):e instanceof kc&&t.setStyleName(e)),(i=this.getStyle("oldHeaderStyleName"))&&(F(i)?m.removeClass(t.element,i):i instanceof kc&&m.removeClass(t.element,i._cssName)),(e=this.getStyle("headerStyleName"))&&(F(e)?m.addClass(t.element,e):e instanceof kc&&t.setStyleName(e))}},C.prototype._applyFormatting=function(t){return null!=this._formatter&&null!=t?(t=this._formatter.format(t),this._formatter.error&&!1===this._formatter.returnValueWhenError?null:t):t},C.prototype.setStyle=function(t,e){C._super.setStyle.call(this,t,e),this.owner&&this.owner.invalidateList()},C.prototype.itemToLabel=function(t,e){e=!(1<arguments.length)||e;var i=this._itemToLabelWithoutFormatting(t);return e?this._applyFormatting(i):i},C.prototype._itemToValue=function(t){var e;if(E(t))try{e=G.getProperty(t,this._dataField)}catch(i){}else if(Ea(t))try{e=t[this._dataField]}catch(i){}else F(t)&&(e=t);return e},C.prototype.itemToData=function(t){var e;return t?(e=this._itemToValue(t),null!=this._labelFunction?this._labelFunction(t,e,this):null!=this.owner.getLabelFunction()?this.owner.getLabelFunction()(t,e,this):e):null},C.prototype._itemToLabelWithoutFormatting=function(t){var e=this.owner?this.owner._getHeaderInfo(this):null;if(e&&null!=e.internalLabelFunction&&(t=e.internalLabelFunction(t,this)),!t)return" ";if(null!=this._labelFunction)return this._labelFunction(t,this._itemToValue(t),this);if(null!=this.owner.getLabelFunction())return this.owner.getLabelFunction()(t,this._itemToValue(t),this);if(E(t))try{t=G.getProperty(t,this._dataField)}catch(i){t=null}else if(Ea(t))try{t=t[this._dataField]}catch(i){t=null}else if(F(t))return t;try{return t.toString()}catch(i){}return" "},C.prototype.itemToDataTip=function(t){if(null!=this.getDataTipFunction())return this.getDataTipFunction()(t,this._itemToValue(t),this);if(null!=this.owner.getDataTipFunction())return this.owner.getDataTipFunction()(t);if(t instanceof C)return t.getHeaderText();if(Ea(t)){var e=this._dataTipField;e||(e=this.owner.getDataTipField());try{E(t)?null!=G.getProperty(t,e)?t=G.getProperty(t,e):null!=G.getProperty(t,this._dataField)&&(t=G.getProperty(t,this._dataField)):null!=t[e]?t=t[e]:null!=t[this._dataField]&&(t=t[this._dataField])}catch(i){t=null}}if(F(t))return t;try{return t.toString()}catch(i){}return" "},C.prototype.itemToSecondLabel=function(t,e){var i=null;if(null!=this._secondLabelFunction){if(I(e)){if(E(t))try{i=G.getProperty(t,this._dataField)}catch(s){}else if(Ea(t))try{i=t[this._dataField]}catch(s){}}else i=e;return this._secondLabelFunction(t,i,this)}if(this._secondDataField)if(E(t))try{i=G.getProperty(t,this._secondDataField)}catch(s){}else if(Ea(t))try{i=t[this._secondDataField]}catch(s){}return i},C.prototype.dataProviderToLabel=function(t,e){var i,s=e;if(this._itemRendererDataProvider)i=this._itemRendererDataProvider;else if(this._itemRendererDataProviderField)if(E(t))try{i=G.getElement(t,this._itemRendererDataProviderField).childNodes}catch(r){}else i=t[this._itemRendererDataProviderField];if(i){var n,o=this._itemRendererDataField?this._itemRendererDataField:this._itemRendererLabelField;if(ha(i)){for(n=0;n<i.length;n++)if(e==i[n][o]){s=i[n][this._itemRendererLabelField];break}}else if(i instanceof xb){for(n=0;n<i.getLength();n++)if(e==i.getItemAt(n)[o]){s=i.getItemAt(n)[this._itemRendererLabelField];break}}else if(Uc(i))for(n=0;n<i.length;n++)if(1===i[n].nodeType&&e==G.getProperty(i[n],o)){
s=G.getProperty(i[n],this._itemRendererLabelField);break}}return s},C.prototype._getHeaderLabel=function(){return null!=this._headerLabelFunction?this._headerLabelFunction(this):null!=this.owner.getHeaderLabelFunction()?this.owner.getHeaderLabelFunction()(this):this._headerText?this._headerText:this._dataField},C.prototype._compareAndCopyStyle=function(t,e){this.getStyle(e)&&this.getStyle(e)!=t.getStyle(e)&&t.setStyle(e,this.getStyle(e))},C.prototype._copyStyle=function(t){this._compareAndCopyStyle(t,"backgroundColor"),this._compareAndCopyStyle(t,"color"),this._compareAndCopyStyle(t,"disabledColor"),this._compareAndCopyStyle(t,"fontFamily"),this._compareAndCopyStyle(t,"fontSize"),this._compareAndCopyStyle(t,"fontStyle"),this._compareAndCopyStyle(t,"fontWeight"),this._compareAndCopyStyle(t,"headerStyleName"),this._compareAndCopyStyle(t,"lineHeight"),this._compareAndCopyStyle(t,"letterSpacing"),this._compareAndCopyStyle(t,"paddingLeft"),this._compareAndCopyStyle(t,"paddingRight"),this._compareAndCopyStyle(t,"textAlign"),this._compareAndCopyStyle(t,"textDecoration"),this._compareAndCopyStyle(t,"textIndent")},C.prototype._copyProperties=function(t){t.editable=this.editable,t.editorDataField=this.editorDataField,t.editorHeightOffset=this.editorHeightOffset,t.editorUsesEnterKey=this.editorUsesEnterKey,t.editorWidthOffset=this.editorWidthOffset,t.editorXOffset=this.editorXOffset,t.editorYOffset=this.editorYOffset,t.itemEditor=this.itemEditor,t.rendererIsEditor=this.rendererIsEditor,t.resizable=this.resizable,t.sortable=this.sortable,t.sortDescending=this.sortDescending,t._dataField=this._dataField,t._dataTipField=this._dataTipField,t._dataTipFunction=this._dataTipFunction,t._formatter=this._formatter,t._headerRenderer=this._headerRenderer,t._headerText=this._headerText,t._headerWordWrap=this._headerWordWrap,t._itemRenderer=this._itemRenderer,t._labelFunction=this._labelFunction,t._minWidth=this._minWidth,t._showDataTips=this._showDataTips,t._sortCompareFunction=this._sortCompareFunction,t._styleFunction=this._styleFunction,t._visible=this._visible,t._width=this._width,t._wordWrap=this._wordWrap,t._itemRendererDataProvider=this._itemRendererDataProvider,t._itemRendererDataProviderField=this._itemRendererDataProviderField,t._itemRendererLabelField=this._itemRendererLabelField,t._headerRendererDataProvider=this._headerRendererDataProvider,t._headerRendererLabelField=this._headerRendererLabelField,t._secondDataField=this._secondDataField,t._secondLabelFunction=this._secondLabelFunction,t._spanable=this._spanable,t._truncateToFit=this._truncateToFit,this._copyStyle(t)},C.prototype.clone=function(){var t=new C;return this._copyProperties(t),t},fb._defaultProperty="children",fb._propertyType={children:Array},z(fb,C),fb.prototype.getWidth=function(){return this.children&&0<this.children.length?this._width:fb._super.getWidth.call(this)},fb.prototype.setWidth=function(t){this.children&&0<this.children.length?this._width=t:fb._super.setWidth.call(this,t)},fb.prototype.itemToData=function(t){if(!t)return null;if(null!=this._labelFunction)return this._labelFunction(t,null,this);try{null!=this._dataField&&(E(t)?t=G.getProperty(t,this._dataField):Ea(t)&&(t=t[this._dataField]))}catch(e){t=null}return t},fb.prototype._copyProperties=function(t){fb._super._copyProperties.call(this,t),t.childrenDragEnabled=this.childrenDragEnabled},fb.prototype.clone=function(){var t=new fb;this._copyProperties(t);for(var e=0;e<this.children.length;e++)t.children[e]=this.children[e].clone();return t};var ab=function(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"DataGridFilterInput",Qd.call(this,this.element,this.className),this._useDelayInvalidate=!0,this.codeField="code",this.labelField="label",this._operatorChanged=!1};z(ab,Qd),ab.prototype.getOperator=function(){return this._operator},ab.prototype.setOperator=function(t){this._operator=t,this._operatorChanged=!0,this.invalidateProperties()},ab.prototype.getFilterData=function(){return this._filterData},ab.prototype.setFilterData=function(t){(this._filterData=t)?ha(t)?(this._textInput.setText(t[0]),this._textInput2.setText(t[1])):(this._textInput.setText(t),this._textInput2.setText("")):(this._textInput.setText(""),this._textInput2.setText(""))},ab.prototype.createChildren=function(){ab._super.createChildren.call(this),this.setVerticalScrollPolicy("off"),this.setHorizontalScrollPolicy("off"),this.setStyle("paddingLeft",10),this.setStyle("paddingRight",10),this.setStyle("paddingTop",10),this.setStyle("paddingBottom",10),this._operators||(this._operators=new za,this._operators.setPercentWidth(100),this._operators.addEvent("keydown",this._keyBoardHandler,this),this._operators.addEvent("keyup",this._keyBoardHandler,this),this.addChild(this._operators)),this._textInput||(this._textInput=new Y,this._textInput.setPercentWidth(100),this._textInput.setText(this._filterData),this._textInput.addEvent("keydown",this._keyDownHandler,this),this._textInput.addEvent("keyup",this._keyBoardHandler,this),this.addChild(this._textInput)),this._tildeLabel||(this._tildeLabel=new mc,this._tildeLabel.setPercentWidth(100),this._tildeLabel.setText("~"),this.addChild(this._tildeLabel)),this._textInput2||(this._textInput2=new Y,this._textInput2.setPercentWidth(100),this._textInput2.setText(this._filterData),this._textInput2.addEvent("keydown",this._keyDownHandler,this),this._textInput2.addEvent("keyup",this._keyBoardHandler,this),this.addChild(this._textInput2)),this._buttonHBox||(this._buttonHBox=new Fd,this._buttonHBox.setVerticalScrollPolicy("off"),this._buttonHBox.setHorizontalScrollPolicy("off")),this._okButton||(this._okButton=new rb,this._okButton._label=B.getString("datagrid","filterOKButtonLabel"),this._okButton.addEvent("click",this._okButtonClickHandler,this),this._buttonHBox.addChild(this._okButton)),this._clearButton||(this._clearButton=new rb,this._clearButton._label=B.getString("datagrid","filterClearButtonLabel"),this._clearButton.addEvent("click",this._clearButtonClickHandler,this),this._buttonHBox.addChild(this._clearButton),this.addChild(this._buttonHBox))},ab.prototype.commitProperties=function(){if(this.owner&&this.owner instanceof l){var t=this.owner.getColumns()[this.columnIndex];if(!t)return;var e,i;if(i=t.getStyle("type"),t.filterType&&F(t.filterType)&&(i=t.filterType.toLowerCase()),i||((e=t.getFormatter())?e instanceof jd||e instanceof Cd?i="number":e instanceof id?i="date":(t.getItemRendererDataProvider()||t.getItemRendererDataProviderField())&&(i="itemrendererdataprovider"):t.getItemRendererDataProvider()||t.getItemRendererDataProviderField()?i="itemrendererdataprovider":p(t.trueValue)||p(t.falseValue)||(i="boolean")),this._filterType=i||"none",t.filterOperators)this._dataProvider=t.filterOperators;else switch(i){case"int":case"float":case"number":this._dataProvider=this._jsonToObject(B.getString("datagrid","filterNumberOperators"));break;case"date":this._dataProvider=this._jsonToObject(B.getString("datagrid","filterDateOperators"));break;case"boolean":p(t.trueValue)||p(t.falseValue)?this._dataProvider=this._jsonToObject(B.getString("datagrid","filterBooleanOperators")):this._dataProvider=[{code:"T",label:t.trueValue},{code:"F",label:t.falseValue}];break;case"itemrendererdataprovider":this._dataProvider=t.getItemRendererDataProvider();break;case"string":this._dataProvider=this._jsonToObject(B.getString("datagrid","filterStringOperators"));break;default:this._dataProvider=[]}switch(this._operators.setDataProvider(this._dataProvider),i){case"int":case"float":case"number":this._operators.setIncludeInLayout(!0),this._textInput.setIncludeInLayout(!0),this._textInput.setVisible(!0),this._tildeLabel.setIncludeInLayout(!1),this._tildeLabel.setVisible(!1),this._textInput2.setIncludeInLayout(!1),this._textInput2.setVisible(!1),e=ab.prototype.numberFilter,this._filterType="number";break;case"range":this._operators.setIncludeInLayout(!1),this._textInput.setIncludeInLayout(!0),this._textInput.setVisible(!0),this._tildeLabel.setIncludeInLayout(!0),this._tildeLabel.setVisible(!0),this._textInput2.setIncludeInLayout(!0),this._textInput2.setVisible(!0),e=ab.prototype.rangeFilter;break;case"date":this._operators.setIncludeInLayout(!0),this._textInput.setIncludeInLayout(!0),this._textInput.setVisible(!0),this._tildeLabel.setIncludeInLayout(!1),this._tildeLabel.setVisible(!1),this._textInput2.setIncludeInLayout(!1),this._textInput2.setVisible(!1),e=ab.prototype.dateFilter;break;case"boolean":this._operators.setIncludeInLayout(!0),this._textInput.setIncludeInLayout(!1),this._textInput.setVisible(!1),this._tildeLabel.setIncludeInLayout(!1),this._tildeLabel.setVisible(!1),this._textInput2.setIncludeInLayout(!1),this._textInput2.setVisible(!1),e=ab.prototype.booleanFilter;break;case"itemrendererdataprovider":this._operators.setIncludeInLayout(!0),this.codeField=t.getItemRendererDataField(),this.labelField=t.getItemRendererLabelField(),this._operators.setLabelField(t.getItemRendererLabelField()),this._textInput.setIncludeInLayout(!1),this._textInput.setVisible(!1),this._tildeLabel.setIncludeInLayout(!1),this._tildeLabel.setVisible(!1),this._textInput2.setIncludeInLayout(!1),this._textInput2.setVisible(!1),e=ab.prototype.itemRendererDataProviderFilter;break;case"string":this._operators.setIncludeInLayout(!0),this._textInput.setIncludeInLayout(!0),this._textInput.setVisible(!0),this._tildeLabel.setIncludeInLayout(!1),this._tildeLabel.setVisible(!1),this._textInput2.setIncludeInLayout(!1),this._textInput2.setVisible(!1),e=ab.prototype.stringFilter;break;default:this._operators.setIncludeInLayout(!1),this._textInput.setIncludeInLayout(!0),this._textInput.setVisible(!0),this._tildeLabel.setIncludeInLayout(!1),this._tildeLabel.setVisible(!1),this._textInput2.setIncludeInLayout(!1),this._textInput2.setVisible(!1),e=ab.prototype.noneFilter}this._filterFunction=t.filterFunction?t.filterFunction:e}if(this._operatorChanged){if(p(this._operator))this._operators.setSelectedIndex(0);else if(this._dataProvider){for(i=F(this._operator)?this._operator:Ea(this._operator)?this._operator[this.codeField]||this._operator[this.labelField]:"",e=0;e<this._dataProvider.length;e++)if(t=this._dataProvider[e]){if(F(t)&&t==i){this._operators.setSelectedIndex(e);break}if(Ea(t)&&(t[this.codeField]==i||t[this.labelField]==i)){this._operators.setSelectedIndex(e);break}}}else this._operators.setSelectedIndex(0);this._operatorChanged=!1}},ab.prototype.focus=function(){this._textInput.getIncludeInLayout()?this._textInput.focus():this._operators.getIncludeInLayout()&&this._operators.focus()},ab.prototype._jsonToObject=function(t){return"object"==typeof JSON?JSON.parse(t):te(t)},ab.prototype._setColumnFiltering=function(){var t,e,i;this.owner&&this.owner instanceof l&&(this._operators.getIncludeInLayout()?(i=this._operators.getSelectedItem(),F(i)||(i=i[this.codeField]||i[this.labelField])):i=null,this._textInput.getIncludeInLayout()&&(t=this._textInput.getText(),this._textInput2.getIncludeInLayout()?(e=this._textInput2.getText(),""==t&&""==e?t=i=null:(""==t?t=null:isNaN(parseInt(t))||(t=Number(t)),""==e?e=null:isNaN(parseInt(e))||(e=Number(e)),t=[t,e])):""==t?t=i=null:"number"==this._filterType&&(t=Number(t))),this.owner.setColumnFiltering(this.columnIndex,this.dataField,i,t,this._filterFunction))},ab.prototype._clearButtonClickHandler=function(t){this.owner&&this.owner instanceof l&&this.owner.setColumnFiltering(this.columnIndex,this.dataField,null,null,null)},ab.prototype._okButtonClickHandler=function(t){this._setColumnFiltering()},ab.prototype._keyDownHandler=function(t){t.stopPropagation(),27==t.keyCode?this.owner&&this.owner instanceof l&&this.owner._hideFilterInstance(t):13==t.keyCode&&this._setColumnFiltering()},ab.prototype._keyBoardHandler=function(t){t.stopPropagation()},ab.prototype.numberFilter=function(t,e,i,s,r){switch(i){case"=":return e==s;case"!=":return e!=s;case">":return e>s;case">=":return e>=s;case"<":return e<s;case"<=":return e<=s}return!1},ab.prototype.dateFilter=function(t,e,i,s,r){switch(t=e,r.getFormatter()&&(t=r._applyFormatting(t)),i){case"=":return t==s;case"!=":return t!=s;case">":return t>s;case">=":return t>=s;case"<":return t<s;case"<=":return t<=s;case"contain":return!p(t)&&0<=t.toString().indexOf(s);case"notcontain":return p(t)||0>t.toString().indexOf(s);case"startWith":return!p(t)&&0==t.toString().indexOf(s);case"endWith":return F(s)&&t.toString().lastIndexOf(s)==t.length-s.length}return!1},ab.prototype.booleanFilter=function(t,e,i,s,r){return!p(e)&&("T"==i?p(r.trueValue)?F(e)?"true"==e:1==e:e==r.trueValue:p(r.trueValue)?F(e)?"true"!=e:1!=e:e!=r.trueValue)},ab.prototype.noneFilter=function(t,e,i,s,r){return p(e)||(r.getItemRendererDataProvider()||r.getItemRendererDataProviderField()?e=r.dataProviderToLabel(t,e):(t=r.getFormatter())&&t instanceof id&&(e=t.format(e))),r.filterCaseInSensitive?!(p(e)||0>e.toString().toLowerCase().indexOf(s.toLowerCase())):!(p(e)||0>e.toString().indexOf(s))},ab.prototype.itemRendererDataProviderFilter=function(t,e,i,s,r){return e==i},ab.prototype.rangeFilter=function(t,e,i,s,r){return!p(e)&&(ha(s)?1<s.length?p(s[0])?e<=s[1]:p(s[1])?e>=s[0]:e>=s[0]&&e<=s[1]:e>=s[0]:e>=s)},ab.prototype.stringFilter=function(t,e,i,s,r){switch(i){case"=":return r.filterCaseInSensitive?e.toString().toLowerCase()==s.toString().toLowerCase():e==s;case"!=":return r.filterCaseInSensitive?e.toString().toLowerCase()!=s.toString().toLowerCase():e!=s;case"contain":return r.filterCaseInSensitive?!p(e)&&0<=e.toString().toLowerCase().indexOf(s.toString().toLowerCase()):!p(e)&&0<=e.toString().indexOf(s);case"notcontain":return r.filterCaseInSensitive?p(e)||0>e.toString().toLowerCase().indexOf(s.toString().toLowerCase()):p(e)||0>e.toString().indexOf(s);case"startWith":return r.filterCaseInSensitive?!p(e)&&0==e.toString().toLowerCase().indexOf(s.toString().toLowerCase()):!p(e)&&0==e.toString().indexOf(s);case"endWith":return r.filterCaseInSensitive?F(s)&&e.toString().toLowerCase().lastIndexOf(s.toLowerCase())==e.toString().length-s.length:F(s)&&e.toString().lastIndexOf(s)==e.toString().length-s.length}return!1};var qc=function(){this.element=this.element?this.element:"div",this.className=this.className?this.className:"DataGridFilterList",Qd.call(this,this.element,this.className),this._useDelayInvalidate=!0,this.codeField="code",this.labelField="label",this._filterDataChanged=!0};z(qc,Qd),qc.prototype.getOperator=function(){return this._operator},qc.prototype.setOperator=function(t){this._operator=t},qc.prototype.getFilterData=function(){return this._filterData},qc.prototype.setFilterData=function(t){this._filterData=t,this._filterDataChanged=!0,this.invalidateProperties()},qc.prototype.createChildren=function(){qc._super.createChildren.call(this),this.setVerticalScrollPolicy("off"),this.setHorizontalScrollPolicy("off"),this.setStyle("paddingLeft",10),this.setStyle("paddingRight",10),this.setStyle("paddingTop",10),this.setStyle("paddingBottom",10),this._textHBox||(this._textHBox=new Fd,this._textHBox.setStyle("verticalAlign","middle"),this._textHBox.setVerticalScrollPolicy("off")),this._textInput||(this._textInput=new Y,this._textInput.setWidth(100),this._textInput.addEvent("keydown",this._keyDownHandler,this),this._textInput.addEvent("keyup",this._keyUpHandler,this),this._textHBox.addChild(this._textInput)),this._searchButton||(this._searchButton=new Ua,this._searchButton.setSrc(Ma+"search.png"),this._searchButton.setWidth(16),this._searchButton.setHeight(16),this._searchButton.addEvent("click",this._searchButtonClickHandler,this),this._textHBox.addChild(this._searchButton),this.addChild(this._textHBox)),this._list||(this._list=new Rd,this._list.setTruncateToFit(!0),this._list.setShowDataTips(!0),this.addChild(this._list)),this._buttonHBox||(this._buttonHBox=new Fd,this._buttonHBox.setPercentWidth(100),this._buttonHBox.setStyle("horizontalAlign","right"),this._buttonHBox.setVerticalScrollPolicy("off"),this._buttonHBox.setHorizontalScrollPolicy("off")),this._okButton||(this._okButton=new rb,this._okButton._label=B.getString("datagrid","filterOKButtonLabel"),this._okButton.addEvent("click",this._okButtonClickHandler,this),this._buttonHBox.addChild(this._okButton)),this._clearButton||(this._clearButton=new rb,this._clearButton._label=B.getString("datagrid","filterClearButtonLabel"),this._clearButton.addEvent("click",this._clearButtonClickHandler,this),this._buttonHBox.addChild(this._clearButton),this.addChild(this._buttonHBox))},qc.prototype.commitProperties=function(){var t,e;if(this.owner&&this.owner instanceof l){var i=this.owner.getColumns()[this.columnIndex];if(!i)return;if(t=i.getStyle("type"),(i.getItemRendererDataProvider()||i.getItemRendererDataProviderField())&&(t="itemrendererdataprovider"),i.filterOperators)this._dataProvider=i.filterOperators,this._list.setLabelField(this.labelField);else{var s,r=-1,n=[{label:B.getString("datagrid","filterSelectAll"),checked:!0,selectAll:!0}];if("itemrendererdataprovider"===t)for(s=i.getItemRendererDataProvider(),this.codeField=i.getItemRendererDataField(),this.labelField=i.getItemRendererLabelField(),t=0;t<s.length;t++)e=s[t],n.push({label:e[this.labelField],code:e[this.codeField?this.codeField:this.labelField],checked:!0});else{for(s=this.owner.getColumnDistinctData(this.columnIndex,i.getDataField()),t=0;t<s.length;t++)e=s[t],p(e)?(n.push({label:B.getString("datagrid","filterNull"),code:e,checked:!0,isNull:!0}),r=n.length-1):n.push({label:i._applyFormatting(e),code:e,checked:!0});0<=r&&(e=n[r],n.splice(r,1),n.push(e))}this._dataProvider=n}this._dataProvider&&this._list.setDataProvider(this._dataProvider),this._filterFunction=i.filterFunction?i.filterFunction:qc.prototype.listFilter}if(this._filterDataChanged){if(this._filterData&&0!=this._filterData.length){if(this._dataProvider)for(t=0,this._dataProvider[0].selectAll&&(this._dataProvider[0].checked=!1,t=1);t<this._dataProvider.length;t++)0<=Ra.indexOf(this._filterData,this._dataProvider[t].code)?this._dataProvider[t].checked=!0:this._dataProvider[t].checked=!1}else if(this._dataProvider&&0<this._dataProvider.length&&this._dataProvider[0].selectAll&&(this._dataProvider[0].checked=!0,i.filterOperators==this._dataProvider))for(t=1;t<this._dataProvider.length;t++)this._dataProvider[t].checked=!0;this._filterDataChanged=!1}},qc.prototype.focus=function(){this._list.focus()},qc.prototype._setColumnFiltering=function(t){if(this._dataProvider&&0<this._dataProvider.length)if(this._dataProvider[0].selectAll&&!this._listCollectionFilterFunction&&this._dataProvider[0].checked)this.owner.setColumnFiltering(this.columnIndex,this.dataField,null,null,null);else{var e,i,s=[],r=this._list.getDataProvider();for(t=0,e=r.getLength();t<e;t++)i=r.getItemAt(t),i.checked&&!i.selectAll&&s.push(i.code);0!=s.length&&this.owner.setColumnFiltering(this.columnIndex,this.dataField,"list",s,this._filterFunction)}else this.owner.setColumnFiltering(this.columnIndex,this.dataField,null,null,null)},qc.prototype._clearButtonClickHandler=function(t){this.owner&&this.owner instanceof l&&this.owner.setColumnFiltering(this.columnIndex,this.dataField,null,null,null)},qc.prototype._okButtonClickHandler=function(t){this._setColumnFiltering()},qc.prototype._searchButtonClickHandler=function(t){var e=this._list.getDataProvider(),i=this._textInput.getText();if(""==i||p(i)){if(!this._listCollectionFilterFunction)return;if(this._listCollectionFilterFunction=e.filterFunction=null,this._dataProvider&&0<this._dataProvider.length&&this._dataProvider[0].selectAll)for(t=0;t<this._dataProvider.length;t++)this._dataProvider[t].checked=!0}else i=i.toLowerCase(),this._listCollectionFilterFunction=e.filterFunction=function(t){return!!(t.selectAll||t.isNull||t.label&&0<=t.label.toString().toLowerCase().indexOf(i))},this._list.setVerticalScrollPosition(0);e.refresh()},qc.prototype._keyDownHandler=function(t){t.stopPropagation(),27==t.keyCode?this.owner&&this.owner instanceof l&&this.owner._hideFilterInstance(t):13==t.keyCode&&this._setColumnFiltering()},qc.prototype._keyUpHandler=function(t){t.stopPropagation()},qc.prototype.listFilter=function(t,e,i,s,r){return 0<=Ra.indexOf(s,e)},Va._defaultStyles={paddingTop:"2px",paddingBottom:"2px"},Va._defaultProperty="columns",Va._propertyType={columns:Array},z(Va,Bb),Va.prototype.getColumns=function(){return this._columns},Va.prototype.setColumns=function(t){this._columns=t,this._columnsChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},Va.prototype.getFooterRenderer=function(){return this._footerRenderer},Va.prototype.setFooterRenderer=function(t){this._footerRenderer=t,this._footerRendererChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},Va.prototype.getSummaryOnlyLeaf=function(){return this._summaryOnlyLeaf},Va.prototype.setSummaryOnlyLeaf=function(t){this._summaryOnlyLeaf=t,this._summaryOnlyLeafChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},Va.prototype.getUseDataSource=function(){return this._useDataSource},Va.prototype.setUseDataSource=function(t){this._useDataSource=t,this._useDataSourceChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},Va.prototype._removeAllColumns=function(){for(var t;1<this.getNumChildren();)this.removeChildAt(1);if(this._columnsForDataGrid=[],this._columns)for(t=0;t<this._columns.length;t++)this._columns[t]._renderer=null},Va.prototype._addNewColumns=function(){var t,e;for(this._columnsForDataGrid=[],t=0;t<this._columns.length;t++){if(e=this._columns[t],!(e instanceof wb))throw Error("All footer columns must be DataGridFooterColumn "+e+" :: "+t);e.owner=this,e._column=e.getDataColumn()?e.getDataColumn():this._dataGrid.getColumns()[t],this._columnsForDataGrid[e._column.colNum]=e}for(t=0;t<this._columnsForDataGrid.length;t++)if(e=this._columnsForDataGrid[t]){var i=e.getFooterRenderer()?e.getFooterRenderer().newInstance():this._footerRenderer.newInstance();i.setStyleName(e),e._renderer=i;var s;if(s=e.data,null!=e.getDataColumn()&&null!=e.getSummaryOperation()&&(s=this._getSummaryResult(e),e.data=s),s=null!=e.getLabelFunction()?e.getLabelFunction()(e,s):e.getLabel()?e.getLabel():I(s)?null:s.toString(),null!=e.getFormatter()){var r=e.getFormatter().format(s);e.getFormatter().error||(s=r)}i.setListData(new nd(s,e._column.getDataField(),t,null,this,(-1))),i.setData(e.getDataColumn()),this.addChild(i)}},Va.prototype._makeSummary=function(){var t,e,i,s;if(this._columns){for(this._summaryObj={},t=[],i=0;i<this._columns.length;i++)e=this._columns[i],e instanceof wb&&null!=e.getDataColumn()&&null!=e.getSummaryOperation()&&t.push(e);if(0<t.length){for(e=t.length,i=0;i<e;i++)switch(s=t[i].uno,t[i].getSummaryOperation()){case"SUM":this._summaryObj[s]=0;break;case"MIN":this._summaryObj[s]=Number.MAX_VALUE;break;case"MAX":this._summaryObj[s]=-Number.MAX_VALUE;break;case"COUNT":this._summaryObj[s]=[],this._summaryObj[s+"Counter"]=0;break;case"AVG":this._summaryObj[s]=0,this._summaryObj[s+"Count"]=0}if(this._dataGrid.getDataProvider()){if(i=this._dataGrid.getDataProvider(),this._useDataSource&&i&&i instanceof T)if(s=i,s.getSource()instanceof fa)i=s.getSource().getSource();else if(s.getSource()instanceof pb&&(this._rootModel=s.getSource(),this._scanArr=[],s=this._rootModel.getRoot())){var r=s.length;for(i=0;i<r;i++)this._rootModel.hasChildren(s[i])?this._scanChildrenOf(s[i]):this._scanArr.push(s[i]);i=new P(this._scanArr)}if(i)for(s=i.createCursor();!s.getAfterLast();){for(r=s.getCurrent(),i=0;i<e;i++)this._calculateSummary(this._summaryObj,t[i],r);s.moveNext()}}}}},Va.prototype._scanChildrenOf=function(t){if(this._rootModel.hasChildren(t)){this._summaryOnlyLeaf||this._scanArr.push(t),t=this._rootModel.getChildren(t);var e,i=t.length;for(e=0;e<i;e++)this._rootModel.hasChildren(t[e])?this._scanChildrenOf(t[e]):this._scanArr.push(t[e])}else this._scanArr.push(t)},Va.prototype._getSummaryResult=function(t){var e=0,i=t.uno;switch(t.getSummaryOperation()){case"SUM":case"MIN":case"MAX":e=this._summaryObj[i];break;case"COUNT":e=this._summaryObj[i+"Counter"];break;case"AVG":e=this._summaryObj[i]/this._summaryObj[i+"Count"]}return e},Va.prototype._calculateSummary=function(t,e,i){if(!(i instanceof ic)){var s=e.getDataColumn().getDataField(),r=e.uno,n=e.getDataColumn().itemToLabel(i,!1);switch(F(n)&&(n=Number(n.toString())),e.getSummaryOperation()){case"SUM":t[r]+=n;break;case"MIN":t[r]=t[r]<n?t[r]:n;break;case"MAX":t[r]=t[r]>n?t[r]:n;break;case"COUNT":t[r].push(i[s]),t[r+"Counter"]+=1;break;case"AVG":t[e.uno]+=n,t[r+"Count"]+=1}}},Va.prototype._copyProperties=function(t){t._footerRenderer=this._footerRenderer,t.setVisible(this.getVisible),t.setWidth(this.getWidth()),t.setHeight(this.getHeight()),t.setStyle("backgroundColor",this.getStyle("backgroundColor")),t.setStyle("borderColor",this.getStyle("borderColor")),t.setStyle("verticalAlign",this.getStyle("verticalAlign"))},Va.prototype.invalidateList=function(){this._removeAllColumns(),this._columns&&this._addNewColumns(),this.invalidateProperties(),this.invalidateDisplayList()},Va.prototype.invalidateData=function(){this._dataChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},Va.prototype.invalidateSize=function(){this._invalidateSizeFlag||(this._invalidateSizeFlag=!0,this._useDelayInvalidate||this._runInvalidatePropertiesFlag||this._runInvalidateDisplayListFlag?this.element.parentNode&&Ba.getInstance().invalidateSize(this):this.element.parentNode&&this.validateSize())},Va.prototype.clone=function(){var t=new Va;if(this._copyProperties(t),this._columns){var e,i=[];for(e=0;e<this._columns.length;e++)i.push(this._columns[e].clone());t.setColumns(i)}return t},Va.prototype.createChildren=function(){Va._super.createChildren.call(this),this._linesShape||(this._linesShape=new A,this.addChild(this._linesShape))},Va.prototype.commitProperties=function(){Va._super.commitProperties.call(this),(this._dataGrid&&this._dataGrid==this.getParent()||(this._dataGrid=this.getParent(),this._dataGrid))&&(this._dataChanged&&(this._dataChanged=!1,this._makeSummary(),this.invalidateList()),this._columnsChanged&&(this._columnsChanged=!1,this._removeAllColumns(),this._columns&&this._addNewColumns()),this._useDataSourceChanged&&(this._useDataSourceChanged=!1,this._makeSummary(),this.invalidateList()),this._summaryOnlyLeafChanged&&(this._summaryOnlyLeafChanged=!1,this._makeSummary(),this.invalidateList()))},Va.prototype.measure=function(){Va._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingTop"),s=this.getSizeStyle("paddingBottom"),r=this.getMinHeight()-i-s,r=Math.max(r,i+s);for(e=0;e<this._columns.length;e++)(t=this._columns[e])&&t._column&&t._renderer&&(t=t._renderer.getExplicitOrMeasuredHeight(),r=Math.max(r,t));this.measuredHeight=r+i+s},Va.prototype.updateDisplayList=function(t,e){if(Va._super.updateDisplayList.call(this,t,e),this._dataGrid){for(var i=this.getSizeStyle("paddingTop"),s=this.getSizeStyle("paddingBottom"),r=this._dataGrid.getStyle("verticalAlign"),n=this._dataGrid.getSizeStyle("borderBottomWidth");this._linesShape.getNumChildren();)this._linesShape.removeChildAt(0);var o,a,l,h=document.createDocumentFragment(),d=this._dataGrid.getStyle("verticalGridLineColor"),c=this._dataGrid.getStyle("verticalGridLines"),_=0;for(o=a=0;o<this._columnsForDataGrid.length;o++)l=this._columnsForDataGrid[o],l&&l._column||(l={colSpan:1},l._column=this._dataGrid.getColumns()[o],this._columnsForDataGrid[o]=l),l._width=this._dataGrid._getWidthOfItem(null,l._column,l._column.colNum),l._colSpan=Xa(l.colSpan)?l.colSpan:0,a<this._dataGrid.getLockedColumnCount()?l._visible=l._column.getVisible():a<this._dataGrid.getLockedColumnCount()+this._dataGrid.getHorizontalScrollPosition()?l._visible=!1:l._visible=l._column.getVisible(),a+=l._column.getVisible()?1:0;for(o=0;o<this._columnsForDataGrid.length;o++)if(l=this._columnsForDataGrid[o],1<l.colSpan)if(l._visible)for(a=1;o+a<this._columnsForDataGrid.length&&a<l._colSpan;a++)this._columnsForDataGrid[o+a]._visible&&(l._width+=this._columnsForDataGrid[o+a]._width,this._columnsForDataGrid[o+a]._visible=!1);else if(l._column.getVisible()){for(a=1;o+a<this._columnsForDataGrid.length&&a<l.colSpan;a++)if(this._columnsForDataGrid[o+a]._visible){l._visible=!0,l._width=this._columnsForDataGrid[o+a]._width,this._columnsForDataGrid[o+a]._visible=!1;break}for(;o+a<this._columnsForDataGrid.length&&a<l._colSpan;a++)this._columnsForDataGrid[o+a]._visible&&(l._width+=this._columnsForDataGrid[o+a]._width,this._columnsForDataGrid[o+a]._visible=!1)}for(o=0;o<this._columnsForDataGrid.length;o++)if(l=this._columnsForDataGrid[o],l._renderer&&(l._renderer.setVisible(l._visible),l._visible&&(a=l._renderer.getExplicitOrMeasuredHeight(),isNaN(a)&&(a=0),a=Math.min(a,e-n-i-s),l._renderer.setActualSize(l._width,a),l._renderer.setX(_),"top"==r?l._renderer.setY(0+i):"bottom"==r?l._renderer.setY(0+e-n-s-a):l._renderer.setY(0+(e-n-a)/2))),l._visible){if(l._renderer){var u=l.getStyle("backgroundColor");u&&(a=new A("div","DataGridBackground"),h.appendChild(a.element),a.parentElement=this,a.setWidthInline(l._width),a.setHeightInline(e-n),a.setX(_),a.setStyle("backgroundColor",u))}c&&(a=new A("div","DataGridLineV"),h.appendChild(a.element),a.parentElement=this,a.setX(_+l._width),a.setY(0),a.setStyle("borderColor",d),a.setHeightInline(e-n)),_+=l._width}(i=this._dataGrid.getStyle("borderBottomColor"))&&(this._dataGrid.getFooters()&&0<this._dataGrid.getFooters().length&&this._dataGrid.getFooters()[0]==this&&(a=new A("div","DataGridLineH"),h.appendChild(a.element),a.parentElement=this,a.setWidthInline(t),a.setStyle("borderColor",i)),a=new A("div","DataGridLineH"),h.appendChild(a.element),a.parentElement=this,a.setY(e-n),a.setWidthInline(t),a.setStyle("borderColor",i)),0<h.childNodes.length&&this._linesShape.element.appendChild(h)}},wb._defaultStyles={paddingLeft:"8px",paddingRight:"8px"},z(wb,kc),wb.prototype.getDataColumn=function(){return this._dataColumn},wb.prototype.setDataColumn=function(t){this._dataColumn=t,this.owner&&this.owner.invalidateList()},wb.prototype.getFormatter=function(){return this._formatter},wb.prototype.setFormatter=function(t){this._formatter=t,this.owner&&this.owner.invalidateList()},wb.prototype.getFooterRenderer=function(){return this._footerRenderer},wb.prototype.setFooterRenderer=function(t){this._footerRenderer=t,this.owner&&this.owner.invalidateList()},wb.prototype.getLabel=function(){return this._label},wb.prototype.setLabel=function(t){this._label=t,this.owner&&this.owner.invalidateList()},wb.prototype.getLabelFunction=function(){return this._labelFunction},wb.prototype.setLabelFunction=function(t){this._labelFunction=t,this.owner&&this.owner.invalidateList()},wb.prototype.getSummaryOperation=function(){return this._summaryOperation},wb.prototype.setSummaryOperation=function(t){this._summaryOperation=t,this.owner&&this.owner.invalidateList()},wb.prototype.getWordWrap=function(){return this._wordWrap},wb.prototype.setWordWrap=function(t){this._wordWrap=t,this.owner&&this.owner.invalidateList()},wb.prototype._copyProperties=function(t){wb._super._copyProperties.call(this,t),t._dataColumn=this._dataColumn,t._formatter=this._formatter,t._footerRenderer=this._footerRenderer,t._label=this._label,t._labelFunction=this._labelFunction,t._summaryOperation=this._summaryOperation,t._wordWrap=this._wordWrap},wb.prototype.clone=function(){var t=new wb;return this._copyProperties(t),t},wb.prototype.getRenderer=function(){return this._renderer},z(Wb,qa),Wb.prototype.getListData=function(){return this._listData},Wb.prototype.setListData=function(t){this._listData!=t&&(this._listData=t,this._listDataChanged=!0,this.invalidateProperties())},Wb.prototype.getText=function(){return this._labelNode.nodeValue},Wb.prototype._getTextWidth=function(){var t=this.element.style;return t.width&&"auto"!=t.width?this.element.scrollWidth:this.getWidth()},Wb.prototype._getTextHeight=function(){var t=this.element.style;return t.height&&"auto"!=t.height?this.element.scrollHeight:this.getHeight()},Wb.prototype.createChildren=function(){
Wb._super.createChildren.call(this),this._labelNode=document.createTextNode(""),this.element.appendChild(this._labelNode)},Wb.prototype.commitProperties=function(){var t;if(t=!1,this._labelNode&&this._listDataChanged){if(Wb._super.commitProperties.call(this),this._listData){var e=this._listData.owner.getColumns()[this._listData.columnIndex];this.element.style.height&&this.clearStyle("height"),e&&(t=e.getWordWrap()),m.setWordWrap(this.element,t),this._visible?m.setStyle(this.element,"display","inline"):this._oldDisplay="inline",t=this._listData.label}else t="";t?(" "==t&&(t=""),this._labelNode.nodeValue!=t&&(this._labelNode.nodeValue=t)):""!=this._labelNode.nodeValue&&(this._labelNode.nodeValue=""),this._listDataChanged=!1}},Wb.prototype.measure=function(){if(this._listData&&this._labelNode){Wb._super.measure.call(this);var t,e;t=isNaN(this._explicitWidth)?this.getWidth():this._explicitWidth,e=this._getTextHeight(),this.measuredMinWidth=this.measuredWidth=t,this.measuredMinHeight=this.measuredHeight=e}},Wb.prototype.setExplicitWidth=function(t){this._width!=t&&(this._width=t,Wb._super.setWidth.call(this,t))},Wb.prototype.setWidth=function(t){this._width!=t&&(this._width=t,Wb._super.setWidth.call(this,t))},Wb.prototype.setHeight=function(t){this._height!=t&&(this._height=t,Wb._super.setHeight.call(this,t))},Wb.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i=this.element,s=m,n=s.getSizeStyle,o=s.getSizeStyleBorder,a=0;this._height!=e&&(this._height=e,r.useBorderBox||(a=n(i,"paddingTop")+n(i,"paddingBottom")+o(i,"borderTopWidth")+o(i,"borderBottomWidth")),s.setPxStyle(i,"height",0<e-a?e-a:0)),this._width!=t&&(this._width=t,r.useBorderBox||(a=n(i,"paddingLeft")+n(i,"paddingRight")+o(i,"borderLeftWidth")+o(i,"borderRightWidth")),s.setPxStyle(i,"width",0<t-a?t-a:0))}},z(Jc,qa),Jc.prototype.getListData=function(){return this._listData},Jc.prototype.setListData=function(t){this._listData!=t&&(this._listData=t,this._listDataChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},Jc.prototype.createChildren=function(){Jc._super.createChildren.call(this),this._disclosureIconElement||(this._disclosureIconElement=document.createElement("img"),this._disclosureIconElement.style.position="absolute",this._disclosureIconElement.alt=B.getString("controls","disclosureIcon"),m.setDisplay(this._disclosureIconElement,!1),this.element.appendChild(this._disclosureIconElement)),this._iconElement||(this._iconElement=document.createElement("img"),this._iconElement.style.position="absolute",m.setDisplay(this._iconElement,!1),this._iconElement.alt=" ",this.element.appendChild(this._iconElement)),this._labelElement||(this._labelElement=new pa,this._labelElement.setText(""),this._labelElement.setStyle("position","absolute"),this.addChild(this._labelElement))},Jc.prototype.commitProperties=function(){var t;if(this._labelElement&&this._listDataChanged){Jc._super.commitProperties.call(this);var e,i;this._disclosureIconElementVisible=!1,i=parseInt(this._disclosureIconElement.style.left),m.setDisplay(this._disclosureIconElement,!1),v.removeEvent(this._disclosureIconElement,"mousedown",this._disclosureMouseDownHandler,this),this._iconElementVisible=!1,e=parseInt(this._iconElement.style.left),m.setDisplay(this._iconElement,!1),this._listData?(this._listOwner=this._listData.owner,t=this._listOwner.getColumns()[this._listData.columnIndex],this._listData.disclosureIcon&&"null"!=this._listData.disclosureIcon&&(0>=this._listData.disclosureIcon.indexOf("/")?this._disclosureIconElement.src=Ma+this._listData.disclosureIcon+".png":this._disclosureIconElement.src=this._listData.disclosureIcon,v.addEvent(this._disclosureIconElement,"mousedown",this._disclosureMouseDownHandler,this),m.setDisplay(this._disclosureIconElement,!!this._data&&this._listData.hasChildren),this._disclosureIconElementVisible=!0,i&&m.setPxStyle(this._disclosureIconElement,"left",Math.round(i))),this._listData.icon&&"null"!=this._listData.icon&&(0>=this._listData.icon.indexOf("/")?this._iconElement.src=Ma+this._listData.icon+".png":this._iconElement.src=this._listData.icon,m.setDisplay(this._iconElement,!0),this._iconElementVisible=!0,e&&m.setPxStyle(this._iconElement,"left",Math.round(e))),this._labelElement.setText(this._listData.label),this._data instanceof C?this._listOwner._columnHeaderWordWrap(t):this._listOwner._columnWordWrap(t),this._labelElement.setWordWrap(this._listOwner._columnWordWrap(t)),this._labelElement.setMultiline(this._listOwner.getVariableRowHeight()),e=this._listOwner.getShowDataTips(),!0===t.getShowDataTips()&&(e=!0),!1===t.getShowDataTips()&&(e=!1),t=e?this._data instanceof C||!(this._labelElement.getTextWidth()>this._labelElement.getWidth()||t.getDataTipFunction()||t.getDataTipField()||this._listOwner.getDataTipFunction()||this._listOwner.getDataTipField())?null:t.itemToDataTip(this._data):null):(this._labelElement.setText(" "),t=null),t?this.element.title!=t&&(this.element.title=t):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},Jc.prototype.measure=function(){if(this._data&&this._listData&&this._labelElement){Jc._super.measure.call(this);var t=this._data?this._listData.indent:0;this._disclosureIconElementVisible&&(t+=16),this._iconElementVisible&&(t+=16),(4>this._labelElement.getWidth()||4>this._labelElement.getHeight())&&this._labelElement.setActualSize(4,16),O(this._explicitWidth)?this.measuredWidth=t+=this._labelElement.getExplicitOrMeasuredWidth():this._labelElement.setWidth(Math.max(this._explicitWidth-t,4)),this.measuredHeight=this._labelElement.getExplicitOrMeasuredHeight(),(m.getDisplay(this._iconElement)||m.getDisplay(this._disclosureIconElement))&&16>this.measuredHeight&&(this.measuredHeight=16)}},Jc.prototype.updateDisplayList=function(t,e){if(this._data&&this._listData&&this._labelElement){Jc._super.updateDisplayList.call(this,t,e);var i=this._data?this._listData.indent:0,s=this._listOwner.getStyle("indentation"),r=this._listOwner.getStyle("folderOpenIcon"),n=this._listOwner.getStyle("defaultLeafIcon"),o=16,a=16;this._disclosureIconElementVisible?(m.setPxStyle(this._disclosureIconElement,"left",i),m.setDisplay(this._disclosureIconElement,this._disclosureIconElementVisible),i=m.getSizeStyle(this._disclosureIconElement,"left")+s,a=m.getSizeStyle(this._disclosureIconElement,"height"),m.setDisplay(this._disclosureIconElement,!!this._data&&this._listData.hasChildren),m.getDisplay(this._disclosureIconElement)?m.setDisplay(this._disclosureIconElement,i<t):this._listData.icon&&(!r&&n||r&&!n)&&(i=this._data?this._listData.indent:0)):0==i&&(i=this.getSizeStyle("paddingLeft")),this._iconElementVisible&&(m.setPxStyle(this._iconElement,"left",i),m.setDisplay(this._iconElement,this._iconElementVisible),i=m.getSizeStyle(this._iconElement,"left")+s,o=m.getSizeStyle(this._iconElement,"height"),m.getSizeStyle(this._iconElement,"left")>t&&m.setDisplay(this._iconElement,!1)),this._labelElement.setX(i),this._labelElement.setWidth(t-this.getSizeStyle("paddingRight")-i),i=this.getStyle("verticalAlign"),o=0<o?o:16,a=0<a?a:16,"top"==i?(this._labelElement.setY(0),this._iconElementVisible&&m.setPxStyle(this._iconElement,"top",0),this._disclosureIconElementVisible&&m.setPxStyle(this._disclosureIconElement,"top",0)):"bottom"==i?(this._labelElement.setY(e-this._labelElement.getHeight()+2),this._iconElementVisible&&m.setPxStyle(this._iconElement,"top",e-o),this._disclosureIconElementVisible&&m.setPxStyle(this._disclosureIconElement,"top",e-a)):(this._labelElement.setY((e-this._labelElement.getHeight())/2),this._iconElementVisible&&m.setPxStyle(this._iconElement,"top",(e-o)/2),this._disclosureIconElementVisible&&m.setPxStyle(this._disclosureIconElement,"top",(e-a)/2)),this._data&&this.getParent()&&(o=this._enabled?this._listOwner.isItemHighlighted(this._listData.uid,this._listData.rowIndex,this._listData.columnIndex)?this._listOwner.getStyle("textRollOverColor"):this._listOwner.isItemSelected(this._listData.uid,this._listData.rowIndex,this._listData.columnIndex)?this._listOwner.getStyle("textSelectedColor"):this.getStyle("color"):this.getStyle("disabledColor"),this._labelElement.setStyle("color",o))}},Jc.prototype._disclosureMouseDownHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;if(t.stopPropagation(),e&&!e._listOwner._isOpening&&e._listOwner.getEnabled()){var i=e._listData.open;e._listData.open=!i,e._listOwner._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,e._listData.item,e,t,!i,!1,!0)}},z(oc,Fd),oc.prototype.getGrid=function(){return this._grid},oc.prototype.setGrid=function(t){this._grid!=t&&(this._grid&&this._grid.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),this._grid=t,this._gridChanged=!0,this.invalidateProperties())},oc.prototype.createChildren=function(){oc._super.createChildren.call(this),this._dragMessage||(this._dragMessage=new mc,this._dragMessage.setText(B.getString("datagrid","groupingPanelDrag")),this._dragMessage.setStyle("verticalAlign","middle"),this._dragMessage.setStyle("position","absolute"),this._dragMessage.move(10,10),this._rawChildren.addChild(this._dragMessage)),this.addEvent("drop",this._dropHandler,this),this.addEvent("dragstart",this._dragStartHandler,this),this.addEvent("dragenter",this._dragEnterHandler,this),this.addEvent("dragend",this._dragEndHandler,this),this.addEvent("dragover",this._dragOverHandle,this),this.setStyle("verticalAlign","middle"),this.setStyle("paddingLeft",10),this.setStyle("paddingRight",10),this.setStyle("horizontalGap",14)},oc.prototype.commitProperties=function(){oc._super.commitProperties.call(this),this._gridChanged&&(this._oriCollection=null,this._groupingFields=[],this.groupCollection=null,this._grid?(this._grid.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),this._getCollction()):this.removeAllChildren(),this._gridChanged=!1)},oc.prototype.addGroupingField=function(t){if(t){var e,i=this.groupCollection.grouping.fields;for(i||(i=[]),e=0;e<i.length;e++)if(i[e].name==t)return;i.push(new ie(t)),this._makeIndicators()}},oc.prototype.removeGroupingField=function(t){if(t){var e,i=this.groupCollection.grouping.fields;for(e=0;e<i.length;e++)if(i[e].name==t){i.splice(e,1),this._makeIndicators();break}}},oc.prototype._getCollction=function(){var t=this._grid.getDataProvider();t&&(t instanceof T?t.getSource()instanceof fa?this.groupCollection=t.getSource():(this.groupCollection=new fa,this.groupCollection.grouping=new he,this.groupCollection.grouping.fields=[],this._oriCollection=t.getSource(),this._oriSource=this._oriCollection.getSource()):(this.groupCollection=new fa,this.groupCollection.grouping=new he,this.groupCollection.grouping.fields=[],this._oriCollection=t instanceof P||t instanceof Hb?t:t.getSource(),this._oriSource=this._oriCollection.getSource()),this._oriSource&&(this.groupCollection.setSource(this._oriSource),this.groupCollection.refresh()),this._makeIndicators())},oc.prototype._makeIndicators=function(){if(this.groupCollection&&this.groupCollection.grouping&&this.groupCollection.grouping.fields&&!(0>=this.groupCollection.grouping.fields.length)||0!=this.getNumChildren()){var t,e,i=this.groupCollection.grouping.fields,s=this.getNumChildren();for(0==s&&(this._contentPane.element.innerHTML=""),t=0;t<i.length;t++)t<s?(e=this.getChildAt(t),e.setText(i[t].name)):(e=new yc,e.setText(i[t].name),this.addChild(e));for(t=i.length;t<s;t++)this.removeChildAt(t);0==this.getNumChildren()?this._oriCollection?this._grid.setDataProvider(this._oriCollection):this.groupCollection.refresh(!1,!0):(this._oriCollection&&(i=this._grid.getDataProvider(),i.getSource()instanceof fa&&this.groupCollection===i.getSource()||this._grid.setDataProvider(this.groupCollection)),this.groupCollection.refresh(!1,!0)),this._dragMessage.setVisible(0==this.getNumChildren())}else this._dragMessage.setVisible(!0)},oc.prototype._collectionChangeHandler=function(t){this._grid&&"reset"==t.kind&&this._getCollction()},oc.prototype._dropHandler=function(t){this._dropedInMe=!0;var e=t.dataTransfer.getData("Text");e&&this.addGroupingField(e),t.preventDefault()},oc.prototype._dragStartHandler=function(t){},oc.prototype._dragEnterHandler=function(t){this._dropedInMe=!1,t.preventDefault()},oc.prototype._dragEndHandler=function(t){t.target.selfElement&&t.target.selfElement instanceof yc&&!this._dropedInMe&&(this.removeGroupingField(t.target.selfElement.getText()),t.preventDefault())},oc.prototype._dragOverHandle=function(t){t.preventDefault()},z(yc,u),yc.prototype.getText=function(){return this._text},yc.prototype.setText=function(t){this._text!==t&&(this._text=t,this._textChanged=!0,this._explicitWidth=this._explicitHeight=NaN,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEvent(new w("valueCommit")))},yc.prototype._textFieldChange=function(t){var e;t||(e=this._text!=this.element.innerHTML),e&&this.dispatchEvent(new w("valueCommit"))},yc.prototype._getMinimumText=function(t){return(!t||2>t.length)&&(t="Wj"),t},yc.prototype.createChildren=function(){yc._super.createChildren.call(this),this.element.draggable=!0,this.element.style.webkitUserDrag="element",this.addEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.addEvent("selectstart",this._selectStartHandler,this)},yc.prototype.commitProperties=function(){yc._super.commitProperties.call(this),this._textChanged&&(this.element.innerHTML=this._text,this._text=this.element.innerHTML,this._textFieldChange(!1),this._textChanged=!1)},yc.prototype.measure=function(){var t=m.getBorderPaddingMetrics(this),e=this._explicitWidth,i=this._explicitHeight,s=this.measureText(this._getMinimumText(this._text));yc._super.measure.call(this),!O(e)&&e||(e=s.width+pa.TEXT_WIDTH_PADDING),!O(i)&&i||(i=s.height+pa.TEXT_HEIGHT_PADDING),this.measuredWidth=e+t.left+t.right,this.measuredHeight=i+t.top+t.bottom},yc.prototype._dragStartHandler=function(t){t.dataTransfer.setData("Text","")},yc.prototype._selectStartHandler=function(t){return t.target.dragDrop(),!1};var Te=function(t,e,i,s,r,n,o){this.column=t,this.parent=e,this.index=i,this.depth=s,this.children=r,this.headerItem=o,this.internalLabelFunction=n,this.headerColSpan=1};Wa._defaultStyles={horizontalGap:0,horizontalAlign:"center"},z(Wa,qa),Wa.prototype.getListData=function(){return this._listData},Wa.prototype.setListData=function(t){this._listData=t,this._grid=t.owner,this.invalidateProperties(),this.invalidateDisplayList()},Wa.prototype.getSortItemRenderer=function(){return this._sortItemRenderer},Wa.prototype.setSortItemRenderer=function(t){this._sortItemRenderer=t,this._sortItemRendererChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},Wa.prototype.setHeight=function(t){Wa._super.setHeight.call(this,t),this.invalidateDisplayList()},Wa.prototype.setWidth=function(t){Wa._super.setWidth.call(this,t),this.invalidateDisplayList()},Wa.prototype._getFieldSortInfo=function(){return this._grid&&this._listData&&-1!=this._listData.columnIndex?this._grid.getFieldSortInfo(this._grid.getColumns()[this._listData.columnIndex]):null},Wa.prototype._getFieldFilterInfo=function(){return this._grid&&this._listData&&-1!=this._listData.columnIndex?this._grid.getFieldFilterInfo(this._grid.getColumns()[this._listData.columnIndex]):null},Wa.prototype.createChildren=function(){Wa._super.createChildren.call(this),this._labelElement||(this._labelElement=new pa,this._labelElement.setStyle("position","absolute"),this._labelElement.setStyle("textAlign","center"),this.addChild(this._labelElement))},Wa.prototype.commitProperties=function(){var t;if(this._data&&this._listData&&this._labelElement){Wa._super.commitProperties.call(this),this._sortItemRendererInstance&&!this._sortItemRendererChanged||(this._sortItemRenderer||(this._sortItemRenderer=this._grid.getSortItemRenderer()),this._sortItemRenderer&&(this._sortItemRendererInstance=this._sortItemRenderer.newInstance(),this.addChild(this._sortItemRendererInstance)),this._sortItemRendererChanged=!1);var e=this._partsSeparatorSkinClass;this._partsSeparatorSkinClass&&this._partsSeparatorSkinClass==this._grid.getStyle("headerSortSeparatorSkin")||(this._partsSeparatorSkinClass=this._grid.getStyle("headerSortSeparatorSkin")),(this._grid.getSortExpertMode()||this._partsSeparatorSkinClass!=e)&&(this._partsSeparatorSkin&&this.removeChild(this._partsSeparatorSkin),this._grid.getSortExpertMode()||(this._partsSeparatorSkin=new this._partsSeparatorSkinClass,this.addChild(this._partsSeparatorSkin))),this._partsSeparatorSkin&&this._partsSeparatorSkin.setVisible(!(this._data instanceof fb)),null!=this._data?(e=this._labelElement.getText(),this._add_text_width_padding=!1,this._labelElement.setText(this._listData.label?this._listData.label:" "),this._labelElement.setMultiline(this._grid.getVariableRowHeight()),this._data instanceof C?this._labelElement.setWordWrap(this._grid._columnHeaderWordWrap(this._data)):this._labelElement.setWordWrap(this._grid.getWordWrap()),this._labelElement.getText()!=e&&this._labelElement.getWordWrap()&&this.invalidateSize(),""==this._labelElement.element.style.top&&this._labelElement.setVisibility(!1),Xb&&(this._labelElement.element.id="Kool__"+this._grid.uno+"_Column"+this._listData.columnIndex,this.setAttr("role","columnheader"),this.element.tabIndex=-1),this._data instanceof C&&(this._column=e=this._data,t=this._grid.getShowDataTips(),1==e.getShowDataTips()&&(t=!0),0==e.getShowDataTips()&&(t=!1),t=t&&(e.getDataTipFunction()||e.getDataTipField()||this._grid.getDataTipFunction()||this._grid.getDataTipField())?e.itemToDataTip(this._data):null,e.getDataField()&&1==e.filterable?(this._filterIcon||(this._filterIcon=new Ua,this._filterIcon.setAlt(B.getString("datagrid","columnFiltering")),this.addChild(this._filterIcon)),this._filterIcon.setVisible(!0),this._filterIcon.setSrc(Ma+"funnel.png")):this._filterIcon&&(this._filterIcon.setVisible(!1),this._filterIcon.setSrc(null))),(this.element.draggable=this._grid.headerDragEnabled)?(this.element.style.webkitUserDrag="element",this.addEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.addEvent("selectstart",this._selectStartHandler,this)):(this.element.style.webkitUserDrag="none",this.removeEvent("dragstart",this._dragStartHandler,this),(r.ie8L||r.ie9)&&this.removeEvent("selectstart",this._selectStartHandler,this))):(this._labelElement.setText(" "),t=null),U(this._sortItemRendererInstance.invalidateProperties)&&this._sortItemRendererInstance.invalidateProperties(),t?this.setAttr("title",t):this.removeAttr("title")}},Wa.prototype.measure=function(){if(this._data&&this._listData&&this._labelElement){Wa._super.measure.call(this);var t=this.getSizeStyle("paddingLeft"),e=this.getSizeStyle("paddingRight"),i=0,s=0;this._grid.getSortExpertMode()&&!this._getFieldSortInfo()||(i=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredWidth():0,s=this._sortItemRendererInstance?this._sortItemRendererInstance.getExplicitOrMeasuredHeight():0);var r=this.getStyle("horizontalGap"),n=0;this._filterIcon&&this._filterIcon.getVisible()&&(n=16),0==i&&0==n&&(r=0);var o,a,l;isNaN(this._explicitWidth)?(o=this._labelElement.getWidth()+pa.TEXT_WIDTH_PADDING,a=this._labelElement.getHeight(),l=o+n+r+(this._partsSeparatorSkin?this._partsSeparatorSkin.getWidth():0)+i):(l=this._explicitWidth,o=l-i-n-r-(this._partsSeparatorSkin?this._partsSeparatorSkin.width+10:0)-t-e,this._labelElement.setWidth(o),a=this._labelElement.getHeight()),i=Math.max(a,s,this._partsSeparatorSkin?this._partsSeparatorSkin.getHeight():0),this.measuredMinWidth=this.measuredWidth=l+(t+e),this.measuredMinHeight=this.measuredHeight=i+0}},Wa.prototype.updateDisplayList=function(t,e){if(Wa._super.updateDisplayList.call(this,t,e),0!==t&&0!==e&&this._grid){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=0,n=0;this._grid.getSortExpertMode()&&!this._getFieldSortInfo()||!this._sortItemRendererInstance||(r=this._sortItemRendererInstance.getExplicitOrMeasuredWidth(),n=this._sortItemRendererInstance.getExplicitOrMeasuredHeight());var o=this.getStyle("horizontalGap"),a=0,l=0;this._filterIcon&&this._filterIcon.getVisible()&&(l=a=16),0==r&&0==a&&(o=0);var h=this._labelElement.getWidth(),d=t-r-a-o-i-s,c=!1;this._add_text_width_padding||(h+=pa.TEXT_WIDTH_PADDING,this._add_text_width_padding=!0),0>d&&(d=0),d<h&&(c=!0,h=d);var d=this._labelElement.getWordWrap()?this._labelElement.getTextHeight():this._labelElement.getHeight(),_=e-0-0;_<d&&(c=!0,d=_),this._labelElement.getVisibility()||this._labelElement.setVisibility(!0),0===h&&0===d||(this._labelElement.setPxStyle("width",h),c&&!this._labelElement.getMultiline()&&this._labelElement.truncateToFit(),c=this.getStyle("horizontalAlign"),i=Math.max("left"===c?i:"right"===c?t-s-r-a-o-h:(t-h-i-s-o-r-a)/2+i,0),this._labelElement.setStyle("textAlign",c),h=this.getStyle("verticalAlign"),d=Math.max("top"===h?0:"bottom"===h?e-d-0+1:(e-d-0-0)/2+0,0),this._labelElement.setX(Math.round(i)),this._labelElement.setY(Math.round(d)),this._sortItemRendererInstance&&(n=(e-n-0-0)/2,this._sortItemRendererInstance.setX(Math.round(t-r-o-s)),this._sortItemRendererInstance.setY(Math.round(n))),this._filterIcon&&this._filterIcon.getVisible()&&(s=t-r-a-s,l=(e-l-0-0)/2,(r=this._getFieldFilterInfo())?(this._filterIcon.setToolTip(r.str),this._filterIcon.setSrc(Ma+"funnelS.png")):(this._filterIcon.setToolTip(null),this._filterIcon.setSrc(Ma+"funnel.png")),this._filterIcon.setX(Math.round(s)),this._filterIcon.setY(Math.round(l))),this._sortItemRendererInstance&&(this._grid.getSortExpertMode()||this._data instanceof fb?this._ldiv&&this._ldiv.setVisibility(!1):this._partsSeparatorSkinClass?(this._partsSeparatorSkin.setX(this._sortItemRendererInstance.getX()-o-this._partsSeparatorSkin.getWidth()),this._partsSeparatorSkin.setY((e-this._partsSeparatorSkin.getHeight())/2)):(this._ldiv?this._ldiv.setVisibility(!0):(this._ldiv=new A("div","DataGridLineV"),this.addChild(this._ldiv)),this._ldiv.setStyle("borderColor",this.getStyle("separatorColor")?this.getStyle("separatorColor"):"#CCCCCC"),this._ldiv.setX(this._sortItemRendererInstance.getX()-1),this._ldiv.setY(1),this._ldiv.setHeightInline(e-1))))}},Wa.prototype.mouseEventToHeaderPart=function(t){return t=new ra(t.pageX,t.pageY),t=this.globalToLocal(t),this._filterIcon?t.x<this._filterIcon.getX()?"headerTextPart":t.x<this._sortItemRendererInstance.getX()?"headerIconFilter":"headerIconPart":t.x<this._sortItemRendererInstance.getX()?"headerTextPart":"headerIconPart"},Wa.prototype._dragStartHandler=function(t){this._enabled&&this._column&&"DataGridColumn"==this._column.className&&this._column.getDataField()&&t.dataTransfer.setData("Text",this._column.getDataField())},Wa.prototype._selectStartHandler=function(t){if(this._enabled&&this._column&&"DataGridColumn"==this._column.className&&this._column.getDataField())return t.target.dragDrop(),!1},z(mb,qa),mb.prototype.getListData=function(){return this._listData},mb.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties(),this.invalidateSize()},mb.prototype.setExplicitHeight=function(t){this._explicitHeight!=t&&(isNaN(t)||(this._percentHeight=NaN),this._explicitHeight=t,this._height!=t&&(this._height=t,m.setPxStyle(this,"height",t),this.element.style.height=t+"px"))},mb.prototype.setExplicitWidth=function(t){this._explicitWidth!=t&&(isNaN(t)||(this._percentWidth=NaN),this._explicitWidth=t,this.setWidth(t))},mb.prototype.getHeight=function(){return I(this._height)||0==this._height?this._visible?(isNaN(this._offsetHeight)&&(this._offsetHeight=m.getOffsetHeight(this.element)),this._offsetHeight):0:this._height},mb.prototype.setHeight=function(t){this._height!=t&&(this._height=t,this.element.style.height=t+"px")},mb.prototype.getWidth=function(){return I(this._width)||0==this._width?this._visible?(isNaN(this._offsetWidth)&&(this._offsetWidth=m.getOffsetWidth(this.element)),this._offsetWidth):0:this._width},mb.prototype.setWidth=function(t){var e;this._width!=t&&(this._width=t,r.useBorderBox&&!this._useContentBox?m.setPxStyle(this,"width",t):(e=m.getSizeStyle(this,"paddingLeft")+m.getSizeStyle(this,"paddingRight"),m.setPxStyle(this,"width",0<t-e?t-e:0)))},mb.prototype._getTextWidth=function(){var t=this.element.style;return t.width&&"auto"!=t.width?this.element.scrollWidth:this.getWidth()},mb.prototype._getTextHeight=function(){var t=this.element.style;return t.height&&"auto"!=t.height?this.element.scrollHeight:m.getOffsetHeight(this.element)},mb.prototype.commitProperties=function(){var t,e,i,s=!1;if(this._offsetHeight=this._offsetWidth=NaN,this._labelOriColor=void 0,this._listDataChanged){if(mb._super.commitProperties.call(this),this._listData){var r=this._listData.owner,n=r.getColumns()[this._listData.columnIndex];t=this._listData.label,i=this._data instanceof C?r._columnHeaderWordWrap(n):r._columnWordWrap(n),m.setWordWrap(this.element,i),r.getVariableRowHeight()&&(s=!0),this._visible?m.setStyle(this.element,"display",s?"inline-block":"inline"):this._oldDisplay=s?"inline-block":"inline",(s||i)&&this.element.style.height&&(this._height=void 0,this._offsetHeight=this._oldMinWidth=NaN,this.clearStyle("height")),t&&"0px"===this.element.style.height&&(this._height=void 0,this._offsetHeight=this._oldMinWidth=NaN,this.clearStyle("height")),i=r.getShowDataTips(),n&&(n.getTruncateToFit()&&"ellipsis"!=this.getStyle("textOverflow")&&this.setStyle("textOverflow","ellipsis"),!0===n.getShowDataTips()&&(i=!0),!1===n.getShowDataTips()&&(i=!1),i&&(this._data instanceof C||!(n.getDataTipFunction()||n.getDataTipField()||r.getDataTipFunction()||r.getDataTipField())||(e=n.itemToDataTip(this._data)))),Xb&&(n&&0==n.colNum&&0<r.getSelectionMode().indexOf("Row")?(i="rowheader",r=r._getRowItemIds(this._listData.rowIndex)):(i="gridcell",r=r&&r.getEditable().length&&n&&n.editable?"Kool__"+r.uno+"_Column"+this._listData.columnIndex+" Kool__"+r.uno+"_editableLabel":"Kool__"+r.uno+"_Column"+this._listData.columnIndex),this.element.tabIndex=-1,this.setAttr("id",this.name),this.setAttr("role",i),this.setAttr("aria-describedby",r))}else t="";t?(" "==t&&(t=""),this._labelNode?this._labelNode.nodeValue!=t&&(this._labelNode.nodeValue=t):(this._labelNode=document.createTextNode(t),this.element.appendChild(this._labelNode))):this._labelNode?""!=this._labelNode.nodeValue&&(this._labelNode.nodeValue=""):(this._labelNode=document.createTextNode(""),this.element.appendChild(this._labelNode)),e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},mb.prototype.measure=function(){if(this._data&&this._listData&&this._labelNode){mb._super.measure.call(this);var t,e;t=isNaN(this._explicitWidth)?this.getWidth():this._explicitWidth,e=this._listData.owner;var i=e.getColumns()[this._listData.columnIndex];e=this._data instanceof C?e._columnHeaderWordWrap(i):e._columnWordWrap(i),e=(this._listData.owner.getVariableRowHeight()||e)&&isNaN(this._offsetHeight)?this._getTextHeight():this.getHeight(),this.measuredMinWidth=this.measuredWidth=t,this.measuredMinHeight=this.measuredHeight=e}},mb.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i=this.element,s=m,n=s.getSizeStyle,o=0;this._height!=e&&(this._height=e,r.useBorderBox&&!this._useContentBox||(o=n(i,"paddingTop")+n(i,"paddingBottom")),s.setPxStyle(i,"height",0<e-o?e-o:0)),this._width!=t&&(this._width=t,r.useBorderBox&&!this._useContentBox||(o=n(i,"paddingLeft")+n(i,"paddingRight")),s.setPxStyle(i,"width",0<t-o?t-o:0))}},mb.prototype.notifyStyleChangeInChildren=function(t,e){},mb.prototype.validateDisplayList=function(){var t,e=this.element.style.color;if(this._invalidateDisplayListFlag){if(this._listData&&this.getParent()){var i=this._listData.owner;!this._enabled||i.isItemDeleted(this._listData.uid)?t=i.getStyle("disabledColor"):i.isItemHighlighted(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex)?t=i.getStyle("textRollOverColor"):i.isItemSelected(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex)&&(t=i.getStyle("textSelectedColor")),t?t!=e&&(this.element.style.color=t):this._labelOriColor?this._labelOriColor!=e&&(this.element.style.color=this._labelOriColor):e&&(this.element.style.color="")}this._runInvalidateDisplayListFlag=this._invalidateDisplayListFlag=!1}},mb.prototype.setStyle=function(t,e){Wa._super.setStyle.call(this,t,e),"color"===t&&(this._labelOriColor=e)};var nd=function(t,e,i,s,r,n){this.columnIndex=i,this.dataField=e,this.label=t,this.owner=r,this.rowIndex=5<arguments.length?n:0,this.ouid=this.uid=s};kd._defaultStyles={paddingLeft:"1px",paddingRight:"1px"},z(kd,C),kd.prototype.getChangedData=function(){return this.owner?this.owner.getChangedData():null},kd.prototype.getItemUpdated=function(t){return null==t?null:F(t)&&this.owner?this.owner.getChangedData()[t]:this.owner?this.owner.getChangedData()[this._itemToUID(t)]:null},kd.prototype.getItemUpdatedByUID=function(t){return null==t?null:this.owner?this.owner.getChangedData()[t]:void 0},kd.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},kd.prototype.clone=function(){var t=new kd;return this._copyProperties(t),t},Aa._defaultStyles={paddingLeft:"1px",paddingRight:"1px"},z(Aa,C),Aa.prototype.getAllItemSelected=function(){return this._allItemSelected},Aa.prototype.setAllItemSelected=function(t){this._allowMultipleSelection&&(this._allItemSelected=t,this._clearSelectionData(),this._selectedItems=[],this._selectedItem=null,t=new L(L.CHANGE),t.itemRenderer=null,t.columnIndex=this.colNum,t.rowIndex=-1,this.dispatchEvent(t),this._checkAndSetDataGridSelection(),this.owner&&this.owner.invalidateList())},Aa.prototype.getAllowAllSelection=function(){return this._allowAllSelection},Aa.prototype.setAllowAllSelection=function(t){this._allowAllSelection=t,this._allowMultipleSelection?(this._headerRenderer=this._allowAllSelection?new kb(tb):null,this._itemRenderer=new kb(Vb)):(this._headerRenderer=null,this._itemRenderer=new kb(fc),this._allItemSelected=!1),this._clearSelectionData(),this.owner&&this.owner.invalidateList()},Aa.prototype.getAllowMultipleSelection=function(){return this._allowMultipleSelection},Aa.prototype.setAllowMultipleSelection=function(t){(this._allowMultipleSelection=t)?(this._headerRenderer=this._allowAllSelection?new kb(tb):null,this._itemRenderer=new kb(Vb)):(this._headerRenderer=null,this._itemRenderer=new kb(fc),this._allowAllSelection=this._allItemSelected=!1),this._clearSelectionData(),this.owner&&this.owner.invalidateList()},Aa.prototype.getSelectedIndex=function(){return this._getSelectedIndex()},Aa.prototype.setSelectedIndex=function(t){this.owner&&this.owner.getDataProvider()&&0!=this.owner.getDataProvider().getLength()&&(this._commitSelectedIndex(t),this.owner.invalidateList())},Aa.prototype.getSelectedIndices=function(){return this._getSelectedIndices()},Aa.prototype.setSelectedIndices=function(t){this.owner&&this.owner.getDataProvider()&&0!=this.owner.getDataProvider().getLength()&&(this._commitSelectedIndices(t),this.owner.invalidateList())},Aa.prototype.getSelectedItem=function(){if(this._allItemSelected){var e=this.owner.getDataProvider();if(e){if(e=e.createCursor(),null==this.getSecondLabelFunction())return e.seek(t.getFIRST()),e.getCurrent();for(;!e.getAfterLast();){var i=e.getCurrent();if(this.itemToSecondLabel(i))return i;e.moveNext()}}return null}return this._selectedItem},Aa.prototype.setSelectedItem=function(t){this.owner.getDataProvider()&&0!=this.owner.getDataProvider().getLength()?(this._commitSelectedItem(t),this.owner.invalidateList()):this._selectedItem=t},Aa.prototype.getSelectedItems=function(){if(this._allItemSelected){var t=[],e=this.owner.getDataProvider();if(e)for(e=e.createCursor();!e.getAfterLast();){var i=e.getCurrent();null!=this.getSecondLabelFunction()?this.itemToSecondLabel(i)&&t.push(i):t.push(i),e.moveNext()}return t.reverse()}return this._selectedItems},Aa.prototype.setSelectedItems=function(t){this.owner&&this.owner.getDataProvider()&&0!=this.owner.getDataProvider().getLength()?(this._commitSelectedItems(t),
this.owner.invalidateList()):this._selectedItems=t},Aa.prototype._addSelectedItem=function(t,e,i,s){if(this._allowMultipleSelection||(this._clearSelectionData(),this._selectedItems=[]),!this._selectedData[t]){if(this._addSelectionData(t,new Nb(e,i+this.owner.getVerticalScrollPosition(),(!1))),this._selectedItems.unshift(e),this.allowChildrenSelection&&this._allowMultipleSelection){var r,n;if(t=this.owner.getDataProvider(),t instanceof T&&(r=this._getAllChildren(t,e))&&r.length){for(t=0;t<r.length;t++)n=this._itemToUID(r[t]),this._removeSelectionData(n),this._addSelectionData(n,new Nb(r[t],i+this.owner.getVerticalScrollPosition()+t+1,(!1))),0>Ra.indexOf(this._selectedItems,r[t])&&this._selectedItems.push(r[t]);this.owner.invalidateList()}}this._checkAllItemSelected()}this._selectedItem=e,e=new L(L.CHANGE),e.itemRenderer=s,e.columnIndex=this.colNum,e.rowIndex=i+this.owner.getVerticalScrollPosition(),this.dispatchEvent(e),this._checkAndSetDataGridSelection(),!this._allowMultipleSelection&&this.owner&&this.owner._invalidateColumnRenderers(this.colNum)},Aa.prototype._removeSelectedItem=function(t,e){var i=this.owner.getDataProvider(),s=0;if(this._allowMultipleSelection&&this._allItemSelected){this.setAllItemSelected(!1),this._clearSelectionData(),this._selectedItems=[];for(var r,n=0,o=i.createCursor();!o.getAfterLast();){var a=o.getCurrent(),l=this._itemToUID(a);t==l?(s=n,r=a):null!=this.getSecondLabelFunction()?this.itemToSecondLabel(a)&&(this._addSelectionData(l,new Nb(a,n,(!1))),this._selectedItems.push(a)):(this._addSelectionData(l,new Nb(a,n,(!1))),this._selectedItems.push(a)),o.moveNext(),n++}if(this.allowChildrenSelection&&this._allowMultipleSelection&&r&&i instanceof T&&(r=this._getAllChildren(i,r))&&r.length){for(i=0;i<r.length;i++)this._removeSelectionData(this._itemToUID(r[i])),n=Ra.indexOf(this._selectedItems,r[i]),0<=n&&this._selectedItems.splice(Ra.indexOf(this._selectedItems,r[i]),1);this.owner.invalidateList()}this._selectedItems=this._selectedItems.reverse(),this._selectedItem=a}else if(a=this._selectedData[t]){if(s=a.index,this._removeSelectionData(t),this.allowChildrenSelection&&this._allowMultipleSelection&&i instanceof T&&(r=this._getAllChildren(i,a.data))&&r.length){for(i=0;i<r.length;i++)this._removeSelectionData(this._itemToUID(r[i]));this.owner.invalidateList()}this._allowMultipleSelection&&(this._selectedItems=this._copySelectedItems(!0)),this._selectedItem=this._firstSelectionData?this._firstSelectionData.data:null}a=new L(L.CHANGE),a.itemRenderer=e,a.columnIndex=this.colNum,a.rowIndex=s,this.dispatchEvent(a),this._checkAndSetDataGridSelection(),!this._allowMultipleSelection&&this.owner&&this.owner._invalidateColumnRenderers(this.colNum)},Aa.prototype._getAllChildren=function(t,e,i){var s,r;if(!(t&&t instanceof T))return null;if(i||(i=[]),null==e)return i;if(e=t.getChildren(e))for(r=0;r<e.getLength();r++)s=e.getItemAt(r),i.push(s),t.getSource().hasChildren(s)&&(i=this._getAllChildren(t,s,i));return i},Aa.prototype._checkAndSetDataGridSelection=function(t,e,i){if(t=this.owner,"selectorColumn"==t.getSelectionMode()&&t.getSelectorColumnIndex()==this.colNum){e=this.getSelectedItems(),i=t._caretIndex;var s=t._anchorIndex,r=t._caretBookmark,n=t._anchorBookmark;t._commitSelectedItems(e.slice(0)),t._caretIndex=i,t._anchorIndex=s,t._caretBookmark=r,t._anchorBookmark=n}},Aa.prototype.isItemSelected=function(t){return!(null==t||null!=this.getSecondLabelFunction()&&!this.itemToSecondLabel(t))&&(!!this._allItemSelected||(F(t)?!I(this._selectedData[t]):!I(this._selectedData[this._itemToUID(t)])))},Aa.prototype.isItemSelectedByUID=function(t){return null!=t&&(!!this._allItemSelected||!I(this._selectedData[t]))},Aa.prototype._checkAllItemSelected=function(){if(this._allowMultipleSelection)if(this._selectedItems&&0!=this._selectedItems.length)if(this._allowAllSelection&&this.owner){var t,e=this.owner.getDataProvider(),i=0,s=e.getLength();if(null!=this.getSecondLabelFunction())for(t=0;t<s;t++)this.itemToSecondLabel(this._getItemAt(e,null,t))&&i++;else i=s;e=this._selectedItems.length==i,this._allItemSelected!=e&&(this._allItemSelected=e,this.owner.invalidateList())}else this._allItemSelected=!1;else 0!=this._allItemSelected&&(this._allItemSelected=!1,this.owner&&this.owner.invalidateList());else this._allItemSelected=!1},Aa.prototype._commitSelectedIndex=function(t){if(-1!=t){t=Math.min(t,this.owner.getDataProvider().getLength()-1);var e=this._getItemAt(this.owner.getDataProvider(),null,t),i=this._itemToUID(e);this._clearSelectionData(),this._addSelectionData(i,new Nb(e,t,(!1))),this._selectedItem=e,this._selectedItems=[e],null==this.getSecondLabelFunction()||this.itemToSecondLabel(e)||(this._selectedItem=null,this._selectedItems=[],this._clearSelectionData()),this._checkAllItemSelected()}else this._selectedItem=null,this._selectedItems=[],this._allItemSelected=!1,this._clearSelectionData();this._checkAndSetDataGridSelection()},Aa.prototype._commitSelectedIndices=function(t){if(t){this._clearSelectionData(),this._selectedItems=[];var e,i,s,r=[];for(e=0;e<t.length;e++)0>Ra.indexOf(r,t[e])&&r.push(t[e]);for(e=0;e<r.length;e++)t=Math.min(r[e],this.owner.getDataProvider().getLength()-1),i=this._getItemAt(this.owner.getDataProvider(),null,t),s=this._itemToUID(i),(null==this.getSecondLabelFunction()||this.itemToSecondLabel(i))&&(this._addSelectionData(s,new Nb(i,t,(!1))),this._selectedItems.push(i));this._selectedItem=i,this._checkAllItemSelected()}else this._selectedItem=null,this._selectedItems=[],this._allItemSelected=!1,this._clearSelectionData();this._checkAndSetDataGridSelection()},Aa.prototype._commitSelectedItem=function(t){null!=t&&this._commitSelectedItems([t])},Aa.prototype._commitSelectedItems=function(t){if(t){this._clearSelectionData(),this._selectedItems=[];var e,i,s,r;for(e=0;e<t.length;e++)s=t[e],i=this._getItemIndex(this.owner.getDataProvider(),null,s),r=this._itemToUID(s),(null==this.getSecondLabelFunction()||this.itemToSecondLabel(s))&&(this._addSelectionData(r,new Nb(s,i,(!1))),this._selectedItems.push(s));this._selectedItem=s,this._checkAllItemSelected()}else this._selectedItem=null,this._selectedItems=[],this._allItemSelected=!1,this._clearSelectionData()},Aa.prototype._getSelectedIndex=function(){return this._firstSelectionData?this._getItemIndex(this.owner.getDataProvider(),null,this._firstSelectionData.data):this._allItemSelected?0:-1},Aa.prototype._getSelectedIndices=function(){if(this._firstSelectionData)return this._copySelectedItems(!1,!0);var t=[];if(this._allItemSelected){var e,i=this.owner.getDataProvider(),s=i.getLength();if(null!=this.getSecondLabelFunction())for(e=0;e<s;e++)this.itemToSecondLabel(this._getItemAt(i,null,e))&&t.push(e);else for(e=0;e<s;e++)t.push(e)}return t},Aa.prototype._copySelectedItems=function(t,e){t=!(0<arguments.length)||t,e=1<arguments.length&&e;var i,s=[],r=this.owner.getDataProvider(),n=this._firstSelectionData;for(r instanceof T&&(i=r.createCursor());null!=n;){if(null==this.getSecondLabelFunction()||this.itemToSecondLabel(n.data))if(t)s.push(n.data);else if(e){var o=this._getItemIndex(r,i,n.data);0<=o&&s.push(o)}else s.push(n.index);n=n.nextSelectionData}return s},Aa.prototype._getItemIndex=function(e,i,s){if(!(e instanceof T))return e.getItemIndex(s);var r=0;for(i||(i=e.createCursor()),i.seek(t.getFIRST());!i.getAfterLast();){if(i.getCurrent()===s)return r;i.moveNext(),r++}return-1},Aa.prototype._getItemAt=function(e,i,s){return e instanceof T?(i||(i=e.createCursor()),i.seek(t.getFIRST(),s),i.getCurrent()):e.getItemAt(s)},Aa.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},Aa.prototype._clearSelectionData=function(){this._selectedData={},this._firstSelectionData=null},Aa.prototype._addSelectionData=function(t,e){this._firstSelectionData&&(this._firstSelectionData.prevSelectionData=e),e.nextSelectionData=this._firstSelectionData,this._firstSelectionData=e,this._selectedData[t]=e},Aa.prototype._removeSelectionData=function(t){var e=this._selectedData[t];e&&(this._firstSelectionData==e&&(this._firstSelectionData=e.nextSelectionData),e.prevSelectionData&&(e.prevSelectionData.nextSelectionData=e.nextSelectionData),e.nextSelectionData&&(e.nextSelectionData.prevSelectionData=e.prevSelectionData),delete this._selectedData[t])},Aa.prototype.clearSelection=function(){this._allItemSelected=!1,this._commitSelectedItems(null),this.owner&&this.owner.invalidateList()},Aa.prototype.removeSelection=function(t){if(this._allowMultipleSelection&&this._allItemSelected){this._clearSelectionData(),this._selectedItems=[];for(var e=0,i=this.owner.getDataProvider().createCursor();!i.getAfterLast();){var s=i.getCurrent(),r=this._itemToUID(s);t!=r&&(null!=this.getSecondLabelFunction()?this.itemToSecondLabel(s)&&(this._addSelectionData(r,new Nb(s,e,(!1))),this._selectedItems.push(s)):(this._addSelectionData(r,new Nb(s,e,(!1))),this._selectedItems.push(s))),i.moveNext(),e++}this._selectedItems=this._selectedItems.reverse(),this._selectedItem=s,this._checkAllItemSelected()}else this._selectedData[t]&&(this._removeSelectionData(t),this._allowMultipleSelection&&(this._selectedItems=this._copySelectedItems(!0)),this._selectedItem=this._firstSelectionData?this._firstSelectionData.data:null)},Aa.prototype._copyProperties=function(t){Aa._super.copyProperties.call(this,t),t instanceof Aa&&(t.setAllItemSelected(this.getAllItemSelected()),t.setAllowAllSelection(this.getAllowAllSelection()),t.setAllowMultipleSelection(this.getAllowMultipleSelection()),t.setSelectedIndex(this.getSelectedIndex()),t.setSelectedIndices(this.getSelectedIndices()))},Aa.prototype.clone=function(){var t=new Aa;return this._copyProperties(t),t},z(ec,u),ec.UP_ICON_NAME="up-arrow-black.png",ec.DOWN_ICON_NAME="down-arrow-black.png",ec.prototype.getDescending=function(){return this._descending},ec.prototype.setDescending=function(t){this._descending!=t&&(this._descending=t,this.invalidateDisplayList())},ec.prototype.createChildren=function(){ec._super.createChildren.call(this),this._labelElement||(this._labelElement=new pa,this._labelElement.setText(""),this.addChild(this._labelElement)),this._iconElement||(this._iconElement=document.createElement("img"),this._iconElement.src=Ma+ec.UP_ICON_NAME,this._iconElement.alt=B.getString("datagrid","sortAscending"),this.element.appendChild(this._iconElement))},ec.prototype.commitProperties=function(){ec._super.commitProperties.call(this);var t,e=this._getFieldSortInfo(),i=!1;e?(this.setVisibility(!0),this.getParent()&&this.getParent().owner&&this.getParent().owner instanceof l&&(t=this.getParent().owner),t&&(i=t.getSortExpertMode()),i&&1==e.sortFieldsCount?this._labelElement.setText(""):this._labelElement.setText(e.sequenceNumber.toString()),e.status==Zc.PROPOSEDSORT?this._labelElement.setStyle("color",t.getStyle("proposedColor")?t.getStyle("proposedColor"):"#999999"):this._labelElement.setStyle("color",t.getStyle("color")?t.getStyle("color"):"#000000"),this._descending=e.descending,this.invalidateDisplayList()):this.getVisibility()&&this.setVisibility(!1)},ec.prototype.measure=function(){ec._super.measure.call(this),this.measuredMinWidth=this.measuredWidth=16,this.measuredMinHeight=this.measuredHeight=13},ec.prototype.updateDisplayList=function(t,e){ec._super.updateDisplayList.call(this,t,e),0!=t&&(this._descending?(this._iconElement.src=Ma+ec.DOWN_ICON_NAME,this._iconElement.alt=B.getString("datagrid","sortDescending")):(this._iconElement.src=Ma+ec.UP_ICON_NAME,this._iconElement.alt=B.getString("datagrid","sortAscending")))},ec.prototype._getFieldSortInfo=function(){var t,e;return this.getParent()&&this.getParent().owner&&this.getParent().owner instanceof l&&(t=this.getParent().owner,this.getParent()instanceof qa&&(e=this.getParent().getListData())&&-1!=e.columnIndex)?t.getFieldSortInfo(t.getColumns()[e.columnIndex]):null},Pa._defaultStyles={stroke:"#333333",strokeWidth:0,fill:"#333333",maxPointStroke:"#00B1BA",maxPointFill:"#00B1BA",minPointStroke:"#FF3E3E",minPointFill:"#FF3E3E",minusPointsStroke:"#FF7C33",minusPointsFill:"#FF7C33",firstPointStroke:"#FFA017",firstPointFill:"#FFA017",lastPointStroke:"#2A9EF4",lastPointFill:"#2A9EF4",zeroAxisStroke:"#222222",zeroAxisStrokeWidth:1},z(Pa,C),Pa.prototype.getColumnWidthRatio=function(){return this._columnWidthRatio},Pa.prototype.setColumnWidthRatio=function(t){this._columnWidthRatio=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getDataFields=function(){return this._dataFields},Pa.prototype.setDataFields=function(t){this._dataFields=t,ha(t)?this._dataFieldsArr=t:this._dataFieldsArr=t?t.split(","):t,this.owner&&this.owner.invalidateList()},Pa.prototype.getHorizontalAxisInvert=function(){return this._horizontalAxisInvert},Pa.prototype.setHorizontalAxisInvert=function(t){this._horizontalAxisInvert=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getRadius=function(){return this._radius},Pa.prototype.setRadius=function(t){this._radius=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowAllPoints=function(){return this._showAllPoints},Pa.prototype.setShowAllPoints=function(t){this._showAllPoints=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowFirstPoint=function(){return this._showFirstPoint},Pa.prototype.setShowFirstPoint=function(t){this._showFirstPoint=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowLastPoint=function(){return this._showLastPoint},Pa.prototype.setShowLastPoint=function(t){this._showLastPoint=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowMaxPoint=function(){return this._showMaxPoint},Pa.prototype.setShowMaxPoint=function(t){this._showMaxPoint=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowMinPoint=function(){return this._showMinPoint},Pa.prototype.setShowMinPoint=function(t){this._showMinPoint=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowMinusPoints=function(){return this._showMinusPoints},Pa.prototype.setShowMinusPoints=function(t){this._showMinusPoints=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getShowZeroAxis=function(){return this._showZeroAxis},Pa.prototype.setShowZeroAxis=function(t){this._showZeroAxis=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getVerticalAxisMaximum=function(){return this._verticalAxisMaximum},Pa.prototype.setVerticalAxisMaximum=function(t){this._verticalAxisMaximum=t,this.owner&&this.owner.invalidateList()},Pa.prototype.getVerticalAxisMinimum=function(){return this._verticalAxisMinimum},Pa.prototype.setVerticalAxisMinimum=function(t){this._verticalAxisMinimum=t,this.owner&&this.owner.invalidateList()},Pa.prototype.itemToDataArray=function(t){var e,i,s=[];if(!this._dataFields||!this._dataFieldsArr)return null;if(Ea(t))for(e=0;e<this._dataFieldsArr.length;e++){var r=this._dataFieldsArr[e];if(r)try{i=E(t)?G.getProperty(t,r):t[r],ze(i)?s.push(NaN):s.push(Number(i))}catch(n){s.push(NaN)}else s.push(NaN)}return s},Pa.prototype.itemToDataTip=function(t){if(null!=this.getDataTipFunction())return this.getDataTipFunction()(t,this.itemToDataArray(t),this);if(null!=this.owner.getDataTipFunction())return this.owner.getDataTipFunction()(t);if(t instanceof C)return t.getHeaderText();if(Ea(t)){var e=this._dataTipField;e||(e=this.owner.getDataTipField());try{E(t)?null!=G.getProperty(t,e)?t=G.getProperty(t,e):null!=this.itemToDataArray(t)&&(t=this.itemToDataArray(t)):null!=t[e]?t=t[e]:null!=this.itemToDataArray(t)&&(t=this.itemToDataArray(t))}catch(i){t=null}}if(F(t))return t;try{return t.toString()}catch(i){}return" "},Pa.prototype._copyProperties=function(t){Pa._super._copyProperties.call(this,t),t._columnWidthRatio=this._columnWidthRatio,t._dataFieldsArr=this._dataFieldsArr,t._dataFields=this._dataFields,t._horizontalAxisInvert=this._horizontalAxisInvert,t._radius=this._radius,t._showAllPoints=this._showAllPoints,t._showFirstPoint=this._showFirstPoint,t._showLastPoint=this._showLastPoint,t._showMaxPoint=this._showMaxPoint,t._showMinPoint=this._showMinPoint,t._showMinusPoints=this._showMinusPoints,t._showZeroAxis=this._showZeroAxis,t._verticalAxisMaximum=this._verticalAxisMaximum,t._verticalAxisMinimum=this._verticalAxisMinimum,t.setStyle("stroke",this.getStyle("stroke")),t.setStyle("strokeWidth",this.getStyle("strokeWidth")),t.setStyle("fill",this.getStyle("fill")),t.setStyle("maxPointStroke",this.getStyle("maxPointStroke")),t.setStyle("maxPointFill",this.getStyle("maxPointFill")),t.setStyle("minPointStroke",this.getStyle("minPointStroke")),t.setStyle("minPointFill",this.getStyle("minPointFill")),t.setStyle("minusPointsStroke",this.getStyle("minusPointsStroke")),t.setStyle("minusPointsFill",this.getStyle("minusPointsFill")),t.setStyle("firstPointStroke",this.getStyle("firstPointStroke")),t.setStyle("firstPointFill",this.getStyle("firstPointFill")),t.setStyle("lastPointStroke",this.getStyle("lastPointStroke")),t.setStyle("lastPointFill",this.getStyle("lastPointFill")),t.setStyle("zeroAxisStroke",this.getStyle("zeroAxisStroke")),t.setStyle("zeroAxisStrokeWidth",this.getStyle("zeroAxisStrokeWidth"))},Pa.prototype.clone=function(){var t=new Pa;return this._copyProperties(t),t},z(Rb,qa),Rb.prototype.getListData=function(){return this._listData},Rb.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties(),this.invalidateSize()},Rb.prototype.createChildren=function(){Rb._super.createChildren.call(this);try{this._graphics=this.element.getContext("2d"),this._graphics.clearRect(0,0,20,10)}catch(t){this._graphics=null}},Rb.prototype.commitProperties=function(){if(r.supportCanvas){var t;if(this._listDataChanged){if(Rb._super.commitProperties.call(this),this._listData&&this._data){var e=this._listData.owner,i=e.getColumns()[this._listData.columnIndex];(this._sparkData=i.itemToDataArray(this._data))&&i.getHorizontalAxisInvert()&&this._sparkData.reverse();var s=e.getShowDataTips();i&&(!0===i.getShowDataTips()&&(s=!0),!1===i.getShowDataTips()&&(s=!1),s&&(this._data instanceof C||!(i.getDataTipFunction()||i.getDataTipField()||e.getDataTipFunction()||e.getDataTipField())||(t=i.itemToDataTip(this._data))),this._vMinimum=i.getVerticalAxisMinimum(),this._vMaximum=i.getVerticalAxisMaximum())}else this._sparkData=null;if(this._sparkData){var n=this._sparkData.length;for(this._yMax=this._yMin=NaN,e=0;e<n;e++)isNaN(this._sparkData[e])||(isNaN(this._yMin)?this._yMin=this._sparkData[e]:this._yMin=Math.min(this._sparkData[e],this._yMin),isNaN(this._yMax)?this._yMax=this._sparkData[e]:this._yMax=Math.max(this._sparkData[e],this._yMax));isNaN(this._vMinimum)&&(this._vMinimum=this._yMin),isNaN(this._vMaximum)&&(this._vMaximum=this._yMax)}s?(t=t?t:this._sparkData?this._sparkData.toString():i.itemToDataTip(this._data),this.element.title!=t&&(this.element.title=t)):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}}},Rb.prototype.setExplicitWidth=function(t){this._width!=t&&(this.setWidth(t),this._explicitWidth=this._width=t)},Rb.prototype.setWidth=function(t){var e=this.element,i=m.getSizeStyle;this._width!=t&&(this._width=t,i=i(e,"paddingLeft")+i(e,"paddingRight"),e.width=0<t-i?t-i:0),Rb._super.setWidth.call(this,t)},Rb.prototype.setHeight=function(t){var e=this.element,i=m.getSizeStyle;this._height!=t&&(this._height=t,i=i(e,"paddingTop")+i(e,"paddingBottom"),e.height=0<t-i?t-i:0),Rb._super.setHeight.call(this,t)},Rb.prototype.setActualSize=function(t,e){if(!O(t)&&!O(e)){var i,s=this.element,r=m.getSizeStyle;this._height!=e&&(this._height=e,i=r(s,"paddingTop")+r(s,"paddingBottom"),s.height=0<e-i?e-i:0),this._width!=t&&(this._width=t,i=r(s,"paddingLeft")+r(s,"paddingRight"),s.width=0<t-i?t-i:0)}},Rb.prototype.measure=function(){if(r.supportCanvas&&this._data&&this._listData){Rb._super.measure.call(this);var t,e;e=this.measureText("W"),t=isNaN(this._explicitWidth)?e.width:this._explicitWidth,e=e.height,this.measuredMinWidth=this.measuredWidth=t,this.measuredMinHeight=this.measuredHeight=e}},z(Be,Rb),Be.prototype.updateDisplayList=function(t,e){var i=this._graphics;if(i&&this._listData&&this._sparkData&&1<this._sparkData.length&&this.getParent()){var s,r,n,o,a,l=this._listData.owner.getColumns()[this._listData.columnIndex],h=this.getSizeStyle("paddingLeft"),d=this.getSizeStyle("paddingRight"),c=this._sparkData.length,_=this._vMaximum-this._vMinimum;s=l.getColumnWidthRatio();var u,p;if(i.clearRect(0,0,t,e),i.strokeStyle=l.getStyle("stroke"),i.lineWidth=l.getStyle("strokeWidth"),i.fillStyle=l.getStyle("fill"),p=Math.abs(Math.round((1-(0-this._vMinimum)/_)*e))-.5,o=(t-h-d)/c,a=Math.round(o*s),l instanceof Pa){for(s=0;s<c;s++)isNaN(this._sparkData[s])||0==this._sparkData[s]||(u=this._sparkData[s],u=Math.min(this._vMaximum,u),u=Math.max(this._vMinimum,u),i.beginPath(),r=Math.round(o*s+(o-a)/2)-.5,n=Math.abs(Math.round((1-(u-this._vMinimum)/_)*e))-.5,l.getShowMaxPoint()&&this._sparkData[s]==this._yMax?(i.fillStyle=l.getStyle("maxPointFill"),i.strokeStyle=l.getStyle("maxPointStroke")):l.getShowMinPoint()&&this._sparkData[s]==this._yMin?(i.fillStyle=l.getStyle("minPointFill"),i.strokeStyle=l.getStyle("minPointStroke")):l.getShowFirstPoint()&&0==s?(i.fillStyle=l.getStyle("firstPointFill"),i.strokeStyle=l.getStyle("firstPointStroke")):l.getShowLastPoint()&&s==c-1?(i.fillStyle=l.getStyle("lastPointFill"),i.strokeStyle=l.getStyle("lastPointStroke")):l.getShowMinusPoints()&&0>this._sparkData[s]?(i.fillStyle=l.getStyle("minusPointsFill"),i.strokeStyle=l.getStyle("minusPointsStroke")):(i.fillStyle=l.getStyle("fill"),i.strokeStyle=l.getStyle("stroke")),n<=p?n==p?i.fillRect(r,p,a,0<u?-1:1):i.fillRect(r,p,a,Math.round(n-p)):i.fillRect(r,n,a,Math.round(p-n)),0<l.getStyle("strokeWidth")&&i.stroke(),i.fill(),i.closePath());l.getShowZeroAxis()&&0>=this._vMinimum&&0<=p&&(i.strokeStyle=l.getStyle("zeroAxisStroke"),i.lineWidth=l.getStyle("zeroAxisStrokeWidth"),i.beginPath(),i.moveTo(0,Math.round(p)-.5),i.lineTo(t-h-d,Math.round(p)-.5),i.stroke(),i.closePath())}}},z(me,Rb),me.prototype.updateDisplayList=function(t,e){var i=this._graphics;if(i&&this._listData&&this._sparkData&&1<this._sparkData.length&&this.getParent()){var s,r,n,o,a,l=this._listData.owner.getColumns()[this._listData.columnIndex],h=this.getSizeStyle("paddingLeft"),d=this.getSizeStyle("paddingRight"),c=this._sparkData.length,_=this._vMaximum-this._vMinimum,u=l.getRadius(),p=u/2,g=!0;for((l.getShowAllPoints()||l.getShowFirstPoint()||l.getShowLastPoint()||l.getShowMaxPoint()||l.getShowMinPoint()||l.getShowMinusPoints())&&(p=u),i.clearRect(0,0,t,e),i.strokeStyle=l.getStyle("stroke"),i.lineWidth=l.getStyle("strokeWidth"),i.beginPath(),a=Math.round((1-(0-this._vMinimum)/_)*(e-3*p)+p)+.5,o=(t-h-d-3*p)/(c-1),s=0;s<c;s++)isNaN(this._sparkData[s])?g=!0:(n=this._sparkData[s],n=Math.min(this._vMaximum,n),n=Math.max(this._vMinimum,n),r=Math.round(o*s)+.5+p,n=Math.abs(Math.round((1-(n-this._vMinimum)/_)*(e-3*p)+p)+.5),g&&i.moveTo(r,n),i.lineTo(r,n),g=!1);if(i.stroke(),i.closePath(),l instanceof Pa)for(l.getShowZeroAxis()&&0>=this._vMinimum&&0<=a&&(i.strokeStyle=l.getStyle("zeroAxisStroke"),i.lineWidth=l.getStyle("zeroAxisStrokeWidth"),i.beginPath(),i.moveTo(0,a),i.lineTo(t-h-d,a),i.stroke(),i.closePath()),s=0;s<c;s++)isNaN(this._sparkData[s])||(n=this._sparkData[s],n=Math.min(this._vMaximum,n),n=Math.max(this._vMinimum,n),i.beginPath(),r=Math.round(o*s+p)+.5,n=Math.abs(Math.round((1-(n-this._vMinimum)/_)*(e-3*p)+p)+.5),l.getShowMaxPoint()&&this._sparkData[s]==this._yMax?(i.fillStyle=l.getStyle("maxPointFill"),i.arc(r,n,u,0,2*Math.PI)):l.getShowMinPoint()&&this._sparkData[s]==this._yMin?(i.fillStyle=l.getStyle("minPointFill"),i.arc(r,n,u,0,2*Math.PI)):l.getShowFirstPoint()&&0==s?(i.fillStyle=l.getStyle("firstPointFill"),i.arc(r,n,u,0,2*Math.PI)):l.getShowLastPoint()&&s==c-1?(i.fillStyle=l.getStyle("lastPointFill"),i.arc(r,n,u,0,2*Math.PI)):l.getShowMinusPoints()&&0>this._sparkData[s]?(i.fillStyle=l.getStyle("minusPointsFill"),i.arc(r,n,u,0,2*Math.PI)):l.getShowAllPoints()&&(i.fillStyle=l.getStyle("fill"),i.arc(r,n,u,0,2*Math.PI)),i.fill(),i.closePath())}},z(Ce,Rb),Ce.prototype.updateDisplayList=function(t,e){var i=this._graphics;if(i&&this._listData&&this._sparkData&&1<this._sparkData.length&&this.getParent()){var s,r,n,o,a,l=this._listData.owner.getColumns()[this._listData.columnIndex],h=this.getSizeStyle("paddingLeft"),d=this.getSizeStyle("paddingRight"),c=this._sparkData.length;if(s=l.getColumnWidthRatio(),i.clearRect(0,0,t,e),i.strokeStyle=l.getStyle("stroke"),i.lineWidth=l.getStyle("strokeWidth"),i.fillStyle=l.getStyle("fill"),n=(t-h-d-1)/c,o=Math.round(n*s),a=Math.round(e/2),l instanceof Pa){for(s=0;s<c;s++)isNaN(this._sparkData[s])||0==this._sparkData[s]||(i.beginPath(),r=Math.round(n*s+(n-o)/2)-.5,l.getShowMaxPoint()&&this._sparkData[s]==this._yMax?(i.fillStyle=l.getStyle("maxPointFill"),i.strokeStyle=l.getStyle("maxPointStroke")):l.getShowMinPoint()&&this._sparkData[s]==this._yMin?(i.fillStyle=l.getStyle("minPointFill"),i.strokeStyle=l.getStyle("minPointStroke")):l.getShowFirstPoint()&&0==s?(i.fillStyle=l.getStyle("firstPointFill"),i.strokeStyle=l.getStyle("firstPointStroke")):l.getShowLastPoint()&&s==c-1?(i.fillStyle=l.getStyle("lastPointFill"),i.strokeStyle=l.getStyle("lastPointStroke")):l.getShowMinusPoints()&&0>this._sparkData[s]?(i.fillStyle=l.getStyle("minusPointsFill"),i.strokeStyle=l.getStyle("minusPointsStroke")):(i.fillStyle=l.getStyle("fill"),i.strokeStyle=l.getStyle("stroke")),0>=this._sparkData[s]?i.fillRect(r,a,o,a):i.fillRect(r,a,o,-a),0<l.getStyle("strokeWidth")&&i.stroke(),i.fill(),i.closePath());l.getShowZeroAxis()&&(i.strokeStyle=l.getStyle("zeroAxisStroke"),i.lineWidth=l.getStyle("zeroAxisStrokeWidth"),i.beginPath(),i.moveTo(0,Math.round(a)-.5),i.lineTo(t-h-d,Math.round(a)-.5),i.stroke(),i.closePath())}}},z(be,mb),be.prototype.commitProperties=function(){var t,e,i;if(this._offsetHeight=this._offsetWidth=NaN,this._labelOriColor=void 0,this._listDataChanged){if(this._listData){t=this._listData;var s=t.owner,r=s.getColumns()[t.columnIndex];if(!(r instanceof C))return;t=r.dataProviderToLabel(this._data,r.itemToData(this._data));var n=s.getShowDataTips();i=this._data instanceof C?s._columnHeaderWordWrap(r):s._columnWordWrap(r),m.setWordWrap(this.element,i),r.getTruncateToFit()&&(i=this.getStyle("textOverflow"),"ellipsis"!=i&&this.setStyle("textOverflow","ellipsis")),!0===r.getShowDataTips()&&(n=!0),!1===r.getShowDataTips()&&(n=!1),n&&(this._data instanceof C||!(this._getTextWidth()>this.getWidth()||r.getDataTipFunction()||r.getDataTipField()||s.getDataTipFunction()||s.getDataTipField())||(e=t?t:r.itemToDataTip(this._data)))}else t="";t?(" "==t&&(t=""),this._labelNode?this._labelNode.nodeValue!=t&&(this._labelNode.nodeValue=t):(this._labelNode=document.createTextNode(t),this.element.appendChild(this._labelNode))):this._labelNode?""!=this._labelNode.nodeValue&&(this._labelNode.nodeValue=""):(this._labelNode=document.createTextNode(""),this.element.appendChild(this._labelNode)),e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},z(ne,X),ne.prototype.focus=function(){this.getEditable()?this._textInput.focus():(ne._super.focus.call(this),this.open())},z(sd,za),sd.prototype.getData=function(){return this._data},sd.prototype.setData=function(t){this._data=t,this._dataChanged=!0},sd.prototype.setListData=function(t){(this._listData=t)&&(this._dataGrid=t.owner,this._dataField=t.dataField),this._collectionChanged=!0,this.invalidateProperties(),this.invalidateSize()},sd.prototype.getSelectedDataField=function(){if(this._listData&&this._selectedItem){var t=this._dataGrid._columns[this._listData.columnIndex];if(t instanceof C)return t.getItemRendererDataField()?E(this._selectedItem)?G.hasElementProperty(this._selectedItem,t.getItemRendererDataField())?G.getProperty(this._selectedItem,t.getItemRendererDataField()):this.getSelectedLabel():this._selectedItem.hasOwnProperty(t.getItemRendererDataField())?this._selectedItem[t.getItemRendererDataField()].toString():this.getSelectedLabel():this.getSelectedLabel()}return this._data?this._data[this._dataField]:this.getSelectedLabel()},sd.prototype.commitProperties=function(){if(sd._super.commitProperties.call(this),this._listData){var t=this._dataGrid._columns[this._listData.columnIndex];if(this._dataChanged){this._selectedItem=null,this._selectedIndex=-1;var e;if(t instanceof C){if(t.getItemRendererLabelField()&&(this._labelField=t.getItemRendererLabelField()),t.getItemRendererDataProvider()){var i=[];if(t.getItemRendererDataProvider())for(e=0;e<t.getItemRendererDataProvider().length;e++)(!t.getItemRendererDataProvider()[e].hasOwnProperty("visible")||t.getItemRendererDataProvider()[e].hasOwnProperty("visible")&&t.getItemRendererDataProvider()[e].visible)&&i.push(t.getItemRendererDataProvider()[e]);this.setDataProvider(i),this._findDataprovider=!0}else if(t.getItemRendererDataProviderField())if(i=[],E(this._data)){try{var s=G.getElement(this._data,t.getItemRendererDataProviderField()).childNodes}catch(r){}if(s&&Uc(s)){for(e=0;e<s.length;e++)1===s[e].nodeType&&(!G.hasElementProperty(s[e],"visible")||G.hasElementProperty(s[e],"visible")&&"true"==G.getProperty(s[e],"visible"))&&i.push(s[e]);this.setDataProvider(i),this._findDataprovider=!0}}else{if(this._data[t.getItemRendererDataProviderField()]&&ha(this._data[t.getItemRendererDataProviderField()]))for(e=0;e<this._data[t.getItemRendererDataProviderField()].length;e++)(!this._data[t.getItemRendererDataProviderField()][e].hasOwnProperty("visible")||this._data[t.getItemRendererDataProviderField()][e].hasOwnProperty("visible")&&this._data[t.getItemRendererDataProviderField()][e].visible)&&i.push(this._data[t.getItemRendererDataProviderField()][e]);this.setDataProvider(i),this._findDataprovider=!0}if(this._findDataprovider)if(i=this._data[this._dataField],(E(i)||i instanceof Hb)&&0<i.text().length()&&(i=i.text()[0]),t.getItemRendererDataField()){for(e=0;e<this.getDataProvider().getLength();e++)if(this.getDataProvider().getPropertyAt(e,t.getItemRendererDataField())==i){this.setSelectedIndex(e);break}}else if(this.setSelectedItem(i),0>this._selectedIndex&&this.getDataProvider())for(e=0;e<this.getDataProvider().length;e++)if(this.itemToLabel(this.getDataProvider()[e])==i){this.setSelectedIndex(e);break}}this._findDataprovider||this.setDataProvider(t.itemToData(this._data)),this._dataChanged=!1}}},z(td,Z),td.prototype.getData=function(){return this._data},td.prototype.setData=function(t){this._data=t,this._dataChanged=!0,this.invalidateProperties()},td.prototype.setListData=function(t){t&&(this._listData=t,this._dataGrid=t.owner,this._dataField=t.dataField),this.invalidateProperties(),this.invalidateSize()},td.prototype.getSelectedDataField=function(){if(this._listData&&this._selectedItem){var t=this._dataGrid._columns[this._listData.columnIndex];if(t instanceof C)return t.getItemRendererDataField()?E(this._selectedItem)?G.hasElementProperty(this._selectedItem,t.getItemRendererDataField())?G.getProperty(this._selectedItem,t.getItemRendererDataField()):this.getSelectedLabel():this._selectedItem.hasOwnProperty(t.getItemRendererDataField())?this._selectedItem[t.getItemRendererDataField()].toString():this.getSelectedLabel():this.getSelectedLabel()}else if(this.getText())return this.getText();return this._data?this._data[this._dataField]:this.getSelectedLabel()},td.prototype.commitProperties=function(){var t=this._listData;if(t&&(t=this._dataGrid.getColumns()[t.columnIndex],this._dataChanged)){var e=!1;if(t instanceof C){if(t.getItemRendererLabelField()&&this.setLabelField(t.getItemRendererLabelField()),t.getItemRendererDataProvider())this.setDataProvider(t.getItemRendererDataProvider()),e=!0;else if(t.getItemRendererDataProviderField())if(E(this._data)){var i=G.getElement(this._data,t.getItemRendererDataProviderField());i&&(this.setDataProvider(i),e=!0)}else this.setDataProvider(this._data[t.getItemRendererDataProviderField()]),e=!0;if(e){var s,i=t.itemToData(this._data);if(t.getItemRendererDataField()){for(s=0;s<this.getDataProvider().getLength();s++)if(this.getDataProvider().getPropertyAt(s,t.getItemRendererDataField())==i){
this.setSelectedIndex(s);break}}else if(this.setSelectedItem(i),0>this.getSelectedIndex())for(s=0;s<this.getDataProvider().getLength();s++)if(this.itemToLabel(this.getDataProvider().getItemAt(s))==i){this.setSelectedIndex(s);break}s>=this.getDataProvider().getLength()&&this.setText(i)}}e||this.setDataProvider(t.itemToData(this._data)),this._dataChanged=!1}td._super.commitProperties.call(this)},z(Rd,Q),Rd.prototype.measure=function(){var t=this.getSizeStyle("width"),e=this.getSizeStyle("height");this.measuredMinWidth=this.measuredWidth=t,this.measuredMinHeight=this.measuredHeight=e},Rd.prototype.focus=function(){Rd._super.focus.call(this)},Rd.prototype._updateChecked=function(e,i){if(this._collection&&e&&i){var s,r,n,o;if(0==e.rowIndex&&i.selectAll)for(s=this._collection.createCursor(),s.seek(t.getFIRST());!s.getAfterLast();)o=s.getCurrent(),o.checked=i.checked,s.moveNext();else if(i.checked){if((r=this._collection.getItemAt(0))&&r.selectAll){for(n=0,s=this._collection.createCursor(),s.seek(t.getFIRST()),s.moveNext();!s.getAfterLast()&&(o=s.getCurrent(),o.checked);)n++,s.moveNext();n==this._collection.getLength()-1&&(r.checked=!0)}}else(r=this._collection.getItemAt(0))&&r.selectAll&&r.checked&&(r.checked=!1);this.invalidateList()}},z(tc,qa),tc.prototype.getListData=function(){return this._listData},tc.prototype.setListData=function(t){this._listData!=t&&(this._listData=t,this._listDataChanged=!0,this.invalidateProperties())},tc.prototype.getSelected=function(){return this._checkBox.getSelected()},tc.prototype.setSelected=function(t){this._checkBox.setSelected(t),this.invalidateProperties()},tc.prototype.createChildren=function(){tc._super.createChildren.call(this),this._checkBox||(this._checkBox=new Ka,this._checkBox.setStyleName(this),this.addChild(this._checkBox),this._checkBox.addEventListener("change",this._checkBoxChangeHandler,this),this._checkBox.setTabIndex(-1))},tc.prototype.commitProperties=function(){if(tc._super.commitProperties.call(this),this._listDataChanged){if(this._listData){this._listOwner=this._listData.owner;var t,e;if(E(this._data))try{t=G.getProperty(this._data,"checked"),e=G.getProperty(this._data,"label")}catch(i){t=!1}else t=this._data.checked,e=this._data.label;F(t)&&"true"==t&&(t=!0),this._checkBox.getSelected()!=t&&this._checkBox.setSelected(t),this._checkBox.setLabel(e);var s;this._listOwner.getShowDataTips()&&(s=this._listOwner.itemToDataTip(this._data)),s?this.element.title!=s&&(this.element.title=s):""!=this.element.title&&(this.element.title="")}this._listDataChanged=!1}},tc.prototype.measure=function(){tc._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._checkBox.getExplicitOrMeasuredWidth():this._explicitWidth-i-s,e=this._checkBox.getExplicitOrMeasuredHeight(),t=Number(t)+i+s,i=Number(e)+r+n,this.measuredMinWidth=this.measuredWidth=t,this.measuredMinHeight=this.measuredHeight=i},tc.prototype.updateDisplayList=function(t,e){tc._super.updateDisplayList.call(this,t,e);var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._checkBox.measuredMinWidth,a=t-i-s;a<o&&(o=a);var a=this._checkBox.measuredMinHeight,l=e-r-n;l<a&&(a=l),l=this.getStyle("textAlign"),i="center"==l?(t-o-i-s)/2+i:"right"==l?t-s-o:i,this._checkBox.setStyle("textAlign",l),i=Math.max(i,0),r=Math.max((e-a-r-n)/2+r,0),this._checkBox.setX(Math.round(i)),this._checkBox.setY(Math.round(r))},tc.prototype.focus=function(){this._checkBox?this._checkBox.focus():tc._super.focus.call(this)},tc.prototype._checkBoxChangeHandler=function(t){if(this._enabled){if(E(this._data))try{G.setProperty(this._data,"checked",this._checkBox.getSelected())}catch(e){}else this._data.checked=this._checkBox.getSelected();this._listOwner&&this._listOwner._updateChecked(this._listData,this._data)}else t.stopImmediatePropagation()},z(dd,mb),dd.prototype.getText=function(){return this._text},dd.prototype.setText=function(t){this._text=t,this.invalidateProperties()},dd.prototype.getValue=function(){return this._text},dd.prototype.setValue=function(t){var e=this;if(e._text=t,e._listData&&(t=e._listData.owner._columns[e._listData.columnIndex])&&t.updateImmediatelyAfterChange){var i=e._listData.owner.getEditedItemPosition();i?(e._listData.owner._endEdit("other"),e._listData.owner.setEditedItemPosition(i)):e.callLater(function(){i=e._listData.owner.getEditedItemPosition(),e._listData.owner._endEdit("other"),e._listData.owner.setEditedItemPosition(i)})}},dd.prototype.createChildren=function(){dd._super.createChildren.call(this),this._labelNode=" "},dd.prototype.commitProperties=function(){var t,e,i;if(this._offsetHeight=this._offsetWidth=NaN,this._labelOriColor=void 0,this._listDataChanged){if(this._listData){var s=this._listData.owner,r=s.getColumns()[this._listData.columnIndex];t=this._listData.label,p(this._text)&&(this._text=r._itemToValue(this._data)),i=this._data instanceof C?s._columnHeaderWordWrap(r):s._columnWordWrap(r),m.setWordWrap(this.element,i),this._visible?m.setStyle(this.element,"display","inline-block"):this._oldDisplay="inline-block",this.element.style.height&&(this._height=void 0,this.clearStyle("height")),i=s.getShowDataTips(),!0===r.getShowDataTips()&&(i=!0),!1===r.getShowDataTips()&&(i=!1),i&&(this._data instanceof C||!(this._getTextWidth()>this.getWidth()||r.getDataTipFunction()||r.getDataTipField()||s.getDataTipFunction()||s.getDataTipField())||(e=r.itemToDataTip(this._data)))}else t="";if(t){if(this.element.innerHTML!=t)for(this.element.innerHTML=t,r=this.element.getElementsByTagName("*"),t=0,s=r.length;t<s;t++)r[t].selfElement=this}else""!=this.element.innerHTML&&(this.element.innerHTML=" ");e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},z(Hd,mb),Hd.prototype.createChildren=function(){Hd._super.createChildren.call(this),this._labelNode=" "},Hd.prototype.commitProperties=function(){var t,e,i;if(this._offsetHeight=this._offsetWidth=NaN,this._labelOriColor=void 0,this._listDataChanged){if(this._listData){var s=this._listData.owner,r=s.getColumns()[this._listData.columnIndex];t=this._listData.label,i=this._data instanceof C?s._columnHeaderWordWrap(r):s._columnWordWrap(r),m.setWordWrap(this.element,i),this._visible?m.setStyle(this.element,"display","inline-block"):this._oldDisplay="inline-block",this.element.style.height&&(this._height=void 0,this.clearStyle("height")),i=s.getShowDataTips(),!0===r.getShowDataTips()&&(i=!0),!1===r.getShowDataTips()&&(i=!1),i&&(this._data instanceof C||!(this._getTextWidth()>this.getWidth()||r.getDataTipFunction()||r.getDataTipField()||s.getDataTipFunction()||s.getDataTipField())||(e=r.itemToDataTip(this._data)))}else t="";if(t){if(this.element.innerHTML!=t)for(this.element.innerHTML=t,r=this.element.getElementsByTagName("*"),t=0,s=r.length;t<s;t++)r[t].selfElement=this}else""!=this.element.innerHTML&&(this.element.innerHTML=" ");e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},Eb._defaultStyles={horizontalGap:3},z(Eb,qa),Eb.prototype.getListData=function(){return this._listData},Eb.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties(),this.invalidateSize()},Eb.prototype.createChildren=function(){Eb._super.createChildren.call(this),this._icon||(this._icon=new Ua,this.addChild(this._icon)),this._label||(this._label=new pa,this._label.setStyleName(this),this._label.setStyle("position","absolute"),this._label.setStyle("overflow","hidden"),this._label.setVisibility(!1),this.addChild(this._label))},Eb.prototype.commitProperties=function(){if(Eb._super.commitProperties.call(this),this._labelOriColor=void 0,this._listDataChanged){if(this._listData){this._dataGrid=this._listData.owner;var t,e,i=this._dataGrid.getColumns()[this._listData.columnIndex];i.getSecondDataField()||null!=i.getSecondLabelFunction()?t=i.itemToSecondLabel(this._data):i.getStyle("icon")?t=i.getStyle("icon"):this.getStyle("icon")&&(t=this.getStyle("icon")),t&&" "!==t?(0>t.indexOf("/")&&(t=Ma+"icons/"+t+(0<t.indexOf(".")?"":".png")),t!=this._icon.getSrc()?(this._icon.setWidth(NaN),this._icon.setHeight(NaN),this._icon.setExplicitWidth(NaN),this._icon.setExplicitHeight(NaN),this._icon.setVisibility(!1),this._icon.addEvent("click",this._iconClickHandler,this),this._icon.addEventListener("load",this._iconLoadHandler,this),this._icon.setSrc(t)):(this._icon.setVisibility(!1),this.invalidateDisplayList())):t&&" "!=t||(this._icon.setSrc(null),this._icon.removeEvent("click",this._iconClickHandler,this),this._icon.removeEventListener("load",this._iconLoadHandler,this)),this._label.setText(this._listData.label&&" "!=this._listData.label?this._listData.label:""),t=this._data instanceof C?this._dataGrid._columnHeaderWordWrap(i):this._dataGrid._columnWordWrap(i),m.setWordWrap(this._label.element,t),this._dataGrid.getVariableRowHeight()&&(e=!0),this._visible?m.setStyle(this._label.element,"display",e?"inline-block":"inline"):this._oldDisplay=e?"inline-block":"inline",i.getTruncateToFit()&&(e=this._label.getStyle("textOverflow"),"ellipsis"!=e&&this._label.setStyle("textOverflow","ellipsis"));var s;e=this._dataGrid.getShowDataTips(),1==i.getShowDataTips()&&(e=!0),0==i.getShowDataTips()&&(e=!1),e&&(this._data instanceof C||!(this._label.getTextWidth()>this._label.getWidth()||i.getDataTipFunction()||i.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(s=i.itemToDataTip(this._data)))}else this._label.setText("");s?this.element.title!=s&&(this.element.alt=this.element.title=s,this._icon.setAlt(s)):""!=this.element.title&&(this.element.alt=this.element.title="",this._icon.setAlt("")),this._listDataChanged=!1}},Eb.prototype.measure=function(){if(Eb._super.measure.call(this),this._listData){var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("horizontalGap"),n=0,o=0;this._icon.complete&&!this._icon.isError?(n=this._icon.naturalWidth,o=this._icon.naturalHeight):r=0,e=this._dataGrid.getVariableRowHeight()?this._label.getTextHeight():this._label.getHeight(),O(this._explicitWidth)?(t=this.measureText(this._label.getText()).width+pa.TEXT_WIDTH_PADDING,i=t+r+n+i+s):i=this._explicitWidth,o=Math.max(e,o),this.measuredMinWidth=this.measuredWidth=i,this.measuredMinHeight=this.measuredHeight=o}},Eb.prototype.updateDisplayList=function(t,e){if(Eb._super.updateDisplayList.call(this,t,e),0!=t){var i,s=this.getSizeStyle("paddingLeft"),r=this.getSizeStyle("paddingRight"),n=this.getSizeStyle("paddingTop"),o=this.getSizeStyle("paddingBottom"),a=this.element.style.color,l=this._icon.complete&&!this._icon.isError,h=l?this._icon.naturalWidth:0,d=l?this._icon.naturalHeight:0;l&&this._icon.setActualSize(h,d);var c=l?this.getSizeStyle("horizontalGap"):0,_=this.measureText(this._label.getText()),u=_.width+1,g=t-h-c-s-r;0>g&&(g=0),g<u&&(u=g),_=_.height,n=e-n-o,n<_&&(_=n),this._label.setActualSize(u,_),this._label.getVisibility()||this._label.setVisibility(!0),o=this.getStyle("iconPlacement"),g=this.getStyle("textAlign"),n="right"==o?"center"==g?(t-u-s-r-c-h)/2+s+c+(this._icon?u:0):"right"==g?t-r-(this._icon?h:u):s+(this._icon?u+c:0):"center"==g?(t-u-s-r-c-h)/2+s:"right"==g?t-r-h-c-u:s,n=Math.max(n,0),"right"==o?(this._icon.setX(Math.round(n)),"center"==g?this._label.setX(Math.round((t-u-s-r-c-h)/2+s)):"right"==g?this._label.setX(Math.round(t-r-h-c-u)):this._label.setX(s)):(this._icon.setX(Math.round(n)),this._label.setX(Math.round(n+h+c))),_>d?this._icon.setY((_-d)/2):this._icon.setY(0),this._icon.getSrc()?l&&(this._icon.setVisible(!0),this._icon.setVisibility(!0)):p(this._icon.getSrc())&&this._icon.setVisible(!1),this._listData&&this.getParent()&&(!this._enabled||this._dataGrid.isItemDeleted(this._listData.uid)?i=this._dataGrid.getStyle("disabledColor"):this._dataGrid.isItemHighlighted(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex)?i=this._dataGrid.getStyle("textRollOverColor"):this._dataGrid.isItemSelected(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex)&&(i=this._dataGrid.getStyle("textSelectedColor")),i?i!=a&&(this.element.style.color=i):this._labelOriColor?this._labelOriColor!=a&&(this.element.style.color=this._labelOriColor):a&&(this.element.style.color=""))}},Eb.prototype.setStyle=function(t,e){Eb._super.setStyle.call(this,t,e),"color"===t&&(this._labelOriColor=e)},Eb.prototype._iconLoadHandler=function(t){this._icon.removeEventListener("load",this._iconLoadHandler,this),this._icon.setVisible(!1),this.invalidateDisplayList()},Eb.prototype._iconClickHandler=function(t){if(t.stopPropagation(),null!=this._data){t=this._dataGrid.getColumns()[this._listData.columnIndex];var e=new Bc(Bc.ITEM_ICON_CLICK,(!1),(!1),this._listData.columnIndex,this._listData.rowIndex+this._dataGrid.getVerticalScrollPosition(),null,this);t.dispatchEvent(e)}},Eb.prototype._getLabel=function(){return this._label},z(Sd,Eb),Sd.prototype.commitProperties=function(){if(Eb._super.commitProperties.call(this),this._labelOriColor=void 0,this._listDataChanged){if(this._listData){this._dataGrid=this._listData.owner;var t,e,i=this._dataGrid.getColumns()[this._listData.columnIndex];this._column=i,this._dataGrid&&this._dataGrid.getEditable().length&&i&&i.editable&&("always"===i.showEditableIcon||"mouseover"===i.showEditableIcon)&&(i.getSecondDataField()||null!=i.getSecondLabelFunction()?t=i.itemToSecondLabel(this._data):i.getStyle("editableIcon")?t=i.getStyle("editableIcon"):this.getStyle("editableIcon")&&(t=this.getStyle("editableIcon"))),t&&" "!==t?(0>=t.indexOf("/")&&(t=Ma+"icons/"+t+".png"),t!=this._icon.getSrc()?(this._icon.setWidth(NaN),this._icon.setHeight(NaN),this._icon.setExplicitWidth(NaN),this._icon.setExplicitHeight(NaN),this._icon.setVisibility(!1),this._icon.addEventListener("load",this._iconLoadHandler,this),this._icon.setSrc(t)):(this._icon.setVisibility(!1),this.invalidateDisplayList())):t&&" "!=t||(this._icon.setSrc(null),this._icon.removeEventListener("load",this._iconLoadHandler,this)),t=i.getItemRendererDataProvider()||i.getItemRendererDataProviderField()?i.dataProviderToLabel(this._data,i.itemToData(this._data)):this._listData.label,this._label.setText(t&&" "!=t?t:""),t=this._data instanceof C?this._dataGrid._columnHeaderWordWrap(i):this._dataGrid._columnWordWrap(i),m.setWordWrap(this._label.element,t),this._dataGrid.getVariableRowHeight()&&(e=!0),this._visible?m.setStyle(this._label.element,"display",e?"inline-block":"inline"):this._oldDisplay=e?"inline-block":"inline",i.getTruncateToFit()&&(e=this._label.getStyle("textOverflow"),"ellipsis"!=e&&this._label.setStyle("textOverflow","ellipsis"));var s;e=this._dataGrid.getShowDataTips(),1==i.getShowDataTips()&&(e=!0),0==i.getShowDataTips()&&(e=!1),e&&(this._data instanceof C||!(this._label.getTextWidth()>this._label.getWidth()||i.getDataTipFunction()||i.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(s=i.itemToDataTip(this._data)))}else this._label.setText("");s?this.element.title!=s&&(this.element.title=s):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},Sd.prototype.measure=function(){if(Eb._super.measure.call(this),this._listData){var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("horizontalGap"),n=0,o=0;this._dataGrid&&this._dataGrid.getEditable().length&&this._column&&this._column.editable&&("always"===this._column.showEditableIcon||"mouseover"===this._column.showEditableIcon)&&this._icon.complete&&!this._icon.isError?(n=this._icon.naturalWidth,o=this._icon.naturalHeight):r=0,e=this._dataGrid.getVariableRowHeight()?this._label.getTextHeight():this._label.getHeight(),O(this._explicitWidth)?(t=this.measureText(this._label.getText()).width+pa.TEXT_WIDTH_PADDING,i=t+r+n+i+s):i=this._explicitWidth,o=Math.max(e,o),this.measuredMinWidth=this.measuredWidth=i,this.measuredMinHeight=this.measuredHeight=o}},Sd.prototype.updateDisplayList=function(t,e){if(Eb._super.updateDisplayList.call(this,t,e),0!=t){var i,s=this.getSizeStyle("paddingLeft"),r=this.getSizeStyle("paddingRight"),n=this.getSizeStyle("paddingTop"),o=this.getSizeStyle("paddingBottom"),a=this.element.style.color,l=!1,h=0,d=0;this._dataGrid&&this._dataGrid.getEditable().length&&this._column&&this._column.editable&&this._listData&&("always"===this._column.showEditableIcon||"mouseover"===this._column.showEditableIcon&&this._dataGrid.isItemHighlighted(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex))&&(h=(l=this._icon.complete&&!this._icon.isError)?this._icon.naturalWidth:0,d=l?this._icon.naturalHeight:0),l&&this._icon.setActualSize(h,d);var c=l?this.getSizeStyle("horizontalGap"):0,_=this.measureText(this._label.getText()),u=_.width+1,g=t-h-c-s-r;0>g&&(g=0),g<u&&(u=g),_=_.height,n=e-n-o,n<_&&(_=n),this._label.setActualSize(u,_),this._label.getVisibility()||this._label.setVisibility(!0),this._label.getVisibility()||this._label.setVisibility(!0),o=this.getStyle("iconPlacement"),g=this.getStyle("textAlign"),n="left"==o?s:t-r-(this._icon?h:u),n=Math.max(n,0),"left"==o?(this._icon.setX(Math.round(n)),this._label.setX(Math.round(n+h+c))):(this._icon.setX(Math.round(n)),"center"==g?this._label.setX(Math.round((t-u-s-r-c-h)/2+s)):"right"==g?this._label.setX(Math.round(t-r-h-c-u)):this._label.setX(s)),_>d?this._icon.setY((_-d)/2):this._icon.setY(0),this._icon.getSrc()?(this._icon.setVisible(l),this._icon.setVisibility(l)):p(this._icon.getSrc())&&this._icon.setVisible(!1),this._listData&&this.getParent()&&(!this._enabled||this._dataGrid.isItemDeleted(this._listData.uid)?i=this._dataGrid.getStyle("disabledColor"):this._dataGrid.isItemHighlighted(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex)?i=this._dataGrid.getStyle("textRollOverColor"):this._dataGrid.isItemSelected(this._listData.ouid,this._listData.rowIndex,this._listData.columnIndex)&&(i=this._dataGrid.getStyle("textSelectedColor")),i?i!=a&&(this.element.style.color=i):this._labelOriColor?this._labelOriColor!=a&&(this.element.style.color=this._labelOriColor):a&&(this.element.style.color=""))}},z(zc,qa),zc.prototype.getListData=function(){return this._listData},zc.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties()},zc.prototype.createChildren=function(){zc._super.createChildren.call(this),this._image||(this._image=new Ua,this.addChild(this._image))},zc.prototype.commitProperties=function(){if(this._listDataChanged){if(zc._super.commitProperties.call(this),this._listData){this._dataGrid=this._listData.owner;var t=this._dataGrid.getColumns()[this._listData.columnIndex];this._listData.label&&0<Mc.trim(this._listData.label).length?this._image.getSrc()!=this._listData.label&&(this._image.setWidth(NaN),this._image.setHeight(NaN),this._image.setExplicitWidth(NaN),this._image.setExplicitHeight(NaN),this._image.setVisible(!1),this._image.setSrc(this._listData.label),this._image.addEvent("click",this._imageClickHandler,this),this._image.addEventListener("load",this._imageLoadHandler,this)):(this._image.setVisible(!1),this._image.getSrc()&&(this._image.setSrc(null),this._image.removeEvent("click",this._imageClickHandler,this),this._image.removeEventListener("load",this._imageLoadHandler,this)));var e,i=this._dataGrid.getShowDataTips();1==t.getShowDataTips()&&(i=!0),0==t.getShowDataTips()&&(i=!1),i&&(this._data instanceof C||!(t.getDataTipFunction()||t.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(e=t.itemToDataTip(this._data))),e?this.element.title!=e&&(this.element.title=e,this._image.setAlt(" ")):""!=this.element.title&&(this.element.title="",this._image.setAlt(""))}this._listDataChanged=!1}},zc.prototype.measure=function(){zc._super.measure.call(this),this._dataGrid&&!this._dataGrid.getVariableRowHeight()?(0==this.measuredWidth&&(this.measuredWidth=10),this.measuredHeight=this._dataGrid.getRowHeight()-4):(this.measuredWidth=(this._image.naturalWidth?this._image.naturalWidth:10)+this.getSizeStyle("paddingLeft")+this.getSizeStyle("paddingRight"),this.measuredHeight=(this._image.naturalHeight?this._image.naturalHeight:10)+this.getSizeStyle("paddingTop")+this.getSizeStyle("paddingBottom"))},zc.prototype.updateDisplayList=function(t,e){if(zc._super.updateDisplayList.call(this,t,e),this._listData){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=1;this._image.complete&&this._image.setVisible(!0);var a=0<=this._image.naturalWidth?this._image.naturalWidth:0,l=0<=this._image.naturalHeight?this._image.naturalHeight:0,h=t-i-s,d=e-r-n;(a>h||l>d)&&(o=0==a?1:h/a,d=0==l?1:d/l,o=o>d?d:o),a*=o,l*=o,0!=a&&0!=l&&(o=this.getStyle("textAlign"),i=Math.max("center"==o?(t-a-i-s)/2+i:"right"==o?t-s-a:i,0),this._image.setX(Math.round(i)),i=this._dataGrid.getStyle("verticalAlign"),this._dataGrid&&!this._dataGrid.getVariableRowHeight()?(r=Math.max("middle"==i?(e-l-r-n)/2+r:"bottom"==i?e-l-n:r,0),this._image.setY(Math.round(r))):"middle"==i?16<l?this._image.setY(Math.round((16-l)/2)):this._image.setY(0):"bottom"==i?this._image.setY(e-l-n-(e-16)):this._image.setY(r),this._image.setStyle("textAlign",o),this._image.setActualSize(a,l))}},zc.prototype._imageLoadHandler=function(t){this._image.removeEventListener("load",this._imageLoadHandler,this),this.invalidateDisplayList()},zc.prototype._imageClickHandler=function(t){if(t.stopPropagation(),null!=this._data){t=this._dataGrid.getColumns()[this._listData.columnIndex];var e=new Bc(Bc.ITEM_IMAGE_CLICK,(!1),(!1),this._listData.columnIndex,this._listData.rowIndex+this._dataGrid.getVerticalScrollPosition(),null,this);t.dispatchEvent(e)}},z(Rc,qa),Rc.prototype.getListData=function(){return this._listData},Rc.prototype.setListData=function(t){this._listData=t,this._listDataChanged=!0,this.invalidateProperties()},Rc.prototype.createChildren=function(){Rc._super.createChildren.call(this),this._image||(this._image=new Ua,this.addChild(this._image))},Rc.prototype.commitProperties=function(){if(this._listDataChanged){if(Rc._super.commitProperties.call(this),this._listData){this._dataGrid=this._listData.owner;var t,e=this._dataGrid.getColumns()[this._listData.columnIndex],i=e.getItemUpdatedByUID(this._listData.uid);i&&(t="st"+i.job),t&&0<t.length?this._image.getSrc()!=t&&(this._image.setWidth(NaN),this._image.setHeight(NaN),this._image.setExplicitWidth(NaN),this._image.setExplicitHeight(NaN),this._image.setVisible(!1),this._image.setSrc(Ma+t+".png"),this._image.addEventListener("load",this._imageLoadHandler,this)):(this._image.setVisible(!1),this._image.getSrc()&&(this._image.setSrc(null),this._image.removeEventListener("load",this._imageLoadHandler,this)));var s;t=this._dataGrid.getShowDataTips(),1==e.getShowDataTips()&&(t=!0),0==e.getShowDataTips()&&(t=!1),t&&(this._data instanceof C||!(e.getDataTipFunction()||e.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(s=e.itemToDataTip(this._data))),s?this.element.title!=s&&(this.element.title=s):""!=this.element.title&&(this.element.title="")}this._listDataChanged=!1}},Rc.prototype.measure=function(){Rc._super.measure.call(this),this.measuredWidth=(this._image.naturalWidth?this._image.naturalWidth:16)+this.getSizeStyle("paddingLeft")+this.getSizeStyle("paddingRight"),this.measuredHeight=(this._image.naturalHeight?this._image.naturalHeight:16)+this.getSizeStyle("paddingTop")+this.getSizeStyle("paddingBottom")},Rc.prototype.updateDisplayList=function(t,e){if(Rc._super.updateDisplayList.call(this,t,e),this._listData){var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=1;this._image.complete&&this._image.setVisible(!0);var a=0<=this._image.naturalWidth?this._image.naturalWidth:0,l=0<=this._image.naturalHeight?this._image.naturalHeight:0,h=t-i-s,d=e-r-n;(a>h||l>d)&&(o=0==a?1:h/a,d=0==l?1:d/l,o=o>d?d:o),a*=o,l*=o,o=this.getStyle("textAlign"),i=Math.max("center"==o?(t-a-i-s)/2+i:"right"==o?t-s-a:i,0),this._image.setX(Math.round(i)),i=this._dataGrid.getStyle("verticalAlign"),this._dataGrid&&!this._dataGrid.getVariableRowHeight()?(r=Math.max("middle"==i?(e-l-r-n)/2+r:"bottom"==i?e-l-n:r,0),this._image.setY(Math.round(r))):"middle"==i?16<l?this._image.setY(Math.round((16-l)/2)):this._image.setY(0):"bottom"==i?this._image.setY(e-l-n-(e-16)):this._image.setY(r),this._image.setStyle("textAlign",o),this._image.setActualSize(a,l)}},Rc.prototype._imageLoadHandler=function(t){this._image.removeEventListener("load",this._imageLoadHandler,this),this.invalidateDisplayList()},z(ce,mb),ce.prototype.commitProperties=function(){var t,e,i;if(ce._super.commitProperties.call(this),this._listData){var s=this._listData.owner,r=s._columns[this._listData.columnIndex];t=this._listData.rowIndex+s.getVerticalScrollPosition()+r.indexStartNo,e=t.toString(),null!=r.getSecondLabelFunction()&&(e=r.itemToSecondLabel(this._data,t)),t=s.getShowDataTips(),1==r.getShowDataTips()&&(t=!0),0==r.getShowDataTips()&&(t=!1),t&&(this._data instanceof C||!(r.getDataTipFunction()||r.getDataTipField()||s.getDataTipFunction()||s.getDataTipField())||(i=e))}else e="";e?(" "==e&&(e=""),this._labelNode?this._labelNode.nodeValue!=e&&(this._labelNode.nodeValue=e):(this._labelNode=document.createTextNode(e),this.element.appendChild(this._labelNode))):this._labelNode?""!=this._labelNode.nodeValue&&(this._labelNode.nodeValue=""):(this._labelNode=document.createTextNode(""),this.element.appendChild(this._labelNode)),i?this.element.title!=i&&(this.element.title=i):""!=this.element.title&&(this.element.title="")},z(oe,da),oe.prototype.focus=function(){this.getEditable()?this._textInput.focus():(oe._super.focus.call(this),this.open())},z(Fc,qa),Fc.prototype.getListData=function(){return this._listData},Fc.prototype.setListData=function(t){(this._listData=t)&&(this._dataGrid=t.owner,this._dataField=t.dataField),this.invalidateProperties()},Fc.prototype.getSelected=function(){return this._radioButton.getSelected()},Fc.prototype.setSelected=function(t){this._radioButton.setSelected(t),this.invalidateProperties()},Fc.prototype.createChildren=function(){Fc._super.createChildren.call(this),this._radioButton||(this._radioButton=new qb,this._radioButton.setStyleName(this),this.addChild(this._radioButton),this._radioButton.addEventListener("change",this._radioButtonChangeHandler,this),this._radioButton.setTabIndex(-1))},Fc.prototype.commitProperties=function(){if(Fc._super.commitProperties.call(this),this._listData){var t=this._dataGrid._columns[this._listData.columnIndex];if(E(this._data)){try{var e=G.getProperty(this._data,this._dataField)}catch(i){e=null}bb(e)?this._radioButton.getSelected()!=e&&this._radioButton.setSelected(e):this._radioButton.getSelected()!=("true"==e)&&this._radioButton.setSelected("true"==e)}else bb(this._data[this._dataField])?this._radioButton.getSelected()!=this._data[this._dataField]&&this._radioButton.setSelected(this._data[this._dataField]):this._radioButton.getSelected()!=("true"==this._data[this._dataField])&&this._radioButton.setSelected("true"==this._data[this._dataField]);e=this._dataGrid.getShowDataTips(),1==t.getShowDataTips()&&(e=!0),0==t.getShowDataTips()&&(e=!1),e&&(this._data instanceof C||!(t.getDataTipFunction()||t.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||t.itemToDataTip(this._data))}},Fc.prototype.measure=function(){Fc._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._radioButton.getExplicitOrMeasuredWidth():this._explicitWidth,e=this._radioButton.getExplicitOrMeasuredHeight(),this.measuredMinWidth=this.measuredWidth=t+(i+s),this.measuredMinHeight=this.measuredHeight=e+(r+n)},Fc.prototype.updateDisplayList=function(t,e){Fc._super.updateDisplayList.call(this,t,e);var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._radioButton.measuredMinWidth,a=t-i-s;a<o&&(o=a),a=this._radioButton.measuredMinHeight,r=e-r-n,r<a&&(a=r),this._radioButton.setActualSize(o,a),r=this.getStyle("textAlign"),i=Math.max("center"==r?(t-o-i-s)/2+i:"right"==r?t-s-o:i,0),this._radioButton.setStyle("textAlign",r),this._radioButton.setX(Math.round(i))},Fc.prototype._radioButtonChangeHandler=function(t){this._enabled||t.stopImmediatePropagation()},z(fc,qa),fc.prototype.getListData=function(){return this._listData},fc.prototype.setListData=function(t){(this._listData=t)&&(this._dataGrid=t.owner,this._column=this._dataGrid._columns[this._listData.columnIndex]),this.invalidateProperties()},fc.prototype.getSelected=function(){return this._radioButton.getSelected()},fc.prototype.setSelected=function(t){this._radioButton.setSelected(t),this.invalidateProperties()},fc.prototype.createChildren=function(){fc._super.createChildren.call(this),this._radioButton||(this._radioButton=new qb,this._radioButton.setStyleName(this),this.addChild(this._radioButton),this._radioButton.addEventListener("change",this._radioButtonChangeHandler,this),this._radioButton.setTabIndex(-1))},fc.prototype.commitProperties=function(){if(fc._super.commitProperties.call(this),this._listData){var t,e=this._dataGrid.getShowDataTips();null!=this._column.getSecondLabelFunction()?this._radioButton.setEnabled(this._column.itemToSecondLabel(this._data)):this._radioButton.setEnabled(!0),this._radioButton.getEnabled()?this._radioButton.setSelected(this._column.isItemSelectedByUID(this._listData.uid)):this._radioButton.setSelected(!1),1==this._column.getShowDataTips()&&(e=!0),0==this._column.getShowDataTips()&&(e=!1),e&&(this._data instanceof C||!(this._column.getDataTipFunction()||this._column.getDataTipField()||this._dataGrid.getDataTipFunction()||this._dataGrid.getDataTipField())||(t=this._column.itemToDataTip(this._data)),t?this.element.title!=t&&(this.element.title=t):""!=this.element.title&&(this.element.title="")),Xb&&(this._column&&0==this._column.colNum?(t="rowheader",e=this._dataGrid._getRowItemIds(this._listData.rowIndex),this._radioButton._radioElm.setAttr("aria-labelledby",e),this.setAttr("aria-labelledby",e)):(t="gridcell",this._radioButton._radioElm.setAttr("aria-label",B.getString("datagrid","ariaRowSelect")),this.setAttr("aria-label",B.getString("datagrid","ariaRowSelect"))),this.setAttr("id",this.name),this.setAttr("role",t),this._radioButton.setAttr("role",t))}},fc.prototype.measure=function(){fc._super.measure.call(this);var t,e,i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom");t=isNaN(this._explicitWidth)?this._radioButton.getExplicitOrMeasuredWidth():this._explicitWidth,e=this._radioButton.getExplicitOrMeasuredHeight(),this.measuredMinWidth=this.measuredWidth=t+(i+s),this.measuredMinHeight=this.measuredHeight=e+(r+n)},fc.prototype.updateDisplayList=function(t,e){fc._super.updateDisplayList.call(this,t,e);var i=this.getSizeStyle("paddingLeft"),s=this.getSizeStyle("paddingRight"),r=this.getSizeStyle("paddingTop"),n=this.getSizeStyle("paddingBottom"),o=this._radioButton.measuredMinWidth,a=t-i-s;a<o&&(o=a),a=this._radioButton.measuredMinHeight,r=e-r-n,r<a&&(a=r),this._radioButton.setActualSize(o,a),r=this.getStyle("textAlign"),i=Math.max("center"==r?(t-o-i-s)/2+i:"right"==r?t-s-o:i,0),this._radioButton.setStyle("textAlign",r),this._radioButton.setX(Math.round(i))},fc.prototype.focus=function(){this._radioButton?this._radioButton.focus():fc._super.focus.call(this)},fc.prototype._radioButtonChangeHandler=function(t){
this._enabled?this._radioButton.getSelected()?this._column._addSelectedItem(this._listData.uid,this._listData.item,this._listData.rowIndex,this):this._column._removeSelectedItem(this._listData.uid,this):t.stopImmediatePropagation()};var Zc=function(t,e,i,s){this.sequenceNumber=0<arguments.length?t:-1,this.descending=1<arguments.length&&e,this.status=2<arguments.length?i:Zc.ACTUALSORT,this.sortFieldsCount=3<arguments.length?s:0};Zc.PROPOSEDSORT="proposedSort",Zc.ACTUALSORT="actualSort",z(ud,mb),ud.prototype.createChildren=function(){ud._super.createChildren.call(this),this._labelNode=" "},ud.prototype.commitProperties=function(){var t,e,i;if(this._offsetHeight=this._offsetWidth=NaN,this._labelOriColor=void 0,this._listDataChanged){if(this._listData){var s=this._listData.owner,r=s.getColumns()[this._listData.columnIndex];t=this._listData.label,i=this._data instanceof C?s._columnHeaderWordWrap(r):s._columnWordWrap(r),m.setWordWrap(this.element,i),this._visible?m.setStyle(this.element,"display","inline-block"):this._oldDisplay="inline-block",this._oldText!=t&&this.element.style.height&&(this._height=void 0,this._offsetHeight=this._oldMinWidth=NaN,this.clearStyle("height")),i=s.getShowDataTips(),!0===r.getShowDataTips()&&(i=!0),!1===r.getShowDataTips()&&(i=!1),i&&(this._data instanceof C||!(this._getTextWidth()>this.getWidth()||r.getDataTipFunction()||r.getDataTipField()||s.getDataTipFunction()||s.getDataTipField())||(e=r.itemToDataTip(this._data)))}else t="";(this._oldText=t)?(t=" "==t?"":t.replace(/\n/g,"</br>").replace(/ /g,""),this.element.innerHTML=t):this.element.innerHTML="",e?this.element.title!=e&&(this.element.title=e):""!=this.element.title&&(this.element.title=""),this._listDataChanged=!1}},ud.prototype._mouseWheelHandler=function(t){this.element.scrollHeight>this.element.clientHeight+1&&t.stopPropagation()},ed.prototype.getUniqueName=function(){return this._uniqueName},ed.prototype.setUniqueName=function(t){this._uniqueName=t},ed.prototype.getType=function(){return this._type},ed.prototype.setType=function(t){this._type=t},ed.prototype.getRenderer=function(){return this._renderer},ed.prototype.setRenderer=function(t){this._renderer=t},z(Kc,qa),Kc._defaultStyles={disabledColor:void 0,horizontalAlign:void 0},Kc.prototype.getListData=function(){return this._listData},Kc.prototype.setListData=function(t){this._listData!=t&&(this._listData=t,this.invalidateProperties())},Kc.prototype.createChildren=function(){Kc._super.createChildren.call(this),this._label||(this._label=new pa,this._label.setStyleName(this),this.addChild(this._label))},Kc.prototype.commitProperties=function(){var t;Kc._super.commitProperties.call(this),this._data?(this._listOwner=this._listData.owner,this._label.setText(this._listData.label),this._label.setMultiline(this._listOwner.getVariableRowHeight()),this._label.setWordWrap(this._listOwner.getWordWrap()),this._data instanceof C?this._label.setWordWrap(this._listOwner._columnHeaderWordWrap(this._data)):this._label.setWordWrap(this._listOwner._rowHeaderWordWrap(this._data.getMembers().getItemAt(this._listData.columnIndex))),t=this._listOwner.getShowDataTips()&&(this._label.getTextWidth()>this._label.getWidth()||null!=this._listOwner.getDataTipFunction())?this._listOwner.itemToDataTip(this._data):null):(this._label.setText(" "),t=null),t?this.element.title!=t&&(this.element.title=t):""!=this.element.title&&(this.element.title=""),this.invalidateDisplayList()},Kc.prototype.measure=function(){Kc._super.measure.call(this);var t=this._data?this._listData.indent:0;(4>this._label.getWidth()||4>this._label.getHeight())&&(this._label.setWidth(4),this._label.setHeight(16)),isNaN(this.explicitWidth)?this.measuredWidth=t+=this._label.getExplicitOrMeasuredWidth():this._label.setWidth(Math.max(this.explicitWidth-t,4)),this.measuredHeight=this._label.getExplicitOrMeasuredHeight()},Kc.prototype.updateDisplayList=function(t,e){Kc._super.updateDisplayList.call(this,t,e);var i=this._data?this._listData.indent:0,s=this.getStyle("horizontalAlign"),r=this.getStyle("verticalAlign");"left"==s?this._label.setX(i):"right"==s?this._label.setX(t-this._label.getWidth()+2):this._label.setX((e-this._label.getHeight())/2+i),this._label.setActualSize(t-this._label.getX(),e),"top"==r?this._label.setY(0):"bottom"==r?this._label.setY(e-this._label.getHeight()+2):this._label.setY((e-this._label.getHeight())/2),this._data&&this.getParent()&&(i=this._enabled?this._listOwner.isItemHighlighted(this._listData.uid)?this.getStyle("textRollOverColor"):this._listOwner.isItemSelected(this._listData.uid)?this.getStyle("textSelectedColor"):this.getStyle("color"):this.getStyle("disabledColor"),this._label.setStyle("color",i))},Kc.prototype._getLabel=function(){return this._label},z(Yb,H),Yb.prototype.getData=function(){return this._data},Yb.prototype.setData=function(t){this._data=t},Yb.prototype.getListData=function(){return this._listData},Yb.prototype.setListData=function(t){this._listData!=t&&(this._listData=t,this.invalidateProperties())},Yb.prototype.getFactories=function(){return this._factories},Yb.prototype.setFactories=function(t){this._checkIfChanged(this._factories,t)&&(this._factories=t,this._factoriesChanged=!0,this.invalidateProperties())},Yb.prototype.getDataProvider=function(){return this._dataProvider},Yb.prototype.setDataProvider=function(t){this._checkIfChanged(this._dataProvider,t)&&(this._dataProvider=t,this._dataProviderChanged=!0,this.invalidateProperties())},Yb.prototype.commitProperties=function(){if(Yb._super.commitProperties.call(this),(this._factoriesChanged||this._dataProviderChanged)&&this._factories&&this._dataProvider){for(this._factoriesChanged=this._dataProviderChanged=!1;this.getNumChildren();)this.removeChildAt(0);for(var t=0;t<this._factories.length;t++){var e,i=this._factories[t].newInstance();U(i.setListData)&&(e=this._data instanceof C?this._data:null,i.setListData(this._makeListData(this._dataProvider[t],this._listData.uid,this._listData.rowIndex,this._listData.columnIndex,e))),i.setData(this._data),this.addChild(i)}}},Yb.prototype._makeListData=function(t,e,i,s,r){var n="";return t instanceof uc&&(n=t.getName()),new nd(n,r?r.getDataField():"",s,e,this._listData.owner,i)},Yb.prototype.setStyle=function(t,e){if(Yb._super.setStyle.call(this,t,e),"axisHeaderStyleName"==t)for(var i,s=0;s<this.getNumChildren();s++)i=this.getChildAt(s),U(i.setStyleName)&&i.setStyleName(e)},Yb.prototype.measure=function(){Yb._super.measure.call(this);var t,e,i=0,s=0;for(e=0;e<this._factories.length;e++)t=this.getChildAt(e),s=Math.max(s,t.getExplicitOrMeasuredHeight()),t=t.getExplicitOrMeasuredWidth()+5,i+=t;isNaN(this.getExplicitWidth())||(i=this.getExplicitWidth()),this.measuredWidth=i,this.measuredHeight=s},Yb.prototype.updateDisplayList=function(t,e){Yb._super.updateDisplayList.call(this,t,e);var i,s,r,n=0,o=this._listData.owner.getStyle("verticalGridLineColor");for(this._data instanceof C&&(n=this._data.getSizeStyle("paddingLeft"));1<this.getRawChildren().getNumChildren();)this._rawChildren_removeChildAt(1);for(r=0;r<this._factories.length;r++)i=this.getChildAt(r),i.move(n,0),s=i.getExplicitOrMeasuredWidth(),i.setActualSize(s,i.getExplicitOrMeasuredHeight()),n+=s,i=new A("div","DataGridLineV"),s=i.element.style,s.borderColor=o,s.borderRightStyle="solid",s.left=n+"px",s.top="-5px",s.height=e+5+"px",this.getRawChildren().addChild(i)},Yb.prototype._checkIfChanged=function(t,e){var i,s=!1;if(t){if(e&&e.length)if(e.length!=t.length)s=!0;else for(i=0;i<e.length&&i<t.length;i++)t[i]!=e[i]&&(s=!0)}else s=!0;return s},z(Le,ed),z(Me,ed);var Gc=function(t,e,i,s,r,n){w.call(this,t,e,i),this.message=s,this.progress=r,this.total=n};z(Gc,w),Gc.QUERY_PROGRESS="queryProgress",Gc.CUBE_PROGRESS="progress",Gc.CUBE_COMPLETE="complete",Gc.prototype.clone=function(){return new Gc(this.type,this.bubbles,this.cancelable,this.message,this.progress,this.total)};var Bc=function(t,e,i,s,r,n,o){L.call(this,t,e,i,s,r,n,o)};z(Bc,L),Bc.HEADER_CHANGE="headerChange",Bc.HEADER_CLICK="headerClick",Bc.HEADER_LIST_CHANGE="headerListChange",Bc.ITEM_ICON_CLICK="itemIconClick",Bc.ITEM_IMAGE_CLICK="itemImageClick",Bc.prototype.clone=function(){return new Bc(this.type,this.bubbles,this.cancelable,this.columnIndex,this.rowIndex,this.reason,this.itemRenderer)};var K=function(t,e,i,s,r,n,o,a,l,h,d,c,_,u){w.call(this,t,e,i),this.columnIndex=3<arguments.length?s:-1,this.dataField=4<arguments.length?r:null,this.rowIndex=5<arguments.length?n:-1,this.reason=6<arguments.length?o:null,this.itemRenderer=7<arguments.length?a:null,this.localX=8<arguments.length?l:NaN,this.multiColumnSort=9<arguments.length&&h,this.removeColumnFromSort=10<arguments.length&&d,this.item=11<arguments.length?c:null,this.triggerEvent=12<arguments.length?_:null,this.headerPart=13<arguments.length?u:null};z(K,w),K.ITEM_CLOSE="itemClose",K.ITEM_EDIT_BEGIN="itemEditBegin",K.ITEM_EDIT_END="itemEditEnd",K.ITEM_FOCUS_IN="itemFocusIn",K.ITEM_FOCUS_OUT="itemFocusOut",K.ITEM_EDIT_BEGINNING="itemEditBeginning",K.ITEM_EDIT_COMPLETE="itemEditComplete",K.ITEM_OPEN="itemOpen",K.ITEM_OPENING="itemOpening",K.ITEM_VALUE_CHANGE="itemValueChange",K.COLUMN_STRETCH="columnStretch",K.HEADER_DRAG_OUTSIDE="headerDragOutside",K.HEADER_DROP_OUTSIDE="headerDropOutside",K.HEADER_RELEASE="headerRelease",K.SORT="sort",K.PASTE_EDIT_END="pasteEditEnd",K.CONTEXT_MENU_DOWN="contextMenuDown",K.FOOTER_CLICK="footerClick",K.HEADER_CLICK="headerClick",K.prototype.clone=function(){var t=new K(this.type,this.bubbles,this.cancelable,this.columnIndex,this.dataField,this.rowIndex,this.reason,this.itemRenderer,this.localX,this.multiColumnSort,this.removeColumnFromSort,this.item,this.triggerEvent,this.headerPart);return t.animate=this.animate,t.dispatchEvent=this.dispatchEvent,t.column=this.column,t.opening=this.opening,t.oldValue=this.oldValue,t.newValue=this.newValue,t};var pd=function(t,e,i,s,r){w.call(this,t,e,i),this.csvData=s,this.csvHeader=r};z(pd,w),pd.PARSE_COMPLETE="parseComplete",pd.prototype.clone=function(){return new pd(this.type,this.bubbles,this.cancelable,this.csvData,this.csvHeader)};var J=function(t,e,i,s,r){w.call(this,t,e,i),this.relatedEvent=s,this.text=r};z(J,w),J.EXPORT_MAKE_COMPLETE="exportMakeComplete",J.EXPORT_MAKE_ERROR="exportMakeError",J.EXPORT_UPLOAD_COMPLETE="exportUploadComplete",J.EXPORT_UPLOAD_ERROR="exportUploadError",J.EXPORT_SAVE_COMPLETE="exportSaveComplete",J.EXPORT_SAVE_ERROR="exportSaveError",J.prototype.clone=function(){return new J(this.type,this.bubbles,this.cancelable,this.relatedEvent,this.text)};var qd=function(t,e,i,s,r){w.call(this,t,e,i),this.parsedData=s,this.parsedHeader=r};z(qd,w),qd.PARSE_COMPLETE="parseComplete",qd.prototype.clone=function(){return new qd(this.type,this.bubbles,this.cancelable,this.parsedData,this.parsedHeader)};var Hc=function(t,e,i,s,r,n,o,a,l,h){w.call(this,t,e,i),this.columnIndex=3<arguments.length?s:-1,this.dataField=4<arguments.length?r:null,this.rowIndex=5<arguments.length?n:-1,this.reason=6<arguments.length?o:null,this.item=7<arguments.length?a:null,this.value=8<arguments.length?l:null,this.newValue=9<arguments.length?h:null};z(Hc,w),Hc.ITEM_DATA_CHANGED="itemDataChanged",Hc.UNDO_REDO_DATA_CHANGED="undoRedoDataChanged",Hc.prototype.clone=function(){return new Hc(this.type,this.bubbles,this.cancelable,this.columnIndex,this.dataField,this.rowIndex,this.reason,this.item,this.value,this.newValue)},Ga.prototype.getLevel=function(t){return this._level},fd.prototype.setCube=function(t){this._cube=t},fd.prototype.initNodeBuilding=function(){this._prevNodeAtLevel=[],this._allNodeAtLevel=[],this._prevValueAtLevel=[],this._measureMembers=this._cube.findDimension("Measures").getMembers(),this._measuresLength=this._measureMembers.getLength();for(var t=0;t<this._measureMembers.getLength();t++){var e=this._measureMembers.getItemAt(t);this._computeEndMap[e]=[],this._computeEndMap2[e]=e,this._computeObjEndMap[e]=[],this._measureMap[e.getName()]=e}},fd.prototype.moveToNextRound=function(){this._currentLevel=0,this._prevLevel=-1,this._nextLevel=1},fd.prototype.completeNodeBuilding=function(){if(this._prevNodeAtLevel&&this._prevValueAtLevel){this.rootNode=this._prevNodeAtLevel[0],this._closingNodesBelow=this._prevNodeAtLevel.reverse(),this._closingValues=this._prevValueAtLevel.reverse();for(var t=this._closingNodesBelow.length-1,e=this._closingNodesBelow.length,i=0;i<e;++i)if(!(1>t)){var s=this._closingValues[i],r=this._closingNodesBelow[i];r[s]instanceof Ga&&r[this.allNodePropertyName]instanceof Ga&&(2==r.numCells?r[this.allNodePropertyName]=r[s]:this._accumValuesFromNode(r[this.allNodePropertyName],r[s])),--t}this._allNodeAtLevel=this._prevValueAtLevel=this._prevNodeAtLevel=null,this._rootCellValues=[];for(var n in this.rootNode)n!=this.allNodePropertyName&&"numCells"!=n&&"_level"!=n&&"getLevel"!=n&&this._rootCellValues.push(n);return!1}for(;this._rootCellValues.length;)return n=this._rootCellValues.pop(),this._accumValuesFromNode(this.rootNode[this.allNodePropertyName],this.rootNode[n]),!1;for(t in this._computeEndMap){for(s=this._computeEndMap2[t],r=s.getAggregator(),n=this._computeEndMap[t],e=0;e<n.length;e++)i=n[e],i["saved_"+s.getName()]=i[s.getName()],i[s.getName()]=r.computeEnd(i[s.getName()],s.getDataField());delete this._computeEndMap[t]}for(t in this._computeObjEndMap){for(s=this._computeEndMap2[t],r=s.getAggregator(),n=this._computeObjEndMap[t],e=0;e<n.length;e++)i=n[e],i["saved_"+s.getName()]=i[s.getName()],i[s.getName()]=r.computeObjectEnd(i[s.getName()],s.getDataField());delete this._computeObjEndMap[t],delete this._computeEndMap2[t]}return this._computeEndMap={},this._computeEndMap2={},this._computeObjEndMap={},this._optimizeCube(),!0},fd.prototype._optimizeCube=function(){this.rootNode&&this._findNodeWithOneCell(this.rootNode)},fd.prototype._findNodeWithOneCell=function(t){var e=0;2==t.numCells&&++e;for(var i in t)if("numCells"!=i&&"_level"!=i&&"getLevel"!=i){2==t.numCells&&t[this.allNodePropertyName]!=t[i]&&(delete t[this.allNodePropertyName],t[this.allNodePropertyName]=t[i]);var s=t[i];s&&(e+=this._findNodeWithOneCell(s))}return e},fd.prototype.addValueToNodeBuilder=function(t,e){var i;for(i=0;i<t.length;i++){var s,r,n=t[i],o=this._prevNodeAtLevel[this._currentLevel],a=this._prevValueAtLevel[this._currentLevel];if(a&&a!=n){this._closingNodesBelow=this._prevNodeAtLevel.splice(this._nextLevel,this._prevNodeAtLevel.length).reverse(),this._closingValues=this._prevValueAtLevel.splice(this._nextLevel,this._prevValueAtLevel.length).reverse();for(var l=this._currentLevel+this._closingNodesBelow.length,h=this._closingNodesBelow.length,d=0;d<h;++d)0!=l&&(s=this._closingValues[d],r=this._closingNodesBelow[d],r[s]instanceof Ga&&r[this.allNodePropertyName]instanceof Ga&&(l>this._currentLevel&&2==r.numCells?r[this.allNodePropertyName]=r[s]:this._accumValuesFromNode(r[this.allNodePropertyName],r[s]))),--l;s=a,r=o,0!=this._currentLevel&&r[s]instanceof Ga&&r[this.allNodePropertyName]instanceof Ga&&this._accumValuesFromNode(r[this.allNodePropertyName],r[s])}if(o)o.hasOwnProperty(n)||(this._prevNodeAtLevel.splice(this._nextLevel,this._prevNodeAtLevel.length),this._prevValueAtLevel.splice(this._nextLevel,this._prevValueAtLevel.length));else{var c=new Ga(this._currentLevel);c[this.allNodePropertyName]=new Ga(this._currentLevel+1),++c.numCells,0==this._currentLevel&&0==this._prevNodeAtLevel.length&&(this.rootNode=c),this._prevNodeAtLevel[this._currentLevel]=c,o=this._allNodeAtLevel[this._currentLevel],o||(0<this._currentLevel?(this._allNodeAtLevel[this._currentLevel]=o=new Ga(this._currentLevel),o[this.allNodePropertyName]={},this._allNodeAtLevel[this._prevLevel][this.allNodePropertyName]=o,++o.numCells):this._allNodeAtLevel[this._currentLevel]=c),o=c}if(this._currentLevel==this.levelPreviousToMeasuresIndex)for(o.hasOwnProperty(n)||(o[n]=new Lc,++o.numCells),a=o[this.allNodePropertyName]instanceof Ga||Xa(o[this.allNodePropertyName])?o[this.allNodePropertyName]=new Lc:o[this.allNodePropertyName],s=0;s<this._measuresLength;++s)r=this._measureMembers.getItemAt(s),l=e[r.getDataField()],E(l)&&(l=Number(l.toString())),l=Number(l),this._addValueToNode(o[n],r.getName(),l,r,e),this._addValueToNode(a,r.getName(),l,r,e);0<this._currentLevel&&(o=this._prevNodeAtLevel[this._prevLevel],o.hasOwnProperty(this._prevValueAtLevel[this._prevLevel])||(o[this._prevValueAtLevel[this._prevLevel]]=c,++o.numCells)),this._prevValueAtLevel[this._currentLevel]=n,++this._prevLevel,++this._currentLevel,++this._nextLevel}},fd.prototype._addValueToNode=function(t,e,i,s,r){var n;if(Xa(i))n=s.getAggregator(),t.hasOwnProperty(e)||(t[e]=n.computeBegin(s.getDataField()),this._computeEndMap[s].push(t)),n.computeLoop(t[e],s.getDataField(),r);else{if(t.hasOwnProperty(e))i instanceof Lc&&!(t[e]instanceof Lc)?(s=!1,t.hasOwnProperty(e)||(s=!0),e=t[e]=new Lc,s&&++t.numCells):e=t[e];else{t[e]=e=new Lc,++t.numCells;var o}for(o in i)s=this._measureMap[o],n=s.getAggregator(),e.hasOwnProperty(o)?n.computeObjectLoop(e[o],i[o]):(e[o]=n.computeObjectBegin(i[o]),this._computeObjEndMap[s].push(e))}},fd.prototype._accumValuesFromNode=function(t,e){for(var i in e)if(i!=this.allNodePropertyName&&"numCells"!=i&&"_level"!=i&&"getLevel"!=i){var s=e[i];if(s instanceof Ga){var r;t[i]instanceof Ga?r=t[i]:(t[i]=r=new Ga(s.getLevel()),++t.numCells),this._accumValuesFromNode(r,s)}else this._addValueToNode(t,i,s,null,null)}if(1==t.numCells){for(i in t){t[this.allNodePropertyName]=t[i];break}++t.numCells}else if(2==t.numCells&&t.hasOwnProperty(this.allNodePropertyName)){for(i in t)if(i!=this.allNodePropertyName&&"numCells"!=i&&"_level"!=i&&"getLevel"!=i){t[this.allNodePropertyName]!=t[i]&&(t[this.allNodePropertyName]=t[i]);break}}else{var n,s=!1;for(i in t)if(i!=this.allNodePropertyName&&"numCells"!=i&&"_level"!=i&&"getLevel"!=i&&t[this.allNodePropertyName]==t[i]){if(s=t[i],s instanceof Ga)for(n in t[this.allNodePropertyName]=r=new Ga,this._accumValuesFromNode(r,s),t)n!=this.allNodePropertyName&&"numCells"!=n&&"_level"!=n&&"getLevel"!=n&&n!=i&&this._accumValuesFromNode(r,e[n]);else for(n in t[this.allNodePropertyName]=null,this._addValueToNode(t,this.allNodePropertyName,s,null,null),t)n!=this.allNodePropertyName&&"numCells"!=n&&"_level"!=n&&"getLevel"!=n&&n!=i&&this._addValueToNode(t,this.allNodePropertyName,t[n],null,null);s=!0;break}s||(i=this.allNodePropertyName,s=e[i],s instanceof Ga?(t[i]instanceof Ga?r=t[i]:(t[i]=r=new Ga(s.getLevel()),++t.numCells),this._accumValuesFromNode(r,s)):this._addValueToNode(t,i,s,null,null))}},cb.prototype.setCube=function(t){this._cube=t},cb.prototype.getQueryProgress=function(){return this._queryProgress},cb.prototype.getQueryTotal=function(){return this._queryTotal},cb.prototype._getAllNodePropertyName=function(){return this._nodeBuilder.allNodePropertyName},cb.prototype._getRootNode=function(){return this._nodeBuilder.rootNode},cb.prototype._getQueryRootNode=function(){return this._queryCubeBuilder?this._queryCubeBuilder.rootNode:null},cb.prototype._getNextTuple=function(){if(this._reachedEnd)return null;var t,e=this._queryTuple,i=0;for(t=0;t<this._queryAxisPositions.length;t++){var s=this._queryAxisPositions[t];e.addMembers(s[this._tupleIndexObject[i]].getMembers()),++i}if(--i,t=++this._tupleIndexObject[i],t>=s.length)for(;t>=s.length;){if(this._tupleIndexObject[i]=0,++this._tupleIndexObject[i-1],t=this._tupleIndexObject[i-1],--i,-1==i){this._reachedEnd=!0;break}s=this._queryAxisPositions[i]}return e},cb.prototype._buildQueryTuples=function(t){if(this._queryCubeColIndex<this._colPositions.length){for(;this._queryCubeRowIndex<this._queryRowCount||!this._validRowPositions&&0==this._queryCubeRowIndex;){do this._getNextTuple(),this._isTupleValid(this._queryTuple)?(this._validRows[this._queryCubeRowIndex]=1,this._validColumns[this._queryCubeColIndex]=1,this._queryTuples[this._queryCubeRowIndex][this._queryCubeColIndex]?this._queryTuples[this._queryCubeRowIndex][this._queryCubeColIndex].push(this._queryTuple):this._queryTuples[this._queryCubeRowIndex][this._queryCubeColIndex]=[this._queryTuple],this._queryTuple=new $b):this._queryTuple._clear();while(!this._reachedEnd&&this._queryCubeColIndex==this._tupleIndexObject[0]&&this._queryCubeRowIndex==this._tupleIndexObject[1]);return++this._queryCubeRowIndex,!1}return this._queryCubeRowIndex=0,++this._queryCubeColIndex,!1}for(t=this._validRows.length-1;-1<t;--t)I(this._validRows[t])&&(this._rowPositions.splice(t,1),this._queryTuples.splice(t,1));for(this._queryRowCount=this._rowPositions.length,t=this._validColumns.length-1;-1<t;--t)if(I(this._validColumns[t])){this._colPositions.splice(t,1);for(var e=0;e<this._queryTuples.length;e++)this._queryTuples[e].splice(t,1)}return this._queryCubeColIndex=this._queryCubeRowIndex=this._queryProgress=0,this._queryTuplesBuilt=!0,this._validRows=this._validColumns=null,!0},cb.prototype._buildQueryCube=function(t){var e=this._getRootNode();if(this._queryCubeBuilder||(this._initQueryNodeBuilder(),this._validRows=Array(this._queryRowCount),this._validColumns=Array(this._colPositions.length),this._queryCubeColIndex=this._queryCubeRowIndex=0),this._queryCubeColIndex<this._colPositions.length){for(var i;this._queryCubeRowIndex<this._queryRowCount||!this._validRowPositions&&0==this._queryCubeRowIndex;){var s=this._queryTuples[this._queryCubeRowIndex][this._queryCubeColIndex];if(s){for(t=0;t<s.length;t++){var r,n=s[t],o=n._getMembersArray(),a=o.length-1;for(n.getExplicitMembers().toArray(),this._validRows[this._queryCubeRowIndex]=1,this._validColumns[this._queryCubeColIndex]=1,n=e,this._moveToNextRoundQuery(),r=0;r<a;r++){if(i=o[r],!n.hasOwnProperty(i.getName())){n=void 0;break}n=n[i.getName()],i.getUniqueName(),this._addValueToQueryNodeBuilder(i.getUniqueName(),n)}I(n)||(n instanceof Ga&&(n=n[this._getAllNodePropertyName()]),o=o[o.length-1],this._addMeasureToQueryNodeBuilder(i.getUniqueName(),n,o))}return this._queryCubeRowIndex++,!1}++this._queryCubeRowIndex}return this._queryCubeRowIndex=0,this._queryCubeColIndex++,!1}for(this._completeQueryNodeBuilding(),i=this._validRows.length-1;-1<i;i--)I(this._validRows[i])&&(this._rowPositions.splice(i,1),this._queryTuples.splice(i,1));for(this._queryRowCount=this._rowPositions.length,i=this._validColumns.length-1;-1<i;i--)if(I(this._validColumns[i]))for(this._colPositions.splice(i,1),t=0;t<this._queryTuples.length;t++)this._queryTuples[t].splice(i,1);return this._queryCubeColIndex=this._queryCubeRowIndex=this._queryProgress=0,this._queryCubeBuilt=!0},cb.prototype._prepareResult=function(t){this._queryTuplesBuilt=this._queryCubeBuilt=!1,this._colPositions=[],this._rowPositions=[],this._queryTuples=[],this._queryTuple=new $b,this._queryAxisPositions=[];for(var e,i,s=0,r=t.getAxis(s);r;){var n,o,a,l=[];for(n=0;n<r.getTuples().length;n++){for(a=r.getTuples()[n],i=new vd,o=0;o<a.getExplicitMembers().getLength();o++)e=a.getExplicitMembers().getItemAt(o),i.addMember(e);l.push(i)}l.length&&(this._queryAxisPositions.push(l),this._newResult._setAxis(s,new Td),this._tupleIndexObject[s]=0),s++,r=t.getAxis(s)}this._colPositions=this._queryAxisPositions[0],this._queryAxisPositions[1]&&(this._rowPositions=this._queryAxisPositions[1]),this._colAxis=this._newResult.getAxis(0),this._rowAxis=this._newResult.getAxis(1),this._rowAxis||(this._rowAxis=new Td,this._newResult._setAxis(gc.ROW_AXIS,this._rowAxis)),this._slicerAxis=this._newResult.getAxis(2),this._slicerPositions=this._queryAxisPositions[2]},cb.prototype._dispatchCubeProgress=function(t,e,i){var s=new Gc(Gc.QUERY_PROGRESS);s.progress=t,s.total=e,i||(s.message="Processing cell : "+t+" of "+e),s.message=i,this._cube.dispatchEvent(s)},cb.prototype._insertResult=function(){for(var t;this._queryCubeColIndex<this._colPos.getLength();){for(;this._queryCubeRowIndex<this._rowPos.getLength()||0==this._rowPos.getLength()&&0==this._queryCubeRowIndex;){if(t=this._queryTuples[this._queryCubeRowIndex][this._queryCubeColIndex]){t=t[0];var e=void 0;return this._getQueryRootNode()?(this._removableSlicerMembers&&this._removableSlicerMembers.length&&(t.removeElementsAtEnd(this._removableSlicerMembers.length),this._measureInSlice&&t.addMember(this._measureInSlice)),e=this._readCubeCell(this._getQueryRootNode(),!1,t._getMembersArray())):void 0==e&&(e=this._readCubeCell(this._getRootNode(),!0,t._getMembersArray())),void 0!=e&&(this._validRows[this._queryCubeRowIndex]=1,this._validColumns[this._queryCubeColIndex]=1,this._newResult._setCell(this._queryCubeRowIndex,this._queryCubeColIndex,Number(e))),this._queryCubeRowIndex++,!1}this._queryCubeRowIndex++}return this._queryCubeRowIndex=0,this._queryCubeColIndex++,!1}return!0},cb.prototype._prepareForNewQuery=function(t){for(this._queryCubeBuilder=null,this._prepareResult(t),this._validRows=this._validColumns=null,this._queryProgress=0,this._rowPositions.length?(this._validRowPositions=!0,this._queryRowCount=this._resultRowCount=this._rowPositions.length):(this._validRowPositions=!1,this._resultRowCount=1,this._queryRowCount=0),this._queryTotal=this._resultRowCount*this._colPositions.length,this._dispatchCubeProgress(this._queryProgress,this._queryTotal),this._newResult.setQuery(t),this._actionFunction=this._buildQueryTuplesAction,this._validRows=Array(this._resultRowCount),this._validColumns=Array(this._colPositions.length),this._queryCubeColIndex=this._queryCubeRowIndex=0,this._queryTuples=Array(this._resultRowCount),t=0;t<this._resultRowCount;t++)this._queryTuples[t]=Array(this._colPositions.length);return this._reachedEnd=!1},cb.prototype._buildQueryTuplesAction=function(t){return this._buildQueryTuples(t)?(this._actionFunction=this._buildQueryCubeAction,!1):(this._cube.hasEventListener(Gc.QUERY_PROGRESS)&&(t=this._queryCubeColIndex*this._resultRowCount+this._queryCubeRowIndex,t-this._queryProgress>this._queryProgressEventThreashold&&(this._queryProgress=t,this._dispatchCubeProgress(this._queryProgress,this._queryTotal,"First Pass - Processing cell : "+this._queryProgress+" of "+this._queryTotal))),!1)},cb.prototype._buildQueryCubeAction=function(t){return this._slicerAxis&&!this._buildQueryCube(t)?(this._cube.hasEventListener(Gc.QUERY_PROGRESS)&&(t=this._queryCubeColIndex*this._resultRowCount+this._queryCubeRowIndex,t-this._queryProgress>this._queryProgressEventThreashold&&(this._queryProgress=t,this._dispatchCubeProgress(this._queryProgress,this._queryTotal,"Second Pass - Processing cell : "+this._queryProgress+" of "+this._queryTotal))),!1):(this._actionFunction=this._buildQueryResultAction,this._prepareToGenerateResult(),!1)},cb.prototype._prepareToGenerateResult=function(){var t;if(0==this._queryCubeRowIndex&&0==this._queryCubeColIndex&&(this._dispatchCubeProgress(this._queryTotal,this._queryTotal),this._colAxis.setPositions(new P(this._colPositions)),this._colPos=this._colAxis.getPositions(),this._validColumns=Array(this._colPos.getLength()),this._rowAxis.setPositions(new P(this._rowPositions)),this._rowPos=this._rowAxis.getPositions(),this._validRows=Array(this._rowPos.getLength()),this._queryProgress=0,this._queryTotal=this._resultRowCount*this._colPositions.length,this._removableSlicerMembers=new P,this._slicerAxis)){t=new P(this._slicerPositions),this._slicerAxis.setPositions(t);for(var e=t.getItemAt(0).getMembers(),i=0;i<e.getLength();i++)t=e.getItemAt(i),this._removableSlicerMembers.addItem(t),t.getIsMeasure()&&(this._measureInSlice=t)}},cb.prototype._buildQueryResultAction=function(t){if(!this._insertResult())return this._cube.hasEventListener(Gc.QUERY_PROGRESS)&&(t=this._queryCubeColIndex*this._rowPos.getLength()+this._queryCubeRowIndex,t-this._queryProgress>this._queryProgressEventThreashold&&(this._queryProgress=t,this._dispatchCubeProgress(this._queryProgress,this._queryTotal,"Third Pass - Processing cell : "+this._queryProgress+" of "+this._queryTotal))),!1;for(this._dispatchCubeProgress(this._queryTotal,this._queryTotal,"Third Pass - Processing cell : "+this._queryTotal+" of "+this._queryTotal),t=this._validRows.length-1;-1<t;--t)I(this._validRows[t])&&(this._rowPos.removeItemAt(t),this._newResult._removeRowData(t));for(t=this._validColumns.length-1;-1<t;--t)I(this._validColumns[t])&&(this._colPos.removeItemAt(t),this._newResult._removeColumnData(t));return this._actionFunction=this._prepareForNewQuery,this._queryTuples=this._validRows=this._validColumns=this._queryCubeBuilder=null,!0},cb.prototype.execute=function(t,e){this._newResult=e;var i,s,r=new Date;do i=this._actionFunction(t),s=new Date-r;while(!i&&10>s);return i},cb.prototype.cancelQuery=function(t){this._actionFunction=this._prepareForNewQuery,this._queryTuples=this._validRows=this._validColumns=this._queryCubeBuilder=null},cb.prototype.cancelRefresh=function(){this._prepared=!1,this._currentPosition=t.getFIRST(),this._iterator=null,this._newSort&&(this._cube.getDataProvider().setSort(this._oldSort),this._cube.getDataProvider().refresh())},cb.prototype._readCubeCell=function(t,e,i){var s;for(s=0;s<i.length;s++){var r,n=i[s];if(r=n.getIsMeasure()?n.getName():n.getIsAll()?e?this._getAllNodePropertyName():this._allQueryNodePropertyName():e?n.getName():n.getUniqueName(),!t.hasOwnProperty(r)){t=void 0;break}t=t[r]}return void 0!=t&&(t instanceof Ga&&(t=e?t[this._getAllNodePropertyName()]:t[this._allQueryNodePropertyName()]),n instanceof wd||(e=this._cube.findDimension("Measures").getDefaultMember(),t=t[e.getName()])),t},cb.prototype._sortData=function(){var t,e;for(t=0;t<this._cube.getDimensions().getLength();t++){var i=this._cube.getDimensions().getItemAt(t);for(e=0;e<i.getHierarchies().getLength();e++){var s=i.getHierarchies().getItemAt(t);this._levels=this._levels.concat(s.getLevels().toArray())}}for(e=new Ac,i=[],t=0;t<this._levels.length;t++)s=new sb(this._levels[t].getDataField()),i.push(s);e.setFields(i),this._cube.getDataProvider().setSort(e),this._cube.getDataProvider().refresh()},cb.prototype.refresh=function(){},cb.prototype.buildCubeIteratively=function(){if(!this._cube.getDataProvider())return!0;var e,i,s;if(!this._prepared){for(this._levels=[],i=0;i<this._cube.getDimensions().getLength();i++){var r=this._cube.getDimensions().getItemAt(i);if(!r.getIsMeasure()){for(s=0;s<r.getAttributes().getLength();s++)e=r.getAttributes().getItemAt(s),e._getUserHierarchyLevel()||(this._levels=this._levels.concat(e.getLevels().toArray()));for(s=0;s<r.getHierarchies().getLength();s++)e=r.getHierarchies().getItemAt(s),this._levels=this._levels.concat(e.getLevels().toArray())}}for(this._oldSort=this._cube.getDataProvider().getSort(),this._newSort=new Ac,s=[],i=0;i<this._levels.length;i++)e=this._levels[i],e.getAttribute()&&e.getAttribute()._userDataFunction?(e=e.getAttribute(),r=new sb(e.getDataField()),r.compareFunction=e.dataCompareFunction):r=new sb(e.getDataField()),s.push(r);return this._newSort.setFields(s),this._cube.getDataProvider().setSort(this._newSort),this._cube.getDataProvider().refresh(),this._queryCubeBuilder=this._nodeBuilder=null,this._initNodeBuilder(),this._prepared=!0,this._iterator=this._cube.getDataProvider().createCursor(),!1}if(this._iterator.seek(this._currentPosition),this._iterator.getAfterLast()||this._currentPosition==t.getLAST())return!!this._completeNodeBuilder()&&(this._prepared=!1,this._currentPosition=t.getFIRST(),this._iterator=null,this._newSort&&(this._cube.getDataProvider().setSort(this._oldSort),this._cube.getDataProvider().refresh()),!0);for(s=this._iterator.getCurrent(),this._nodeBuilder.moveToNextRound(),r=[],i=0;i<this._levels.length;i++)e=this._levels[i],e=e._getDataFunction()(s,e.getDataField()),r.push(e);return this._nodeBuilder.addValueToNodeBuilder(r,s),this._iterator.moveNext(),this._currentPosition=this._iterator.getBookmark(),!1},cb.prototype._initNodeBuilder=function(){this._nodeBuilder||(this._nodeBuilder=new fd,this._nodeBuilder.setCube(this._cube),this._nodeBuilder.levelPreviousToMeasuresIndex=this._levels.length-1),this._nodeBuilder.initNodeBuilding()},cb.prototype._addValueToNodeBuilder=function(t,e){this._nodeBuilder.addValueToNodeBuilder(t,e)},cb.prototype._completeNodeBuilder=function(){return this._nodeBuilder.completeNodeBuilding()},cb.prototype._initQueryNodeBuilder=function(){
this._queryCubeBuilder||(this._queryCubeBuilder=new Vc,this._queryCubeBuilder.setCube(this._cube)),this._queryCubeBuilder.initNodeBuilding()},cb.prototype._allQueryNodePropertyName=function(){return this._queryCubeBuilder.allNodePropertyName},cb.prototype._addValueToQueryNodeBuilder=function(t,e){this._queryCubeBuilder.addValueToNodeBuilder(t,e)},cb.prototype._addMeasureToQueryNodeBuilder=function(t,e,i){this._queryCubeBuilder.addMeasureValueToNode(t,e,i)},cb.prototype._completeQueryNodeBuilding=function(){this._queryCubeBuilder.completeNodeBuilding()},cb.prototype._moveToNextRoundQuery=function(){this._queryCubeBuilder.moveToNextRound()},cb.prototype._isTupleValid=function(t){t=t._getMembersArray();for(var e,i=this._getRootNode(),s=t.length-1,r=0;r<s;r++)if(e=t[r],e.getIsAll())i=i[this._getAllNodePropertyName()];else if(i=i[e.getName()],I(i))return!1;return!0},uc.prototype.getUniqueName=function(){return this._dimension?String("["+this._dimension.getName()+"].["+this._name+"]"):this._name},uc.prototype.getDisplayName=function(){return this._displayName?this._displayName:this.getName()},uc.prototype.setDisplayName=function(t){return this._displayName=t},uc.prototype.getName=function(){return this._name},uc.prototype.setName=function(t){return nb.traceMsg("Setting the name to: "+t,nb.TRACE_LEVEL_3),this._name=t},uc.prototype.getDimension=function(){return this._dimension},uc.prototype.setDimension=function(t){return this._dimension=t},uc.prototype.toString=function(){return this.getUniqueName()},Qa._defaultProperty="elements",Qa._propertyType={elements:Array},z(Qa,uc),Qa.prototype.getHasAll=function(){return this._hasAll},Qa.prototype.setHasAll=function(t){this._hasAll!=t&&(this._allLevels=null),this._hasAll=t},Qa.prototype.getLevels=function(){return this._levels},Qa.prototype.setLevels=function(t){for(this._levels=t,this._levelMap={},t=0;t<this._levels.getLength();t++){var e=this._levels.getItemAt(t);e.setHierarchy(this),this._levelMap[e.getAttributeName()]=e}},Qa.prototype.setElements=function(t){this.setLevels(new P(t))},Qa.prototype.getElements=function(){return null},Qa.prototype.getDataProvider=function(){return this._dataProvider?this._dataProvider:this.getDimension()._getDataProvider()},Qa.prototype.setDataProvider=function(t){this._dataProvider=t},Qa.prototype.getAllMemberName=function(){return this._allMemberName},Qa.prototype.setAllMemberName=function(t){if(t&&this._allMemberName!=t){var e=this._levelMap[this._getAllLevelName()];e?(e.removeMemberByName(this._allMemberName),this._allMemberName=t,this._allMember=e._createMember(null,this._allMemberName),this._allMember._setIsAll(!0)):this._allMemberName=t}},Qa.prototype.getMembers=function(){var t=[];if(this._hasAll)return this._allMembersCache||(t.push(this.getAllMember()),t=t.concat(this._getMembersRecursively(this.getAllMember())),this._allMembersCache=new P(t)),this._allMembersCache;for(var e=0;e<this._levels.getLength();e++)var i=this._levels.getItemAt(e),t=t.concat(i.getMembers(!1).getSource());return new P(t)},Qa.prototype.getDefaultMember=function(){return this._hasAll?this._allMember:1<=this._levels.getLength()?this._levels[0].getMembers()[0]:null},Qa.prototype.getName=function(){var t=Qa._super.getName.call(this);return!t&&this.getDimension()?this.getDimension().getName():t},Qa.prototype.getChildren=function(){return this._allLevel?this._allLevel.getMembers().getItemAt(0).getChildren():null},Qa.prototype._getAllLevels=function(){return this._allLevels||(this._allLevels=new P(this._levels.toArray()),this._allLevels.addItemAt(this._allLevel,0)),this._allLevels},Qa.prototype._getAllLevelName=function(){return this._allLevelName},Qa.prototype._setAllLevelName=function(t){this._allLevelName=t},Qa.prototype._getAllLevel=function(){return this._allLevel},Qa.prototype._setAllLevel=function(t){this._allLevel=t},Qa.prototype._createLevel=function(t){var e=new db(t);return e.setHierarchy(this),e.setDimension(this.getDimension()),this._levels.addItem(e),this._levelMap[t]=e},Qa.prototype.findLevel=function(t){return t==this._allLevelName?null:this._levelMap[t]},Qa.prototype._createAllLevelIfRequired=function(){var t;this._hasAll?(t=this._levelMap[this._allLevelName],t||(t=new db(this.getName()),t.setHierarchy(this),t.setDimension(this.getDimension()),this._allLevel=t,this._allMember=t._createMember(null,this._allMemberName),this._allMember._setIsAll(!0))):(this._allMember=this._allLevel=null,(t=this._levelMap[this._allLevelName])&&(t=this._levels.getItemIndex(t),-1<t&&this._levels.removeItemAt(t),delete this._levelMap[this._allLevelName]))},Qa.prototype._refresh=function(){this.allMembersCache=this._allLevels=null,this._createAllLevelIfRequired(),this._allLevel&&this._allLevel._refresh();for(var t=0;t<this._levels.getLength();t++){var e=this._levels.getItemAt(t);e.setDimension(this.getDimension()),e._refresh()}},Qa.prototype._processData=function(t){var e;this._allLevel&&(e=this._allLevel.getMembers().getItemAt(0));for(var i=0;i<this._levels.getLength();i++){var s=this._levels.getItemAt(i),r=s._getDataFunction()(t,s.getDataField());e=s._createMember(e,r)}},Qa.prototype._makeMembers=function(){for(var t=this.getDataProvider().createCursor();!t.getAfterLast();){var e=t.getCurrent();this._processData(e),t.moveNext()}return!0},Qa.prototype._getMembersRecursively=function(t){var e=[];t=t.getChildren();for(var i=0;i<t.getLength();i++){var s=t.getItemAt(i);e.push(s),s.getChildren().getLength()&&(s=this._getMembersRecursively(s),e=e.concat(s))}return e},Qa.prototype.findMember=function(t){return this._allLevel?t==this._allMemberName?this._allMember:this._allMember.findChildMember(t):this._levels.getLength()&&(t=this._levels.getItemAt(0).findMember(t))&&1==t.getLength()?t.getItemAt(0):null},z(ob,Qa),ob.prototype._getAllLevels=function(){return new P([this._allLevel,this._singleLevel])},ob.prototype._getUserHierarchy=function(){return this._userHierarchy},ob.prototype._setUserHierarchy=function(t){this._userHierarchy=t},ob.prototype._getUserHierarchyLevel=function(){return this._userHierarchyLevel},ob.prototype._setUserHierarchyLevel=function(t){this._userHierarchyLevel=t},ob.prototype.getHasAll=function(){return!0},ob.prototype.getMembers=function(){var t=new P(this._uniqueMembers.toArray());return t.addItemAt(ob._super.findMember.call(this,this.getAllMemberName()),0),t},ob.prototype.getChildren=function(){return this._uniqueMembers},ob.prototype.setLevels=function(t){},ob.prototype.getDataField=function(){return this._dataField},ob.prototype.setDataField=function(t){this._dataField=t},ob.prototype.getDataFunction=function(){return this._dataFunction},ob.prototype.setDataFunction=function(t){null!=t?(this._dataFunction=t,this._userDataFunction=!0):(this._dataFunction=this._internalDataFunction,this._userDataFunction=!1)},ob.prototype.findLevel=function(t){return null},ob.prototype._processData=function(t){if(t=this._dataFunction(t,this._dataField),!this._uniqueChildrenMap[t]){var e=this._singleLevel._createMember(this._allMember,t);null!=this.displayNameFunction&&e.setDisplayName(this.displayNameFunction(t)),this._uniqueChildrenMap[e.getName()]=e,this._uniqueMembers.addItem(e)}},ob.prototype._refresh=function(){this._uniqueChildrenMap={},this._uniqueMembers=new P,ob._super.findLevel.call(this,this.getName())||(this._createAllLevelIfRequired(),this._singleLevel=this._createLevel(this.getName()),this._allLevel._refresh(),this._singleLevel._refresh(),this._userHierarchyLevel&&(1==this._userHierarchyLevel.getDepth()&&this._allLevel._setUserLevel(this._userHierarchy._getAllLevel()),this._singleLevel._setUserLevel(this._userHierarchyLevel)))},ob.prototype._createAllLevelIfRequired=function(){var t;this._hasAll?(t=this._levelMap[this._allLevelName],t||(t=new Id(this._allLevelName),t.setHierarchy(this),t.setDimension(this.getDimension()),t.setAttributeName(this.getName()),this._allLevel=t,this._allMember=t._createMember(null,this._allMemberName),this._allMember._setIsAll(!0))):(this._allMember=this._allLevel=null,(t=this._levelMap[this._allLevelName])&&(t=this._levels.getItemIndex(t),-1<t&&this._levels.removeItemAt(t),delete this._levelMap[this._allLevelName]))},ob.prototype._createLevel=function(t){var e=new Id(t);return e.setHierarchy(this),e.setDimension(this.getDimension()),e.setAttributeName(t),this._levels.addItem(e),this._levelMap[t]=e},ob.prototype._internalDataFunction=function(t,e){var i;if(E(t))try{i=G.getProperty(t,e)}catch(s){}else i=t[e];return i},ob.prototype._internalDataCompareFunction=function(t,e){var i=this._internalDataFunction(t,this._dataField),s=this._internalDataFunction(e,this._dataField);return i<s?-1:i>s?1:0},z(db,uc),db.prototype.getName=function(){return this._attribute?this._attribute.getName():db._super.getName.call(this)},db.prototype.setName=function(t){nb.traceMsg("Attempt to set the name of a level. Name of a level is defined by the associated attribute",nb.TRACE_LEVEL_1)},db.prototype.getUniqueName=function(){return String("["+this.getHierarchy().getDimension().getName()+"].["+this.getHierarchy().getName()+"].["+this.getName()+"]")},db.prototype.getAttribute=function(){return this._attribute},db.prototype.getAttributeName=function(){return this._attributeName},db.prototype.setAttributeName=function(t){this._attributeName=t},db.prototype.getChild=function(){var t=this.getHierarchy()._getAllLevels(),e=t.getItemIndex(this);return e<t.getLength()-1?t.getItemAt(e+1):null},db.prototype.getDataField=function(){return this._attribute?this._attribute.getDataField():null},db.prototype.getDepth=function(){return this.getHierarchy()._getAllLevels().getItemIndex(this)},db.prototype.getHierarchy=function(){return this._hierarchy},db.prototype.setHierarchy=function(t){this._hierarchy=t},db.prototype.getMembers=function(){return this._hierarchy.getAllMemberName()==this.getName()?this._getMembers():this._getMembers(!1)},db.prototype.getParent=function(){var t=this._hierarchy._getAllLevels(),e=t.getItemIndex(this);return 1<=e?t.getItemAt(e-1):null},db.prototype._getDataFunction=function(){return this._attribute?this._attribute.getDataFunction():null},db.prototype._getDataCompareFunction=function(){return this._attribute?this._attribute.dataCompareFunction:null},db.prototype.findMember=function(t){return this._membersMapOnName[t]},db.prototype._addMember=function(t){t.setLevel(this);var e=this._membersMapOnUName[t.getUniqueName()];return(!e||!(e=this._membersMapOnName[t.getName()]))&&(this._membersMapOnUName[t.getUniqueName()]=t,this._membersMapOnName[t.getName()]||(this._membersMapOnName[t.getName()]=new P),this._membersMapOnName[t.getName()].addItem(t),this._orderedMembers.addItem(t),!0)},db.prototype._createMember=function(t,e){var i;return db._tempMember?(i=db._tempMember,i.setName(e)):i=new Sb(e),i.setParent(t),i.setLevel(this),i.setDimension(this.getDimension()),this._membersMapOnUName[i.getUniqueName()]?(db._tempMember=i,i=this._membersMapOnUName[i.getUniqueName()]):(db._tempMember=null,this._attribute&&null!=this._attribute.displayNameFunction&&i.setDisplayName(this._attribute.displayNameFunction(e)),this._membersMapOnUName[i.getUniqueName()]=i,this._membersMapOnName[i.getName()]||(this._membersMapOnName[i.getName()]=new P),this._membersMapOnName[i.getName()].addItem(i),this._orderedMembers.addItem(i),t&&t._addChild(i)),i},db.prototype._getMembers=function(t){if(t=!(0<arguments.length)||t)return this._orderedMembers;var e=this._orderedMembers.getSource().slice(0),e=new P(e),i=e.getItemIndex(this._levelAllMember);return-1<i&&e.removeItemAt(i),e},db.prototype._refresh=function(){var t;if(this.findMember(this._allMemberName)||(this._levelAllMember=this._createMember(null,this._allMemberName)),this._attributeName){if(this._attribute=this.getDimension().findAttribute(this._attributeName),!this._attribute)throw t=B.getString("olap","invalidAttributeName",[this._attributeName]),Error(t)}else if(this.getHierarchy()._getAllLevel()!=this)throw t=B.getString("olap","noAttributeForLevel",[this.getHierarchy().getName()]),Error(t)},db.prototype._removeMember=function(t){if(t){delete this._membersMapOnUName[t.getUniqueName()];var e=this._membersMapOnName[t.getName()];t=e.getItemIndex(t),-1<t&&e.removeItemAt(t)}},db.prototype._removeMemberByName=function(t){var e=this._membersMapOnUName[t];e?this._removeMember(e):(t=this._membersMapOnName[t],1==t.length&&this._removeMember(t.getItemAt(0)))},z(Id,db),Id.prototype.getDataField=function(){return this.getHierarchy().getDataField()},Id.prototype._getUserLevel=function(){return this._userLevel},Id.prototype._setUserLevel=function(t){this._userLevel=t},Id.prototype.getChildren=function(){return null},vd.prototype.getMembers=function(){return this._members},vd.prototype.addMember=function(t){this._members.addItem(t)},pe.prototype.getFormattedValue=function(){return this._formattedValue?this._formattedValue:this._value.toString()},pe.prototype.getValue=function(){return this._value},La._defaultProperty="elements",La._propertyType={elements:Array},z(La,wa),La.prototype.getDataProvider=function(){return this._dataProvider},La.prototype.setDataProvider=function(t){this._dataProvider=t},La.prototype.getDimensions=function(){return this._dimensions},La.prototype.setDimensions=function(t){this._attributeLevels=null,this._dimensions=t;for(var e=0;e<t.getLength();e++){var i=t.getItemAt(e);i.setCube(this),this._dimensionMap[i.getName()]=i}},La.prototype.setElements=function(t){var e,i=new P,s=new P;for(e=0;e<t.length;e++){var r=t[e];r instanceof ub?i.addItem(r):r instanceof wd?s.addItem(r):nb.traceMsg("Invalid element specified for cube elements")}this.setDimensions(i),this.setMeasures(s)},La.prototype.getElements=function(){return null},La.prototype.setMeasures=function(t){this._measures=t},La.prototype.getName=function(){return this._name},La.prototype.setName=function(t){this._name=t},La.prototype._getAttributeLevels=function(){if(this._attributeLevels)return this._attributeLevels;this._attributeLevels=[];for(var t=0;t<this._dimensions.getLength();t++){var e=this._dimensions.getItemAt(t);if(!e.getIsMeasure()){for(var i=0;i<e.getAttributes().getLength();i++){var s=e.getAttributes().getItemAt(i);s._getUserHierarchyLevel()||(this._attributeLevels=this._attributeLevels.concat(s._getAllLevels().toArray()))}for(i=0;i<e.getHierarchies().getLength();i++)for(var r=e.getHierarchies().getItemAt(i).getLevels(),n=r.getLength(),o=0;o<n;o++)s=r.getItemAt(o).getAttribute(),this._attributeLevels=this._attributeLevels.concat(s._getAllLevels().toArray())}}return this._attributeLevels},La.prototype._getDefaultTupleMembers=function(){if(!this._defaultTupleMembers){this._defaultTupleMembers=Array(this._getAttributeLevels().length/2),this._attributeToIndex={};for(var t=0,e=0;e<this._getAttributeLevels().length;e+=2){var i=this._getAttributeLevels()[e].getAttribute();this._attributeToIndex[i]=t,this._defaultTupleMembers[t++]=i.getDefaultMember()}}return this._defaultTupleMembers.slice()},La.prototype._getCubeImpl=function(){return this._cubeImpl},La.prototype._setCubeImpl=function(t){this._cubeImpl=t,this._cubeImpl.setCube(this)},La.prototype.cancelQuery=function(t){var e=Ra.indexOf(this._queriesPending,t);-1!=e&&(0==e&&this._cubeImpl.cancelQuery(t),this._queriesPending.splice(e,1),delete this._queryToken[t],0==this._queriesPending.length&&(this._queryTimer.stop(),this._queryTimer=null))},La.prototype.cancelRefresh=function(){this._prepare=!1,this._progress=0,this._cubeImpl.cancelRefresh(),this._cubeBuildingTimer&&(this._cubeBuildingTimer.stop(),this._cubeBuildingTimer.removeEventListener("timer",this._updateDimensions,this),this._cubeBuildingTimer.removeEventListener("timer",this._buildCube,this),this._cubeBuildingTimer=null),this._oldSort&&(this._dataProvider.setSort(this._oldSort),this._dataProvider.refresh())},La.prototype.createDimension=function(t){var e=new ub(t);return e.setCube(this),this._dimensions.addItem(e),this._dimensionMap[t]=e},La.prototype.findDimension=function(t){return this._dimensionMap[t]},La.prototype.refresh=function(){if(this._attributeLevels=null,!this.findDimension(this._measureDimensionName)){var t=this.createDimension(this._measureDimensionName),e=t._createHierarchy(this._measureDimensionName);if(e.setHasAll(!1),e.setDimension(t),e=e._createLevel(this._measureDimensionName),t._setAsMeasure(!0),t._refresh(),!this._measures||0==this._measures.getLength())throw t=B.getString("olap","noMeasures"),Error(t);for(var i=0;i<this._measures.getLength();i++){var s=this._measures.getItemAt(i);s.setDimension(t),e._addMember(s)}}this._defaultMeasure=this._measures.getItemAt(0),this._dataProvider&&(this._cubeBuildingTimer=new sc(this._cubeBuildingTimeInterval,0),this._cubeBuildingTimer.addEventListener("timer",this._updateDimensions,this),this._cubeBuildingTimer.start())},La.prototype._dispatchCubeProgress=function(t,e,i){var s=new Gc(Gc.CUBE_PROGRESS);s.progress=t,s.total=e,s.message=i,this.dispatchEvent(s)},La.prototype._updateDimensions=function(t){this._prepare?this._dimIndex<this._dimensions.getLength()?(this._dispatchCubeProgress(this._dimIndex,this._dimensions.getLength(),"Processing dimension: "+this._dimensions.getItemAt(this._dimIndex).getName()),this._dimensions.getItemAt(this._dimIndex)._refresh(),this._dimIndex++):(this._dispatchCubeProgress(this._dimIndex,this._dimensions.getLength()),this._prepare=!1,this._cubeBuildingTimer.stop(),this._cubeBuildingTimer.removeEventListener("timer",this._updateDimensions,this),this._dataProvider.setSort(this._oldSort),this._oldSort=null,this._dataProvider.refresh(),this._cubeImpl&&(this._cubeImpl.setCube(this),this._cubeImpl.refresh(),this._cubeBuildingTimer.addEventListener("timer",this._buildCube,this),this._cubeBuildingTimer.start(),this._progress=0,this._total=this._dataProvider.getLength())):(this._oldSort=this._dataProvider.getSort(),this._prepare=!0,this._dimIndex=0,this._dispatchCubeProgress(this._dimIndex,this._dimensions.getLength(),"Processing dimension: "+this._dimensions.getItemAt(this._dimIndex).getName()))},La.prototype._buildCube=function(t){if(this._progress==this._total+1)this._dispatchCubeProgress(this._progress-1,this._total,"Finalizing...Please wait"),this._progress++;else{t=new Date;for(var e,i=0;i<this._workDuration&&!(e=this._cubeImpl.buildCubeIteratively());)this._progress>this._total?this._dispatchCubeProgress(this._total,this._total,"Finalizing...Please wait"):this._dispatchCubeProgress(this._progress++,this._total,"Processing data Row: "+this._progress+" of "+this._total),i=new Date-t;e&&(this.dispatchEvent(new Gc(Gc.CUBE_COMPLETE)),this._cubeBuildingTimer.stop(),this._cubeBuildingTimer=null)}},La.prototype.execute=function(t){if(-1!=Ra.indexOf(this._queriesPending,t))return null;var e=new ad(null);return this._queriesPending.push(t),this._queryToken[t]={tok:e},this._queryTimer||(this._queryTimer=new sc(this._queryBuildingTimeInterval,0),this._queryTimer.addEventListener("timer",this._executeQuery,this),this._queryTimer.start()),e},La.prototype._getAxisHierarchies=function(t){var e=[];t=t.getSets();for(var i=0;i<t.length;i++)for(var s=t[i].getTuples(),r=0;r<s.length;r++)for(var n=s[r].getExplicitMembers(),o=0;o<n.getLength();o++){var a=n.getItemAt(o).getHierarchy();a&&e.push(a)}return e},La.prototype._findDuplicateHierarchies=function(t,e){for(var i=0;i<t.length;i++){var s=t[i];if(-1<Ra.indexOf(e,s))return s}return null},La.prototype._validateQuery=function(t){t=t.getAxes();for(var e=0;e<t.length;e++)for(var i=this._getAxisHierarchies(t[e]),s=e+1;s<t.length;s++){var r=this._getAxisHierarchies(t[s]);if(r=this._findDuplicateHierarchies(i,r))throw t=B.getString("olap","duplicateHierarchyOnAxes",[r.getName(),e,s]),new De(t)}},La.prototype._executeQuery=function(t){t=this._queryToken[this._queriesPending[0]];var e=t.tok;if(e.hasResponder()){var i,s,r=this._queriesPending[0],n=!0;try{if(t.hasOwnProperty("result")?i=t.result:(this._validateQuery(r),t.result=i=new this._resultClass),!this._cubeImpl.execute(r,i))return void(n=!1)}catch(o){for(s=0;s<e.getResponders().length;s++)e.getResponders()[s].fault(o.message);i=null}finally{n&&(this._queriesPending.splice(0,1),delete this._queryToken[r],0==this._queriesPending.length&&(this._queryTimer.stop(),this._queryTimer=null))}if(i)for(s=0;s<e.getResponders().length;s++)e.getResponders()[s].result(i)}},La.prototype._isTupleValid=function(t){return this._cubeImpl._isTupleValid(t)},La.prototype.toString=function(){return this._name},La.resources={"ko-KR":{olap:{duplicateHierarchyOnAxes:"'{0}'()  '{1}'   '{2}'  .",nullMemberOnAxis:" '{1}' null   .",crossJoinSameHierarchyError:" '{0}'()    .",multipleHierarchies:"     .      .",noMeasures:"    .",unionError:"     .    .",invalidAggregator:"'{0}'()   .    'SUM', 'AVG', 'MIN', 'MAX', 'COUNT'.",invalidAttributeName:"   '{0}'    .",noAttributeForLevel:"'{0}'      .",multipleHierarchiesNotSupported:"      '{0}'  .          ."}},"en-US":{olap:{duplicateHierarchyOnAxes:"'{0}' appears on Axis '{1}' and on Axis '{2}'",nullMemberOnAxis:"Attempt was made to add a null member to the Axis '{1}'",crossJoinSameHierarchyError:" '{0}' found in both sets.",multipleHierarchies:"Dimension contains multiple hierarchies. A hierarchy should be specified explicitly.",noMeasures:"No measures have been specified for the cube",unionError:"Sets do not have same dimensionality. Union cannot be peformed.",invalidAggregator:"Invalid aggregator value '{0}'. The possible values are 'SUM', 'AVG', 'MIN', 'MAX' and 'COUNT'.",invalidAttributeName:"A attribute with the name '{0}' is not available on the dimension.",noAttributeForLevel:"No attribute has been specified for a level in '{0}' hierarchy.",multipleHierarchiesNotSupported:"Attempt to add multiple user defined hierarchies to the dimension '{0}'. Only a single user defined hierarchy is supported in this version."}},"fr-FR":{olap:{duplicateHierarchyOnAxes:"{0} apparat sur l'axe {1} et sur l'axe {2}.",nullMemberOnAxis:"Tentative d'ajout d'un membre nul  l'axe {1}.",crossJoinSameHierarchyError:" {0} figure dans les deux jeux.",multipleHierarchies:"La dimension contient plusieurs hirarchies. Une seule hirarchie doit tre dfinie de faon explicite.",noMeasures:"Aucune mesure n'a t spcifie pour le cube.",unionError:"Les jeux n'ont pas le mme ordre de grandeur. Aucune runion n'est possible.",invalidAggregator:"Valeur d'agrgation incorrecte {0}. Les valeurs admises sont SUM, AVG, MIN, MAX et COUNT.",invalidAttributeName:"L'attribut appel {0} n'est pas disponible pour la dimension.",noAttributeForLevel:"Aucun attribut n'a t spcifi pour un niveau de la hirarchie {0}.",multipleHierarchiesNotSupported:"Tentative d'ajout de plusieurs hirarchies dfinies par l'utilisateur  la dimension {0}. Une seule hirarchie de ce type est prise en charge dans cette version."}},"de-DE":{olap:{duplicateHierarchyOnAxes:"'{0}' erscheint auf Achse '{1}' und auf Achse '{2}'.",nullMemberOnAxis:"NULL-Member sollte zu Achse '{1}' hinzugefgt werden.",crossJoinSameHierarchyError:" '{0}' found in both sets.",multipleHierarchies:"Die Dimension enthlt mehrere Hierarchien. Eine Hierarchie muss explizit angegeben werden.",noMeasures:"Fr den Wrfel wurden keine Mae angegeben.",unionError:"Die Mengen haben nicht dieselbe Dimensionalitt. Vereinigung nicht mglich.",invalidAggregator:"Ungltiger Aggregatorwert '{0}'. Mgliche Werte sind: 'SUM', 'AVG', 'MIN', 'MAX' und 'COUNT'.",invalidAttributeName:"Das Attribut '{0}' ist fr die Dimension nicht verfgbar.",noAttributeForLevel:"Kein Attribut angegeben fr eine Ebene in Hierarchie '{0}'.",multipleHierarchiesNotSupported:"Mehrere benutzerdefinierte Hierarchien sollen zu Dimension '{0}' hinzugefgt werden. In dieser Version werden nur einzelne benutzerdefinierte Hierarchien untersttzt."}},"zh-CN":{olap:{duplicateHierarchyOnAxes:"{0}{1}{2}",nullMemberOnAxis:"{1}",crossJoinSameHierarchyError:" {0}",multipleHierarchies:"",noMeasures:"",unionError:"",invalidAggregator:"{0}SUMAVGMINMAXCOUNT",invalidAttributeName:"{0}",noAttributeForLevel:"{0}",multipleHierarchiesNotSupported:"{0}"}}},B.addResourceBundle("olap",La.resources["ko-KR"].olap,"ko-KR"),B.addResourceBundle("olap",La.resources["en-US"].olap,"en-US"),B.addResourceBundle("olap",La.resources["fr-FR"].olap,"fr-FR"),B.addResourceBundle("olap",La.resources["de-DE"].olap,"de-DE"),B.addResourceBundle("olap",La.resources["zh-CN"].olap,"zh-CN"),ub._defaultProperty="elements",ub._propertyType={elements:Array},z(ub,uc),ub.prototype.getAttributes=function(){return this._attributes},ub.prototype.setAttributes=function(t){this._attributes=t;for(var e=0;e<t.getLength();e++){var i=t.getItemAt(e);i.setDimension(this),this._attributeMap[i.getName()]=i}},ub.prototype.getCube=function(){return this._cube},ub.prototype.setCube=function(t){this._cube=t},ub.prototype.getDefaultMember=function(){if(1<this._hierarchies.length+this._attributes.getLength()){var t=B.getString("olap","multipleHierarchies");throw Error(t)}return this._hierarchies[0].getDefaultMember()},ub.prototype.setElements=function(t){var e,i=new P,s=new P;for(e=0;e<t.length;e++){var r=t[e];r instanceof ob?i.addItem(r):r instanceof Qa?s.addItem(r):nb.traceMsg("Invalid element specified for dimension elements")}this.setAttributes(i),this.setHierarchies(s)},ub.prototype.getElements=function(){return null},ub.prototype.getHierarchies=function(){return this._hierarchies},ub.prototype.setHierarchies=function(t){if(1<t.length)throw t=B.getString("olap","multipleHierarchiesNotSupported",[this.getName()]),Error(t);this._hierarchies=t;for(var e=0;e<t.getLength();e++){var i=t.getItemAt(e);i.setDimension(this),this._hierarchiesMap[i.getName()]=i}},ub.prototype.getIsMeasure=function(){return this._isMeasureDimension},ub.prototype.getMembers=function(){for(var t=[],e=0;e<this._hierarchies.getLength();e++)t=t.concat(this._hierarchies.getItemAt(e).getMembers().toArray());return new P(t)},ub.prototype._setAsMeasure=function(t){this._isMeasureDimension=t},ub.prototype._getDataProvider=function(){return this._cube.getDataProvider()},ub.prototype._createHierarchy=function(t){return t=new Qa(t),t.setDimension(this),this._hierarchies.addItem(t),this._hierarchiesMap[t.getName()]=t},ub.prototype.findHierarchy=function(t){return this._hierarchiesMap[t]},ub.prototype.findAttribute=function(t){return this._attributeMap[t]},ub.prototype.findMember=function(t){var e,i;for(i=0;i<this._attributes.getLength()&&(e=this._attributes.getItemAt(i),!(e=e.findMember(t)));i++);if(!e)for(i=0;i<this._hierarchies.getLength()&&(e=this._hierarchies.getItemAt(i),!(e=e.findMember(t)));i++);return e},ub.prototype._refresh=function(){if(!this.getIsMeasure()){var t,e,i=[];for(e=0;e<this._attributes.getLength();e++)t=this._attributes.getItemAt(e),i.push(t);for(e=0;e<this._hierarchies.getLength();e++)t=this._hierarchies.getItemAt(e),t._refresh(),i.push(t);for(e=0;e<this._hierarchies.getLength();e++){t=this._hierarchies.getItemAt(e).getLevels();for(var s=0;s<t.getLength();++s){var r=t.getItemAt(s),n=this.findAttribute(r.getName());n._setUserHierarchy(r.getHierarchy()),n._setUserHierarchyLevel(r)}}for(e=0;e<this._attributes.getLength();e++)t=this._attributes.getItemAt(e),t._refresh();for(e=this._getDataProvider().createCursor();!e.getAfterLast();){for(r=e.getCurrent(),s=0;s<i.length;s++)t=i[s],t._processData(r);e.moveNext()}}},ub.prototype._addAttribute=function(t,e){var i=this._attributeMap[t];return i||(i=new ob(t),i.setDataField(e),i.setDimension(this),this._attributeMap[t]=i,this._attributes.addItem(i)),i},z(Sb,uc),Sb.prototype.getDimension=function(){return this._level&&this._level.getHierarchy()?this._level.getHierarchy().getDimension():null},Sb.prototype.getUniqueName=function(){var t=[];t.push(this);var e=this.getParent();if(!(this.getHierarchy()instanceof ob)){for(;e&&e.getParent();)t.push(e),e=e.getParent();t.push(this.getHierarchy().getLevels().getItemAt(0))}t.push(this.getHierarchy()),t.push(this._dimension);for(var e="",i=t.length-1;-1<i;i--)e+="["+t[i].getName()+"].";return e=e.substring(0,e.length-1)},Sb.prototype.getChildren=function(){return this._children},Sb.prototype.getDataField=function(){return this._dataField},Sb.prototype.setDataField=function(t){this._dataField=t},Sb.prototype.getHierarchy=function(){return this._level.getHierarchy()},Sb.prototype.getIsMeasure=function(){return!1},Sb.prototype.getLevel=function(){return this._level},Sb.prototype.setLevel=function(t){this._level=t},Sb.prototype.getParent=function(){return this._parent},Sb.prototype.setParent=function(t){this._parent=t},Sb.prototype.getIsAll=function(){return this._all},Sb.prototype._setIsAll=function(t){this._all=t},Sb.prototype._addChild=function(t){this._children.addItem(t),this._childrenMap[t.getName()]=t},Sb.prototype.findChildMember=function(t){return this._childrenMap[t]},z(wd,Sb),wd.prototype.getIsMeasure=function(){return!0},wd.prototype.getAggregator=function(){return this._aggregator},wd.prototype.setAggregator=function(t){if(this._aggregator=t,F(t))switch(t.toLowerCase()){case"sum":this._aggregator=new xd;break;case"count":this._aggregator=new Kd;break;case"avg":this._aggregator=new Jd;break;case"max":this._aggregator=new Ld;break;case"min":this._aggregator=new Md;break;default:throw this._aggregator=null,t=B.getString("olap","invalidAggregator",[t]),Error(t)}},Zb._defaultProperty="axes",Zb._propertyType={axes:Array},Zb.COLUMN_AXIS=0,Zb.ROW_AXIS=1,Zb.SLICER_AXIS=2,Zb.prototype.getAxes=function(){return this._axes},Zb.prototype.setAxes=function(t){this._axes=t},Zb.prototype.getAxis=function(t){switch(t){case Zb.COLUMN_AXIS:case Zb.ROW_AXIS:case Zb.SLICER_AXIS:return this._axes[t]}return null},Zb.prototype.setAxis=function(t,e){switch(t){case Zb.COLUMN_AXIS:case Zb.ROW_AXIS:case Zb.SLICER_AXIS:this._axes[t]=e}},gd.prototype.getSets=function(){return this._sets},gd.prototype.getTuples=function(){return this._tuples},gd.prototype.addMember=function(t){if(!t)throw t=B.getString("olap","nullMemberOnAxis",[this.axisOrdinal]),new De(t);var e=new $b;this._tuples.push(e);var i=new Fb;i.addTuple(e),this._sets.push(i),e.addMember(t)},gd.prototype.addSet=function(t){this._sets.push(t);for(var e=0;e<t.getTuples().length;e++)this._tuples.push(t.getTuples()[e])},gd.prototype.addTuple=function(t){this._tuples.push(t);var e=new Fb;e.addTuple(t),this._sets.push(e)},gd.prototype.clear=function(){this._tuples.splice(0,this._tuples.length),this._sets.splice(0,this._sets.length)},gc.COLUMN_AXIS=0,gc.ROW_AXIS=1,gc.SLICER_AXIS=2,gc.prototype.getAxes=function(){return this._axes},gc.prototype.getQuery=function(){return this._query},gc.prototype.setQuery=function(t){this._query=t},gc.prototype.getAxis=function(t){return this._axes[t]},gc.prototype._setAxis=function(t,e){this._axes[t]=e},gc.prototype.getCell=function(t,e){return new pe(this._cellData[t]?this._cellData[t][e]:NaN)},gc.prototype._setCell=function(t,e,i){this._cellData[t]||(this._cellData[t]=[]),this._cellData[t][e]=i},gc.prototype.hasRowData=function(t){return!I(this._cellData[t])},gc.prototype._removeRowData=function(t){this._cellData.splice(t,1)},gc.prototype._removeColumnData=function(t){for(var e=0;e<this._cellData.length;e++)this._cellData[e].splice(t,1)},Td.prototype.getPositions=function(){return this._positions},Td.prototype.setPositions=function(t){this._positions=t},Td.prototype.addPosition=function(t){this._positions.addItem(t)},Td.prototype.removePosition=function(t){return t=this._positions.getItemIndex(t),-1!=t&&(this._positions.removeItemAt(t),!0)},yd._defaultProperty="cubeArray",yd._propertyType={cubeArray:Array},yd.prototype.getCubes=function(){var t,e=[];for(t in this._cubes)e.push(this._cubes[t]);return new P(e);
},yd.prototype.setCubes=function(t){for(var e=t.length,i=0;i<e;i++){var s=t.getItemAt(i);this._cubes[s.getName()]=s}},yd.prototype.setCubeArray=function(t){this._cubes=new P(t)},yd.prototype.addCube=function(t){return!this._cubes[t.getName()]&&(this._cubes[t.getName()]=t,!0)},yd.prototype.createCube=function(t){if(!this._cubes[t]){var e=new La(t);this._cubes[t]=e}return this._cubes[t]},yd.prototype.getCube=function(t){return this._cubes[t]},Fb.prototype.getTuples=function(){return this._tuples},Fb.prototype.addElement=function(t){var e=new P;if(t instanceof ub&&e.addItem(t.getDefaultMember()),t instanceof Qa&&e.addItem(t.getDefaultMember()),t instanceof db&&(e=t.getMembers()),t instanceof Sb&&e.addItem(t),0<e.getLength())for(t=0;t<e.getLength();t++){var i=e.getItemAt(t),s=new $b;s.addMember(i),this._tuples.push(s)}else nb.traceMsg("Members were not added for "+t.getUniqueName(),nb.TRACE_LEVEL_1)},Fb.prototype.addElements=function(t){for(var e=0;e<t.getLength();e++){var i=t.getItemAt(e),s=new $b;s.addMember(i),this._tuples.push(s)}},Fb.prototype.addTuple=function(t){this._tuples.push(t)},Fb.prototype.crossJoin=function(t){var e,i,s=new Fb,r=new $b;for(this._validateCrossJoin(t),e=0;e<this._tuples.length;e++){var n=this._tuples[e];for(i=0;i<t.getTuples().length;i++){var o=t.getTuples()[i];r.addMembers(n.getExplicitMembers()),r.addMembers(o.getExplicitMembers()),r._isValid()?(s.addTuple(r),r=new $b):r._clear()}}return s},Fb.prototype._validateCrossJoin=function(t){var e,i,s,r;for(e=0;e<this._tuples.length;e++)for(s=this._tuples[e],i=0;i<t.getTuples().length;i++)if(r=t.getTuples()[i],r=this._findCommonHierarchy(s,r))throw t=B.getString("olap","crossJoinSameHierarchyError",[r.getUniqueName()]),Error(t)},Fb.prototype._findCommonHierarchy=function(t,e){var i,s,r,n;for(i=0;i<t.getExplicitMembers().getLength();i++)for(r=t.getExplicitMembers().getItemAt(i),s=0;s<e.getExplicitMembers().getLength();s++)if(n=e.getExplicitMembers().getItemAt(s),r.getHierarchy()==n.getHierarchy())return r.getHierarchy();return null},Fb.prototype.hierarchize=function(t){t=0<arguments.length&&t;var e,i=new Fb;this._reverseCompare=t;var s=[],r=this._tuples;for(e=0;e<r.length;e++)s.push({no:e,tuple:r[e]});for(r=s.sort(this._sortTuple),e=0;e<r.length;e++)i.addTuple(this._tuples[r[e].no]);return this._reverseCompare=!1,i},Fb.prototype._compareMembers=function(t,e){if(t==e)return 0;for(;;){if(t&&!e)return this._reverseCompare?-1:1;if(!t&&e)return this._reverseCompare?1:-1;if(t.getLevel().getDepth()<e.getLevel().getDepth()){if(e=e.getParent(),t==e)return this._reverseCompare?1:-1}else if(t.getLevel().getDepth()>e.getLevel().getDepth()){if(t=t.getParent(),t==e)return this._reverseCompare?-1:1}else{if(t.getParent()==e.getParent()){var i=t.getName().toString().localeCompare(e.getName());return 0==i?0:0<i?1:-1}t=t.getParent(),e=e.getParent()}}},Fb.prototype._sortTuple=function(t,e){var i,s,r,n=t.tuple.getExplicitMembers().toArray(),o=e.tuple.getExplicitMembers().toArray();for(i=0;i<n.length&&(s=n[i],r=o[i],s=Fb.prototype._compareMembers.call(this,s,r),0==s);i++);return s},Fb.prototype._isDuplicate=function(t,e){for(var i=t.getExplicitMembers(),s=e.getExplicitMembers(),r=0;r<i.getLength();++r)if(i.getItemAt(r)!=s.getItemAt(r))return!1;return!0},Fb.prototype.union=function(t){var e=new Fb,i=this.getTuples();t.getTuples();for(var s=[],i=i[0].getExplicitMembers(),r=i.getLength(),n=0;n<r;++n)s.push(i.getItemAt(n).getHierarchy());for(this._checkTupleHierarchies(this,r,s),this._checkTupleHierarchies(t,r,s),t=this.getTuples().concat(t._tuples),r=[],i=t,s=0;s<i.length;s++)r.push({no:s,tuple:i[s]});for(i=r.sort(this._sortTuple),r=i.length-1,n=[],s=0;s<r;s++)this._isDuplicate(t[i[s].no],t[i[s+1].no])&&n.push(i[s].no);for(n=n.sort(),s=0;s<n.length;s++)t.splice(n[s],1);return e._tuples=t,e},Fb.prototype._checkTupleHierarchies=function(t,e,i){t=t.getTuples();for(var s=B.getString("olap","unionError"),r=0;r<t.length;++r){var n=t[r].getExplicitMembers();if(n.getLength()!=e)throw Error(s);for(var o=0;o<e;++o)if(n.getItemAt(o).getHierarchy()!=i[o])throw Error(s)}},nb.traceOn=!0,nb.traceLevel=1,nb.TRACE_LEVEL_1=1,nb.TRACE_LEVEL_2=2,nb.TRACE_LEVEL_3=3,nb.traceMsg=function(t,e){e=1<arguments.length?e:1,nb.traceOn&&e<=nb.traceLevel&&window.console&&window.console.log&&console.log(t)},$b.prototype.getExplicitMembers=function(){return this._explicitMembersValid||(this._explicitMembers.setSource(this._userMembers.slice(0)),this._explicitMembersValid=!0),this._explicitMembers},$b.prototype._getUserMembers=function(){var t,e,i=[];for(t=0;t<this._userMembers.length;t++)if(e=this._userMembers[t],i.push(e),!(e.getHierarchy()instanceof ob))for(e=e.getParent();e&&e.getHierarchy()._getAllLevel()!=e.getLevel();)i.push(e),e=e.getParent();return i},$b.prototype._getMembers=function(){if(this._cacheValid)return this._cachedMembers;var t,e,i=[],s=this._userMembers[0].getLevel().getHierarchy().getDimension().getCube(),r=s._getAttributeLevels(),n={};for(t=0;t<this._userMembers.length;t++)for(e=this._userMembers[t],n[e.getLevel()]=e;e.getParent()&&e.getParent().getParent();)e=e.getParent(),n[e.getLevel()]=e;for(t=r.length,e=0;e<t;++e){var o=r[e],a=o.getHierarchy(),l=n[o];l||a instanceof ob&&(l=n[o._getUserLevel()]),l?(i.push(l),o==a._getAllLevel()&&++e):o==a._getAllLevel()?n[r[e+1]]||n[r[e+1]._getUserLevel()]||(i.push(a._allMember),++e):o._levelAllMember?i.push(o._levelAllMember):i.push(a.getDefaultMember())}for(r=!1,t=0;t<this.getExplicitMembers().getLength();t++)if(n=this.getExplicitMembers().getItemAt(t),n instanceof wd){r=!0,i.push(n);break}return r||i.push(s._defaultMeasure),this._cachedMembers.setSource(i),this._cacheValid=!0,this._cachedMembers},$b.prototype._getMembersArray=function(){return this._getMembers(),this._cachedMembers.getSource()},$b.prototype.addMembers=function(t){this._cacheValid=this._explicitMembersValid=!1;for(var e=t.getLength(),i=0;i<e;++i)this._userMembers.push(t.getItemAt(i))},$b.prototype._removeElements=function(t){this._cacheValid=this._explicitMembersValid=!1;for(var e=t.getLength(),i=0;i<e;++i){var s=Ra.indexOf(this._userMembers,t.getItemAt(i));-1!=s&&this._userMembers.splice(s,1)}},$b.prototype._removeElementsAtEnd=function(t){this._cacheValid=this._explicitMembersValid=!1,this._userMembers.splice(-1,t)},$b.prototype.addMember=function(t){this._cacheValid=this._explicitMembersValid=!1,t instanceof ub?(nb.traceMsg("Getting default member of dimension:"+t.getName(),nb.TRACE_LEVEL_3),this._userMembers.push(t.getDefaultMember())):t instanceof Qa?(this._userMembers.push(t.getDefaultMember()),nb.traceMsg("Getting default member of hierarchy:"+t.getName(),nb.TRACE_LEVEL_3)):t instanceof Sb?this._userMembers.push(t):t instanceof db&&nb.traceMsg("Error a level is being passed as input to tuple:"+t.getName(),nb.TRACE_LEVEL_1)},$b.prototype._clear=function(){this._cacheValid=!1,this._userMembers.splice(0,this._userMembers.length),this.explicitMembersValid=!1},$b.prototype._clone=function(){var t=new $b;return t._userMembers=this._userMembers.slice(0),t},$b.prototype._isValid=function(){for(var t=this._userMembers.length,e=0;e<t;++e){var i=this._userMembers[e].getHierarchy();if(i instanceof ob)for(var i=i._getUserHierarchyLevel(),s=0;s<t;++s)if(s!=e&&this._userMembers[s].getLevel()==i)return!1}return this._userMembers[0].getDimension().getCube()._isTupleValid(this)},Vc.prototype.setCube=function(t){this._cube=t},Vc.prototype.initNodeBuilding=function(){var t,e,i,s;for(this._prevNodeAtLevel=[],this._allNodeAtLevel=[],this._prevValueAtLevel=[],this._measureMap={},this._measureMembers=this._cube.findDimension("Measures").getMembers(),t=0;t<this._measureMembers.getLength();t++)e=this._measureMembers.getItemAt(t),this._computeEndMap[e]=[],this._computeEndMap2[e]=e,this._computeObjEndMap[e]=[],this._measureMap[e.getName()]=e;for(this._nodesToClose=[],this._nodesToAggregate=[],this._dataToAggregate=[],this._measureToAggregate=[],this._valueToAggregate=[],this._allLevelNames=[],t=0;t<this._cube.getDimensions().getLength();t++)if(i=this._cube.getDimensions().getItemAt(t),!i.getIsMeasure()){for(e=0;e<i.getAttributes().getLength();e++)s=i.getAttributes().getItemAt(e),this._allLevelNames.push(s.findMember(s.getAllMemberName()).getUniqueName());for(e=0;e<i.getHierarchies().getLength();e++)s=i.getHierarchies().getItemAt(e),this._allLevelNames.push(s.findMember(s.getAllMemberName()).getUniqueName())}},Vc.prototype.moveToNextRound=function(){this._currentLevel=0,this._prevLevel=-1,this._nextLevel=1},Vc.prototype._sortCubeNodes=function(t,e){return t.getLevel()==e.getLevel()?0:t.getLevel()<e.getLevel()?1:-1},Vc.prototype._allPropertyPresent=function(t){for(var e in t)if(-1<Ra.indexOf(this._allLevelNames,e))return!0;return!1},Vc.prototype.completeNodeBuilding=function(){this.rootNode=this._prevNodeAtLevel[0],this._closingNodesBelow=this._prevNodeAtLevel.reverse(),this._closingValues=this._prevValueAtLevel.reverse();for(var t=this._closingNodesBelow.length-1,e=this._closingNodesBelow.length,i=0;i<e;++i)if(!(1>t)){var s=this._closingNodesBelow[i];s[this._closingValues[i]]instanceof Ga&&s[this.allNodePropertyName]instanceof Ga&&-1==Ra.indexOf(this._nodesToClose,s)&&this._nodesToClose.push(s),--t}for(t=0;t<this._nodesToAggregate.length;++t)if(e=this._nodesToAggregate[t],!(2<e.numCells&&-1<Ra.indexOf(this._allLevelNames,this._valueToAggregate[t])))if(2==e.numCells&&e.hasOwnProperty(this.allNodePropertyName)){for(var r in e)if(r!=this.allNodePropertyName&&"numCells"!=r&&"_level"!=r&&"getLevel"!=r){e[this.allNodePropertyName]!=e[r]&&(e[this.allNodePropertyName]=e[r]);break}}else e=e[this.allNodePropertyName]instanceof Ga||Xa(e[this.allNodePropertyName])?e[this.allNodePropertyName]=new Lc:e[this.allNodePropertyName],this.aggregateAllValue(e,this._dataToAggregate[t],this._measureToAggregate[t]);for(this._nodesToClose.sort(this._sortCubeNodes),t=0;t<this._nodesToClose.length;t++)for(r in e=this._nodesToClose[t],i=this._allPropertyPresent(e),e)r!=this.allNodePropertyName&&(2<e.numCells&&-1<Ra.indexOf(this._allLevelNames,r)||(i&&3==e.numCells?e[this.allNodePropertyName]=e[r]:this._accumValuesFromNode(e[this.allNodePropertyName],e[r])));for(var n in this.rootNode)n==this.allNodePropertyName||"numCells"==n||"_level"==n||"getLevel"==n||2<this.rootNode.numCells&&-1<Ra.indexOf(this._allLevelNames,n)||this._accumValuesFromNode(this.rootNode[this.allNodePropertyName],this.rootNode[n]);for(var o in this._computeEndMap)for(e=this._computeEndMap2[o],i=e.getAggregator(),r=this._computeEndMap[o],t=0;t<r.length;t++)n=r[t],n[e.getName()]=i.computeEnd(n[e.getName()],e.getDataField());for(o in this._computeObjEndMap)for(e=this._computeEndMap2[o],i=e.getAggregator(),r=this._computeObjEndMap[o],t=0;t<r.length;t++)n=r[t],n[e.getName()]=i.computeObjectEnd(n[e.getName()],e.getDataField())},Vc.prototype.addValueToNodeBuilder=function(t,e){var i,s,r=this._prevNodeAtLevel[this._currentLevel],n=this._prevValueAtLevel[this._currentLevel];if(n&&n!=t){this._closingNodesBelow=this._prevNodeAtLevel.splice(this._nextLevel,this._prevNodeAtLevel.length).reverse(),this._closingValues=this._prevValueAtLevel.splice(this._nextLevel).reverse();for(var o=this._currentLevel+this._closingNodesBelow.length,a=0;a<this._closingNodesBelow.length;++a)i=this._closingValues[a],s=this._closingNodesBelow[a],s[i]instanceof Ga&&0!=o&&s[this.allNodePropertyName]instanceof Ga&&-1==Ra.indexOf(this._nodesToClose,s)&&this._nodesToClose.push(s),--o;s=r,s[n]instanceof Ga&&0!=this._currentLevel&&s[this.allNodePropertyName]instanceof Ga&&-1==Ra.indexOf(this._nodesToClose,s)&&this._nodesToClose.push(s)}if(n=this._allNodeAtLevel[this._currentLevel],r)r.hasOwnProperty(t)?this._prevNodeAtLevel[this._nextLevel]||r[t]instanceof Ga&&(this._prevNodeAtLevel[this._nextLevel]=r[t]):(this._prevNodeAtLevel.splice(this._nextLevel,this._prevNodeAtLevel.length),this._prevValueAtLevel.splice(this._nextLevel,this._prevValueAtLevel.length));else{var l=new Ga(this._currentLevel);l[this.allNodePropertyName]=new Ga(this._currentLevel+1),++l.numCells,0==this._currentLevel&&0==this._prevNodeAtLevel.length&&(this.rootNode=l),this._prevNodeAtLevel[this._currentLevel]=l,n||(0<this._currentLevel?(this._allNodeAtLevel[this._currentLevel]=n=new Ga(this._currentLevel+1),n[this.allNodePropertyName]={},this._allNodeAtLevel[this._prevLevel][this.allNodePropertyName]=n,++n.numCells):this._allNodeAtLevel[this._currentLevel]=l)}0<this._currentLevel&&(r=this._prevNodeAtLevel[this._prevLevel],r.hasOwnProperty(this._prevValueAtLevel[this._prevLevel])||(r[this._prevValueAtLevel[this._prevLevel]]=l,++r.numCells)),this._prevValueAtLevel[this._currentLevel]=t,++this._prevLevel,++this._currentLevel,++this._nextLevel},Vc.prototype.addMeasureValueToNode=function(t,e,i){var s=this._prevNodeAtLevel[this._currentLevel-1];s.hasOwnProperty(t)||(s[t]=new Lc,++s.numCells),this.aggregateAllValue(s[t],e,i),this._nodesToAggregate.push(s),this._dataToAggregate.push(e),this._measureToAggregate.push(i),this._valueToAggregate.push(t)},Vc.prototype._addValueToNode=function(t,e,i,s){var r;if(Xa(i))r=s.getAggregator(),t.hasOwnProperty(e)||(t[e]=r.computeBegin(e),this._computeEndMap[s].push(t)),r.computeLoop(t[e],e,i);else{var n;if(t.hasOwnProperty(e))for(o in i instanceof Lc&&!(t[e]instanceof Lc)?(r=!1,t.hasOwnProperty(e)||(r=!0),n=t[e]=new Lc,r&&++t.numCells):n=t[e],i)n.hasOwnProperty(o)?(s=this._measureMap[o],r=s.getAggregator(),r.computeObjectLoop(n[o],i[o])):(n instanceof Lc&&(s=this._measureMap[o]),s&&(r=s.getAggregator(),Xa(i[o])?(n[o]=r.computeBegin(o),r.computeLoop(n[o],o,i[o])):(n[o]=r.computeObjectBegin(i[o]),this._computeObjEndMap[s].push(n))));else{t[e]=n=new Lc,++t.numCells;for(var o in i)i instanceof Lc&&(s=this._measureMap[o]),s&&(r=s.getAggregator(),Xa(i[o])?(n[e]=r.computeBegin(o),this._computeEndMap[s].push(n),r.computeLoop(n[e],o,i[o])):n.hasOwnProperty(o)?r.computeObjectLoop(n[o],i[o]):(n[o]=r.computeObjectBegin(i[o]),this._computeObjEndMap[s].push(n)))}}},Vc.prototype._accumValuesFromNode=function(t,e){for(var i in e)if(i!=this.allNodePropertyName&&"numCells"!=i&&"_level"!=i&&"getLevel"!=i&&!(2<e.numCells&&-1<Ra.indexOf(this._allLevelNames,i))){var s=e[i];if(s instanceof Ga){var r;t[i]instanceof Ga?r=t[i]:(t[i]=r=new Ga(s.getLevel()),++t.numCells),this._accumValuesFromNode(r,s)}else this._addValueToNode(t,i,s,null)}if(1==t.numCells){for(i in t){t[this.allNodePropertyName]=t[i];break}++t.numCells}else if(2==t.numCells&&t.hasOwnProperty(this.allNodePropertyName)){for(i in t)if(i!=this.allNodePropertyName&&"numCells"!=i&&"_level"!=i&&"getLevel"!=i){t[this.allNodePropertyName]!=t[i]&&(t[this.allNodePropertyName]=t[i]);break}}else{var n,s=!1;for(i in t)if(i!=this.allNodePropertyName&&"numCells"!=i&&"_level"!=i&&"getLevel"!=i&&t[this.allNodePropertyName]==t[i]){if(s=t[i],s instanceof Ga)for(n in t[this.allNodePropertyName]=r=new Ga(s.getLevel()),this._accumValuesFromNode(r,s),t)n!=this.allNodePropertyName&&"numCells"!=n&&"_level"!=n&&"getLevel"!=n&&n!=i&&this._accumValuesFromNode(r,e[n]);else for(n in t[this.allNodePropertyName]=null,this._addValueToNode(t,this.allNodePropertyName,s,null),t)n!=this.allNodePropertyName&&"numCells"!=n&&"_level"!=n&&"getLevel"!=n&&n!=i&&this._addValueToNode(t,this.allNodePropertyName,t[n],null);s=!0;break}s||(i=this.allNodePropertyName,s=e[i],s instanceof Ga?(t[i]instanceof Ga?r=t[i]:(t[i]=r=new Ga(s.getLevel()),++t.numCells),this._accumValuesFromNode(r,s)):this._addValueToNode(t,i,s,null))}},Vc.prototype.aggregateAllValue=function(t,e,i){var s=i.getName(),r=i.getAggregator(),n="saved_"+s;t.hasOwnProperty(s)?t.hasOwnProperty(s)?r.computeObjectLoop(t[s],e[n]):Xa(e[n])?(t[n]=r.computeBegin(n),r.computeLoop(t[n],n,e[n])):(t[s]=r.computeObjectBegin(e[n]),this._computeObjEndMap[i].push(t)):i&&(t.hasOwnProperty(s)?r.computeObjectLoop(t[s],e[n]):(t[s]=r.computeObjectBegin(e[n]),this._computeObjEndMap[i].push(t)))},De.prototype=Error.prototype,Jd.prototype.computeBegin=function(t){var e={};return e[t]=0,e[t+"Count"]=0,e},Jd.prototype.computeLoop=function(t,e,i){var s;if(E(i))try{s=G.getProperty(i,e)}catch(r){}else s=i[e];t.hasOwnProperty(e)?(t[e]+=s,t[e+"Count"]+=1):(t[e]=s,t[e+"Count"]=1)},Jd.prototype.computeEnd=function(t,e){return t[e]/t[e+"Count"]},Jd.prototype.computeObjectBegin=function(t){var e,i={};for(e in t)i[e]=t[e];return i},Jd.prototype.computeObjectLoop=function(t,e){for(var i in e)t[i]+=e[i]},Jd.prototype.computeObjectEnd=function(t,e){return t[e]/t[e+"Count"]},Kd.prototype.computeBegin=function(t){var e={};return e[t]=[],e[t+"Counter"]=0,e},Kd.prototype.computeLoop=function(t,e,i){var s;if(E(i))try{s=G.getProperty(i,e),s=Number(s.toString())}catch(r){}else s=i[e];t.hasOwnProperty(e)?(t[e].push(s),t[e+"Counter"]+=1):(t[e]=[s],t[e+"Counter"]=1)},Kd.prototype.computeEnd=function(t,e){return t[e+"Counter"]},Kd.prototype.computeObjectBegin=function(t){var e,i={};for(e in t)i[e]=t[e];return i},Kd.prototype.computeObjectLoop=function(t,e){for(var i in e)ha(t[i])?t[i]=t[i].concat(e[i]):t[i]+=e[i]},Kd.prototype.computeObjectEnd=function(t,e){return t[e+"Counter"]},Ld.prototype.computeBegin=function(t){var e={};return e[t]=-Number.MAX_VALUE,e},Ld.prototype.computeLoop=function(t,e,i){var s;if(E(i))try{s=G.getProperty(i,e),s=Number(s.toString())}catch(r){}else s=i[e];t.hasOwnProperty(e)?t[e]=t[e]>s?t[e]:s:t[e]=s},Ld.prototype.computeEnd=function(t,e){return t[e]},Ld.prototype.computeObjectBegin=function(t){var e,i={};for(e in t)i[e]=t[e];return i},Ld.prototype.computeObjectLoop=function(t,e){for(var i in e)t[i]=t[i]>e[i]?t[i]:e[i]},Ld.prototype.computeObjectEnd=function(t,e){return t[e]},Md.prototype.computeBegin=function(t){var e={};return e[t]=Number.MAX_VALUE,e},Md.prototype.computeLoop=function(t,e,i){var s;if(E(i))try{s=G.getProperty(i,e),s=Number(s.toString())}catch(r){}else s=i[e];t.hasOwnProperty(e)?t[e]=t[e]<s?t[e]:s:t[e]=s},Md.prototype.computeEnd=function(t,e){return t[e]},Md.prototype.computeObjectBegin=function(t){var e,i={};for(e in t)i[e]=t[e];return i},Md.prototype.computeObjectLoop=function(t,e){for(var i in e)t[i]=t[i]<e[i]?t[i]:e[i]},Md.prototype.computeObjectEnd=function(t,e){return t[e]},xd.prototype.computeBegin=function(t){var e={};return e[t]=0,e},xd.prototype.computeLoop=function(t,e,i){var s;if(E(i))try{s=G.getProperty(i,e),s=Number(s.toString())}catch(r){}else s=i[e];t.hasOwnProperty(e)?t[e]+=s:t[e]=s},xd.prototype.computeEnd=function(t,e){return t[e]},xd.prototype.computeObjectBegin=function(t){var e,i={};for(e in t)i[e]=t[e];return i},xd.prototype.computeObjectLoop=function(t,e){for(var i in e)t[i]+=e[i]},xd.prototype.computeObjectEnd=function(t,e){return t[e]},z(qe,Pb),qe.prototype.updateDisplayList=function(t,e){qe._super.updateDisplayList.call(this,t,e);var i=this.getStyle("rollOverColor");i&&(this.setStyle("border","1px solid "+i),this.setStyle("backgroundColor",i))},z(Ne,Pb),z(re,Pb),re.prototype.updateDisplayList=function(t,e){re._super.updateDisplayList.call(this,t,e);var i=this.getStyle("headerColors"),s=this.getStyle("headerBorderTopColor"),n=this.getSizeStyle("headerBorderTopWidth"),o=this.getStyle("headerBorderBottomColor"),a=this.getSizeStyle("headerBorderBottomWidth");if(i)if(r.ie8L||r.ie9)this.setStyle("filter","progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='"+i[0]+"', EndColorStr='"+i[1]+"')");else{var l=r.getCssPrefix();this.setStyle("backgroundImage",l+"linear-gradient(top, "+i[0]+" 0%, "+i[0]+" 0%, "+i[1]+" 100%)"),this.setStyle("backgroundImage","linear-gradient(to bottom, "+i[0]+" 0%, "+i[0]+" 0%, "+i[1]+" 100%)")}s&&this.setStyle("borderTopColor",s),p(n)||this.setPxStyle("borderTopWidth",n),o&&this.setStyle("borderBottomColor",o),p(a)||this.setPxStyle("borderBottomWidth",a)},z(Oe,Pb),z(Pe,Pb);var l=function(){this.className=this.className?this.className:"DataGrid",jb.call(this),this._useDelayInvalidate=!0,this.alwaysShowErrorTip=this.allowDragSelection=!1,this.endEditOnBlur=this.draggableColumns=!0,this.errorInEditing=!1,this.headerItems=[],this.itemIcons=this.itemEditorInstance=void 0,this.lookAheadDuration=400,this.menuSelectionMode=!1,this.offscreenExtraColumns=this.offscreenExtraRows=0,this.selectable=this.resizableColumns=!0,this.showScrollTips=!1,this.sortableColumns=!0,this.dragSelectable=!1,this.pasteParseFunction=void 0,this.autoFitColumns=!0,this.headerDragEnabled=!1,this.parsingDate=this.filterInstance=void 0,this.copyWithAllColumns=this.copyWithHeader=!1,this.exportColumns=this.editingKeyMode=this.copyValueFunction=void 0,this.exportFileName="export.xlsx",this.exportFooter=void 0,this.exportFooterHeight=20,this.exportColumnFormat=this.exportOnlyData=!1,this.exportTitle=void 0,this.exportTitleHeight=50,this.exportType="xlsx",this.exportTxtSeperator=",",this.exportCodePage=949,this.useSameFreeItemRenderersTable=this.undoable=!1,this._iteratorValid=!0,this._visibleData={},this._listItems=[],this._rowInfo=[],this._rowMap={},this._freeItemRenderers=[],this._reservedItemRenderers={},this._unconstrainedRenderers={},this._dataItemWrappersByRenderer={},this._runningDataEffect=this._runDataEffectNextUpdate=!1,this._cachedDataChangeEffect=null,this._offscreenExtraColumnsRight=this._offscreenExtraColumnsLeft=this._offscreenExtraRowsBottom=this._offscreenExtraRowsTop=0,this._selectedData={},this._selectionIndicators={},this._showCaret=!1,this._itemsNeedMeasurement=!0,this._keySelectionPending=this._wordWrapChanged=this._rendererChanged=this._itemsSizeChanged=!1,this._columnMap={},this._freeItemRenderersTable={},this._bCtrlKey=this._bShiftKey=this._itemPending=!1,this._lastKey=0,this._bSelectItem=!1,this._headerRowInfo=[],this._itemRendererToFactoryMap={},this._dropColumnIndex=-1,this._measuringObjects={},this._orderedHeadersList=[],this._isKeyPressed=this._headerInfoInitialized=!1,this._visibleCellRenderers={},this._caretIndex=this._anchorIndex=this._anchorColumnIndex=this._caretColumnIndex=this._highlightColumnIndex=this._selectedColumnIndex=-1,this._defaultColumnCount=4,this._defaultRowCount=7,this._explicitRowCount=this._explicitColumnCount=-1,this._bColumnScrolling=!0,this._listType="vertical",this._isPressed=this._bSelectedIndexChanged=this._bSelectionChanged=this._bSelectOnRelease=!1,this._columnsInvalid=!0,this._cellSelectionData={},this._cellSelectionIndicators={},this._isOpening=this._columnGrouping=!1,this._cellsWaitingToBeDisplayed=!0,this._pendingCellSelection=new P([]),this._columnsToInfo={},this._DRAG_THRESHOLD=4,this._bSelectedIndicesChanged=this._bSelectedItemsChanged=this._bSelectedItemChanged=this._approximate=this._bSortItemPending=!1,this._cachedVerticalAlignInvalid=this._cachedPaddingBottomInvalid=this._cachedPaddingTopInvalid=!0,this._dragScrollingInterval=0,this._trackedRenderers=[],this._collectionUpdatesDisabled=this._inEndEdit=this._losingFocus=this._dontEdit=!1,this._lastSortIndex=this._sortIndex=-1,this._separatorAffordance=3,this._resizeCursorID="auto",this._manualSort=!1,this._headerIndex=-1,this._lookAheadCache="",this._originalExplicitHeaderHeight=this._headerWordWrapPresent=this._subContentScrolled=this._headerSepSkinChanged=this._headerBGSkinChanged=!1,this._originalHeaderHeight=0,this._isHeaderDragOutside=this._dropIndexFound=!1,this._rendererDescriptionMap={},this._selectedCellsChanged=!1,this._temporary_selectedCells=null,this._visualSortInfo={},this._designViewDataFlag=!1,this._lastColumnWidth=NaN,this._headerSelected=!0,this._headerDraggedOutside=this._lockedColumnCountChanged=!1,this._userMaxHorizontalScrollPosition=this._numSeparators=0,this._oldLength=-1,this._startEditingByKeyboardEvent=this._showFootersOffForced=this._showFootersChanged=this._footersChanged=this._bSelectedItemRemoved=!1,this._itemAttributes=[],this._oldCellStyles={},this._calledDrawVerticalSeparators=this._calledDrawHorizontalSeparators=this._calledSetItemVisible=this._needResetCellY=this._needRedrawSelection=!1,this._cellNumberFormatter=new jd,this._cellDateFormatter=new id,this._cellCurrencyFormatter=new ae,this._mouseY=this._mouseX=0,this._listContentDocumentFragment=document.createDocumentFragment(),this._listSubContentDocumentFragment=document.createDocumentFragment(),this._backgroundDocumentFragment=document.createDocumentFragment(),this._lastColumnWidthPolicy="balance",this._visualFilterInfo={},this._allowMultipleSelection=!1,this._columnCount=-1,this._columnCountChanged=!0,this._columns=[],this._columnWidthChanged=this._columnsChanged=!1,this._copyEnabled=!0,this._dataProviderChanged=!1,this._dataTipField="label",this._dropEnabled=this._dragMoveEnabled=this._dragEnabled=!1,this._editable="",this._headerWordWrap=this._bEditedItemPositionChanged=!1,this._iconField="icon",this._imeMode=null,this._labelField="label",this._lockedRowCount=this._lockedColumnCount=0,this._pasteEnabled=this._minColumnWidthInvalid=!1,this._rowCount=-1,this._rowCountChanged=!0,this._rowHeight=23,this._rowHeightChanged=!1,this._selectedIndex=-1,this._showDataTips=!1,this._showHeaders=!0,this._wordWrap=this._variableRowHeight=this._sortExpertMode=!1,this._selectionMode="singleRow",this._headerHeight=26,this._groupedColumnsChanged=this._explicitHeaderHeight=!1,this._selectedCells=[],this._groupRowHeight=-1,this._rendererProviders=[],this._hierarchicalCollectionView=new T,this._displayDisclosureIcon=!0,this._displayItemsExpanded=this._displayItemsExpandedChanged=!1,this._treeColumn=null,this._footersChanged=!1,this._showFooters=!0,this._showFootersOffForced=this._showFootersChanged=!1,this._touchEventsStack=[],this._changedData={},this._showDeletedRows=!1,this._itemRenderer=new kb(mb),this._headerRenderer=new kb(Wa),this._sortItemRenderer=new kb(ec),this._groupItemRenderer=new kb(Jc),this._explicitMinHeight=100,this.addEvent(r.firefox?"DOMMouseScroll":"mousewheel",this._mouseWheelHandler,this),this.element.tabIndex=0,this.element.unselectable="on",this.addEvent("keydown",this._keyDownHandler,this),r.firefox&&this.addEvent("compositionstart",this._keyDownHandler,this),this.addEvent("keyup",this._keyUpHandler,this),this.addEvent("mouseover",this._mouseOverHandler,this),this.addEvent("mousedown",this._mouseDownHandler,this),this.addEvent("mouseup",this._mouseUpHandler,this),this.addEvent("mouseout",this._mouseOutHandler,this),this.addEvent("mousemove",this._mouseMoveHandler,this),this.addEvent("mouseleave",this._mouseLeaveHandler,this),this.addEvent("click",this._mouseClickHandler,this),this.addEvent("dblclick",this._mouseDoubleClickHandler,this),r.supportTouch&&(this.addEvent("touchstart",this._touchHandler,this),this.addEvent("touchend",this._touchHandler,this),this.addEvent("touchmove",this._touchHandler,this),this.addEvent("touchcancel",this._touchHandler,this)),this.addEventListener(K.HEADER_RELEASE,this._headerReleaseHandler,this,!1,-50),this.addEventListener(K.SORT,this._sortHandler,this,!1,-50),this.addEventListener(K.ITEM_EDIT_BEGINNING,this._itemEditorItemEditBeginningHandler,this,!1,-50),this.addEventListener(K.ITEM_EDIT_BEGIN,this._itemEditorItemEditBeginHandler,this,!1,-50),this.addEventListener(K.ITEM_EDIT_END,this._itemEditorItemEditEndHandler,this,!1,-50),this.addEventListener(K.ITEM_OPENING,this._expandItemHandler,this,!1,-50),this.invalidateProperties()};l._IS_ITEM_STYLE={alternatingItemColors:1,backgroundColor:1,backgroundDisabledColor:1,color:1,rollOverColor:1,selectionColor:1,selectionDisabledColor:1,styleName:1,textRollOverColor:1,textSelectedColor:1},l._defaultStyles={alternatingItemColors:["#FFFFFF","#FFFFFF"],backgroundDisabledColor:"#F2F2F2",columnResizeSkin:Ne,deletedRowBackgroundColor:"#E0E0E0",disabledColor:"#AAAAAA",exportFooterAlign:"right",exportFooterColor:"#000000",exportFooterFontSize:10,exportTitleAlign:"center",exportTitleColor:"#000000",exportTitleFontSize:18,headerColors:["#FFFFFF","#FFFFFF"],headerBackgroundSkin:re,headerHorizontalSeparatorSkin:Oe,headerStyleName:"KoolGridHeaderStyles",headerSeparatorSkin:Pe,headerSeparatorColor:"#EAEAEA",headerHorizontalSeparatorColor:"#EAEAEA",headerPaddingTop:9,headerPaddingBottom:9,headerBorderTopColor:"#555555",headerBorderTopWidth:1,headerBorderBottomColor:"#999999",headerBorderBottomWidth:1,horizontalGridLines:!0,horizontalGridLineColor:"#DDDDDD",horizontalGridLineStyle:"solid",indentation:17,lockedLineColor:"#CCCCCC",lockedLineStyle:"double",openDuration:250,proposedColor:void 0,rollOverColor:"#EFF6FC",headerRollOverColor:"#F4F4F4",selectionColor:"#348FD6",selectionDisabledColor:"#DDDDDD",selectionDuration:250,textRollOverColor:"#31393F",textSelectedColor:"#EEEEEE",useRollOver:!0,verticalGridLines:!0,verticalGridLineColor:"#EAEAEA",verticalGridLineStyle:"solid",oldHeaderStyleName:void 0,paddingTop:7,paddingBottom:7,verticalAlign:"top",sortFontFamily:"Verdana",sortFontSize:10,sortFontStyle:"normal",sortFontWeight:"normal",disclosureOpenIcon:"DownArrow",disclosureClosedIcon:"Arrow",defaultLeafIcon:"leaf",folderOpenIcon:"FolderOpen",folderClosedIcon:"FolderClosed"},l._defaultProperty="dataProvider",l._propertyType={groupedColumns:Array,columns:Array,footers:Array},z(l,jb),l.prototype.setHorizontalScrollPolicy=function(t){l._super.setHorizontalScrollPolicy.call(this,t),this._columnsInvalid=this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getHorizontalScrollPosition=function(){return isNaN(this._horizontalScrollPositionPending)?l._super.getHorizontalScrollPosition.call(this):this._horizontalScrollPositionPending},l.prototype._setSuperSuperHorizontalScrollPosition=function(t){if(0!=this._listItems.length&&this.getDataProvider()&&O(this._horizontalScrollPositionPending)){this._horizontalScrollPositionPending=NaN;var e=l._super.getHorizontalScrollPosition.call(this);if(l._super.setHorizontalScrollPosition.call(this,t),this._removeClipMask(),e!=t){if(this._itemsSizeChanged)return;var e=t-e,i=0<e,e=Math.abs(e);this._bColumnScrolling&&e>=this.getColumnCount()-this._lockedColumnCount?(this._clearIndicators(),this._visibleData={},this._makeRowsAndColumnsWithExtraColumns(this._oldUnscaledWidth,this._oldUnscaledHeight),this._drawRowBackgrounds()):this._scrollHorizontally(t,e,i)}this._addClipMask(!1)}else this._horizontalScrollPositionPending=t,this.getDataProvider()&&this.invalidateDisplayList()},l.prototype._setSuperHorizontalScrollPosition=function(t){if(this._initialized&&0!=this._listItems.length){var e=this.getHorizontalScrollPosition();if(this._setSuperSuperHorizontalScrollPosition(t),this._columnsInvalid=!0,this._calculateColumnSizes(),!this._itemsSizeChanged&&e!=t){if(this._removeClipMask(),this._getOptimumColumns()==this._visibleColumns){this._visibleData={},this._scrollAreaChanged=!0;var i;this._iterator&&(i=this._iterator.getBookmark()),(t=this._getLines())&&((e=this._getLinesBody(t,"verticalLines"))&&e.setVisible(!1),(t=t.getChildByName("header"))&&t.setVisible(!1)),this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0),this._iterator&&i&&this._iterator.seek(i,0)}else this._subContentScrolled=!0;this._updateSubContent(),this._updateHeaderSearchList(),this._addClipMask(!1),this.invalidateDisplayList()}}else this._setSuperSuperHorizontalScrollPosition(t)},l.prototype.setHorizontalScrollPosition=function(t){var e=this._anchorColumnIndex,i=this._caretColumnIndex,s=this._selectedColumnIndex;this._isSpanCollectionView()&&l._super.getHorizontalScrollPosition.call(this)!=t&&this._spanColumns&&0<this._spanColumns.length?(this._needResetCellY&&this._resetCellY(),this._needRedrawSelection=!1,this._setSuperHorizontalScrollPosition(t),(this._needRedrawSelection||this._isRowSelectionMode())&&this._redrawSelection(),this._drawColumnBackgrounds()):this._setSuperHorizontalScrollPosition(t),this._anchorColumnIndex=e,this._caretColumnIndex=i,this._selectedColumnIndex=s,this._cellsWaitingToBeDisplayed&&this._processCellsWaitingToBeDisplayed()},l.prototype.setVerticalScrollPolicy=function(t){l._super.setVerticalScrollPolicy.call(this,t),this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getVerticalScrollPosition=function(){return isNaN(this._verticalScrollPositionPending)?l._super.getVerticalScrollPosition.call(this):this._verticalScrollPositionPending},l.prototype._setSuperVerticalScrollPosition=function(t){
if(0!=this._listItems.length&&this.getDataProvider()&&isNaN(this._verticalScrollPositionPending)){this._verticalScrollPositionPending=NaN;var e=l._super.getVerticalScrollPosition.call(this);l._super.setVerticalScrollPosition.call(this,t),this._removeClipMask();var i=this._offscreenExtraRowsTop,s=this._offscreenExtraRowsBottom;if(e!=t){var e=t-e,r=0<e,e=Math.abs(e);e>=this._rowInfo.length-this._lockedRowCount||!this._iteratorValid?(this._clearIndicators(),this._visibleData={},this._makeRowsAndColumnsWithExtraRows(this._oldUnscaledWidth,this._oldUnscaledHeight)):(this._scrollVertically(t,e,r),this._adjustListContent(this._oldUnscaledWidth,this._oldUnscaledHeight)),this._variableRowHeight&&this._configureScrollBars(),this._drawRowBackgrounds()}this._addClipMask(this._offscreenExtraRowsTop!=i||this._offscreenExtraRowsBottom!=s)}else this._verticalScrollPositionPending=t,this.getDataProvider()&&this.invalidateDisplayList()},l.prototype.setVerticalScrollPosition=function(t){var e=this._anchorColumnIndex,i=this._caretColumnIndex,s=this._selectedColumnIndex;this._calledDrawVerticalSeparators=this._calledDrawHorizontalSeparators=!1,l._super.getVerticalScrollPosition.call(this)!=t&&this._isSpanCollectionView()&&this._spanColumns&&0<this._spanColumns.length?(this._needResetCellY&&this._resetCellY(),this._calledSetItemVisible=this._needRedrawSelection=!1,this._setSuperVerticalScrollPosition(t),(this._needRedrawSelection||this._isRowSelectionMode())&&this._redrawSelection()):this._setSuperVerticalScrollPosition(t),this._drawColumnBackgrounds(),this._calledDrawHorizontalSeparators&&!this._variableRowHeight||this._drawHorizontalSeparators(),this._anchorColumnIndex=e,this._caretColumnIndex=i,this._selectedColumnIndex=s,this._calledDrawVerticalSeparators&&0==this._rendererProviders.length||this._drawVerticalSeparators(),this._variableRowHeight||-1==this._groupRowHeight||this._groupRowHeight==this._rowHeight||this._drawHorizontalSeparators(),this._cellsWaitingToBeDisplayed&&this._processCellsWaitingToBeDisplayed()},l.prototype.getAllowMultipleSelection=function(){return this._allowMultipleSelection},l.prototype.setAllowMultipleSelection=function(t){this._allowMultipleSelection=t},l.prototype.getChangedData=function(){return this._changedData},l.prototype.getColumnCount=function(){return this._columns?this._columns.length:0},l.prototype.setColumnCount=function(t){this._explicitColumnCount=t,this._columnCount!=t&&(this._setColumnCountInternal(t),this._columnCountChanged=!0,this.invalidateProperties(),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype._setColumnCountInternal=function(t){this._columnCount=t},l.prototype.getColumns=function(){return this._columns.slice(0)},l.prototype._setSuperColumns=function(t){var e,i;for(this._freeItemRenderersTable={},this._columnMap={},this._visualFilterInfo={},this._purgeHeaderRenderers(),e=this._columns.length,i=0;i<e;i++)this._columnRendererChanged(this._columns[i]);for(this._columns=t.slice(0),this._columnsInvalid=!0,e=t.length,i=0;i<e;i++)t=this._columns[i],t.owner=this,t.colNum=i;this._updateSortIndexAndDirection(),this._columnsChanged=this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.setColumns=function(t){this._columnsValue=t,this._columnsChanged=!0,this.invalidateProperties()},l.prototype.getColumnWidth=function(){return this._columnWidth},l.prototype.setColumnWidth=function(t){this._explicitColumnWidth=t,this._columnWidth!=t&&(this._setColumnWidthInternal(t),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype._setColumnWidthInternal=function(t){this._columnWidth=t},l.prototype.getCopyEnabled=function(){return this._copyEnabled},l.prototype.setCopyEnabled=function(t){this._copyEnabled=t},l.prototype.getDataProvider=function(){return this._actualCollection?this._actualCollection:this._collection},l.prototype._setSuperDataProvider=function(t){if(this.itemEditorInstance&&this._endEdit("other"),this._hideFilterInstance(),this._lastEditedItemPosition=null,this._collection&&this._collection.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),ha(t))this._collection=new P(t);else if(E(t))this._collection=new Hb(t);else if(t instanceof xb)this._collection=t;else if(t instanceof T)this._collection=t;else if(t instanceof la)this._collection=t;else{var e=[];null!=t&&e.push(t),this._collection=new P(e)}this._iterator&&this._iterator.removeListener(),this._iterator=this._collection.createCursor(!0),this._collectionIterator&&this._collectionIterator.removeListener(),this._collectionIterator=this._collection.createCursor(!0),this._collection.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),this._clearSelectionData(),this._clearSelectorColumnSelection(),this.resetChangedData(),t=new y(y.COLLECTION_CHANGE),t.kind="reset",this._collectionChangeHandler(t),this.dispatchEvent(t),this._itemsNeedMeasurement=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList()},l.prototype.setDataProvider=function(t){this.itemEditorInstance&&this._endEdit("other"),this._hideFilterInstance(),this._visualFilterInfo={},this._isCellSelectionMode()&&this._clearCellSelectionData(),this._rootModel&&this._rootModel.removeEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),t instanceof pb?this._rootModel=t:t instanceof T?(this._rootModel=t.getSource(),this._hierarchicalCollectionInstance=t):(this._hierarchicalCollectionInstance=this._rootModel=null,this._setSuperDataProvider(t)),this._rootModel&&this._rootModel.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this),this._dataProviderChanged=!0,this.invalidateProperties()},l.prototype.getDataTipField=function(){return this._dataTipField},l.prototype.setDataTipField=function(t){this._dataTipField=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getDataTipFunction=function(){return this._dataTipFunction},l.prototype.setDataTipFunction=function(t){this._dataTipFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getDragEnabled=function(){return this._dragEnabled},l.prototype.setDragEnabled=function(t){this._dragEnabled&&!t&&this.removeEvent("drop",this._dragCompleteHandler,this,!1),(this._dragEnabled=t)&&this.addEvent("drop",this._dragCompleteHandler,this,!1,-50)},l.prototype.getDragMoveEnabled=function(){return this._dragMoveEnabled},l.prototype.setDragMoveEnabled=function(t){this._dragMoveEnabled=t},l.prototype.getDropEnabled=function(){return this._dropEnabled},l.prototype.setDropEnabled=function(t){this._dropEnabled&&!t&&(this.removeEvent("dragenter",this._dragEnterHandler,this,!1),this.removeEvent("dragend",this._dragExitHandler,this,!1),this.removeEvent("dragover",this._dragOverHandler,this,!1),this.removeEvent("dropleave",this._dragDropHandler,this,!1)),(this._dropEnabled=t)&&(this.addEvent("dragenter",this._dragEnterHandler,this,!1,-50),this.addEvent("dragend",this._dragExitHandler,this,!1,-50),this.addEvent("dragover",this._dragOverHandle,this,!1,-50),this.addEvent("dropleave",this._dragDropHandler,this,!1,-50))},l.prototype.getEditable=function(){return this._editable},l.prototype.setEditable=function(t){if(this._editable="",t){F(t)||(t=t.toString()),t=t.split(" ");var e,i=t.length,s=!0;for(e=0;e<i&&s;e++)switch(t[e]){case"item":case"group":case"summary":this._editable+=t[e]+" ";break;case"true":this._editable="item ",s=!1;break;case"false":this._editable=" ",s=!1;break;case"all":this._editable="item group summary ",s=!1}this._editable=this._editable.slice(0,-1)}},l.prototype.getEditedItemPosition=function(){return this._editedItemPosition?{rowIndex:this._editedItemPosition.rowIndex,columnIndex:this._editedItemPosition.columnIndex}:this._editedItemPosition},l.prototype.setEditedItemPosition=function(t){t?this._setEditedItemPosition({rowIndex:t.rowIndex,columnIndex:t.columnIndex}):this._setEditedItemPosition(null)},l.prototype.getEditedItemRenderer=function(){return this.itemEditorInstance?this._listItems[this._actualRowIndex][this._actualColIndex]:null},l.prototype.getHeaderWordWrap=function(){return this._headerWordWrap},l.prototype.setHeaderWordWrap=function(t){t!=this._headerWordWrap&&(this._headerWordWrap=t,this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype.getIconField=function(){return this._iconField},l.prototype.setIconField=function(t){this._iconField=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getIconFunction=function(){return this._iconFunction},l.prototype.setIconFunction=function(t){this._iconFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getImeMode=function(){return this._imeMode},l.prototype.setImeMode=function(t){this._imeMode=t},l.prototype.getItemRenderer=function(){return this._itemRenderer},l.prototype.setItemRenderer=function(t){this._itemRenderer=t,this._rendererChanged=this._itemsSizeChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},l.prototype.getLabelField=function(){return this._labelField},l.prototype.setLabelField=function(t){this._labelField=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getLabelFunction=function(){return this._labelFunction},l.prototype.setLabelFunction=function(t){this._labelFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getLastColumnWidthPolicy=function(){return this._lastColumnWidthPolicy},l.prototype.setLastColumnWidthPolicy=function(t){this._lastColumnWidthPolicy=t,this._columnsInvalid=!0,this.invalidateDisplayList()},l.prototype.getLockedColumnCount=function(){return this._lockedColumnCount},l.prototype._setSuperLockedColumnCount=function(t){var e,i;if(t>this._lockedColumnCount)for(e=this._lockedColumnCount;e<t;e++)for(i=0;i<this._listItems.length;i++)this._listItems[i]&&this._listItems[i][e]&&delete this._columnMap[this._listItems[i][e].name];else if(t<this._lockedColumnCount)for(e=t;e<this._lockedColumnCount;e++)for(i=0;i<this._listItems.length;i++)this._listItems[i]&&this._listItems[i][e]&&delete this._columnMap[this._listItems[i][e].name];this._lockedColumnCount=t,this._updateSubContent(),this._columnsInvalid=this._itemsSizeChanged=!0,this.setHorizontalScrollPosition(l._super.getHorizontalScrollPosition.call(this)),this.invalidateDisplayList()},l.prototype.setLockedColumnCount=function(t){this._lockedColumnCountVal=t,this._lockedColumnCountChanged=!0,this.invalidateProperties()},l.prototype.getLockedRowCount=function(){return this._rootModel instanceof pb?0:this._lockedRowCount},l.prototype.setLockedRowCount=function(t){this._lockedRowCount=t,this.invalidateDisplayList()},l.prototype.getMinColumnWidth=function(){return this._minColumnWidth},l.prototype.setMinColumnWidth=function(t){this._minColumnWidth=Number(t),this._columnsInvalid=this._itemsSizeChanged=this._minColumnWidthInvalid=!0,this.invalidateDisplayList()},l.prototype.getPasteEnabled=function(){return this._pasteEnabled},l.prototype.setPasteEnabled=function(t){(this._pasteEnabled=t)?this.addEvent("paste",this._pasteHandler,this):this.removeEvent("paste",this._pasteHandler,this)},l.prototype.getRowCount=function(){return this._rowCount},l.prototype.setRowCount=function(t){this._explicitRowCount=t,this._rowCount!=t&&(this._setRowCountInternal(t),this._itemsSizeChanged=this._rowCountChanged=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},l.prototype._setRowCountInternal=function(t){this._rowCount=t},l.prototype.getRowHeight=function(){return this._rowHeight},l.prototype.setRowHeight=function(t){this._explicitRowHeight=t,this._rowHeight!=t&&(this._setRowHeightInternal(t),this.invalidateSize(),this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype._setRowHeightInternal=function(t){this._rowHeight=t},l.prototype.getSelectedIndex=function(){return this._selectedIndex},l.prototype.setSelectedIndex=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedIndex(t):(this._selectedIndex=t,this._bSelectedIndexChanged=this._bSelectionChanged=!0,this.invalidateDisplayList())},l.prototype.getSelectedIndices=function(){return this._bSelectedIndicesChanged?this._selectedIndices:this._copySelectedItems(!1)},l.prototype.setSelectedIndices=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedIndices(t):(this._selectedIndices=t,this._bSelectionChanged=this._bSelectedIndicesChanged=!0,this.invalidateDisplayList())},l.prototype.getSelectedItem=function(){return this._selectedItem},l.prototype.setSelectedItem=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedItem(t):(this._selectedItem=t,this._bSelectionChanged=this._bSelectedItemChanged=!0,this.invalidateDisplayList())},l.prototype.getSelectedItems=function(){return this._bSelectedItemsChanged?this._selectedItems:this._copySelectedItems()},l.prototype.setSelectedItems=function(t){this._collection&&0!=this._collection.getLength()?this._commitSelectedItems(t):(this._selectedItems=t,this._bSelectionChanged=this._bSelectedItemsChanged=!0,this.invalidateDisplayList())},l.prototype.getShowDataTips=function(){return this._showDataTips},l.prototype.setShowDataTips=function(t){this._showDataTips=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getShowHeaders=function(){return this._showHeaders},l.prototype.setShowHeaders=function(t){this._showHeaders=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype._getHeaderVisible=function(){return this.getShowHeaders()&&0<this.getHeaderHeight()},l.prototype.getSortItemRenderer=function(){return this._sortItemRenderer},l.prototype.setSortItemRenderer=function(t){this._sortItemRenderer=t,this._rendererChanged=this._itemsSizeChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},l.prototype.getSortExpertMode=function(){return this._sortExpertMode},l.prototype.setSortExpertMode=function(t){this._sortExpertMode=t,this._invalidateHeaders(),this.invalidateProperties(),this.invalidateDisplayList()},l.prototype.getVariableRowHeight=function(){return this._variableRowHeight},l.prototype.setVariableRowHeight=function(t){this._variableRowHeight=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getWordWrap=function(){return this._wordWrap},l.prototype.setWordWrap=function(t){t!=this._wordWrap&&(this._wordWrap=t,this._itemsSizeChanged=this._wordWrapChanged=!0,this.invalidateDisplayList())},l.prototype.getSelectionMode=function(){return this._selectionMode},l.prototype.setSelectionMode=function(t){this.setSelectionModeInternal(t),this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.setSelectionModeInternal=function(t){this._selectionMode!=t&&("none"==t?this.selectable=!1:this.selectable||(this.selectable=!0),"singleRow"==t||"singleCell"==t?this._allowMultipleSelection&&this.setAllowMultipleSelection(!1):"multipleRows"==t||"multipleCells"==t||"selectorColumn"==t?this._allowMultipleSelection||this.setAllowMultipleSelection(!0):"none"!=t&&(t="singleRow",this._allowMultipleSelection&&this.setAllowMultipleSelection(!1)),this._clearAllSelection(),this._selectionMode=t)},l.prototype.getHeaderHeight=function(){return this._headerHeight},l.prototype.setHeaderHeight=function(t){this._headerHeight=t,this._itemsSizeChanged=this._explicitHeaderHeight=!0,this.invalidateDisplayList()},l.prototype.getHeaderLabelFunction=function(){return this._headerLabelFunction},l.prototype.setHeaderLabelFunction=function(t){this._headerLabelFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getHeaderRenderer=function(){return this._headerRenderer},l.prototype.setHeaderRenderer=function(t){this._headerRenderer=t,this._rendererChanged=this._itemsSizeChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},l.prototype.getStyleFunction=function(){return this._styleFunction},l.prototype.setStyleFunction=function(t){this._styleFunction=t,this.invalidateDisplayList()},l.prototype.getGroupedColumns=function(){return this._groupedColumns},l.prototype.setGroupedColumns=function(t){if(this._validateGroupedColumns(t)){if(this._groupedColumns)for(var e=0;e<this._groupedColumns.length;e++)this._groupedColumns[e]instanceof fb&&this._columnGroupRendererChanged(this._groupedColumns[e]);this._groupedColumns=t,this._groupedColumnsChanged=!0,this.invalidateProperties()}},l.prototype.getSelectedCells=function(){return this._selectedCells?this._selectedCells.slice():null},l.prototype.setSelectedCells=function(t){this._clearSelectedCells(),this._temporary_selectedCells=t,this._clearPendingCells(),this._selectedCellsChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},l.prototype.getGroupIconFunction=function(){return this._groupIconFunction},l.prototype.setGroupIconFunction=function(t){this._groupIconFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getGroupItemRenderer=function(){return this._groupItemRenderer},l.prototype.setGroupItemRenderer=function(t){this._groupItemRenderer=t,this._rendererChanged=this._itemsSizeChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},l.prototype.getGroupLabelFunction=function(){return this._groupLabelFunction},l.prototype.setGroupLabelFunction=function(t){this._groupLabelFunction=t,this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.getGroupRowHeight=function(){return this._groupRowHeight},l.prototype.setGroupRowHeight=function(t){this._groupRowHeight=t,this._itemsSizeChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},l.prototype.getRendererProviders=function(){return this._rendererProviders},l.prototype.setRendererProviders=function(t){this._rendererProviders=t,this._rendererChanged=this._itemsSizeChanged=!0,this.invalidateSize(),this.invalidateDisplayList()},l.prototype.getFirstVisibleItem=function(){return this._listItems[0][0].getData()},l.prototype.setFirstVisibleItem=function(t){t=this._getItemIndex(t),0>t||this.setVerticalScrollPosition(Math.min(this.getMaxVerticalScrollPosition(),t))},l.prototype.getHierarchicalCollectionView=function(){return this._hierarchicalCollectionView},l.prototype.setHierarchicalCollectionView=function(t){this._hierarchicalCollectionView=t,this._dataProviderChanged=!0,this.invalidateProperties()},l.prototype.getDisplayDisclosureIcon=function(){return this._displayDisclosureIcon},l.prototype.setDisplayDisclosureIcon=function(t){t!=this._displayDisclosureIcon&&(this._displayDisclosureIcon=t,this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype.getDisplayItemsExpanded=function(){return this._displayItemsExpanded},l.prototype.setDisplayItemsExpanded=function(t){t!=this._displayItemsExpanded&&(this._displayItemsExpanded=t)&&(this._displayItemsExpandedChanged=!0,this.invalidateProperties())},l.prototype.getTreeColumn=function(){return this._treeColumn?this._treeColumn:null},l.prototype.setTreeColumn=function(t){t!=this._treeColumn&&(this._treeColumn=t,this._purgeItemRenderers(),this._freeItemRenderersTable={},this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype.getTreeColumnIndex=function(){return this._treeColumn?this._treeColumn.colNum:0},l.prototype.getSelectorColumn=function(){return this._selectorColumn?this._selectorColumn:null},l.prototype.setSelectorColumn=function(t){t instanceof Aa&&t!=this._selectorColumn&&(this._selectorColumn=t,this._itemsSizeChanged=!0,this.invalidateDisplayList())},l.prototype.getSelectorColumnIndex=function(){return this._selectorColumn?this._selectorColumn.colNum:this._columns[0]instanceof Aa?0:-1},l.prototype.getFooters=function(){return this._footers},l.prototype.setFooters=function(t){this._removeFooters(),this._footers=t,this._scrollAreaChanged=this._footersChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},l.prototype.getShowFooters=function(){return this._showFooters},l.prototype.setShowFooters=function(t){this._showFooters=t,this._showFootersChanged=!0,this._showFootersOffForced=!1,this._scrollAreaChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},l.prototype.getShowDeletedRows=function(){return this._showDeletedRows},l.prototype.setShowDeletedRows=function(t){this._showDeletedRows=t},l.prototype.setVisible=function(t){l._super.setVisible.call(this,t),t&&(p(this.element.offsetParent)||this.element.offsetParent===document.body||this.invalidateList())},l.resources={"ko-KR":{datagrid:{groupingPanelDrag:"     .",importTitle:"Load CSV File",importExcelTitle:"Load Excel File",msgKeepColumns:"    ?",msgNoDataToRead:"   .",importAlertTitle:"Import",rowCountLabelText:"  ",selectButtonLabel:"CSV  ",sheetSelectLabelText:"Import Sheet .",sheetSelectComboBoxOption:"",UTF8:"UTF-8",sortAscending:" ",sortDescending:" ",columnFiltering:" ",filterClearButtonLabel:"",filterOKButtonLabel:"",filterBooleanOperators:'[{"code":"T","label":""},{"code":"F","label":""}]',filterDateOperators:'[{"code":"=","label":""},{"code":"!=","label":" "},{"code":">","label":""},{"code":">=","label":"  "},{"code":"<","label":""},{"code":"<=","label":"  "},{"code":"contain","label":""}, {"code":"notcontain","label":" "},{"code":"startWith","label":" "},{"code":"endWith","label":" "}]',filterNumberOperators:'[{"code":"=","label":""},{"code":"!=","label":" "},{"code":">","label":" "},{"code":">=","label":" "},{"code":"<","label":" "},{"code":"<=","label":" "}]',filterStringOperators:'[{"code":"contain","label":""},{"code":"notcontain","label":" "},{"code":"=","label":""},{"code":"!=","label":" "},{"code":"startWith","label":" "},{"code":"endWith","label":" "}]',filterSelectAll:"( )",filterNull:"(  )",ariaEditable:"",ariaRowSelect:"",ariaSelectAll:"",invalidFileName:" .",invalidFileExtension:"{0}   ."}},"en-US":{datagrid:{groupingPanelDrag:"Drag a column header here to create a group.",importTitle:"Load CSV File",importExcelTitle:"Load Excel File",msgKeepColumns:"Do you want to keep the current column information?",msgNoDataToRead:"There is no data to read.",importAlertTitle:"Import",rowCountLabelText:"Number of header rows",selectButtonLabel:"Select CSV File",sheetSelectLabelText:"Select the sheet you want to import.",sheetSelectComboBoxOption:"Select",UTF8:"UTF-8",sortAscending:"Sort ascending",sortDescending:"Sort descending",columnFiltering:"Column filtering",filterClearButtonLabel:"Clear",filterOKButtonLabel:"Apply",filterBooleanOperators:'[{"code":"T","label":"On"},{"code":"F","label":"Off"}]',filterDateOperators:'[{"code":"=","label":"Equal to"},{"code":"!=","label":"Not equal to"},{"code":">","label":"After"},{"code":">=","label":"After or equal to"},{"code":"<","label":"Before"},{"code":"<=","label":"Before or equal to"},{"code":"contain","label":"Contains"}, {"code":"notcontain","label":"Does not contain"},{"code":"startWith","label":"Begins with"},{"code":"endWith","label":"Ends with"}]',filterNumberOperators:'[{"code":"=","label":"Equal to"},{"code":"!=","label":"Not equal to"},{"code":">","label":"Greater than"},{"code":">=","label":"Greater than or equal to"},{"code":"<","label":"Less than"},{"code":"<=","label":"Less than or equal to"}]',filterStringOperators:'[{"code":"contain","label":"Contains"},{"code":"notcontain","label":"Does not contain"},{"code":"=","label":"Equal to"},{"code":"!=","label":"Not equal to"},{"code":"startWith","label":"Begins with"},{"code":"endWith","label":"Ends with"}]',filterSelectAll:"(Select All)",filterNull:"(Blanks)",ariaEditable:"editable",ariaRowSelect:"Select row",ariaSelectAll:"Select All",invalidFileName:"Invalid file name.",invalidFileExtension:"You can upload only file in {0} format."}},"fr-FR":{datagrid:{groupingPanelDrag:"Dplacer len-tte de colonne pour crer un groupe.",importTitle:"Charger le fichier CSV",importExcelTitle:"Charger le fichier Excel",msgKeepColumns:"Voulez vous garder ces informations?",msgNoDataToRead:"Il ny a aucune donne  lire.",importAlertTitle:"Importer",rowCountLabelText:"Nombre den-tte",selectButtonLabel:"Slectionner un fichier CSV",sheetSelectLabelText:"Slectionnez la feuille  importer.",sheetSelectComboBoxOption:"Slectionner",UTF8:"UTF-8",sortAscending:"Trier par ordre croissant",sortDescending:"Trier par ordre dcroissant",columnFiltering:"le filtrage de la colonne",filterClearButtonLabel:"Effacer",filterOKButtonLabel:"Appliquer",filterBooleanOperators:'[{"code":"T","label":"Oui"},{"code":"F","label":"Non"}]',filterDateOperators:'[{"code":"=","label":"gal "},{"code":"!=","label":"Diffrent de"},{"code":">","label":"Aprs"},{"code":">=","label":"Aprs ou gal "},{"code":"<","label":"Avant"},{"code":"<=","label":"Avant ou gal "},{"code":"contain","label":"Contient"}, {"code":"notcontain","label":"Est-il pas contenir"},{"code":"startWith","label":"Commence par"},{"code":"endWith","label":"Se termine par"}]',filterNumberOperators:'[{"code":"=","label":"gal "},{"code":"!=","label":"Diffrent de"},{"code":">","label":"Suprieur "},{"code":">=","label":"Suprieur ou gal "},{"code":"<","label":"Infrieur "},{"code":"<=","label":"Infrieur ou gal "}]',filterStringOperators:'[{"code":"contain","label":"Contient"},{"code":"notcontain","label":"Est-il pas contenir"},{"code":"=","label":"gal "},{"code":"!=","label":"Diffrent de"},{"code":"startWith","label":"Commence par"},{"code":"endWith","label":"Se termine par"}]',filterSelectAll:"(Slectionner tout)",filterNull:"(Vides)",ariaEditable:"modifiable",ariaRowSelect:"Slectionnez la ligne",ariaSelectAll:"Tout slectionner",invalidFileName:"Nom de fichier non valide.",invalidFileExtension:"Vous pouvez tlcharger seul fichier au format {0}."}},"de-DE":{datagrid:{groupingPanelDrag:"Ziehen Sie den Spaltenkopf um eine Gruppe zu anlagen.",importTitle:"Laden Sie CSV Datei",importExcelTitle:"Laden Sie Excel Datei",msgKeepColumns:"Wollen Sie diese Informationen halten?",msgNoDataToRead:"Es liegen keine Daten zu lesen.",importAlertTitle:"Importieren",rowCountLabelText:"Anzahl der Kopfreihen",selectButtonLabel:"Whlen Sie eine CSV Datei",sheetSelectLabelText:"Whlen Sie das Blatt, das Sie importieren mchten.",sheetSelectComboBoxOption:"Whlen",UTF8:"UTF-8",sortAscending:"Aufsteigend sortieren",sortDescending:"Absteigend sortieren",columnFiltering:"Column-Filterung",filterClearButtonLabel:"Lschen",filterOKButtonLabel:"bernehmen",filterBooleanOperators:'[{"code":"T","label":"Ein"},{"code":"F","label":"Aus"}]',filterDateOperators:'[{"code":"=","label":"Gleich"},{"code":"!=","label":"Ungleich"},{"code":">","label":"Nach"},{"code":">=","label":"Nach oder gleich"},{"code":"<","label":"Vor"},{"code":"<=","label":"Vor oder gleich"},{"code":"contain","label":"Enthlt"}, {"code":"notcontain","label":"Ist nicht enthalten"},{"code":"startWith","label":"Beginnt mit"},{"code":"endWith","label":"Endet mit"}]',filterNumberOperators:'[{"code":"=","label":"Gleich"},{"code":"!=","label":"Ungleich"},{"code":">","label":"Grer als"},{"code":">=","label":"Grer oder gleich"},{"code":"<","label":"Kleiner als"},{"code":"<=","label":"Kleiner oder gleich"}]',filterStringOperators:'[{"code":"contain","label":"Enthlt"},{"code":"notcontain","label":"Ist nicht enthalten"},{"code":"=","label":"Gleich"},{"code":"!=","label":"Ungleich"},{"code":"startWith","label":"Beginnt mit"},{"code":"endWith","label":"Endet mit"}]',filterSelectAll:"(Alles auswhlen)",filterNull:"(Leere)",ariaEditable:"editierbare",ariaRowSelect:"Whlen Sie die Zeile",ariaSelectAll:"Alle auswhlen",invalidFileName:"Ungltiger Dateiname.",invalidFileExtension:"Sie knnen nur Dateien im {0}-Format hochladen."}},"zh-CN":{datagrid:{groupingPanelDrag:"",importTitle:"CSV",importExcelTitle:"Excel",msgKeepColumns:"",msgNoDataToRead:"",importAlertTitle:"Import",rowCountLabelText:"",selectButtonLabel:"CSV",sheetSelectLabelText:"",sheetSelectComboBoxOption:"",UTF8:"UTF-8",sortAscending:"",sortDescending:"",columnFiltering:"",filterClearButtonLabel:"",filterOKButtonLabel:"",filterBooleanOperators:'[{"code":"T","label":""},{"code":"F","label":""}]',filterDateOperators:'[{"code":"=","label":""},{"code":"!=","label":""},{"code":">","label":""},{"code":">=","label":""},{"code":"<","label":""},{"code":"<=","label":""},{"code":"contain","label":""}, {"code":"notcontain","label":""},{"code":"startWith","label":""},{"code":"endWith","label":""}]',filterNumberOperators:'[{"code":"=","label":""},{"code":"!=","label":""},{"code":">","label":""},{"code":">=","label":""},{"code":"<","label":""},{"code":"<=","label":""}]',filterStringOperators:'[{"code":"contain","label":""},{"code":"notcontain","label":""},{"code":"=","label":""},{"code":"!=","label":""},{"code":"startWith","label":""},{"code":"endWith","label":""}]',filterSelectAll:"()",filterNull:"()",ariaEditable:"",ariaRowSelect:"",ariaSelectAll:"",invalidFileName:"",invalidFileExtension:"{0}"}}},B.addResourceBundle("datagrid",l.resources["ko-KR"].datagrid,"ko-KR"),B.addResourceBundle("datagrid",l.resources["en-US"].datagrid,"en-US"),B.addResourceBundle("datagrid",l.resources["fr-FR"].datagrid,"fr-FR"),B.addResourceBundle("datagrid",l.resources["de-DE"].datagrid,"de-DE"),B.addResourceBundle("datagrid",l.resources["zh-CN"].datagrid,"zh-CN");var Xe=function(){this.type=0,this.oCno=this.oRno=-1,this.vi=this.hl=this.vl=!0};l.prototype._scrollHandler=function(t){t.target.selfElement!=this._verticalScrollBar&&t.target.selfElement!=this._horizontalScrollBar||"scroll"!=t.type||!this.liveScrolling&&t.detail||(this.itemEditorInstance&&this._endEdit("other"),this._hideFilterInstance(),t.currentTarget.selfElement==this._verticalScrollBar?this.setVerticalScrollPosition(t.position):t.currentTarget.selfElement==this._horizontalScrollBar&&this.setHorizontalScrollPosition(t.position),l._super._scrollHandler.call(this,t))},l.prototype._mouseOutHandler=function(t){var e,i,s;if(this.getEnabled()&&this.selectable&&!(this._isPressed&&(t.relatedTarget&&t.relatedTarget.selfElement&&"DataGridBackground"===t.relatedTarget.selfElement.className||t.fromElement&&t.fromElement.selfElement&&"DataGridBackground"===t.fromElement.selfElement.className)||this._tween)&&(this._sortExpertMode||(e=this._mouseEventToItemRenderer(t))&&e instanceof qa&&this._isHeaderItemRenderer(e)&&(i=e.getListData().columnIndex,delete this._visualSortInfo[i],delete this._visualSortInfo["HEADERPART"+i],this._invalidateRenderer(e)),!this._movingColumn)){s=this._getOptimumColumns();var r;if(this._getHeaderVisible()&&this._listItems.length){if(e=e?e:this._mouseEventToItemRenderer(t),!e)for(r=s.length,i=0;i<r;i++)s[i].colNum==this._sortIndex&&(e=this._getHeaderInfo(s[i]).headerItem);for(r=this._orderedHeadersList.length,i=0;i<r&&e;i++)if(s=this._orderedHeadersList[i].headerItem,s==e)return void((e=this._selectionLayer.getChildByName("headerSelection"))&&this._selectionLayer.removeChild(e))}if(this._lastItemDown=(this._isPressed=1===v.getButtonDown(t,this._isPressed))?e:null,e&&!this._isPressed&&this._highlightUID&&this._highlightItemRenderer){if(t.relatedTarget&&t.relatedTarget.selfElement&&(t=t.relatedTarget.selfElement,t==this._listContent&&t!=this._highlightIndicator))return;this.getStyle("useRollOver")&&e.getData()&&(e!=this._highlightItemRenderer&&this._highlightItemRenderer.getData()&&this._clearHighlight(this._highlightItemRenderer),this._clearHighlight(e))}}},l.prototype._mouseDownHandler=function(t){if(!v.isRightButtonDown(t)){var e,i=this;if(!(t.target.selfElement&&t.target.selfElement instanceof Ta)){if(e=i._mouseEventToItemRenderer(t),i._isPressed=!0,i._getOptimumColumns(),i.getEnabled()&&(i.sortableColumns||i.draggableColumns)&&i._getHeaderVisible()&&i._hasHeaderItemsCreated()){var s,r,n,o=i._orderedHeadersList.length;for(s=0;s<o&&e;s++)if(n=i._orderedHeadersList[s].headerItem,
n==e){if(o=i._orderedHeadersList[s],i.itemEditorInstance&&i._endEdit("blur"),i._hideFilterInstance(),r=i._orderedHeadersList[s].column,r.filterable&&(i._lastItemDown=e),i.sortableColumns&&r.sortable){i._lastItemDown=e,t=i._selectionLayer.getChildByName("headerSelection"),t||(t=new A("div","DataGridBackground"),t.name="headerSelection",i._selectionLayer.addChild(t)),s=e.getHeight()+i._cachedHeaderPaddingBottom+i._cachedHeaderPaddingTop-i.getSizeStyle("headerBorderBottomWidth"),n=e.getExplicitOrMeasuredWidth();var a=e.getX(),l=e.getY()-i._cachedHeaderPaddingTop;o.actualColNum>=i._lockedColumnCount&&(a=i._getAdjustedXPos(e.getX()),0<i.getHorizontalScrollPosition()&&o.actualColNum-i.getHorizontalScrollPosition()<i._lockedColumnCount&&(e=0,e=0<i._lockedColumnCount?i.getHeaderInfo(i._columns[i._lockedColumnCount-1]).headerItem.getX()+i._columns[i._lockedColumnCount-1].getWidth():0,n-=e-a,a=e)),1>l&&(l+=i.getSizeStyle("headerBorderTopWidth"),s-=i.getSizeStyle("headerBorderTopWidth")),t.setStyle("backgroundColor",i.getStyle("selectionColor")),t.setWidthInline(n),t.setHeightInline(s),t.setX(a),t.setY(l)}return void(i.draggableColumns&&i._isDraggingAllowed(r)&&(i._startX=NaN,v.documentAddEvent("mousemove",i._columnDraggingMouseMoveHandler,i),v.documentAddEvent("mouseup",i._columnDraggingMouseUpHandler,i),v.documentAddEvent("selectstart",i._documentSelectStartHandler,i),i._movingColumn=r))}}if(i._lastItemDown=null,i.itemRendererContains(i.itemEditorInstance,t.target.selfElement||t.target.selfUIElement))i._resetDragScrolling();else{if(e&&e.getData()){if(i._lastItemDown=e,r=i._itemRendererToIndices(e),o=!0,i.itemEditorInstance&&(o=null==r?i._endEdit("blur"):i._endEdit(i._editedItemPosition.rowIndex==r.y?"newColumn":"newRow")),i._hideFilterInstance(),!o)return}else i.itemEditorInstance&&i._endEdit("blur");-1!=i._headerIndex&&(o=i._itemRendererToIndices(e))&&(i._unselectColumnHeader(i._headerIndex,!0),i._headerIndex=-1,i._caretIndex=o.y),i.getEnabled()&&i.selectable&&e&&(i._bSelectOnRelease=!1,o=v.getEventPageXY(t),i._mouseDownPoint=i.globalToLocal(o),v.documentAddEvent("mouseup",i._mouseUpHandler,i),v.documentAddEvent("selectstart",i._documentSelectStartHandler,i),i.dragSelectable&&(i._dragScrollingInterval=setInterval(function(){i._dragScroll()},15)),i.getDragEnabled()&&i._selectedData[i._rowMap[e.name].uid]?i._bSelectOnRelease=!0:i._selectItem(e,t.shiftKey,t.ctrlKey)&&(i._mouseDownItem=e)),e&&r&&i._displayableColumns[r.x].rendererIsEditor&&i._resetDragScrolling()}i._updateSelectedCells(),i.dragSelectable&&e&&e instanceof qa&&!i._isHeaderItemRenderer(e)&&("multipleRows"==i._selectionMode||"multipleCells"==i._selectionMode)&&(i._dragSelectedItemRenderer=e,v.documentAddEvent("mousemove",i._mouseMoveHandler,i))}}},l.prototype._mouseLeaveHandler=function(t){this._mouseIsUp(),this._isPressed=!1},l.prototype._mouseUpHandler=function(t){if(!v.isRightButtonDown(t)){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;if(this._isPressed=!1,this._mouseIsUp(),!(t.target.selfElement&&t.target.selfElement instanceof Ta||this._tween||(this.dragSelectable&&(this._dragSelectedItemRenderer=null,v.documentRemoveEvent("mousemove",this._mouseMoveHandler,this)),!this._collection||this.itemEditorInstance&&!this.endEditOnBlur&&this.errorInEditing))){var i,s;if((i=this._mouseEventToItemRenderer(t))&&i instanceof qa&&e instanceof Ua&&this.getEnabled()&&this._getHeaderVisible()&&this._hasHeaderItemsCreated()&&this._isHeaderItemRenderer(i)&&(s=this._columns[i.getListData().columnIndex])&&s.filterable&&this._lastItemDown==i)return this._lastItemDown=null,e=new K(K.HEADER_RELEASE,(!1),(!0)),-1==s.colNum||isNaN(s.colNum)?e.columnIndex=-1:e.columnIndex=s.colNum,e.dataField=s.getDataField(),e.itemRenderer=i,e.triggerEvent=t,U(i.mouseEventToHeaderPart)&&(e.headerPart=i.mouseEventToHeaderPart(t)),void this.dispatchEvent(e);if(this._collection.getLength()){if(this.getEnabled()&&(this.sortableColumns||this.draggableColumns)&&this._collection&&this._getHeaderVisible()&&this._hasHeaderItemsCreated())for(e=this._orderedHeadersList.length,s=0;s<e;s++)if(i==this._orderedHeadersList[s].headerItem&&i)return s=this._orderedHeadersList[s].column,void(this.sortableColumns&&s.sortable&&this._lastItemDown==i&&(this._lastItemDown=null,e=new K(K.HEADER_RELEASE,(!1),(!0)),-1==s.colNum||isNaN(s.colNum)?e.columnIndex=-1:e.columnIndex=s.colNum,e.dataField=s.getDataField(),e.itemRenderer=i,e.triggerEvent=t,U(i.mouseEventToHeaderPart)&&(e.headerPart=i.mouseEventToHeaderPart(t)),this.dispatchEvent(e)));if(!this._movingColumn){if(this._mouseDownPoint=null,s=this._itemRendererToIndices(i),this.getEnabled()&&this.selectable&&(this._mouseDownItem&&(e=new L(L.CHANGE),e.itemRenderer=this._mouseDownItem,(s=this._itemRendererToIndices(this._mouseDownItem))&&(e.columnIndex=s.x,e.rowIndex=s.y),this.dispatchEvent(e),this._mouseDownItem=null),i&&this.hitTestPoint(t.pageX,t.pageY)&&this._bSelectOnRelease&&(this._bSelectOnRelease=!1,this._selectItem(i,t.shiftKey,t.ctrlKey)&&(e=new L(L.CHANGE),e.itemRenderer=i,s&&(e.columnIndex=s.x,e.rowIndex=s.y),this.dispatchEvent(e)))),this._editable.length&&i&&i.getData()&&i!=this.itemEditorInstance&&(!i.getVisible()||(e=this._getRowAttribute(i.getData()))&&!e.editable||!this._isDataEditable(i.getData())||this._doubleClickEnabled&&"dblclick"!=t.type&&"touchend"!=t.type&&!this._isHeaderItemRenderer(i)))return;i&&i.getData()&&i!=this.itemEditorInstance&&this._lastItemDown==i&&i.getVisible()&&this._isDataEditable(i.getData())?(t=this._itemRendererToIndices(i))&&0<=t.y&&this._displayableColumns[t.x].editable&&!this._dontEdit&&(e=new K(K.ITEM_EDIT_BEGINNING,(!1),(!0)),e.columnIndex=this._displayableColumns[t.x].colNum,e.dataField=this._displayableColumns[t.x].getDataField(),e.rowIndex=t.y,e.itemRenderer=i,this.dispatchEvent(e)):this._lastItemDown&&this._lastItemDown!=this.itemEditorInstance&&(t=this._itemRendererToIndices(this._lastItemDown))&&0<=t.y&&this.getEditable()&&!this._dontEdit&&(this._displayableColumns[t.x].editable?(e=new K(K.ITEM_EDIT_BEGINNING,(!1),(!0)),e.columnIndex=this._displayableColumns[t.x].colNum,e.dataField=this._displayableColumns[t.x].getDataField(),e.rowIndex=t.y,e.itemRenderer=this._lastItemDown,this.dispatchEvent(e)):this._lastEditedItemPosition={columnIndex:t.x,rowIndex:t.y}),this._lastItemDown=null}}}}},l.prototype._mouseMoveHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null,i=this.globalToLocal(v.getEventPageXY(t));this._mouseX=i.x,this._mouseY=i.y,t.target.selfElement&&t.target.selfElement instanceof Ta||!this.getEnabled()||!this.selectable||(this._isPressed=1===v.getButtonDown(t,this._isPressed),e&&(i=v.getEventPageXY(t),i=e.localToGlobal(i),i=this.globalToLocal(i),this._isPressed&&this._mouseDownPoint&&(Math.abs(this._mouseDownPoint.x-i.x)>this._DRAG_THRESHOLD||Math.abs(this._mouseDownPoint.y-i.y)>this._DRAG_THRESHOLD)&&this.getDragEnabled()&&!Lb.isDragging&&this._mouseDownPoint&&(e=new DragEvent(DragEvent.DRAG_START),e.dragInitiator=this,e.localX=this._mouseDownPoint.x,e.localY=this._mouseDownPoint.y,e.which=1,this._dragStartHandler(e))),(e=this._mouseEventToItemRenderer(t))&&this._highlightItemRenderer?(i=this._rowMap[e.name],this._highlightItemRenderer&&this._highlightUID&&i&&i.uid!=this._highlightUID&&(this._isPressed||this.getStyle("useRollOver")&&this._highlightItemRenderer.getData()&&this._clearHighlight(this._highlightItemRenderer))):!e&&this._highlightItemRenderer&&(this._isPressed||this.getStyle("useRollOver")&&this._highlightItemRenderer.getData()&&this._clearHighlight(this._highlightItemRenderer)),e&&!this._highlightItemRenderer&&(r.supportTouch&&r.Platform.ios||this._mouseOverHandler(t)),this.dragSelectable&&this._isPressed&&t.currentTarget==document&&("multipleRows"==this._selectionMode||"multipleCells"==this._selectionMode)&&this._dragSelectedItemRenderer&&e&&e!=this._dragSelectedItemRenderer&&(this._isCellSelectionMode()?this._selectCellItem(e,!0,!1)&&(this._mouseDownItem=e):this._selectItem(e,!0,!1)&&(this._mouseDownItem=e),this._dragSelectedItemRenderer=e))},l.prototype._mouseOverHandler=function(t){var e=t.target.selfElement;if(!(e&&e instanceof Ta||this._tween||this._movingColumn)&&this.getEnabled()&&this.selectable){var i,e=this._mouseEventToItemRenderer(t);if(!this._sortExpertMode){var s;if(e?s=e:this._visualSortInfo={},s&&s.getListData()&&(i=s.getListData().columnIndex),s&&this._isHeaderItemRenderer(e)&&this.sortableColumns&&-1!=i&&this._columns[i].sortable&&U(e.mouseEventToHeaderPart)&&(s=e.mouseEventToHeaderPart(t),!this._visualSortInfo[i]||this._visualSortInfo["HEADERPART"+i]!=s))if("headerTextPart"==s)this._visualSortInfo[i]=new Zc(1,(!1),Zc.PROPOSEDSORT),this._invalidateRenderer(e),this._visualSortInfo["HEADERPART"+i]=s;else if("headerIconPart"==s){var n,o;(o=this.getFieldSortInfo(this._columns[i]))?(n=o.sequenceNumber,o=o.descending):(n=this._collection&&this._collection.getSort()&&this._collection.getSort().getFields()&&this._collection.getSort().getFields().length?this._collection.getSort().getFields().length+1:1,o=!1),this._visualSortInfo[i]=new Zc(n,o,Zc.PROPOSEDSORT),this._invalidateRenderer(e),this._visualSortInfo["HEADERPART"+i]=s}}if(e&&!this._isHeaderItemRenderer(e)&&this._isCellSelectionMode()){if(i=this._itemRendererToIndices(e)){this._isPressed=1===v.getButtonDown(t,this._isPressed);var a=this._displayToAbsoluteColumnIndex(i.x);!this._isPressed||this.allowDragSelection?this.getStyle("useRollOver")&&null!=e.getData()&&(this.allowDragSelection&&(this._bSelectOnRelease=!0),s=this._itemToUID(e.getData()),this._visibleCellRenderers[s]&&(r.supportTouch&&r.Platform.ios||this._drawCellItem(this._visibleCellRenderers[s][a.toString()],this._cellSelectionData[s]&&this._cellSelectionData[s][a.toString()],!0,s==this._caretUID&&a==this._caretColumnIndex)),i&&(t=new L(L.ITEM_ROLL_OVER),t.columnIndex=i.x,t.rowIndex=i.y,t.itemRenderer=e,this.dispatchEvent(t))):!Lb.isDragging&&(this.allowDragSelection||this._menuSelectionMode)&&this._selectCellItem(e,t.shiftKey,t.ctrlKey)&&(t=new L(L.CHANGE),t.itemRenderer=e,i&&(t.columnIndex=i.x,t.rowIndex=i.y),this.dispatchEvent(t))}}else{if(this.getEnabled()&&this._getHeaderVisible()&&this._getNumColumns()&&!this._isPressed)for(i=this._orderedHeadersList.length,n=0;n<i&&e;n++)if(s=this._orderedHeadersList[n].headerItem,s==e)return o=this._orderedHeadersList[n],t=this._selectionLayer.getChildByName("headerSelection"),t||(t=new A("div","DataGridBackground"),t.name="headerSelection",this._selectionLayer.addChild(t)),a=e.getHeight()+this._cachedHeaderPaddingBottom+this._cachedHeaderPaddingTop-this.getSizeStyle("headerBorderBottomWidth"),i=e.getExplicitOrMeasuredWidth(),s=e.getX(),n=e.getY()-this._cachedHeaderPaddingTop,o.actualColNum>=this._lockedColumnCount&&(s=this._getAdjustedXPos(e.getX()),0<this.getHorizontalScrollPosition()&&o.actualColNum-this.getHorizontalScrollPosition()<this._lockedColumnCount&&(e=0<this._lockedColumnCount?this._getHeaderInfo(this._columns[this._lockedColumnCount-1]).headerItem.getX()+this._columns[this._lockedColumnCount-1].getWidth():0,i-=e-s,s=e)),1>n&&(n+=this.getSizeStyle("headerBorderTopWidth"),a-=this.getSizeStyle("headerBorderTopWidth")),t.setStyle("backgroundColor",this.getStyle("headerRollOverColor")),t.setWidthInline(i),t.setHeightInline(a),t.setX(s),void t.setY(n);if(this._lastItemDown=(this._isPressed=1===v.getButtonDown(t,this._isPressed))?e:null,0==this._dragScrollingInterval||this._isPressed||this._mouseIsUp(),i=this._itemRendererToIndices(e),e)if(s=this._itemToUID(e.getData()),!this._isPressed||this.allowDragSelection){if(t.relatedObject&&(this._lastHighlightItemRenderer&&this._highlightUID&&(a=this._rowData.uid),this.itemRendererContains(e,t.relatedObject)||s==a||t.relatedObject==this._highlightIndicator))return;this.getStyle("useRollOver")&&e.getData()&&(this.allowDragSelection&&(this._bSelectOnRelease=!0),r.supportTouch&&r.Platform.ios||this._drawItem(this._visibleData[e.getListData().uid],this.isItemSelected(e.getListData().item),!0,e.getListData().uid==this._caretUID),i&&(t=new L(L.ITEM_ROLL_OVER),t.columnIndex=i.x,t.rowIndex=i.y,t.itemRenderer=e,this.dispatchEvent(t),this._lastHighlightItemIndices=i,this._lastHighlightItemRendererAtIndices=e))}else!Lb.isDragging&&(0!=this._dragScrollingInterval&&this.allowDragSelection||this._menuSelectionMode)&&this._selectItem(e,t.shiftKey,t.ctrlKey)&&(t=new L(L.CHANGE),t.itemRenderer=e,i&&(t.columnIndex=i.x,t.rowIndex=i.y),this.dispatchEvent(t))}}},l.prototype._mouseLeaveHandler=function(t){this._highlightItemRenderer&&this._clearHighlight(this._highlightItemRenderer)},l.prototype._mouseClickHandler=function(t){if(!this._tween&&!this._resizeGraphic){var e=this._mouseEventToItemRenderer(t);if(e){if(this._isHeaderItemRenderer(e)){var i=new K(K.HEADER_CLICK),s=e.getListData();i.columnIndex=s.columnIndex,i.rowIndex=s.rowIndex,i.column=s.item,i.item=s.label,i.dataField=s.dataField,i.itemRenderer=e,i.htmlEvent=t,this.dispatchEvent(i)}(i=this._itemRendererToIndices(e))&&(s=new L(L.ITEM_CLICK),s.columnIndex=i.x,s.rowIndex=i.y,s.itemRenderer=e,s.htmlEvent=t,this.dispatchEvent(s)),e instanceof Wb&&(i=new K(K.FOOTER_CLICK),s=e.getListData(),i.columnIndex=s.columnIndex,i.rowIndex=Ra.indexOf(this._footers,s.owner),i.column=e.getStyleName(),i.item=s.label,i.itemRenderer=e,i.htmlEvent=t,this.dispatchEvent(i))}}},l.prototype._mouseDoubleClickHandler=function(t){if(this._doubleClickEnabled&&!this._tween){var e=this._mouseEventToItemRenderer(t);if(e){var i=this._itemRendererToIndices(e);if(i){var s=new L(L.ITEM_DOUBLE_CLICK);s.columnIndex=i.x,s.rowIndex=i.y,s.itemRenderer=e,this.dispatchEvent(s)}this._editable.length&&(this._isHeaderItemRenderer(e)||this._mouseUpHandler(t))}}},l.prototype._mouseWheelHandler=function(t){if(!this._tween){if(this.itemEditorInstance){if(this.itemEditorInstance instanceof Oa)return;this._endEdit("other")}this._hideFilterInstance(),this._contextMenu&&this._contextMenuDocumentMouseDownHandler(t);var e;if(I(t.wheelDeltaX)||0==t.wheelDeltaX)this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(I(t.wheelDelta)?I(t.detail)||(e=-t.detail):(e=t.wheelDelta/120,e=0<=e?Math.ceil(e):Math.floor(e)),0<e?e=Math.min(e,Math.max(this._rowCount-1,1)):0>e&&(e=Math.max(e,-1*Math.max(this._rowCount-1,1))),i=this.getVerticalScrollPosition(),e=i-e*this._verticalScrollBar.lineScrollSize,e=Math.max(0,Math.min(e,this._verticalScrollBar.getMaxScrollPosition())),this.setVerticalScrollPosition(e),i!=this.getVerticalScrollPosition()&&(t.stopPropagation(),t.preventDefault(),t=new ma(ma.SCROLL),t.detail=!1,t.direction="vertical",t.position=this.getVerticalScrollPosition(),t.delta=this.getVerticalScrollPosition()-i,this.dispatchEvent(t)));else if(this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()){e=t.wheelDeltaX/200,e=0<=e?Math.ceil(e):Math.floor(e);var i=this.getHorizontalScrollPosition();e=i-e*this._horizontalScrollBar.lineScrollSize,e=Math.max(0,Math.min(e,this._horizontalScrollBar.getMaxScrollPosition())),this.setHorizontalScrollPosition(e),i!=this.getHorizontalScrollPosition()&&(t.stopPropagation(),t.preventDefault(),t=new ma(ma.SCROLL),t.detail=!1,t.direction="horizontal",t.position=this.getHorizontalScrollPosition(),t.delta=this.getHorizontalScrollPosition()-i,this.dispatchEvent(t))}}},l.prototype._columnResizeMouseOverHandler=function(t){t=t.target.selfElement,this._enabled&&this.resizableColumns&&(0<t.className.indexOf("Separator")&&(t=t.getParent()),t=t.getParent().getChildIndex(t),this._getOptimumColumns()[t].resizable&&m.setStyle(this.element,"cursor","e-resize"))},l.prototype._columnResizeMouseOutHandler=function(t){t=t.target.selfElement,this._enabled&&this.resizableColumns&&(0<t.className.indexOf("Separator")&&(t=t.getParent()),t=t.getParent().getChildIndex(t),this._getOptimumColumns()[t].resizable&&m.setStyle(this.element,"cursor","default"))},l.prototype._columnResizeMouseDownHandler=function(t){var e=t.currentTarget.selfElement;if(this._enabled&&this.resizableColumns){var i=e.getParent().getChildIndex(e);0<this._lockedColumnCount&&e.getParent()==this._getLines().getChildByName("header")&&(i+=this._lockedColumnCount-1);var s=this._getOptimumColumns();if(s[i].resizable){if(this.itemEditorInstance){if(!this.endEditOnBlur&&this.errorInEditing)return;this._endEdit("other")}this._hideFilterInstance(),this._startX=e.getX(),this._lastPt=this._listContent.globalToLocal("touchstart"===t.type?new ra(t.touches[0].pageX,t.touches[0].pageY):new ra(t.pageX,t.pageY)),this._resizingColumn=s[i],t=this._getHeaderInfo(s[i]).headerItem,i>this._lockedColumnCount?(this._minX=this._getAdjustedXPos(t.getX()),this._startX=this._getAdjustedXPos(this._startX)):this._minX=t.getX(),this._minX+=this._resizingColumn.getMinWidth(),this._isPressed=!0,r.supportTouch?(v.documentAddEvent("touchmove",this._columnResizingHandler,this),v.documentAddEvent("touchend",this._columnResizeMouseUpHandler,this)):(v.documentAddEvent("mousemove",this._columnResizingHandler,this),v.documentAddEvent("mouseup",this._columnResizeMouseUpHandler,this)),v.documentAddEvent("selectstart",this._documentSelectStartHandler,this),(i=this.getStyle("columnResizeSkin"))&&(this._removeResizeGraphic(),this._resizeGraphic=new i,this._resizeGraphic.resizingColumn=this._resizingColumn,this._listContent.addChild(this._resizeGraphic),this._resizeGraphic.move(this._lastPt.x,e.getY()),this._resizeGraphic.setActualSize(this._resizeGraphic.measuredWidth,this._unscaledHeight-e.getY()),this.autoFitColumns&&this._resizeGraphic.addEvent("dblclick",this._columnResizeDoubleClickHandler,this))}}},l.prototype._removeResizeGraphic=function(){this._resizeGraphic&&(0<=this._listContent.getChildIndex(this._resizeGraphic)&&(this._resizeGraphic.removeEvent("dblclick",this._columnResizeDoubleClickHandler,this),this._listContent.removeChild(this._resizeGraphic)),this._resizeGraphic=null)},l.prototype._documentSelectStartHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;e?(e=e.getStyle(Mc.removeHyphen(r.getCssPrefix()+"user-select"))||e.getStyle("userSelect"))&&"none"!==e||t.preventDefault():t.preventDefault()},l.prototype._columnResizingHandler=function(t){if(0<=t.type.indexOf("mouse")&&1!=v.getButtonDown(t,this._isPressed)&&(!r.ie||0>=this._lockedColumnCount))this._columnResizeMouseUpHandler.call(this,t);else{var e=this._verticalScrollBar?this._verticalScrollBar.getWidth():0,i=this.getSizeStyle("borderLeftWidth")+this.getSizeStyle("borderRightWidth");this._lastPt=t=this._listContent.globalToLocal("touchmove"===t.type?new ra(t.touches[0].pageX,t.touches[0].pageY):new ra(t.pageX,t.pageY));var s=0;this._lockedSeparators&&0<this._lockedSeparators.length?s=this._lockedSeparators[0].getWidth():this._separators&&0<this._separators.length&&(s=this._separators[0].getWidth()),e=this._unscaledWidth-s-e-i,this._getOptimumColumns()==this._visibleColumns?this._absoluteToVisibleColumnIndex(this._resizingColumn.colNum):this._absoluteToDisplayColumnIndex(this._resizingColumn.colNum),this._resizeGraphic.move(Math.min(Math.max(this._minX,t.x),e),this._resizeGraphic.getY())}},l.prototype._columnResizeMouseUpHandler=function(t){var e=this;if(e._isPressed=!1,e.getEnabled()&&e.resizableColumns&&(r.supportTouch?(v.documentRemoveEvent("touchmove",e._columnResizingHandler,e),v.documentRemoveEvent("touchend",e._columnResizeMouseUpHandler,e)):(v.documentRemoveEvent("mousemove",e._columnResizingHandler,e),v.documentRemoveEvent("mouseup",e._columnResizeMouseUpHandler,e)),v.documentRemoveEvent("selectstart",e._documentSelectStartHandler,e),0<=e._listContent.getChildIndex(e._resizeGraphic))){setTimeout(function(){e._removeResizeGraphic()},250),e.setStyle("cursor","default");var i=e._resizingColumn;e._resizingColumn=null;var s=e._verticalScrollBar?e._verticalScrollBar.getWidth():0,n=e.getSizeStyle("borderLeftWidth")+e.getSizeStyle("borderRightWidth");t=0<=t.type.indexOf("mouse")?e._listContent.globalToLocal(new ra(t.pageX,t.pageY)):e._lastPt;var o=0;e._lockedSeparators&&0<e._lockedSeparators.length?o=e._lockedSeparators[0].getWidth():e._separators&&0<e._separators.length&&(o=e._separators[0].getWidth()),s=Math.min(Math.max(e._minX,t.x),e._unscaledWidth-o-s-n)-e._startX,e._resizeColumn(i.colNum,Math.floor(i.getWidth()+s)),s=new K(K.COLUMN_STRETCH),s.columnIndex=i.colNum,s.dataField=i.getDataField(),s.localX=t.x,e.dispatchEvent.call(e,s)}},l.prototype._columnResizeDoubleClickHandler=function(t){this._resizeGraphic&&(t=this._resizeGraphic.resizingColumn,this._removeResizeGraphic(),t&&this._collection&&this.autoFit(t))},l.prototype._columnDraggingMouseMoveHandler=function(t){var e,i,s,r=this._movingColumn;if(1!=v.getButtonDown(t,this._isPressed))this._columnDraggingMouseUpHandler.call(this,t);else if(isNaN(this._startX)){for(this._startX=t.pageX,this._lastItemDown=null,t=this._columnItemRenderer(r,!0,null),t.name="headerDragProxy",s=this._makeListData(r,null,0,r.colNum,r),t instanceof qa&&t.setListData(s),this._listContent.addChild(t),s=this._orderedHeadersList.length,i=0;i<s&&(!(e=this._orderedHeadersList[i].headerItem)||e.getData()!=this._movingColumn);i++);e.getHeight(),s=e.getExplicitOrMeasuredWidth();var n=e.getX();this._orderedHeadersList[i].actualColNum>=this._lockedColumnCount&&(n=this._getAdjustedXPos(e.getX()),0<this.getHorizontalScrollPosition()&&this._orderedHeadersList[i].actualColNum-this.getHorizontalScrollPosition()<this._lockedColumnCount&&(0<this._lockedColumnCount?(this._getHeaderInfo(this._columns[this._lockedColumnCount-1]),i=this._lastLockedInfo.headerItem.getX()+this._columns[this._lockedColumnCount-1].getWidth()):i=0,s-=i-n,n=i)),t.setData(r),t.setStyleName(this.getStyle("headerDragProxyStyleName")),t.setActualSize(s,this._explicitHeaderHeight?this._headerHeight:t.getExplicitOrMeasuredHeight()),t.move(n,e.getY()),r=new u,r.name="columnDragOverlay",r.setStyle("position","absolute"),r.setAlpha(.6),this._listContent.addChildAt(r,this._listContent.getChildIndex(this._selectionLayer)),t=this.getViewMetrics(),r.setX(n),r.setY(e.getY()-this._cachedPaddingTop),0<s&&(r.setStyle("backgroundColor",this.getStyle("disabledColor")),r.setActualSize(s,this._unscaledHeight-t.bottom-r.getY())),(r=this._selectionLayer.getChildByName("headerSelection"))&&r.setWidth(s),this._listContent.mask||(e=this.getBorderMetrics(),this._listContent.scrollRect=new zd(0,0,this._unscaledWidth-e.left-e.right,this._unscaledHeight-e.top-e.bottom))}else{s=t.pageX-this._startX,(r=this._selectionLayer.getChildByName("headerSelection"))&&r.setX(r.getX()+s),(e=this._listContent.getChildByName("headerDragProxy"))&&e.move(e.getX()+s,e.getY()),this._startX+=s,n=new ra(t.pageX,t.pageY),this._lastPt=n=this._listContent.globalToLocal(n),i=this._getPossibleDropPositions(this._movingColumn),s=i.length;var o,a,r=i[0].headerItem.getX(),l=r,h=!1;for(this._dropIndexFound=!1,a=0;a<s;++a){if(o=i[a],o.actualColNum>=this._lockedColumnCount&&(h=!0),l+=o.column.getWidth(),!(h&&o.actualColNum+o.columnSpan-this.getHorizontalScrollPosition()<=this._lockedColumnCount)&&(h&&(r=this._getAdjustedXPos(r)),n.x>=r&&n.x<r+o.column.getWidth())){this._dropIndexFound=!0,this._isHeaderDragOutside=!1,(n.x>r+o.column.getWidth()/2||h&&o.actualColNum-this.getHorizontalScrollPosition()<this._lockedColumnCount)&&(r+=o.column.getWidth(),++a),this._dropColumnIndex!=a&&(this._dropColumnIndex=a,this._columnDropIndicator||((s=this.getStyle("columnDropIndicatorSkin"))||(s=qe),this._columnDropIndicator=new s,this._columnDropIndicator instanceof u&&this._columnDropIndicator.setStyleName(this),this._listContent.addChild(this._columnDropIndicator)),this._listContent.setChildIndex(this._columnDropIndicator,this._listContent.getNumChildren()-1),this._columnDropIndicator.setX(r-1),this._columnDropIndicator.setY(e.getY()),this._columnDropIndicator.setActualSize(3,this._listContent.getHeight()-e.getY())),this._columnDropIndicator.setVisible(!0);break}r=l}this._dropIndexFound||0!=this._isHeaderDragOutside||(this._isHeaderDragOutside=!0,e=new K(K.HEADER_DRAG_OUTSIDE,(!1),(!0)),s=this._getHeaderInfo(this._movingColumn),e.column=this._movingColumn,e.columnIndex=-1,e.itemRenderer=s.headerItem,e.triggerEvent=t,this.dispatchEvent(e))}},l.prototype._columnDraggingMouseUpHandler=function(t){if(this._movingColumn){if(this._columnGrouping){var e=this._getHeaderInfo(this._movingColumn).index,i=this._getPossibleDropPositions(this._movingColumn),s=i.length;0<=this._dropColumnIndex&&(this._dropColumnIndex>=s?this._dropColumnIndex=s-1:e<this._dropColumnIndex&&this._dropColumnIndex--,this._dropColumnIndex=i[this._dropColumnIndex].index)}else{var e=this._movingColumn.colNum;0<=this._dropColumnIndex&&(this._dropColumnIndex>=this._visibleColumns.length?this._dropColumnIndex=this._visibleColumns.length-1:e<this._visibleColumns[this._dropColumnIndex].colNum&&this._dropColumnIndex--,this._dropColumnIndex=this._visibleColumns[this._dropColumnIndex].colNum)}this._shiftColumns(e,this._dropColumnIndex,t),this._unsetColumnDragParameters()}},l.prototype._collectionChangeHandler=function(e){var i;if(e instanceof y&&(i=e,"reset"==i.kind&&((this._rootModel instanceof fa||this._rootModel instanceof ja)&&this._rootModel.grouping&&(this._groupLabelField=this._rootModel.grouping.label),this._displayItemsExpanded&&this.expandAll())),null!=this._iterator){i&&("expand"==i.kind&&e.stopPropagation(),"update"==i.kind&&(e.stopPropagation(),this._itemsSizeChanged=!0,this.invalidateDisplayList()),"reset"==i.kind?this._updateSortIndexAndDirection():"refresh"!=i.kind||this._manualSort?("remove"==i.kind?this._editedItemPosition&&(0==this._collection.getLength()?(this.itemEditorInstance&&this._endEdit("cancelled"),this._setEditedItemPosition(null)):i.location<=this._editedItemPosition.rowIndex&&(e=this._editedItemPosition,i.location==this._editedItemPosition.rowIndex&&this.itemEditorInstance&&this._endEdit("cancelled"),this._inEndEdit?this._editedItemPosition={columnIndex:this._editedItemPosition.columnIndex,rowIndex:Math.max(0,this._editedItemPosition.rowIndex-i.items.length)}:this._setEditedItemPosition({columnIndex:e.columnIndex,rowIndex:Math.max(0,e.rowIndex-i.items.length)}))):"replace"==i.kind&&this._editedItemPosition&&i.location==this._editedItemPosition.rowIndex&&this.itemEditorInstance&&this._endEdit("cancelled"),this._hideFilterInstance()):this._updateSortIndexAndDirection());var s,r,n;if(i)if("add"==i.kind){if(0==i.location&&0==this.getVerticalScrollPosition())try{this._iterator.seek(t.getFIRST())}catch(o){this._lastSeekPending=new Da(t.getFIRST(),0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}else"vertical"==this._listType&&this.getVerticalScrollPosition()>=i.location&&l._super.setVerticalScrollPosition.call(this,this._verticalScrollPosition+i.items.length);r=i.items.length;for(n in this._selectedData)s=this._selectedData[n],s.index>i.location&&(s.index+=r);this._selectedIndex>=i.location&&(this._selectedIndex+=r,this.dispatchEvent(new w("valueCommit")))}else if("replace"==i.kind)for(n=this._selectedItem?this._itemToUID(this._selectedItem):null,s=i.items.length,r=0;r<s;r++){e=this._itemToUID(i.items[r].oldValue);var a=this._selectedData[e];a&&(a.data=i.items[r].newValue,delete this._selectedData[e],this._selectedData[this._itemToUID(a.data)]=a,n==e&&(this._selectedItem=a.data,this.dispatchEvent(new w("valueCommit"))))}else if("remove"==i.kind){if(e=!1,this._listItems.length&&this._listItems[this._lockedRowCount].length){for(a=this._rowMap[this._listItems[this._lockedRowCount][0].name].uid,n=this._selectedItem?this._itemToUID(this._selectedItem):null,r=0;r<i.items.length;r++){var h=this._itemToUID(i.items[r]);if(h==a&&0==this.getVerticalScrollPosition())try{this._iterator.seek(t.getFIRST())}catch(o){o instanceof ca&&(this._lastSeekPending=new Da(t.getFIRST(),0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}if(this._selectedData[h]&&this._removeSelectionData(h),this._cellSelectionData[h])for(s in this._cellSelectionData[h])this._removeCellSelectionData(h,s),this._removeFromSelectedCells(i.location+r,s);n==h&&(this._selectedItem=null,this._selectedIndex=-1,e=!0),this._removeIndicators(h),this._removeSelectorColumnSelection(h)}if("vertical"==this._listType&&this.getVerticalScrollPosition()>=i.location){this.getVerticalScrollPosition()>i.location?l._super.setVerticalScrollPosition.call(this,this.getVerticalScrollPosition()-Math.min(i.items.length,this.getVerticalScrollPosition()-i.location)):this.getVerticalScrollPosition()>=this._collection.getLength()&&l._super.setVerticalScrollPosition.call(this,Math.max(this._collection.getLength()-1,0));try{this._offscreenExtraRowsTop=Math.min(this._offscreenExtraRowsTop,this.getVerticalScrollPosition()),this._iterator.seek(t.getFIRST(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop)}catch(o){o instanceof ca&&(this._lastSeekPending=new Da(t.getFIRST(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}}this._adjustAfterRemove(i.items,i.location,e)&&this.dispatchEvent(new w("valueCommit"))}}else if("move"==i.kind){if(i.oldLocation<i.location){for(n in this._selectedData)s=this._selectedData[n],s.index>i.oldLocation&&s.index<i.location?s.index--:s.index==i.oldLocation&&(s.index=i.location);this._selectedIndex>i.oldLocation&&this._selectedIndex<i.location?this._selectedIndex--:this._selectedIndex==i.oldLocation&&(this._selectedIndex=i.location)}else if(i.location<i.oldLocation){for(n in this._selectedData)s=this._selectedData[n],s.index>i.location&&s.index<i.oldLocation?s.index++:s.index==i.oldLocation&&(s.index=i.location);this._selectedIndex>i.location&&this._selectedIndex<i.oldLocation?this._selectedIndex++:this._selectedIndex==i.oldLocation&&(this._selectedIndex=i.location)}i.oldLocation==this.getVerticalScrollPosition()?(i.location>this.getMaxVerticalScrollPosition()&&this._iterator.seek(t.getCURRENT(),this.getMaxVerticalScrollPosition()-i.location),l._super.setVerticalScrollPosition.call(this,Math.min(i.location,this.getMaxVerticalScrollPosition()))):i.location>=this.getVerticalScrollPosition()&&i.oldLocation<this.getVerticalScrollPosition()?this._seekNextSafely(this._iterator,this.getVerticalScrollPosition()):i.location<=this.getVerticalScrollPosition()&&i.oldLocation>this.getVerticalScrollPosition()&&this._seekPreviousSafely(this._iterator,this.getVerticalScrollPosition())}else if("refresh"==i.kind)if(this._anchorBookmark){try{this._iterator.seek(this._anchorBookmark,0)}catch(o){o instanceof hd?this._clearSelected():o instanceof ca&&(this._bSortItemPending=!0,this._lastSeekPending=new Da(this._anchorBookmark,0),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}this._adjustAfterSort()}else try{r=this._collection.getLength(),r<=this.getVerticalScrollPosition()&&isNaN(this._verticalScrollPositionPending)&&(this._verticalScrollPositionPending=Math.max(r-1,0),l._super.setVerticalScrollPosition.call(this,this._verticalScrollPositionPending)),this._iterator.seek(t.getFIRST(),this.getVerticalScrollPosition())}catch(o){o instanceof ca&&(this._bSortItemPending=!0,this._lastSeekPending=new Da(t.getFIRST(),this.getVerticalScrollPosition()),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}else if("reset"==i.kind){(0==this._collection.getLength()||this._runningDataEffect&&0==this._actualCollection.getLength())&&(r=this._reconstructDataFromListItems(),r.length&&(s=new y(y.COLLECTION_CHANGE),s.kind="remove",s.items=r,s.location=0));try{this._iterator.seek(t.getFIRST()),this._collectionIterator.seek(t.getFIRST())}catch(o){o instanceof ca&&(this._lastSeekPending=new Da(t.getFIRST(),0),
o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}this._bSelectedIndexChanged||this._bSelectedItemChanged||this._bSelectedIndicesChanged||this._bSelectedItemsChanged?this._bSelectionChanged=!0:this._commitSelectedIndex(-1),isNaN(this._verticalScrollPositionPending)&&(this._verticalScrollPositionPending=0,l._super.setVerticalScrollPosition.call(this,0)),isNaN(this._horizontalScrollPositionPending)&&(this._horizontalScrollPositionPending=0,l._super.setHorizontalScrollPosition.call(this,0),this._columnsInvalid=!0),this.invalidateSize()}if(this._itemsSizeChanged=!0,this.invalidateDisplayList(),i){if("add"==i.kind&&(1==this._collection.getLength()&&this._generatedColumns&&this._generateCols(),this._displayItemsExpanded))for(s=i.items.length,r=0;r<s;r++)this.expandChildrenOf(i.items[r],!0);"refresh"!=i.kind&&"reset"!=i.kind||(this._itemAttributes=[])}if(this._showFooters&&null!=this._footers&&0<this._footers.length)for(r=0;r<this._footers.length;r++)i=this._footers[r],i instanceof Va?i.invalidateData():i.invalidateDisplayList()}},l.prototype._headerReleaseHandler=function(t){if(!t.defaultPrevented)if(this.itemEditorInstance&&this._endEdit("other"),this._hideFilterInstance(),"headerIconFilter"==t.headerPart)this._showFilterInstance(t);else{var e=new K(K.SORT,(!1),(!0));e.columnIndex=t.columnIndex,e.dataField=t.dataField,e.triggerEvent=t.triggerEvent,this._sortExpertMode?(t.triggerEvent&&"mouseup"==t.triggerEvent.type&&(e.multiColumnSort=t.triggerEvent.ctrlKey,e.removeColumnFromSort=t.triggerEvent.shiftKey),this.dispatchEvent(e)):(e.multiColumnSort=!1,this._collection&&this._collection.getSort()&&this._collection.getSort().getFields()&&this._collection.getSort().getFields().length?"headerTextPart"==t.headerPart?this.dispatchEvent(e):"headerIconPart"==t.headerPart&&(e.multiColumnSort=!0,this.dispatchEvent(e)):this.dispatchEvent(e))}},l.prototype._sortHandler=function(t){if(!t.defaultPrevented&&this.sortableColumns&&!isNaN(t.columnIndex)&&-1!=t.columnIndex&&this._columns[t.columnIndex].sortable){if(this._columnGrouping){var e=t.columnIndex;if(isNaN(e)||-1==e)return;null!=this._getHeaderInfo(this._columns[e]).internalLabelFunction&&(t.dataField=null)}this._columnGrouping&&null!=this._selectedHeaderInfo&&(this._selectedHeaderInfo=this._getHeaderInfo(this._columns[t.columnIndex]));var i=t.dataField,e=t.columnIndex;this.sortableColumns&&this._columns[e].sortable&&(null==i&&(i=this._itemToUID(this._columns[e])),t.multiColumnSort?t.removeColumnFromSort?this._removeSortField(i,e,this._collection):-1==this._findSortField(i)?this._addSortField(i,e,this._collection):-1<this._findSortField(i)&&(1==this._collection.getSort().getFields().length?this._sortDirection=this._flipSortOrder(i,e,this._collection):(this._flipSortOrder(i,e,this._collection),this._sortDirection=null)):this._collection.getSort()&&1==this._collection.getSort().getFields().length&&i&&-1<this._findSortField(i)?1==this._sortExpertMode&&(this._sortDirection=this._flipSortOrder(i,e,this._collection)):(this._collection.setSort(null),this._addSortField(i,e,this._collection)),this._collection.refresh(),-1!=this._headerIndex&&(this._selectedHeaderInfo=this._getHeaderInfo(this._columns[t.columnIndex]),this._headerIndex=t.columnIndex,this._selectColumnHeader(this._headerIndex)),this._invalidateHeaders(),this._isRowSelectionMode()&&this._updateSelectedCells())}},l.prototype._superKeyDownHandler=function(t){if(this.selectable&&this._iteratorValid&&this._collection)switch(t.keyCode){case 38:case 40:case 35:case 36:this._moveSelectionVertically(t.keyCode,t.shiftKey,t.ctrlKey),t.stopPropagation(),t.preventDefault();break;case 37:case 39:this._moveSelectionHorizontally(t.keyCode,t.shiftKey,t.ctrlKey),t.stopPropagation(),t.preventDefault();break;case 33:case 34:t.shiftKey||this._moveSelectionVertically(t.keyCode,t.shiftKey,t.ctrlKey),t.stopPropagation(),t.preventDefault();break;case 32:if(-1!=this._caretIndex&&0<=this._caretIndex-this.getVerticalScrollPosition()+this._lockedRowCount&&this._caretIndex-this.getVerticalScrollPosition()+this._lockedRowCount<this._listItems.length){var e=this._listItems[this._caretIndex-this.getVerticalScrollPosition()+this._lockedRowCount][0];if(this._selectItem(e,t.shiftKey,t.ctrlKey)){t=this._itemRendererToIndices(e);var i=new L(L.CHANGE);t&&(i.columnIndex=t.x,i.rowIndex=t.y),i.itemRenderer=e,this.dispatchEvent(i)}}}},l.prototype._keyDownHandler=function(t){if(this&&(!this.itemEditorInstance||this._isCellSelectionMode()&&"excel"===this.editingKeyMode&&this._startEditingByKeyboardEvent&&33<=t.keyCode&&40>=t.keyCode))if(this._isOpening)t.stopImmediatePropagation(),t.preventDefault();else if(!(this._rootModel instanceof pb&&this._treeNavigationHandler(t)))if(this._copyEnabled&&67==t.keyCode&&t.ctrlKey)t.target&&t.target.parentNode&&"Kool__CopyPanel"==t.target.parentNode.id||this.selectionToClipboard(this.copyWithHeader,t);else if(this._pasteEnabled&&86==t.keyCode&&t.ctrlKey)t.target&&t.target.parentNode&&"Kool__PastePanel"==t.target.parentNode.id||(t=r.getClipboard(this,t),this.clipboardPaste(t));else if(!t.target||"checkbox"!=t.target.type||32!=t.keyCode||t.ctrlKey||t.shiftKey||t.altKey){if(this._isCellSelectionMode()&&-1==this._headerIndex&&27!=t.keyCode)this._cellNavigationHandler(t);else{if(this.itemEditorInstance)return;if(-1!=this._headerIndex)return void this._headerNavigationHandler(t);if(27==t.keyCode)return this._setEditedItemPosition(null),this._lastEditedItemPosition=null,this._endEdit("cancelled"),void this._hideFilterInstance();!this._getHeaderVisible()||0!=this._selectedIndex||0!=this._caretIndex||38!=t.keyCode||t.ctrlKey||t.shiftKey?33==t.keyCode&&0==this._caretIndex&&-1==this._selectedIndex?this.moveFocusToHeader():!t.shiftKey||33!=t.keyCode&&34!=t.keyCode||this._moveSelectionHorizontally(t.keyCode,t.shiftKey,t.ctrlKey):this.moveFocusToHeader(),32!=t.keyCode?this._superKeyDownHandler(t):-1!=this._caretIndex&&this._moveSelectionVertically(t.keyCode,t.shiftKey,t.ctrlKey)}this._isRowSelectionMode()&&this._updateSelectedCells()}},l.prototype._keyUpHandler=function(t){this._isKeyPressed&&this._columnGrouping?(this._isKeyPressed=!1,null!=this._selectedHeaderInfo&&this._selectColumnHeader(this._selectedHeaderInfo.column.colNum)):this._isKeyPressed&&-1!=this._headerIndex&&(this._isKeyPressed=!1,this._selectedHeaderInfo=this._getHeaderInfo(this._columns[this._headerIndex]),this._selectColumnHeader(this._headerIndex)),this._copyEnabled&&67==t.keyCode&&t.ctrlKey&&this.focus()},l.prototype._cellNavigationHandler=function(t){var e,i=[38,40,37,39,32,36,35,33,34,113],s=t.keyCode,n=t.shiftKey,o=!1;for(e=0;e<i.length;e++)if(s==i[e]){o=!0;break}if(!o){if(!this._editable.length||"excel"!==this.editingKeyMode||-1==this._caretColumnIndex)return;if(13===s){if(t.defaultPrevented)return;s=n?38:40,n=!1,t.stopPropagation()}else{if(9!==s){if(!(t.ctrlKey&&(89===s||90===s)||48>s||90<s&&96>s||111<s&&188>s||192<s&&219>s||222<s&&229!=s||229==s&&(r.chrome||r.safari)&&("Lang1"==t.code||"AltRight"==t.code))){if(i=this._absoluteToDisplayColumnIndex(this._caretColumnIndex),this._displayableColumns[i]&&0==this._displayableColumns[i].editable)return;if((s=this._rowNumberToData(this._caretIndex))&&this._isDataEditable(s)){this._startEditingByKeyboardEvent=!0,s=new K(K.ITEM_EDIT_BEGINNING,(!1),(!0)),s.columnIndex=this._caretColumnIndex,s.dataField=this._columns[this._caretColumnIndex].getDataField(),s.rowIndex=this._caretIndex,s.triggerEvent=t;var a=this._absoluteToVisibleIndices(this._caretIndex,this._caretColumnIndex),l=a.rowIndex,a=a.columnIndex;s.itemRenderer=this._listItems[l][a],this.dispatchEvent(s)}}return}if(t.defaultPrevented)return;s=n?37:39,n=!1,t.preventDefault(),t.stopPropagation()}}if(113!=s||-1==this._caretColumnIndex||(i=this._absoluteToDisplayColumnIndex(this._caretColumnIndex),!this._displayableColumns[i]||0!=this._displayableColumns[i].editable)){var h,o=!1,i=this._listItems.length;if(e=0,0!=i){switch(this._rowInfo[i-1].y+this._rowInfo[i-1].height>this._listContent.getHeight()&&e++,this._showCaret=!0,this._bSelectItem=!1,s){case 38:0!=this._caretIndex||0!=this._selectedIndex||!this._getHeaderVisible()||t.ctrlKey||n?0<this._caretIndex&&(0<this._visibleColumns.length&&this._visibleColumns[0].colNum>this._caretColumnIndex&&(this._caretColumnIndex=this._visibleColumns[0].colNum),this._caretIndex--,this._bSelectItem=o=!0):(s=this._caretColumnIndex,this._clearSelectedCells(),this.moveFocusToHeader(s));break;case 40:this._caretIndex<this._collection.getLength()-1?(this._isSpanCollectionView()?((o=this._getCellAttributeAt(this._caretIndex,this._caretColumnIndex))&&o._type&&(this._caretIndex+=Math.max(0,o.rowSpan-o._rowGap-1)),this._caretIndex<this._collection.getLength()-1&&this._caretIndex++):this._caretIndex++,0==this._caretIndex?this._caretColumnIndex=0:0<this._visibleColumns.length&&this._visibleColumns[0].colNum>this._caretColumnIndex&&(this._caretColumnIndex=this._visibleColumns[0].colNum),this._bSelectItem=o=!0):this._caretIndex==this._collection.getLength()-1&&e&&this.getVerticalScrollPosition()<this.getMaxVerticalScrollPosition()&&(h=this.getVerticalScrollPosition()+1);break;case 37:s=this._viewDisplayableColumnAtOffset(this._caretColumnIndex,-1,this._caretIndex),-1!=s&&(this._caretColumnIndex=s,this._bSelectItem=!0);break;case 39:s=this._viewDisplayableColumnAtOffset(this._caretColumnIndex,1,this._caretIndex),-1!=s&&(this._caretColumnIndex=s,this._bSelectItem=!0);break;case 32:this._bSelectItem=t.ctrlKey;break;case 36:case 35:case 33:case 34:this._moveSelectionVertically(s,n,t.ctrlKey);break;case 113:-1!=this._caretColumnIndex&&(s=this._rowNumberToData(this._caretIndex))&&this._isDataEditable(s)&&(s=new K(K.ITEM_EDIT_BEGINNING,(!1),(!0)),s.columnIndex=this._caretColumnIndex,s.dataField=this._columns[this._caretColumnIndex].getDataField(),s.rowIndex=this._caretIndex,a=this._absoluteToVisibleIndices(this._caretIndex,this._caretColumnIndex),l=a.rowIndex,a=a.columnIndex,s.itemRenderer=this._listItems[l][a],this.dispatchEvent(s))}if(t.stopPropagation(),t.preventDefault(),o&&(this._caretIndex<this._lockedRowCount?h=0:this._caretIndex<this.getVerticalScrollPosition()+this._lockedRowCount?h=this._caretIndex-this._lockedRowCount:this._caretIndex>=this.getVerticalScrollPosition()+i-e&&(h=Math.min(this.getMaxVerticalScrollPosition(),this._caretIndex-i+e+1)),!isNaN(h)&&(this.getVerticalScrollPosition()!=h&&(i=new ma(ma.SCROLL),i.detail=!1,i.direction="vertical",i.delta=h-this.getVerticalScrollPosition(),i.position=h,this.setVerticalScrollPosition(h),this.dispatchEvent(i)),!this._iteratorValid)))return void(this._keySelectionPending=!0);this._bShiftKey=n,this._bCtrlKey=t.ctrlKey,this._lastKey=t.keyCode,this._finishCellKeySelection()}}},l.prototype._headerNavigationHandler=function(t){if(this._columnGrouping&&-1!=this._headerIndex&&null!=this._selectedHeaderInfo){if(-1==this._headerIndex||null==this._selectedHeaderInfo)return;var e;38==t.keyCode?null!=this._selectedHeaderInfo.parent&&(e=this._selectedHeaderInfo.parent,this._unselectColumnHeader(this._headerIndex),this._selectedHeaderInfo=e,this._headerIndex=e.index,this._selectColumnGroupHeader(e)):40==t.keyCode?null==this._selectedHeaderInfo.visibleChildren||0==this._selectedHeaderInfo.visibleChildren.length?(this._unselectColumnHeader(this._selectedHeaderInfo.column.colNum,!0),this._headerIndex=-1):(e=this._selectedHeaderInfo.visibleChildren[0],this._unselectColumnHeader(this._headerIndex),this._selectedHeaderInfo=e,this._headerIndex=0,this._selectColumnGroupHeader(e)):37==t.keyCode?(e=null!=this._selectedHeaderInfo.parent?this._selectedHeaderInfo.parent.visibleChildren:this._visibleHeaderInfos,0<this._selectedHeaderInfo.visibleIndex&&(e=e[this._selectedHeaderInfo.visibleIndex-1],this._scrollColumnGroupIfNeeded(this._selectedHeaderInfo,e),this._unselectColumnHeader(this._headerIndex),this._selectedHeaderInfo=e,this._headerIndex=e.visibleIndex,this._selectColumnGroupHeader(e))):39==t.keyCode?(e=null!=this._selectedHeaderInfo.parent?this._selectedHeaderInfo.parent.visibleChildren:this._visibleHeaderInfos,this._selectedHeaderInfo.visibleIndex<e.length-1&&(e=e[this._selectedHeaderInfo.visibleIndex+1],this._scrollColumnGroupIfNeeded(this._selectedHeaderInfo,e),this._unselectColumnHeader(this._headerIndex),this._selectedHeaderInfo=e,this._headerIndex=e.visibleIndex,this._selectColumnGroupHeader(e))):32==t.keyCode?this.sortableColumns&&-1!=this._selectedHeaderInfo.column.colNum&&!isNaN(this._selectedHeaderInfo.column.colNum)&&this._columns[this._selectedHeaderInfo.column.colNum].sortable&&(this._isKeyPressed=!0,this._selectColumnHeader(this._selectedHeaderInfo.column.colNum),e=new K(K.SORT,(!1),(!0)),e.multiColumnSort=t.ctrlKey,e.removeColumnFromSort=t.shiftKey,e.columnIndex=this._selectedHeaderInfo.column.colNum,e.dataField=this._selectedHeaderInfo.column.dataField,this.dispatchEvent(e)):!t.shiftKey||33!=t.keyCode&&34!=t.keyCode||this._moveSelectionHorizontally(t.keyCode,t.shiftKey,t.ctrlKey)}else{if(-1==this._headerIndex)return;40==t.keyCode?(this._unselectColumnHeader(this._headerIndex,!0),this._headerIndex=-1):37==t.keyCode?(e=this._viewDisplayableColumnAtOffset(this._headerIndex,-1),-1!=e&&(this._unselectColumnHeader(this._headerIndex),this._selectedHeaderInfo=this._getHeaderInfo(this._columns[e]),this._headerIndex=e,this._selectColumnHeader(this._headerIndex))):39==t.keyCode?(e=this._viewDisplayableColumnAtOffset(this._headerIndex,1),-1!=e&&(this._unselectColumnHeader(this._headerIndex),this._selectedHeaderInfo=this._getHeaderInfo(this._columns[e]),this._headerIndex=e,this._selectColumnHeader(this._headerIndex))):32==t.keyCode?this.sortableColumns&&this._columns[this._headerIndex].sortable&&(this._isKeyPressed=!0,this._selectedHeaderInfo=this._getHeaderInfo(this._columns[this._headerIndex]),this._selectColumnHeader(this._headerIndex),e=new K(K.SORT,(!1),(!0)),e.columnIndex=this._headerIndex,e.dataField=this._columns[this._headerIndex].getDataField(),e.multiColumnSort=t.ctrlKey,e.removeColumnFromSort=t.shiftKey,this.dispatchEvent(e)):!t.shiftKey||33!=t.keyCode&&34!=t.keyCode||this._moveSelectionHorizontally(t.keyCode,t.shiftKey,t.ctrlKey)}t.stopPropagation(),t.preventDefault()},l.prototype._itemEditorItemEditBeginHandler=function(t){if(!t.defaultPrevented&&null!=this._listItems[this._actualRowIndex][this._actualColIndex].getData()){this.createItemEditor(t.columnIndex,t.rowIndex);var e=new K(K.ITEM_FOCUS_IN);e.columnIndex=this._editedItemPosition.columnIndex,e.rowIndex=this._editedItemPosition.rowIndex,e.item=this.getEditedItemRenderer().getListData().item,e.dataField=this.getEditedItemRenderer().getListData().dataField,e.itemRenderer=this.itemEditorInstance,this.dispatchEvent(e),this._tempTextInput&&this._tempTextInput==this.itemEditorInstance&&this._startEditingByKeyboardEvent?this._tempTextInput=null:(this._columns[t.columnIndex].rendererIsEditor||this.itemEditorInstance.setData(this.getEditedItemRenderer().getData()),U(this.getEditedItemRenderer().setListData)&&U(this.itemEditorInstance.setListData)&&this.itemEditorInstance.setListData(this.getEditedItemRenderer().getListData())),this.itemEditorInstance instanceof R&&this.itemEditorInstance.validateNow(),U(this.itemEditorInstance.setImeMode)&&this.itemEditorInstance.setImeMode(null==this._columns[t.columnIndex].imeMode?this._imeMode:this._columns[t.columnIndex].imeMode),this.itemEditorInstance instanceof A&&(r.ie9&&this._startEditingByKeyboardEvent&&this.itemEditorInstance instanceof Y?this.itemEditorInstance.element.focus():this.itemEditorInstance.focus())}},l.prototype._editorMouseUpHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t.target!=document&&e&&this.owns(e)||this._endEdit("blur")},l.prototype._editorBlurHandler=function(t){this._endEdit("blur")},l.prototype._editorKeyDownHandler=function(t){if(113==t.keyCode&&(this._endEdit("other"),this.focus(),this.invalidateDisplayList()),27==t.keyCode)this._endEdit("cancelled");else if(9==t.keyCode)t.defaultPrevented||(r.ie&&t.currentTarget.selfElement instanceof za&&t.currentTarget.selfElement.blur(),this._findNextItemRenderer(t)||this._endEdit("blur"),t.preventDefault());else if(13==t.keyCode){if(this._columns[this._editedItemPosition.columnIndex].editorUsesEnterKey)return;r.ie&&t.currentTarget.selfElement instanceof za&&t.currentTarget.selfElement.blur(),this._endEdit("newRow")&&!this._dontEdit&&this._findNextEnterItemRenderer(t),t.preventDefault()}this._isCellSelectionMode()&&"excel"===this.editingKeyMode&&this._startEditingByKeyboardEvent&&33<=t.keyCode&&40>=t.keyCode&&(this._endEdit("blur"),this.focus(),this.invalidateDisplayList())},l.prototype._editorStageResizeHandler=function(t){t=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null,t instanceof R&&t.contains(this)&&this._endEdit("other")},l.prototype._itemEditorItemEditEndHandler=function(t){if(t.defaultPrevented)"other"!=t.reason?this.itemEditorInstance&&this._editedItemPosition&&(this.getSelectedIndex()!=this._editedItemPosition.rowIndex&&this.setSelectedIndex(this._editedItemPosition.rowIndex),this.itemEditorInstance instanceof A&&this.itemEditorInstance.focus()):this.itemEditorInstance&&this._editedItemPosition&&this._columns[t.columnIndex].rendererIsEditor&&t.itemRenderer._reset(),this.errorInEditing=!0;else{var e=!1;if("newColumn"==t.reason?this._collectionUpdatesDisabled||(this._collection.disableAutoUpdate(),this._collectionUpdatesDisabled=!0):this._collectionUpdatesDisabled&&(this._collection.enableAutoUpdate(),this._collectionUpdatesDisabled=!1),this.itemEditorInstance&&"cancelled"!=t.reason){var i=bd(this.itemEditorInstance,this._columns[t.columnIndex].editorDataField),s=this._columns[t.columnIndex].getDataField(),r=this._columns[t.columnIndex].getStyle("type"),n=t.itemRenderer.getData();if(r?"int"==r?!ha(i)&&0<=i-parseFloat(i)+1&&F(i)&&i>=-(Math.pow(2,53)-1)&&i<=Math.pow(2,53)-1&&(i=parseInt(i)):"float"==r&&!ha(i)&&0<=i-parseFloat(i)+1&&F(i)&&i>=-(Math.pow(2,53)-1)&&i<=Math.pow(2,53)-1&&(i=Number(i)):!ha(i)&&0<=i-parseFloat(i)+1&&F(i)&&("0"===i||0!=i.indexOf("0"))&&i>=-(Math.pow(2,53)-1)&&i<=Math.pow(2,53)-1&&(i=Number(i)),E(n)?((r=G.getProperty(n,s))&&r!=i||!r&&r!==i)&&(e=!0,G.setProperty(n,s,i?i.toString():i)):(r=n[s],r!==i&&(e=!0,n[s]=i)),e&&this._collection.itemUpdated(n,s),t.itemRenderer.setData(n),t.itemRenderer instanceof qa){var s=t.itemRenderer.getListData(),o=t.itemRenderer.element.style.height;s.label=this._columns[t.columnIndex].itemToLabel(n),t.itemRenderer.setListData(s),Ba.getInstance().validateClient(t.itemRenderer,!0),t.itemRenderer.element.style.height||(t.itemRenderer.element.style.height=o)}}this.errorInEditing=!1}"other"!==t.reason&&t.defaultPrevented?"blur"===t.reason&&this.endEditOnBlur&&this.destroyItemEditor():this.destroyItemEditor(),t.defaultPrevented||(n=new K(K.ITEM_EDIT_COMPLETE),n.columnIndex=t.columnIndex,n.rowIndex=t.rowIndex,n.itemRenderer=t.itemRenderer,n.reason=e?t.reason:"sameValue",n.item=t.itemRenderer.getData(),n.dataField=t.dataField,n.newValue=i,n.oldValue=r,this.dispatchEvent(n))},l.prototype._itemEditorItemEditBeginningHandler=function(t){if(t.defaultPrevented)this.itemEditorInstance||(this._collectionUpdatesDisabled&&(this._collection.enableAutoUpdate(),this._collectionUpdatesDisabled=!1),this._editedItemPosition=null,this.focus());else{var e={columnIndex:t.columnIndex,rowIndex:t.rowIndex};this._isCellSelectionMode()&&"excel"===this.editingKeyMode&&t.triggerEvent&&"keydown"===t.triggerEvent.type&&!r.isMobile?13===t.triggerEvent.keyCode||9===t.triggerEvent.keyCode?this._isCellAlreadySelected(e)||(this._adjustItemPosition(e),this._editedItemPosition=null,this.focus(),r.ie8L&&!this._tempTextInput&&this.callLater(this.focus)):(this._setEditedItemPosition(e),(r.ie10||r.ie11)&&(t=this._columns[t.columnIndex],t.itemEditor&&t.itemEditor.generator==Y&&(this._tempTextInput||(this._tempTextInput=t.itemEditor.newInstance()),this._addRendererToContentArea(this._tempTextInput,t),this._tempTextInput.setActualSize(0,0),t=this._tempTextInput.getParent(),this._columnGrouping&&t===this._listSubContent&&this._tempTextInput.setX(this._listSubContent.element.scrollLeft),this._tempTextInput.focus()))):this._setEditedItemPosition(e)}},l.prototype._expandItemHandler=function(t){if(!t.defaultPrevented&&(t.type==K.ITEM_OPENING&&(this._eventItemRenderer=t.itemRenderer,this.expandItem(t.item,t.opening,t.animate,t.dispatchEvent,t.triggerEvent)),this._showFooters&&null!=this._footers&&0<this._footers.length))for(t=0;t<this._footers.length;t++)this._footers[t]instanceof Va?this._footers[t].invalidateData():this._footers[t].invalidateDisplayList()},l.prototype._treeNavigationHandler=function(t){var e,i,s=this._absoluteToVisibleIndices(this._caretIndex,-1!=this._caretColumnIndex?this._caretColumnIndex:0),r=s.rowIndex,s=s.columnIndex;if(this._listItems[r]&&this._listItems[r][s]&&(i=this._listItems[r][s].getData()),!i)return!1;if(this._listItems[r]&&(e=this._listItems[r][this.getTreeColumnIndex()]),t.ctrlKey&&t.shiftKey&&32==t.keyCode)this._caretIndex!=this._selectedIndex&&((r=this.indexToItemRenderer(this._caretIndex))&&this._drawItem(r),this._caretIndex=this._selectedIndex),this._isBranch(i)&&(r=!this.isItemOpen(i),this._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,i,e,t,r,!1,!0)),t.stopImmediatePropagation();else if(t.ctrlKey&&t.shiftKey&&37==t.keyCode)this.isItemOpen(i)?this._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,i,e,t,!1,!1,!0):(this._selectedItem=this.getParentItem(i),e=new L(L.CHANGE),e.itemRenderer=this.indexToItemRenderer(this._selectedIndex),(i=this._itemRendererToIndices(e.itemRenderer))&&(e.rowIndex=i.y,e.columnIndex=i.x),this.dispatchEvent(e),e=this._getItemIndex(this._selectedItem),e!=this._caretIndex&&(this._caretIndex=this._selectedIndex),e<this._verticalScrollPosition&&this.setVerticalScrollPosition(e)),t.stopImmediatePropagation();else if(t.ctrlKey&&t.shiftKey&&39==t.keyCode)this._isBranch(i)&&(this.isItemOpen(i)?(i?(e=this._getChildren(i,this._iterator.getView()))&&(this._selectedItem=e.createCursor().getCurrent()):this._selectedItem=null,this._caretIndex!=this._selectedIndex&&(this._caretIndex=this._getItemIndex(this._selectedItem)),e=new L(L.CHANGE),e.itemRenderer=this.indexToItemRenderer(this._selectedIndex),(i=this._itemRendererToIndices(e.itemRenderer))&&(e.rowIndex=i.y,e.columnIndex=i.x),this.dispatchEvent(e)):this._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,i,e,t,!0,!1,!0)),t.stopImmediatePropagation();else if(106==t.keyCode)this.expandChildrenOf(i,!this.isItemOpen(i));else if(107==t.keyCode)this._isBranch(i)&&(this.isItemOpen(i)||this._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,i,e,t,!0,!1,!0));else{if(109!=t.keyCode)return!1;this.isItemOpen(i)&&this._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,i,e,t,!1,!1,!0)}return!0},l.prototype._excelExportMakeHandler=function(t){this._excelExportUtil.removeEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeHandler,this),this.dispatchEvent(t)},l.prototype._excelExportSaveHandler=function(t){this._excelExportUtil.removeEventListener(J.EXPORT_SAVE_COMPLETE,this._excelExportSaveHandler,this),this._excelExportUtil.removeEventListener(J.EXPORT_SAVE_ERROR,this._excelExportSaveHandler,this),this.dispatchEvent(t)},l.prototype._excelExportUploadEventHandler=function(t){this._excelExportUtil.removeEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelExportUploadEventHandler,this),this._excelExportUtil.removeEventListener(J.EXPORT_UPLOAD_ERROR,this._excelExportUploadEventHandler,this),this.dispatchEvent(t)},l.prototype._copyHandler=function(t){this._copyEnabled&&this.selectionToClipboard(this.copyWithHeader,t)},l.prototype._pasteHandler=function(t){},l.prototype._touchHandler=function(t){var e,i,s,r,n=this;if(r=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null,1<t.touches.length)n._touchStartPoint=null,n._touchStartTimeStamp=0,n._touchLastPoint=null,n._touchLastScrollEvent=null,n._touchEventsStack=[];else if(n.itemEditorInstance&&n.itemEditorInstance==r)n._touchStartPoint=new ra(e.pageX,e.pageY),n._touchStartTimeStamp=(new Date).getTime(),n._touchLastPoint=new ra(e.pageX,e.pageY),n._touchLastScrollEvent=null;else switch(t.type){case"touchstart":n._tween&&n._tween.endTween(!0),e=t.touches[0],n._touchStartPoint=new ra(e.pageX,e.pageY),n._touchStartTimeStamp=(new Date).getTime(),n._touchLastPoint=new ra(e.pageX,e.pageY),n._touchLastScrollEvent=null,n._touchEventsStack.push(t),8<n._touchEventsStack.length&&n._touchEventsStack.shift();break;case"touchmove":if(e=t.touches[0],!n._touchLastPoint){n._touchLastPoint=new ra(e.pageX,e.pageY),t.preventDefault();break}t.timeStamp||(t.timeStamp=(new Date).getTime()),n._touchEventsStack.push(t),8<n._touchEventsStack.length&&n._touchEventsStack.shift();var o,a,l,h=1;if(r=Math.abs(e.pageX-n._touchLastPoint.x),h=Math.abs(e.pageY-n._touchLastPoint.y),3>=r&&3>=h){n.liveScrolling&&t.preventDefault();break}if(0==r||h>=r?(e.pageY>n._touchLastPoint.y?(h=1,l="u"):(h=-1,l="d"),r=n._touchLastPoint.y-e.pageY):(e.pageX>n._touchLastPoint.x?(h=1,l="r"):(h=-1,l="l"),r=n._touchLastPoint.x-e.pageX),n._touchLastPoint.x=e.pageX,n._touchLastPoint.y=e.pageY,n._resizeGraphic)break;if(("d"==l||"u"==l)&&!n._verticalScrollBar||("r"==l||"l"==l)&&!n._horizontalScrollBar)break;switch(l){case"d":case"u":i=n._verticalScrollBar,o=n.getVerticalScrollPosition,a=n.setVerticalScrollPosition;break;case"r":case"l":i=n._horizontalScrollBar,o=n.getHorizontalScrollPosition,a=n.setHorizontalScrollPosition}e=o.call(n);var d=i.getMinScrollPosition(),c=i.getMaxScrollPosition();if(e<=d&&("u"==l||"r"==l)||e>=c&&("d"==l||"l"==l))break;l=e-h*i.lineScrollSize,l=Math.max(0,Math.min(l,c)),n.liveScrolling?(n.itemEditorInstance&&n._endEdit("other"),a.call(n,l),e!=o.call(n)&&(t.preventDefault(),n._touchLastScrollEvent=new ma(ma.SCROLL),n._touchLastScrollEvent.direction=i.getDirection(),n._touchLastScrollEvent.position=o.call(n),n._touchLastScrollEvent.delta=o.call(n)-e,n._touchLastScrollEvent.edelta=h,n.dispatchEvent(n._touchLastScrollEvent))):(i.isScrolling=!0,i._setScrollPosition(r),n._touchLastScrollEvent||(n._touchLastScrollEvent=new ma(ma.SCROLL),n._touchLastScrollEvent.edelta=h),n._touchLastScrollEvent.direction=i.getDirection(),n._touchLastScrollEvent.position=i.getScrollPosition(),n._touchLastScrollEvent.delta=o.call(n)-e,t.preventDefault());break;case"touchend":if(n._touchLastScrollEvent&&!n._resizeGraphic){a=1;var _;o=n.liveScrolling?500:250,(i="vertical"==n._touchLastScrollEvent.direction?n._verticalScrollBar:n._horizontalScrollBar)&&(i.isScrolling=!1,a=I(t.pageY)?t.changedTouches&&0<t.changedTouches.length?new ra(t.changedTouches[0].pageX,t.changedTouches[0].pageY):n._touchLastPoint:new ra(t.pageX,t.pageY),"vertical"==n._touchLastScrollEvent.direction?(_=i.getHeight(),r=Math.abs(n._touchStartPoint.y-a.y),a=n._touchLastScrollEvent.position+-10*n._rowHeight*n._touchLastScrollEvent.edelta):(_=i.getWidth(),r=Math.abs(n._touchStartPoint.x-a.x),a=n._touchLastScrollEvent.position+-10*n._touchLastScrollEvent.edelta),a=0>a?0:a>i.getMaxScrollPosition()?i.getMaxScrollPosition():a,50<r&&(new Date).getTime()-n._touchStartTimeStamp<o?n._tween=new oa(n,n._touchLastScrollEvent.position,a,750,(-1),function(t){i&&(n.liveScrolling?(s=new ma(ma.SCROLL),s.direction=i.getDirection(),s.position=Math.round(t),s.delta=0,i.dispatchEvent(s)):(i.isScrolling=!0,i._setScrollPosition(parseInt((t-i._getScrollPosition())*_/i._correctedPageSize))))},function(t){n._tween=null,i&&(i.isScrolling=!1,s=new ma(ma.SCROLL),s.direction=i.getDirection(),s.position=Math.round(t),s.delta=0,i.dispatchEvent(s))}):n.liveScrolling||i.dispatchEvent(n._touchLastScrollEvent))}for(o=a=o=0;o<n._touchEventsStack.length;o++)if("touchstart"==n._touchEventsStack[o].type&&800>t.timeStamp-n._touchEventsStack[o].timeStamp){if(h){if(20<Math.abs(n._touchEventsStack[o].touches[0].pageX-h.touches[0].pageX)||20<Math.abs(n._touchEventsStack[o].touches[0].pageY-h.touches[0].pageY)){a=0;continue}}else h=n._touchEventsStack[o];a++}2==a&&(n._touchLastPoint&&(t.pageX2=n._touchLastPoint.x,t.pageY2=n._touchLastPoint.y),t.preventDefault(),n._touchEventsStack=[],n._doubleClickEnabled&&(n._mouseDownHandler(t),n._mouseUpHandler(t),n._mouseDoubleClickHandler(t)),n._resizeGraphic&&n._columnResizeDoubleClickHandler(t)),n._touchStartPoint=null,n._touchStartTimeStamp=0,n._touchLastPoint=null,n._touchLastScrollEvent=null;break;case"touchcancel":n._touchStartPoint=null,n._touchStartTimeStamp=0,n._touchLastPoint=null,n._touchLastScrollEvent=null,n._touchEventsStack=[]}},l.prototype._contextMenuHandler=function(t){if(!t.target||!(t.target.selfElement instanceof Db||t.target.selfElement instanceof Ta)){var e,i=this._mouseEventToItemRenderer(t),s=new K(K.CONTEXT_MENU_DOWN,(!1),(!0));s.columnIndex=-1,s.rowIndex=-1,s.htmlEvent=t,i?(this._isHeaderItemRenderer(i)?(e=new L(L.ITEM_ROLL_OVER),e.columnIndex=this._absoluteToDisplayColumnIndex(i.getListData().columnIndex),e.rowIndex=-2,e.htmlEvent=t,this.dispatchEvent(e),s.columnIndex=e.columnIndex,s.rowIndex=-2):(e=this._itemRendererToIndices(i))&&(s.columnIndex=e.x,s.rowIndex=e.y),s.itemRenderer=i):(e=new L(L.ITEM_ROLL_OVER),e.columnIndex=-1,e.rowIndex=-1,e.htmlEvent=t,this.dispatchEvent(e)),this.dispatchEvent(s),l._super._contextMenuHandler.call(this,t)}},l.prototype._filterInstanceMouseDownHandler=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;t.target!=document&&e&&this.owns(e)||this._hideFilterInstance()},l.prototype._filterInstanceBlurHandler=function(t){this._hideFilterInstance()},l.prototype._exportExcelHeader=function(t,e,i,s,r,n,o,a,l,h,d,c,_){var u=-1;if(!this.exportOnlyData){var p,g=n,u=-1,f=n=!1,y=!1,b=0,v="center",S="middle",C=-1;g||(g=this._getMeasuringRenderer(o,!0,null),g.getData()&&g.getData===o||(g.setData(o),o._addStyleToHeaderItem(g))),g.getStyle("fontSize")&&(u=parseInt(g.getStyle("fontSize"))),g.getStyle("fontWeight")&&(n=m.isBold(g.getStyle("fontWeight"))),g.getStyle("fontStyle")&&(f="italic"==g.getStyle("fontStyle")),g._labelElement&&g._labelElement.getStyle("textDecoration")&&(y="underline"==g._labelElement.getStyle("textDecoration")),g.getStyle("color")&&(b=g.getStyle("color")),g.getStyle("fontFamily")&&(p=g.getStyle("fontFamily")),g.getStyle("horizontalAlign")&&(v=g.getStyle("horizontalAlign")),g.getStyle("verticalAlign")&&(S=g.getStyle("verticalAlign")),o=this._wordWrap,F(r)&&r.search(/<[br]*>/gi)&&(o=!0);var I=this.getStyle("headerColors");I&&(C=N.rgbMiddle(N.color2no(I[0]),N.color2no(I[I.length-1]))),b&&(b=N.color2no(b)),p&&(p=m.getFontFamily(p)[0]),u=a.getXfIndex(u,n,f,y,b,p,null,v,S,o,0,!0,h,c,!0,d,_,!0,l,"",C)}for(r?g instanceof Wa?a.writeCellLabel(t,e,this._convertHtmlTag(r),u):a.writeCellLabel(t,e,r,u):a.writeCellBlank(t,e,u),r=1;r<i;r++)a.writeCellBlank(t+r,e,u);for(r=1;r<s;r++)a.writeCellBlank(t,e+r,u)},l.prototype._convertHtmlTag=function(t){return t?(F(t)||(t=t.toString()),t=t.replace(/<[br]*>/gi,"\n"),t=t.replace(/<[a-zA-Z\/][^>]*>/g,""),0<=t.indexOf("&")&&(t=t.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&#38;/g,"&").replace(/&#x26;/g,"&")),0<=t.indexOf("&#x")&&(t=t.replace(/&#x([0-9a-fA-F]+);/g,function(t,e){return String.fromCharCode(Number("0x"+e))})),0<=t.indexOf("&#")&&(t=t.replace(/&#([0-9]{1,5});/gi,function(t,e){return String.fromCharCode(e)})),t):t},l.prototype._findCSSSheet=function(t){return this._exportCSSBuffer||(this._exportCSSBuffer={}),this._exportCSSBuffer[t]?this._exportCSSBuffer[t]:(this._exportCSSBuffer[t]=m.findCSSSheet(t),this._exportCSSBuffer[t])},l.prototype._getCellXfIndex=function(t,e,i,s,r){var n=-1;if(this.exportOnlyData)return n;var o,a,l,h,n=-1,d=!1,c=!1,_=!1,u=0,p=!1,g=0,f="",y=!1,b=0,v="",S=-1;if(s?(s.getStyle("fontSize")?n=parseInt(s.getStyle("fontSize")):this.getStyle("fontSize")&&(n=parseInt(this.getStyle("fontSize"))),
s.getStyle("fontWeight")?d=m.isBold(s.getStyle("fontWeight")):this.getStyle("fontWeight")&&(d=m.isBold(this.getStyle("fontWeight"))),s.getStyle("fontStyle")?c="italic"==s.getStyle("fontStyle"):this.getStyle("fontStyle")&&(c="italic"==this.getStyle("fontStyle")),s.getStyle("textDecoration")?_="underline"==s.getStyle("textDecoration"):this.getStyle("textDecoration")&&(_="underline"==this.getStyle("textDecoration")),s.getStyle("color")?u=s.getStyle("color"):this.getStyle("color")&&(u=this.getStyle("color")),s.getStyle("fontFamily")?o=s.getStyle("fontFamily"):this.getStyle("fontFamily")&&(o=this.getStyle("fontFamily")),e=s.getFormatter()?r.getFormatString(s.getFormatter()):dc(e)?"yyyy\\/mm\\/dd":null,s.getStyle("textAlign")?a=s.getStyle("textAlign"):this.getStyle("textAlign")&&(a=this.getStyle("textAlign")),h=1==s.getWordWrap(),s.getStyle("backgroundColor")&&(S=s.getStyle("backgroundColor"))):(this.getStyle("fontSize")&&(n=parseInt(this.getStyle("fontSize"))),this.getStyle("fontWeight")&&(d=m.isBold(this.getStyle("fontWeight"))),this.getStyle("fontStyle")&&(c="italic"==this.getStyle("fontStyle")),this.getStyle("textDecoration")&&(_="underline"==this.getStyle("textDecoration")),this.getStyle("color")&&(u=this.getStyle("color")),this.getStyle("fontFamily")&&(o=this.getStyle("fontFamily")),e=null,this.getStyle("textAlign")&&(a=this.getStyle("textAlign")),h=this._wordWrap,this.getStyle("backgroundColor")&&(S=this.getStyle("backgroundColor"))),this.getStyle("verticalAlign")&&(l=this.getStyle("verticalAlign")),this.getStyle("horizontalGridLines")&&(p=this.getStyle("horizontalGridLines")),this.getStyle("horizontalGridLineColor")&&(g=N.color2no(this.getStyle("horizontalGridLineColor"))),this.getStyle("horizontalGridLineStyle")&&(f=this.getStyle("horizontalGridLineStyle")),this.getStyle("verticalGridLines")&&(y=this.getStyle("verticalGridLines")),this.getStyle("verticalGridLineColor")&&(b=N.color2no(this.getStyle("verticalGridLineColor"))),this.getStyle("verticalGridLineStyle")&&(v=this.getStyle("verticalGridLineStyle")),i&&this._isSpanCollectionView()){var C=this._getRowAttribute(i);if(C){if(C.styleName){var I=this._findCSSSheet(C.styleName);I&&(I.style.fontSize&&(n=parseInt(I.style.fontSize)),I.style.fontWeight&&(d=m.isBold(I.style.fontWeight)),I.style.fontStyle&&(c="italic"==I.style.fontStyle),I.style.textDecoration&&(_="underline"==I.style.textDecoration),I.style.color&&(u=I.style.color),I.style.fontFamily&&(o=I.style.fontFamily),I.style.textAlign&&(a=I.style.textAlign))}C.backgroundColor&&(S=C.backgroundColor)}(i=this._getCellAttribute(i,s.colNum))&&(i.styleName&&(C=this._findCSSSheet(i.styleName))&&(C.style.fontSize&&(n=parseInt(C.style.fontSize)),C.style.fontWeight&&(d=m.isBold(C.style.fontWeight)),C.style.fontStyle&&(c="italic"==C.style.fontStyle),C.style.textDecoration&&(_="underline"==C.style.textDecoration),C.style.color&&(u=C.style.color),C.style.fontFamily&&(o=C.style.fontFamily),C.style.textAlign&&(a=C.style.textAlign)),i.backgroundColor&&(S=i.backgroundColor))}return s&&s.getItemRenderer()&&s.getItemRenderer()instanceof kb&&(s.getItemRenderer().generator==Hd||s.getItemRenderer().generator==ud)&&(h=!0),u&&(u=N.color2no(u)),o&&(o=m.getFontFamily(o)[0]),-1!=S&&(S=N.color2no(S)),n=r.getXfIndex(n,d,c,_,u,o,e,a,l,h,t,p,g,f,p,g,f,y,b,v,S)},l.prototype._exportExcelCell=function(t,e,i,s,r,n,o,a){n&&this._isSpanCollectionView()?s=this._getCellXfIndex(s,r,n,o,a):-1!=o._xfIdx?s=o._xfIdx:(s=this._getCellXfIndex(s,r,n,o,a),o._xfIdx=s);var l;i=t+i,o&&o.getItemRenderer()&&o.getItemRenderer()instanceof kb&&(l=o.getItemRenderer()),!l||l.generator!=zc&&l.generator!=Rb?l&&l.generator==ce?(t+=o.indexStartNo,null!=o.getSecondLabelFunction()?(r=o.getSecondLabelFunction()(n,t,o),p(r)?a.writeCellBlank(i,e,s):Xa(r)?a.writeCellNumber(i,e,r,s):a.writeCellLabel(i,e,r.toString(),s)):a.writeCellNumber(i,e,t,s)):!l||l.generator!=Hd&&l.generator!=dd?p(r)?a.writeCellBlank(i,e,s):Xa(r)?a.writeCellNumber(i,e,r,s):F(r)?o.getFormatter()?(n=o.getFormatter(),n instanceof jd||n instanceof ae||n instanceof Cd||n instanceof Wd?a.writeCellNumber(i,e,parseFloat(r),s):n instanceof id?(t=Mb.parseWithFormat(r,n.parseFormatString),isNaN(t)?a.writeCellLabel(i,e,r,s):a.writeCellDate(i,e,new Date(t),s)):a.writeCellLabel(i,e,r,s)):a.writeCellLabel(i,e,r,s):dc(r)?a.writeCellDate(i,e,r,s):o.getFormatter()?(n=o.getFormatter(),n instanceof jd||n instanceof ae||n instanceof Cd||n instanceof Wd?a.writeCellNumber(i,e,parseFloat(r),s):n instanceof id?(t=Mb.parseWithFormat(r.toString(),n.parseFormatString),isNaN(t)?a.writeCellLabel(i,e,r.toString(),s):a.writeCellDate(i,e,new Date(t),s)):a.writeCellLabel(i,e,r.toString(),s)):0==isNaN(parseFloat(r))?a.writeCellNumber(i,e,parseFloat(r),s):0==isNaN(Mb.parse(r))?a.writeCellDate(i,e,new Date(Mb.parse(r)),s):a.writeCellLabel(i,e,r.toString(),s):a.writeCellLabel(i,e,this._convertHtmlTag(r),s):a.writeCellBlank(i,e,s)},l.prototype._exportExcelFooterCell=function(t,e,i,s,r,n,o){var a=-1;if(!this.exportOnlyData){var l,h,d,c,a=-1,_=!1,u=!1,p=!1,g=0,f=!1,y=0,b="",v=!1,S=0,C="",I=-1;if(this.getStyle("fontSize")&&(a=parseInt(this.getStyle("fontSize"))),this.getStyle("fontWeight")&&(_=m.isBold(this.getStyle("fontWeight"))),this.getStyle("fontStyle")&&(u="italic"==this.getStyle("fontStyle")),this.getStyle("textDecoration")&&(p="underline"==this.getStyle("textDecoration")),this.getStyle("color")&&(g=this.getStyle("color")),this.getStyle("fontFamily")&&(l=this.getStyle("fontFamily")),this.getStyle("textAlign")&&(h=this.getStyle("textAlign")),c=this._wordWrap,this.getStyle("backgroundColor")&&(I=this.getStyle("backgroundColor")),r&&(r.getStyle("fontSize")&&(a=parseInt(r.getStyle("fontSize"))),r.getStyle("fontWeight")&&(_=m.isBold(r.getStyle("fontWeight"))),r.getStyle("fontStyle")&&(u="italic"==r.getStyle("fontStyle")),r.getStyle("textDecoration")&&(p="underline"==r.getStyle("textDecoration")),r.getStyle("color")&&(g=r.getStyle("color")),r.getStyle("fontFamily")&&(l=r.getStyle("fontFamily")),r.getStyle("textAlign")&&(h=r.getStyle("textAlign")),r.getStyle("backgroundColor"))){var w=N.color2RgbaArr(r.getStyle("backgroundColor"));w&&0<w[3]&&(I=r.getStyle("backgroundColor"))}n&&(n.getStyle("fontSize")&&(a=parseInt(n.getStyle("fontSize"))),n.getStyle("fontWeight")&&(_=m.isBold(n.getStyle("fontWeight"))),n.getStyle("fontStyle")&&(u="italic"==n.getStyle("fontStyle")),n.getStyle("textDecoration")&&(p="underline"==n.getStyle("textDecoration")),n.getStyle("color")&&(g=n.getStyle("color")),n.getStyle("fontFamily")&&(l=n.getStyle("fontFamily")),n.getStyle("textAlign")&&(h=n.getStyle("textAlign")),c=1==n.getWordWrap(),n.getStyle("backgroundColor")&&(I=n.getStyle("backgroundColor"))),this.getStyle("verticalAlign")&&(d=this.getStyle("verticalAlign")),this.getStyle("horizontalGridLines")&&(f=this.getStyle("horizontalGridLines")),this.getStyle("horizontalGridLineColor")&&(y=N.color2no(this.getStyle("horizontalGridLineColor"))),this.getStyle("horizontalGridLineStyle")&&(b=this.getStyle("horizontalGridLineStyle")),this.getStyle("verticalGridLines")&&(v=this.getStyle("verticalGridLines")),this.getStyle("verticalGridLineColor")&&(S=N.color2no(this.getStyle("verticalGridLineColor"))),this.getStyle("verticalGridLineStyle")&&(C=this.getStyle("verticalGridLineStyle")),g&&(g=N.color2no(g)),l&&(l=m.getFontFamily(l)[0]),-1!=I&&(I=N.color2no(I)),a=o.getXfIndex(a,_,u,p,g,l,null,h,d,c,0,f,y,b,f,y,b,v,S,C,I)}t+=i,null==s?o.writeCellBlank(t,e,a):Xa(s)?o.writeCellNumber(t,e,Number(s),a):F(s)?o.writeCellLabel(t,e,s.toString(),a):dc(s)?o.writeCellDate(t,e,s,a):0==isNaN(Number(s))?o.writeCellNumber(t,e,Number(s),a):0==isNaN(Mb.parse(s))?o.writeCellDate(t,e,new Date(Mb.parse(s)),a):o.writeCellLabel(t,e,s.toString(),a)},l.prototype._getFirstChildColumn=function(t){return t.children?this._getFirstChildColumn(t.children[0]):t.column},l.prototype._getChildColumnCount=function(t){var e=0;if(t.children)for(var i=0;i<t.children.length;i++)e+=this._getChildColumnCount(t.children[i]);else this.exportColumns&&0<this.exportColumns.length?0<=Ra.indexOf(this.exportColumns,t.column.colNum)&&(e=1):e=1;return e},l.prototype._exportHeader=function(t,e,i,s,r){var n,o,a,l,h,d,c,_,u;for((l=this.getStyle("headerSeparatorColor"))||(l=this.getStyle("verticalGridLineColor")),l=N.color2no(l||"#AAB3B3"),(h=this.getStyle("headerHorizontalSeparatorColor"))||(h=this.getStyle("horizontalGridLineColor")),h=N.color2no(h||"#AAB3B3"),d=N.color2no(this.getStyle("headerBorderTopColor")||"#555555"),c=N.color2no(this.getStyle("headerBorderBottomColor")||"#999999"),o=this.getSizeStyle("headerBorderTopWidth"),a=this.getSizeStyle("headerBorderBottomWidth"),0<o&&(_=0<this.getSizeStyle("borderTopWidth")?"medium":"thin"),u=0<a?"thin":"none",o=0;o<t.length;o++)if(a=this._getFirstChildColumn(t[o]).colNum,a=0<=a?a:t[o].actualColNum,t[o].children){if(this.exportColumns&&0<this.exportColumns.length)if(0<=Ra.indexOf(this.exportColumns,a))a=Ra.indexOf(this.exportColumns,a);else for(n=0;n<this.exportColumns.length;n++)if(this.exportColumns[n]>=a){a=n;break}n={},n.rowNo=e,n.rowSpan=1,n.colNo=a,n.colSpan=this._getChildColumnCount(t[o]),0!=n.colSpan&&(s.push(n),0==e?this._exportExcelHeader(e,a,n.rowSpan,n.colSpan,t[o].column.getHeaderText()?t[o].column.getHeaderText():t[o].column.getDataField(),t[o].headerItem,t[o].column,r,l,d,h,_,""):this._exportExcelHeader(e,a,n.rowSpan,n.colSpan,t[o].column.getHeaderText()?t[o].column.getHeaderText():t[o].column.getDataField(),t[o].headerItem,t[o].column,r,l,h,h,"",""),this._exportHeader(t[o].children,e+1,i,s,r))}else{if(this.exportColumns&&0<this.exportColumns.length){if(-1==Ra.indexOf(this.exportColumns,a))continue;a=Ra.indexOf(this.exportColumns,a)}1<i-e?(n={},n.rowNo=e,n.rowSpan=i-e,n.colNo=a,n.colSpan=1,s.push(n),this._exportExcelHeader(e,a,n.rowSpan,n.colSpan,t[o].column.getHeaderText()?t[o].column.getHeaderText():t[o].column.getDataField(),t[o].headerItem,t[o].column,r,l,0<e?h:d,c,0<e?"":_,u)):t[o].column.getHeaderColSpan()?(n={},n.rowNo=e,n.rowSpan=1,n.colNo=a,n.colSpan=t[o].column.getHeaderColSpan(),s.push(n),this._exportExcelHeader(e,a,1,n.colSpan,t[o].column.getHeaderText()?t[o].column.getHeaderText():t[o].column.getDataField(),t[o].headerItem,t[o].column,r,l,0<e?h:d,c,0<e?"":_,u)):this._exportExcelHeader(e,a,1,1,t[o].column.getHeaderText()?t[o].column.getHeaderText():t[o].column.getDataField(),t[o].headerItem,t[o].column,r,l,0<e?h:d,c,0<e?"":_,u)}},l.prototype._itemToData=function(t,e,i,s){i=2<arguments.length&&i;var r=this._getHeaderInfo(e);return null!=r.internalLabelFunction&&(t=r.internalLabelFunction(t,e)),t?(r=e.itemToData(t),i&&e.getItemRenderer()&&e.getItemRenderer()instanceof kb&&(e.getItemRenderer().generator==be||e.getItemRenderer().generator==Qb)&&(r=e.dataProviderToLabel(t,r)),r):null},l.prototype._exportOpenChildrenOf=function(t){if(null!=this._exportOpenIterator&&this._isBranch(t)){this._collection.openNode(t);var e,i=0;if(null!=t&&this._rootModel.canHaveChildren(t)&&this._rootModel.hasChildren(t)&&(e=this._getChildren(t,this._exportOpenIterator.getView())),e)for(t=e[i];t;){this._isBranch(t)&&this._exportOpenChildrenOf(t);try{t=e[i++]}catch(s){s instanceof vc&&(t=null)}}}},l.prototype.exportExcelMake=function(t,e){t=0<arguments.length&&t,0!=this._columns.length&&(this._excelExportUtil=e?e:new Ia,this._excelExportUtil.setExportType(this.exportType),this._excelExportUtil.exportSheetName=this.exportSheetName,this._excelExportUtil.exportTxtSeperator=this.exportTxtSeperator,this._excelExportUtil.exportCodePage=this.exportCodePage,this._excelExportUtil.addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeHandler,this),this._exportExcelExportHeader(t))},l.prototype.exportExcel=function(t){0!=this._columns.length&&(this.itemEditorInstance&&this._endEdit("other"),this._excelExportUtil=new Ia,this._excelExportUtil.setExportType(this.exportType),this._excelExportUtil.exportSheetName=this.exportSheetName,this._excelExportUtil.exportTxtSeperator=this.exportTxtSeperator,this._excelExportUtil.exportCodePage=this.exportCodePage,this._excelExportUtil.addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeHandler,this),this._exportExcelExportHeader(!1),this.exportExcelSave(t))},l.prototype._exportExcelExportHeader=function(e){e=0<arguments.length&&e;var i,s,r=[];if(this.exportColumns&&0<this.exportColumns.length){for(this._excelExportUtil.eCols=[],i=0;i<this.exportColumns.length;i++)s=Number(this.exportColumns[i]),r.push(s),this._columns[s]&&this._excelExportUtil.eCols.push(this._columns[s]);this.exportColumns=r}else this._excelExportUtil.eCols=this._columns.slice();if(0!=this._excelExportUtil.eCols.length){for(this.getStyle("fontFamily")&&((i=this.getStyle("fontFamily"))&&(i=m.getFontFamily(i)[0]),this._excelExportUtil.defaultFontName=i),this.getStyle("fontSize")&&(this._excelExportUtil.defaultFontSize=this.getSizeStyle("fontSize")),this.exportTitle&&(this._excelExportUtil.exportTitle=this.exportTitle,this._excelExportUtil.exportTitleHeight=this.exportTitleHeight,this.getStyle("exportTitleAlign")&&(this._excelExportUtil.exportTitleAlign=this.getStyle("exportTitleAlign")),this.getStyle("exportTitleColor")&&(this._excelExportUtil.exportTitleColor=N.color2no(this.getStyle("exportTitleColor"))),this.getStyle("exportTitleFontSize")&&(this._excelExportUtil.exportTitleFontSize=parseInt(this.getStyle("exportTitleFontSize")))),this.exportFooter&&(this._excelExportUtil.exportFooter=this.exportFooter,this._excelExportUtil.exportFooterHeight=this.exportFooterHeight,this.getStyle("exportFooterAlign")&&(this._excelExportUtil.exportFooterAlign=this.getStyle("exportFooterAlign")),this.getStyle("exportFooterColor")&&(this._excelExportUtil.exportFooterColor=N.color2no(this.getStyle("exportFooterColor"))),this.getStyle("exportFooterFontSize")&&(this._excelExportUtil.exportFooterFontSize=parseInt(this.getStyle("exportFooterFontSize")))),this._excelExportUtil.exportFileName=this.exportFileName,this._excelExportUtil.reset(),i=0;i<this._excelExportUtil.eCols.length;i++)this._excelExportUtil.eCols[i]._xfIdx=-1,s=this._excelExportUtil.eCols[i].getVisible(),this.exportColumns&&0<this.exportColumns.length&&(s=!0),this.exportColumnFormat?this._excelExportUtil.writeColumnInfo(i,this._excelExportUtil.eCols[i].getWidth(),s,this._getCellXfIndex(0,"",null,this._excelExportUtil.eCols[i],this._excelExportUtil)):this._excelExportUtil.writeColumnInfo(i,this._excelExportUtil.eCols[i].getWidth(),s);if(this._showHeaders&&(this._excelExportUtil.headerRowCount=Math.max(this._headerRowInfo.length,1),this._exportHeader(this._headerInfos,0,this._excelExportUtil.headerRowCount,this._excelExportUtil.spanedCells,this._excelExportUtil)),this._collection){var n;s=this._rootModel instanceof pb&&this._collection instanceof T;var r=!1,o=this._isSpanCollectionView()||this._rootModel&&U(this._rootModel.cellAttributes);if(s&&(this._rootModel instanceof fa||this._rootModel instanceof ja)&&this._rootModel.grouping&&(r=!0),s){for(r&&(n=this._rootModel.grouping.label),this._excelExportUtil.openNodes=ua.copy(this._collection.openNodes),this._exportOpenIterator=this._collection.createCursor(),this._exportOpenIterator.seek(t.getFIRST());!this._exportOpenIterator.getAfterLast();)this._exportOpenChildrenOf(this._exportOpenIterator.getCurrent()),this._exportOpenIterator.moveNext();this._isSpanCollectionView()&&this._collection.extractAttributes(this,!1)}i=this._collection.createCursor(!0),this._exportExcelExportCollection(i,0,n,s,r,o,e),i.removeListener()}else this._exportExcelExportFooter(0,e)}},l.prototype._exportExcelExportCollection=function(t,e,i,s,r,n,o){o=6<arguments.length&&o;var a,l,h,d,c,_=this,u=_._excelExportUtil.eCols,p=u.length,g=_._excelExportUtil.headerRowCount,m=_._excelExportUtil.spanedCells;c=0;for(var f=e,y=0,b=0,v=!1,S=!1,C=!1,I=Math.round(300/Math.ceil(p/30));!t.getAfterLast();){if(l=t.getCurrent(),a=!0,l||(a=!1),_._showDeletedRows&&(c=_._itemToUID(l),_._changedData[c]&&"D"===_._changedData[c].job&&(a=!1)),a)if(s&&(y=_.getDataProvider().getNodeDepth(l),b=y-1,v=r&&_._isBranch(l),S=l instanceof ic),v)for(c=0;c<p;c++)d=u[c],d.colNum==_.getTreeColumnIndex()?(null!=_._groupLabelFunction?h=_._groupLabelFunction(l,d):null!=i&&l.hasOwnProperty(i)&&(h=l[i]),d._xfIdx=-1,_._exportExcelCell(f,c,g,b,h,l,d,_._excelExportUtil)):_._exportExcelCell(f,c,g,0,_._itemToData(l,d,d.exportWithItemRendererDataProvider,f),l,u[c],_._excelExportUtil);else{if(S&&0!=_._rendererProviders.length){for(c=0;c<p;c++){for(C=!1,d=u[c],a=0;a<_._rendererProviders.length;a++){var w=_._rendererProviders[a];if(w&&w.depth==y&&(w.column==d||w.columnIndex==d.colNum)){l.hasOwnProperty(w.dataField)&&(h=l[w.dataField],_._exportExcelCell(f,c,g,0,h,l,d,_._excelExportUtil),C=!0,0==w.columnSpan||1<w.columnSpan)&&(a={},a.rowNo=f+g,a.rowSpan=1,a.colNo=c,a.colSpan=0==w.columnSpan?u.length-c:w.columnSpan,1<a.colSpan&&m.push(a));break}}C||_._exportExcelCell(f,c,g,0,null,l,d,_._excelExportUtil)}t.moveNext(),f++;continue}for(c=0;c<p;c++)d=u[c],h=_._itemToData(l,d,d.exportWithItemRendererDataProvider,f),_.getTreeColumnIndex()==d.colNum?(d._xfIdx=-1,_._exportExcelCell(f,c,g,b,h,l,d,_._excelExportUtil)):_._exportExcelCell(f,c,g,0,h,l,d,_._excelExportUtil),n&&(d=_._getCellAttribute(l,d.colNum))&&1==d._type&&(1<d.rowSpan||1<d.colSpan)&&(a={},a.rowNo=f+g,a.rowSpan=d.rowSpan,a.colNo=d.colNo,a.colSpan=d.colSpan,m.push(a))}if(t.moveNext(),f++,0==f%I&&(_.dispatchEvent(new cc(cc.PROGRESS,(!1),(!1),f,_._collection.getLength())),o))break}t.getAfterLast()?_._exportExcelExportFooter(f,o):setTimeout(function(){_._exportExcelExportCollection(t,f,i,s,r,n,o)},30)},l.prototype._exportExcelExportFooter=function(t,e){e=1<arguments.length&&e;var i,s,r,n,o,a,l,h=this,d=t,c=0;if(h._showFooters&&h._footers)for(i=0;i<h._footers.length;i++)if(h._footers[i]instanceof Va){if(s=h._footers[i],h.exportColumns&&0<h.exportColumns.length)for(r=[],n=0;n<h.exportColumns.length;n++)o=Number(h.exportColumns[n]),s.getColumns()[o]&&r.push(s.getColumns()[o]);else r=s.getColumns().slice();for(n=0;n<r.length;n++)r[n]instanceof wb&&(o=r[n],a=null,o.getRenderer()&&(l=o.getRenderer(),jc(l,"text")?a=bd(l,"text"):jc(l,"label")&&(a=bd(l,"label"))),h._exportExcelFooterCell(d,n,h._excelExportUtil.headerRowCount,a,s,o,h._excelExportUtil));for(r=h._excelExportUtil.eCols.length;n<r;n++)h._exportExcelFooterCell(d,n,h._excelExportUtil.headerRowCount,null,s,null,h._excelExportUtil);d++,c++}0<h._excelExportUtil.spanedCells.length&&(h._excelExportUtil.mergedCells=h._excelExportUtil.spanedCells),h._excelExportUtil.rowCount=h._showHeaders?h._collection?h._collection.getLength()+h._excelExportUtil.headerRowCount+c:h._excelExportUtil.headerRowCount+c:h._collection?h._collection.getLength()+c:c,h._excelExportUtil.columnCount=h._excelExportUtil.eCols.length,e?(h._excelExportUtil.addEventListener("complete",function(){h._collection&&h._rootModel&&h._collection instanceof T&&h._rootModel instanceof pb&&(h._collection.openNodes=h._excelExportUtil.openNodes,h._isSpanCollectionView()&&h._collection.extractAttributes(h,!1)),h.dispatchEvent(new cc(cc.PROGRESS,(!1),(!1),h._collection.getLength(),h._collection.getLength())),h.dispatchEvent(new J(J.EXPORT_MAKE_COMPLETE))}),h._excelExportUtil.exportExcelMakeCDF(e)):(h._excelExportUtil.exportExcelMakeCDF(),h._collection&&h._rootModel&&h._collection instanceof T&&h._rootModel instanceof pb&&(h._collection.openNodes=h._excelExportUtil.openNodes,h._isSpanCollectionView()&&h._collection.extractAttributes(h,!1)),h.dispatchEvent(new cc(cc.PROGRESS,(!1),(!1),h._collection.getLength(),h._collection.getLength())),h.dispatchEvent(new J(J.EXPORT_MAKE_COMPLETE))),h._exportCSSBuffer=null},l.prototype.exportExcelSave=function(t,e){e=1<arguments.length&&e,this._excelExportUtil&&this._excelExportUtil.getExportBytes()&&(this.itemEditorInstance&&this._endEdit("other"),this._excelExportUtil.addEventListener(J.EXPORT_SAVE_COMPLETE,this._excelExportSaveHandler,this),this._excelExportUtil.addEventListener(J.EXPORT_SAVE_ERROR,this._excelExportSaveHandler,this),this._excelExportUtil.exportExcelSave(t,this.element,e))},l.prototype.exportExcelUpload=function(t,e){e=1<arguments.length&&e,this._excelExportUtil&&this._excelExportUtil.getExportBytes()&&(this.itemEditorInstance&&this._endEdit("other"),this._excelExportUtil.addEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelExportUploadEventHandler,this),this._excelExportUtil.addEventListener(J.EXPORT_UPLOAD_ERROR,this._excelExportUploadEventHandler,this),this._excelExportUtil.exportExcelUpload(t,e))},l.prototype._getRrendererArray=function(){return this._listItems},l.prototype._setHeaderIndex=function(t){this._headerIndex=t},l.prototype._getHeaderIndex=function(){return this._headerIndex},l.prototype._getHeaderInfo=function(t){return this._columnGrouping?this._columnsToInfo[this._itemToUID(t)]:this._headerInfos[t.colNum]},l.prototype._addClipMask=function(t){var e,i=this.getViewMetrics();if(this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(i.bottom-=this._horizontalScrollBar.getMinHeight()),this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(i.right-=this._verticalScrollBar.getMinWidth()),this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(i.right+=this._verticalScrollBar.getMinWidth()),this._listContent.setScrollRect(new zd(0,0,this._unscaledWidth-i.left-i.right,this._listContent.getHeight())),(this._showFootersOffForced||this._showFooters)&&null!=this._footers&&0<this._footers.length)for(t=0;t<this._footers.length;t++)e=this._footers[t],e.setScrollRect(new zd(0,0,this._unscaledWidth-i.left-i.right,e.getHeight()))},l.prototype._removeClipMask=function(){if(!this._listContent||!this._listContent.mask){var t=this._listItems.length-1;if(!(0>t)){var e,i=this._rowInfo[t].height,s=this._rowInfo[t],t=this._listItems[t],r=t.length;for(e=0;e<r;e++){var n=t[e];n instanceof pa?n.getHeight()!=i-(n.getY()-s.y)&&n.setHeight(i-(n.getY()-s.y)):n&&n.mask&&(this._itemMaskFreeList.push(n.mask),n.mask=null)}}}},l.prototype._getMeasuringRenderer=function(t,e,i){var s,r;if(!e){var n;if(0!=this._rendererProviders.length&&(n=this._getRendererDescription(i,t,!1))&&n.getRenderer())return r=n.getRenderer(),s=this._measuringObjects[r.uno],s||(s=n.getRenderer().newInstance(),s.setVisibility(!1),s.setStyleName(t),this._listContent.addChild(s),this._measuringObjects[r.uno]=s),s}return r=this._columnItemRendererFactory(t,e,i),s=this._measuringObjects[r.uno],s||(s=this._columnItemRenderer(t,e,i),s.setVisibility(!1),s.setStyleName(t),this._listContent.addChild(s),this._measuringObjects[r.uno]=s),s},l.prototype._columnItemRendererFactory=function(t,e,i){var s;return!e&&this._rootModel instanceof pb&&t.colNum==this.getTreeColumnIndex()&&(!this._isBranch(i)&&t.getItemRenderer()?s=t.getItemRenderer():this._groupItemRenderer&&(s=this._groupItemRenderer)),s||(e?s=t.getHeaderRenderer()?t.getHeaderRenderer():this._headerRenderer:t.getItemRenderer()&&(s=t.getItemRenderer()),s||(s=this._itemRenderer)),s},l.prototype._columnItemRenderer=function(t,e,i){return t=this._columnItemRendererFactory(t,e,i),e=t.newInstance(),this._itemRendererToFactoryMap[e.uid]=t,e.owner=this,e},l.prototype._columnHeaderWordWrap=function(t){return t?1==t.getHeaderWordWrap()||0!=t.getHeaderWordWrap()&&this._headerWordWrap:this._headerWordWrap},l.prototype._columnWordWrap=function(t){return t?1==t.getWordWrap()||0!=t.getWordWrap()&&this._wordWrap:this._wordWrap},l.prototype._resizeColumn=function(t,e){if(this._visibleColumns&&0!=this._visibleColumns.length){if(e<this._columns[t].getMinWidth()&&(e=this._columns[t].getMinWidth()),"on"==this._horizontalScrollPolicy||"auto"==this._horizontalScrollPolicy)this._columns[t]._setWidthInternal(e),this._columns[t]._explicitWidth=e,this._columns[t]._preferredWidth=e,this._columnsInvalid=!0;else{var i,s=this._visibleColumns.length;for(i=0;i<s&&t!=this._visibleColumns[i].colNum;i++);if(i>=this._visibleColumns.length)return;t=i;var r,n,o=0,a=0,l=0,h=0,d=this._getOptimumColumns();for(i=t+1;i<s;i++)r=d[i].getWidth(),d[i].resizable&&isNaN(d[i]._explicitWidth)?(a+=d[i].getMinWidth(),l+=r):a+=r,o+=r;if(o-a>e-d[t].getWidth()&&l)for(a=d[t].getWidth()-e+l,isNaN(d[t]._explicitWidth)||d[t]._explicitWidth==d[t].getWidth()?d[t]._explicitWidth=e:d[t]._explicitWidth=e*d[t]._explicitWidth/d[t].getWidth(),d[t]._setWidthInternal(e),i=t+1;i<s;i++)d[i].resizable&&isNaN(d[i]._explicitWidth)&&(r=d[i].getWidth()*a/l,r<d[i].getMinWidth()&&(r=d[i].getMinWidth()),d[i].defaultWidth=r*d[i].defaultWidth/d[i].getWidth(),d[i]._setWidthInternal(r),h+=d[i].getWidth(),n=d[i]);else for(a=d[t].getWidth()-e+o,isNaN(d[t]._explicitWidth)||d[t]._explicitWidth==d[t].getWidth()?d[t]._explicitWidth=e:d[t]._explicitWidth=e*d[t]._explicitWidth/d[t].getWidth(),d[t]._setWidthInternal(e),i=t+1;i<s;i++)r=d[i].getWidth()*a/o,r<d[i].getMinWidth()&&(r=d[i].getMinWidth()),isNaN(d[i]._explicitWidth)?d[i].defaultWidth=r*d[i].defaultWidth/d[i].getWidth():d[i]._explicitWidth!=d[i].getWidth()?d[i]._explicitWidth=r*d[i]._explicitWidth/d[i].getWidth():d[i]._explicitWidth=r,d[i]._setWidthInternal(r),h+=d[i].getWidth(),n=d[i];h>a&&.1<h-a?(r=d[t].getWidth()-h+a,r<d[t].getMinWidth()&&(r=d[t].getMinWidth()),d[t]._explicitWidth!=d[t].getWidth()?d[t]._explicitWidth=r*d[t]._explicitWidth/d[t].getWidth():d[t]._explicitWidth=r,d[t]._setWidthInternal(r)):n&&(r=n.getWidth()-h+a,isNaN(n._explicitWidth)?n.defaultWidth=r*n.defaultWidth/n.getWidth():n._explicitWidth!=n.getWidth()?n._explicitWidth=r*n._explicitWidth/n.getWidth():n._explicitWidth=r,n._setWidthInternal(r))}this._itemsSizeChanged=!0,this._updateSubContent(),this.invalidateDisplayList()}else this._columns[t].setWidth(e),this._columns[t]._preferredWidth=e},l.prototype._columnRendererChanged=function(t){var e,i=this._columnItemRendererFactory(t,!0,null);if(this._measuringObjects&&((e=this._measuringObjects[i.uno])&&(e.getParent().removeChild(e),this._measuringObjects[i.uno]=null),i=this._columnItemRendererFactory(t,!1,null),(e=this._measuringObjects[i.uno])&&(e.getParent().removeChild(e),this._measuringObjects[i.uno]=null)),this._freeItemRenderersTable[t.uno]&&(t=this._freeItemRenderersTable[t.uno][t._itemRenderer?t._itemRenderer.uno:null]))for(;t.length;)e=t.pop(),e.getParent().removeChild(e);this._rendererChanged=!0,this.invalidateDisplayList()},l.prototype._super_mouseEventToItemRenderer=function(t){var e,i,s=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;if(s===this._highlightIndicator||s===this._listContent||s===this._listSubContent||s&&("DataGridBackground"===s.className||"DataGridLineH"===s.className||"DataGridLineV"===s.className)){if(i=this._listContent.globalToLocal(v.getEventPageXY(t)),i.x+=this._listSubContent.getScrollRect()?this._listSubContent.getScrollRect().x:0,this._getHeaderVisible()&&(e=this._findHeaderRenderer(i)),e&&s==this._listSubContent&&this._isHeaderItemRenderer(e))return null;e||0==this._rowInfo.length||(e=this._findRenderer(i,this._listItems,this._rowInfo,this._rowInfo[0].y))}return e||(e=this._mouseEventToItemRendererOrEditor(t)),e==this.itemEditorInstance?null:e},l.prototype._mouseEventToItemRenderer=function(t){var e,i=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;return this._columnGrouping?((i===this._highlightIndicator||i===this._listContent||i===this._listSubContent||i&&("DataGridBackground"===i.className||"DataGridLineH"===i.className||"DataGridLineV"===i.className))&&(e=this._listContent.globalToLocal(v.getEventPageXY(t)),e.x+=this._listSubContent.getScrollRect()?this._listSubContent.getScrollRect().x:0,e=this._findHeaderRenderer_ColumnGrouping(e)),e||(e=this._super_mouseEventToItemRenderer(t)),i!==this._listContent&&i!==this._listSubContent||!this._isHeaderItemRenderer(e)?e===this.itemEditorInstance?null:e:null):this._super_mouseEventToItemRenderer(t)},l.prototype._isHeaderItemRenderer=function(t){var e=this._orderedHeadersList?this._orderedHeadersList.length:0,i=V.getUID(t);for(t=0;t<e;t++)if(V.getUID(this._orderedHeadersList[t].headerItem)===i)return!0;return!1},l.prototype._mouseEventToItemRendererOrEditor=function(t){var e=t.target?t.target.selfElement?t.target.selfElement:t.target.parentNode?t.target.parentNode.selfElement:null:null;if(e==this._listContent){t=this._listContent.globalToLocal(new ra(t.pageX,t.pageY));var i,s,r=0==this._rowInfo.length?0:this._rowInfo[0].y,n=this._listItems.length;for(i=0;i<n;i++){if(this._listItems[i].length&&t.y<r+this._rowInfo[i].height){var o=0,a=this._listItems[i].length;for(s=0;s<a;s++){if(t.x<o+this._visibleColumns[s].getWidth())return this._listItems[i][s];o+=this._visibleColumns[s].getWidth()}}r+=this._rowInfo[i].height}}else if(e==this._highlightIndicator)return this._lastHighlightItemRenderer;for(;e&&e!=this;){if(e instanceof qa&&(t=e.getParent(),t==this._listSubContent||t==this._listContent||t instanceof Va)){if(e.getVisible())return e;break}e=e instanceof A?e.owner?e.owner:e.getParent():e.parentNode?e.parentNode.selfElement:null}return null},l.prototype._shiftColumns=function(t,e,i){if(!(0>e||t==e)){var s,r,n;if(this._columnGrouping){n=this._getHeaderInfo(this._movingColumn),this._updateMovingColumnIndex();var o,a,l=n.parent?n.parent.children:this._headerInfos,h=null==n.parent?this._groupedColumns:n.parent.column.children,d=[],c=0;if(0<=e&&t!=e){for(_=t<e?1:-1,s=t;s!=e;s+=_){if(r=s+_,n=h[s],h[s]=h[r],h[r]=n,l[s].actualColNum+=l[r].columnSpan*_,l[r].actualColNum-=l[s].columnSpan*_,l[s].children&&0<l[s].children.length){for(a=l[r].columnSpan*_,o=0;o<l[s].children.length;o++)d.push(l[s].children[o]);for(;d[c];)if(n=d[c++],n.actualColNum+=a,n&&n.children)for(o=0;o<n.children.length;o++)d.push(n.children[o])}if(l[r].children&&0<l[r].children.length){for(d=[],c=0,a=l[s].columnSpan*_,o=0;o<l[r].children.length;o++)d.push(l[r].children[o]);for(;d[c];)if(n=d[c++],n.actualColNum-=a,n&&n.children)for(o=0;o<n.children.length;o++)d.push(n.children[o])}n=l[s],l[s]=l[r],l[r]=n,l[s].index-=_,l[r].index+=_}for(r=this._getLeafColumns(this._groupedColumns),h=r.length,this._columns=[],s=0;s<h;s++)this._columns[s]=r[s],this._columns[s].colNum=s;this._visibleHeaderInfos=this._updateVisibleHeaders(),this._updateHeaderSearchList(),this._createDisplayableColumns(),s=this._getAdjustedLockedCount(this._lockedColumnCountVal),this._lockedColumnCount!=s&&(this._lockedColumnCountChanged=!0,this._setSuperLockedColumnCount(s)),this._itemsSizeChanged=this._columnsInvalid=!0,this.invalidateDisplayList(),this._footers&&this._invalidateListFooters(),s=new ac(ac.HEADER_SHIFT),s.oldIndex=t,s.newIndex=e,s.triggerEvent=i,this.dispatchEvent(s)}}else{var l=this._headerInfos;if(0<=e&&t!=e){var _=t<e?1:-1;for(s=t;s!=e;s+=_)r=s+_,n=this._columns[s],this._columns[s]=this._columns[r],this._columns[r]=n,this._columns[s].colNum=s,this._columns[r].colNum=r,n=l[s],l[s]=l[r],l[r]=n,l[s].index-=_,l[r].index+=_;this._sortIndex==t?this._sortIndex+=e-t:(t<this._sortIndex&&this._sortIndex<=e||e<=this._sortIndex&&this._sortIndex<t)&&(this._sortIndex-=_),this._lastSortIndex==t?this._lastSortIndex+=e-t:(t<this._lastSortIndex&&this._lastSortIndex<=e||e<=this._lastSortIndex&&this._lastSortIndex<t)&&(this._lastSortIndex-=_),this._itemsSizeChanged=this._columnsInvalid=!0,this._visibleHeaderInfos=this._updateVisibleHeaders(),this._updateHeaderSearchList(),this._createDisplayableColumns(),this.invalidateDisplayList(),this._footers&&this._invalidateListFooters(),s=new ac(ac.HEADER_SHIFT),s.oldIndex=t,s.newIndex=e,s.triggerEvent=i,this.dispatchEvent(s)}}this._isCellSelectionMode()&&this._clearSelectedCells()}},l.prototype._setupRendererFromData=function(t,e,i){e.getVisible(),e.setData(i),e instanceof qa&&(null!=i?e.setListData(this._makeListData(i,this._itemToUID(i),0,t.colNum,t)):e.setListData(null)),e instanceof R&&e.invalidateSize(),e.setExplicitWidth(this._getWidthOfItem(e,t,this._currentColNum)),Ba.getInstance().validateClient(e,!0)},l.prototype._commitSelectedIndex=function(e){if(-1!=e){e=Math.min(e,this._collection.getLength()-1);var i=this._iterator.getBookmark(),s=e-this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition());
try{this._iterator.seek(t.getCURRENT(),s)}catch(r){if(r instanceof ca)return this._iterator.seek(i,0),this._bSelectedIndexChanged=!0,void(this._selectedIndex=e)}var s=this._iterator.getCurrent(),n=this._iterator.getBookmark(),o=this._itemToUID(s);this._iterator.seek(i,0),this._selectData(o,s,e,n)}else this._clearSelected();this.dispatchEvent(new w("valueCommit"))},l.prototype._getWidthOfItem=function(t,e,i){if((t=t?this._rendererDescriptionMap[t.uno]:null)&&t.renderer){if(0==t.columnSpan)for(t=this._columns.length,this._visibleColumnIndex<this._lockedColumnCount&&(t=this._lockedColumnCount),e=0,i=this._visibleColumnIndex;i<t;i++)e+=this._columns[i].getWidth();else{e=0,t=this._visibleColumnIndex+t.columnSpan,this._visibleColumnIndex<this._lockedColumnCount&&t>this._lockedColumnCount&&(t=this._lockedColumnCount),t>this._displayableColumns.length&&(t=this._displayableColumns.length);var s=this._getOptimumColumns();for(i=this._visibleColumnIndex;i<t;i++)e+=s[i].getWidth()}return i=this._displayableColumns.length-1,"off"!=this._horizontalScrollPolicy&&i>=this._visibleColumnIndex&&i<t&&(this._getLastColumnResidualWidth(),t=this._displayableColumns[i],e-=t.getWidth(),e+=(isNaN(t._explicitWidth)?t._preferredWidth:t._explicitWidth)+this._getLastColumnResidualWidth()),e}return"off"!=this._horizontalScrollPolicy&&e==this._displayableColumns[this._displayableColumns.length-1]?(isNaN(e._explicitWidth)?e._preferredWidth:e._explicitWidth)+this._getLastColumnResidualWidth():e.getWidth()},l.prototype._getRenderer=function(t,e,i){i=2<arguments.length&&i;var s,r,n=t.uno;return 0!=this._rendererProviders.length&&(r=this._getRendererDescription(e,t,i)),r&&r.renderer?(this._freeItemRenderersTable[n]&&this._freeItemRenderersTable[n][r.renderer.uid]&&this._freeItemRenderersTable[n][r.renderer.uid].length?s=this._freeItemRenderersTable[n][r.renderer.uid].pop():(s=r.renderer.newInstance(),this._itemRendererToFactoryMap[s.uid]=r.renderer),this._rendererDescriptionMap[s.uno]=r,s):(s=this._columnItemRendererFactory(t,!1,e),this.useSameFreeItemRenderersTable&&!t.getItemRenderer()&&(n=-1),this._freeItemRenderersTable[n]&&this._freeItemRenderersTable[n][s.uno]&&this._freeItemRenderersTable[n][s.uno].length?(s=this._freeItemRenderersTable[n][s.uno].pop(),-1==n&&(s.element.className="Kool__DataGridItemRenderer "+t._cssName,s._classStyle=t)):(s=this._columnItemRenderer(t,!1,e),s.setStyleName(t)),s)},l.prototype._addSelectionData=function(t,e){e.data instanceof C||(p(this._firstSelectionData)||(this._firstSelectionData._prevSelectionData=e),e._nextSelectionData=this._firstSelectionData,this._firstSelectionData=e,this._selectedData[t]=e)},l.prototype._clearHighlight=function(t){var e,i;if(this._isCellSelectionMode()&&(e=this._itemToUID(t.getData()),i=this._columnMap[t.name])&&(i=i.colNum,this._drawCellItem(t,this._cellSelectionData[e]&&this._cellSelectionData[e][i],!1,this._caretUID==e&&this._caretColumnIndex==i)),this._isRowSelectionMode()&&(e=this._itemToUID(t.getListData().item),this._drawItem(this._visibleData[e],this.isItemSelected(t.getListData().item),!1,e==this._caretUID),this._itemRendererToIndices(t)&&this._lastHighlightItemIndices&&(e=new L(L.ITEM_ROLL_OUT),e.columnIndex=this._lastHighlightItemIndices.x,e.rowIndex=this._lastHighlightItemIndices.y,e.itemRenderer=this._lastHighlightItemRendererAtIndices,this.dispatchEvent(e),this._lastHighlightItemIndices=null),this._isSpanCollectionView()&&this._isRowSelectionMode()&&this._highlightItemRenderer&&(this._highlightIndicator&&this._highlightIndicator.setVisibility(!1),e=this._itemToUID(t.getData()),e=this._visibleData[e],t&&e&&t!=e&&!this._isHeaderItemRenderer(t)))){t=this._rowMap[t.name].rowIndex;var s=this._getOptimumColumns().length;for(e=0;e<s;e++)i=this._listItems[t][e],this._updateDisplayOfItemRenderer(i)}},l.prototype._addToSelectedCells=function(t,e){var i={rowIndex:t,columnIndex:e};if(!this._isCellAlreadySelected(i)){var s=this._selectedCells;s||(s=[]),s.unshift(i),this._selectedCells=s}},l.prototype._removeFromSelectedCells=function(t,e){var i,s=-1;if(this._selectedCells){for(i=0;i<this._selectedCells.length;i++)if(this._selectedCells[i].rowIndex==t&&this._selectedCells[i].columnIndex==e){s=i;break}-1!=s&&this._selectedCells.splice(s,1)}},l.prototype._setSelectedCells=function(t){var e,i=!0,s=t.length;for(e=0;e<s;e++)if(!this._isCellAlreadySelected(t[e])){var r=this._absoluteToVisibleIndices(t[e].rowIndex,t[e].columnIndex),n=r.rowIndex,r=r.columnIndex;this._listItems[n]&&this._listItems[n][r]?(n=this._listItems[n][r],i?(this._selectCellItem(n,!1,!1),i=!1):this._selectCellItem(n,!1,!0)):(this._addToSelectedCells(t[e].rowIndex,t[e].columnIndex),this._pendingCellSelection.addItem(t[e]),this._cellsWaitingToBeDisplayed=!0)}},l.prototype._commitSelectedIndices=function(e){this._clearSelected();try{this._collectionIterator.seek(t.getFIRST(),0)}catch(i){if(i instanceof ca)return void i.addResponder(new S(this._selectionIndicesPendingResultHandler,this._selectionIndicesPendingFailureHandler,new Xc((!0),0,e,t.getFIRST(),0)))}this._setSelectionIndicesLoop(0,e,!0)},l.prototype._measureHeightOfItemsUptoMaxHeight=function(e,i,s){if(e=0<arguments.length?e:-1,i=1<arguments.length?i:0,s=2<arguments.length?s:-1,!this._columns.length)return this._rowHeight*i;var r,n,o,a,l,h,d=0,c=0,_=this.getSizeStyle("paddingTop"),u=this.getSizeStyle("paddingBottom"),p=this._lockedRowCount;if(this._measuringObjects||(this._measuringObjects={}),this._getHeaderVisible()&&0<i&&-1==e&&(d=this._calculateHeaderHeight(),-1!=s&&d>s))return this._setRowCountInternal(0),0;var g=this._iterator?this._iterator.getBookmark():null,m=null!=this._iterator;if(-1!=e&&this._iterator)try{this._iterator.seek(t.getFIRST(),e)}catch(f){f instanceof ca&&(m=!1)}if(0<this._lockedCount&&this._collectionIterator)try{this._collectionIterator.seek(t.getFIRST(),0)}catch(f){f instanceof ca&&(m=!1)}for(a=0;a<i;a++){if(m)for(h=0<this._lockedCount?this._collectionIterator.getCurrent():this._iterator.getCurrent(),c=0,o=this._columns.length,l=0;l<o;l++)n=this._columns[l],n.getVisible()&&(r=this._getMeasuringRenderer(n,!1,h),this._isSpanCollectionView()?(n=this._setupRendererFromDataForSpan(n,r,h,a,l),c=this._variableRowHeight?0<n?n:Math.max(c,r.getExplicitOrMeasuredHeight()+u+_):Math.max(c,this._rowHeight)):this._setupRendererFromData(n,r,h),c=Math.max(c,this._variableRowHeight?r.getExplicitOrMeasuredHeight()+u+_:this._rowHeight));if(-1!=s&&(d+c>s||!m)){try{this._iterator&&this._iterator.seek(g,0)}catch(f){}return i=a,this._setRowCountInternal(i),d}if(d+=c,this._iterator)try{m=this._iterator.moveNext(),0<p&&(this._collectionIterator.moveNext(),p--)}catch(f){f instanceof ca&&(m=!1)}}if(this._iterator)try{this._iterator.seek(g,0)}catch(f){}return d},l.prototype._resetDragScrolling=function(){0!=this._dragScrollingInterval&&(clearInterval(this._dragScrollingInterval),this._dragScrollingInterval=0)},l.prototype._getItemDepth=function(t,e){return this._collection?(this._iterator||(this._iterator=this._collection.createCursor(!0)),this._getDepth(t)):0},l.prototype._dispatchAdvancedDataGridEvent=function(t,e,i,s,r,n,o){r=!(4<arguments.length)||r,n=!(5<arguments.length)||n,o=!(6<arguments.length)||o;var a;t==K.ITEM_OPENING&&(a=new K(K.ITEM_OPENING,(!1),(!0)),a.opening=r,a.animate=n,a.dispatchEvent=o),a||(a=new K(t)),a.item=e,a.itemRenderer=i,a.triggerEvent=s,this.dispatchEvent(a)},l.prototype._getChildren=function(t,e){return this._collection.getChildren(t)},l.prototype._reconstructDataFromListItems=function(){if(!this._listItems)return[];var t,e,i=[];for(t=0;t<this._listItems.length;t++)if(this._listItems[t]){var s,r=this._listItems[t][0];if(r)for(s=r.getData(),i.push(s),e=0;e<this._listItems[t].length;e++)(r=this._listItems[t][e])&&(r=r.getData(),r!=s&&i.push(r))}return i},l.prototype._getCellAttribute=function(t,e){return U(this._collection.extractAttributes)?this._collection.getCellAttribute(t,e):null},l.prototype._getCellAttributeItem=function(t,e){return U(this._collection.extractAttributes)?U(t.getListData)&&t.getListData()?this._collection.getCellAttribute(t.getListData().item,e):this._collection.getCellAttribute(t.getData(),e):null},l.prototype._getCellAttributeAt=function(t,e){return U(this._collection.extractAttributes)?this._collection.getCellAttributeAt(t,e):null},l.prototype._getRowAttribute=function(t){return U(this._collection.extractAttributes)?this._collection.getRowAttribute(t):null},l.prototype._getRowAttributeAt=function(t){return U(this._collection.extractAttributes)?this._collection.getRowAttributeAt(t):null},l.prototype._getRowAttributeUID=function(t){return U(this._collection.extractAttributes)?this._collection.getRowAttributeUID(t):null},l.prototype._resetSetColumnPreferredWidth=function(){if("balance"==this._lastColumnWidthPolicy&&"off"!=this._horizontalScrollPolicy){var t,e,i=this._displayableColumns.length-1,s=this.getViewMetrics(),s=this._unscaledWidth-s.right-s.left,r=0,n=0,o=-1,a=0,l=Math.max(0,this._lockedColumnCount);if(0<l&&l<this._displayableColumns.length)for(t=0;t<l;t++)s-=this._displayableColumns[t].getWidth();for(0<=i&&(isNaN(this._displayableColumns[i]._explicitWidth)?(r=e=this._displayableColumns[i].defaultWidth,this._displayableColumns[i]._preferredWidth!=e&&(this._displayableColumns[i]._preferredWidth=e,this._displayableColumns[i]._setWidthInternal(e)),this._displayableColumns[i].resizable&&(n+=e)):r=this._displayableColumns[i]._explicitWidth),t=i-1;t>=l;t--){if(isNaN(this._displayableColumns[t]._explicitWidth)?(e=this._displayableColumns[t].defaultWidth,this._displayableColumns[t]._preferredWidth!=e&&(this._displayableColumns[t]._preferredWidth=e,this._displayableColumns[t]._setWidthInternal(e)),this._displayableColumns[t].resizable&&(n+=e)):e=this._displayableColumns[t]._explicitWidth,!(r+e<=s)){o=t;break}r+=e}if(e=Math.max(0,s-r-5),!(o>i-2||0>=e))if(o<l){if(n&&r<=s)for(t=l;t<i;t++)this._displayableColumns[t].resizable&&isNaN(this._displayableColumns[t]._explicitWidth)&&(o=this._displayableColumns[t],e=o.defaultWidth,a=o.getMinWidth(),e-=(r-s)*(n?e/n:e/r),o._preferredWidth=e>a?e:a,o._setWidthInternal(o._preferredWidth))}else{for(t=o+1;t<=i;t++)isNaN(this._displayableColumns[t]._explicitWidth)&&a++;if(!(0>=a))for(e/=a,t=o+1;t<=i;t++)isNaN(this._displayableColumns[t]._explicitWidth)&&(this._displayableColumns[t]._preferredWidth=this._displayableColumns[t].defaultWidth+e),this._displayableColumns[t]._setWidthInternal(this._displayableColumns[t]._preferredWidth)}}},l.prototype._createHScrollColumns=function(){var t,e=0;for(this._hscrollColumns=[0],t=0;t<this._displayableColumns.length;t++)e+=isNaN(this._displayableColumns[t]._explicitWidth)?this._displayableColumns[t]._preferredWidth:this._displayableColumns[t]._explicitWidth,this._hscrollColumns.push(e)},l.prototype._showFilterInstance=function(t){var e,i;this.filterInstance&&this._hideFilterInstance(),e=this.getColumns()[t.columnIndex],e.filterType&&"list"==e.filterType||e.getItemRendererDataProvider()||e.getItemRendererDataProviderField()?this.filterInstance=new qc:this.filterInstance=new ab,this.addChild(this.filterInstance),i=this.getFieldFilterInfo(e),this.filterInstance.setVisible(!0),this.filterInstance.owner=this,this.filterInstance.columnIndex=t.columnIndex,this.filterInstance.dataField=t.dataField,this.filterInstance.setOperator(i?i.operator:""),this.filterInstance.setFilterData(i?i.filterData:""),this.filterInstance.validateNow(),this.filterInstance.setActualSize(this.filterInstance.getExplicitOrMeasuredWidth(),this.filterInstance.getExplicitOrMeasuredHeight()),t=this._getHeaderVisible()&&this._headerRowInfo&&this._headerRowInfo[0]?this._headerRowInfo[0].height:0,e=this._getHeaderInfo(e),e=this._columnGrouping&&this._listSubContent&&this._listSubContent.getScrollRect()?e?e.headerItem.getX()-this._listSubContent.getScrollRect().x+this._listSubContent.getX():0:e?e.headerItem.getX():0,e+this.filterInstance.getWidth()>this._listContent.getWidth()&&(e=this._listContent.getWidth()-this.filterInstance.getWidth()),this.filterInstance.move(e,t),this.filterInstance.focus(),v.documentAddEvent("mousedown",this._filterInstanceMouseDownHandler,this),r.ie8L||v.windowAddEvent("blur",this._filterInstanceBlurHandler,this)},l.prototype._hideFilterInstance=function(t){this.filterInstance&&(this.removeChild(this.filterInstance),this.filterInstance=null,v.documentRemoveEvent("mousedown",this._filterInstanceMouseDownHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._filterInstanceBlurHandler,this))},l.prototype._getRowItemIds=function(t){var e,i="";if(this._listItems[t]&&0<this._listItems[t].length)for(e=1;e<this._listItems[t].length;e++)i+=this._listItems[t][e].name+" ";return i},l.prototype._invalidateColumnRenderers=function(t){var e=this._absoluteToDisplayColumnIndex(t);if(this._listItems&&0<=e)for(t=0;t<this._listItems.length;t++)this._listItems[t]&&this._listItems[t].length&&this._listItems[t][e]&&(this._listItems[t][e].invalidateProperties(),this._listItems[t][e].invalidateDisplayList())},l.prototype._getLastColumnResidualWidth=function(){var t,e=this._displayableColumns.length-1,i=this.getViewMetrics(),i=this._unscaledWidth-i.right-i.left,s=0,r=Math.max(0,this._lockedColumnCount);if("cut"==this._lastColumnWidthPolicy&&!this._displayableColumns[e].resizable)return 0;if(0<r&&r<this._visibleColumns.length)for(t=0;t<r;t++)i-=this._displayableColumns[t].getWidth();for(0<=e&&(s=isNaN(this._displayableColumns[e]._explicitWidth)?this._displayableColumns[e]._preferredWidth:this._displayableColumns[e]._explicitWidth),t=e-1;t>=r&&s+this._displayableColumns[t].getWidth()<=i;t--)s+=this._displayableColumns[t].getWidth();return i-s},l.prototype._createHeaderItems=function(t){var e,i,s,r,n,o,a=0,l=t.length;for(e=0;e<l;e++)if(t[e].visibleChildren&&(n=this._createHeaderItems(t[e].visibleChildren)),s=t[e].column,"off"!=this._horizontalScrollPolicy&&s==this._displayableColumns[this._displayableColumns.length-1]&&(this._lastColumnWidth=(isNaN(s._explicitWidth)?s._preferredWidth:s._explicitWidth)+this._getLastColumnResidualWidth()),r=this._getHeaderRenderer(s,!0),i=this._makeListData(s,this.uid,-1,s.colNum,s),this._rowMap[r.name]=i,r.setData(s),U(r.setListData)&&r.setListData(i),this._headerItemsList.push(r),t[e].headerItem=r,0>=t[e].headerColSpan?r.setVisible(!1):r.setVisible(this._getHeaderVisible()),t[e].visibleChildren)r.setExplicitWidth(n),s.setWidth(n);else if(isNaN(this._lastColumnWidth)||s!=this._displayableColumns[this._displayableColumns.length-1]){if(o=0,1<t[e].headerColSpan)for(i=1;i<t[e].headerColSpan&&e+i<l;i++)t[e+i].visible&&0>=t[e+i].headerColSpan&&(o+=t[e+i].column.getWidth());r.setExplicitWidth(s.getWidth()+o)}else r.setExplicitWidth(this._lastColumnWidth);for(0<this._listContentDocumentFragment.childNodes.length&&this._listContent.element.appendChild(this._listContentDocumentFragment),0<this._listSubContentDocumentFragment.childNodes.length&&this._listSubContent.element.appendChild(this._listSubContentDocumentFragment),e=0;e<l;e++)s=t[e].column,r=t[e].headerItem,r.setStyleName(s),s._addStyleToHeaderItem(r),!this._isMeasuringHeader&&this._columnGrouping&&this._addRendererToContentArea(r,s),0===r.measuredHeight&&r.invalidateSize(),Ba.getInstance().validateClient(r,!0),a=isNaN(this._lastColumnWidth)||s!=this._displayableColumns[this._displayableColumns.length-1]?a+s.getWidth():a+this._lastColumnWidth;return a},l.prototype._calculateColumnSizes=function(){var t,e,i,s=0;if(0==this._columns.length)this._visibleColumns=[];else{if(this._columnsInvalid){if(this._columnsInvalid=!1,this._visibleColumns=[],this._minColumnWidthInvalid){for(t=this._columns.length,e=0;e<t;e++)this._columns[e].setMinWidth(this._minColumnWidth);this._minColumnWidthInvalid=!1}if("off"==this._horizontalScrollPolicy)for(t=this._displayableColumns.length,e=0;e<t;e++)this._visibleColumns.push(this._displayableColumns[e]);else for(t=this._displayableColumns.length,e=0;e<t;e++)if(!(e>=this._lockedColumnCount&&e<this._lockedColumnCount+this.getHorizontalScrollPosition())){if(i=this._displayableColumns[e],i._preferredWidth<i.getMinWidth()&&(i._preferredWidth=i.getMinWidth()),!(s<this._displayWidth)){for(0==this._visibleColumns.length&&this._visibleColumns.push(this._displayableColumns[0]);e<t;)i=this._displayableColumns[e],i.getWidth()!=i._preferredWidth&&i._setWidthInternal(i._preferredWidth),e++;break}this._visibleColumns.push(i),s+=isNaN(i._explicitWidth)?i._preferredWidth:i._explicitWidth,i.getWidth()!=i._preferredWidth&&i._setWidthInternal(i._preferredWidth)}}var r,n;if("off"==this._horizontalScrollPolicy){var o=0;for(n=i=0,t=this._visibleColumns.length,e=0;e<t;e++)this._visibleColumns[e].resizable?isNaN(this._visibleColumns[e]._explicitWidth)?(o++,n+=this._visibleColumns[e].getMinWidth(),i+=this._visibleColumns[e].defaultWidth):n+=this._visibleColumns[e]._explicitWidth:n+=isNaN(this._visibleColumns[e]._explicitWidth)?this._visibleColumns[e].defaultWidth:this._visibleColumns[e]._explicitWidth,s+=isNaN(this._visibleColumns[e]._explicitWidth)?this._visibleColumns[e].defaultWidth:this._visibleColumns[e]._explicitWidth;var a,l=this._displayWidth;if(this._displayWidth>n&&o){for(t=this._visibleColumns.length,e=0;e<t;e++)this._visibleColumns[e].resizable&&!isNaN(this._visibleColumns[e]._explicitWidth)&&this._visibleColumns[e]._explicitWidth!=this._visibleColumns[e].getWidth()&&this._visibleColumns[e]._setWidthInternal(this._visibleColumns[e]._explicitWidth);for(e=0;e<t;e++)this._visibleColumns[e].resizable&&isNaN(this._visibleColumns[e]._explicitWidth)&&(r=this._visibleColumns[e],a=r.defaultWidth,o=r.getMinWidth(),n=a/(i?i:s),n=a-(s-this._displayWidth)*n,r._setWidthInternal(n>o?n:o)),l-=this._visibleColumns[e].getWidth()}else for(t=this._visibleColumns.length,e=0;e<t;e++)r=this._visibleColumns[e],a=isNaN(r._explicitWidth)?r.defaultWidth:r._explicitWidth,n=a/s,n*=this._displayWidth,r._setWidthInternal(n),l-=n;l&&r&&r._setWidthInternal(r.getWidth()+l),this.getHorizontalScrollPosition()&&(this.setMaxHorizontalScrollPosition(0),this._setSuperSuperHorizontalScrollPosition(0))}else{for(s=0,t=this._visibleColumns.length,e=0;e<t;e++){if(s>this._displayWidth){this._visibleColumns.splice(e,this._visibleColumns.length-e);break}s+=isNaN(this._visibleColumns[e]._explicitWidth)?this._visibleColumns[e]._preferredWidth:this._visibleColumns[e]._explicitWidth}if(0!=this._visibleColumns.length){if(e=this._visibleColumns[this._visibleColumns.length-1].colNum+1,s<this._displayWidth&&e<this._displayableColumns.length)for(t=this._displayableColumns.length;e<t&&s<this._displayWidth;e++)i=this._displayableColumns[e],this._visibleColumns.push(i),s+=isNaN(i._explicitWidth)?i._preferredWidth:i._explicitWidth;else if(s<this._displayWidth&&0<this.getHorizontalScrollPosition())for(;s<this._displayWidth&&0<this.getHorizontalScrollPosition()&&(i=this._displayableColumns[this._lockedColumnCount+this.getHorizontalScrollPosition()-1],t=isNaN(i._explicitWidth)?i._preferredWidth:i._explicitWidth,t<this._displayWidth-s);)this._visibleColumns.splice(this._lockedColumnCount,0,i),this._setSuperSuperHorizontalScrollPosition(this.getHorizontalScrollPosition()-1),s+=t;r=this._visibleColumns[this._visibleColumns.length-1],t=isNaN(r._explicitWidth)?r._preferredWidth:r._explicitWidth,n=t+this._displayWidth-s,r==this._displayableColumns[this._displayableColumns.length-1]&&r.resizable&&n>=r.getMinWidth()&&n>t?(r._setWidthInternal(n),this.setMaxHorizontalScrollPosition(this._displayableColumns.length-this._visibleColumns.length)):this._visibleColumns.length==this._displayableColumns.length?(this.setMaxHorizontalScrollPosition(0<n?1:0),this._setSuperSuperHorizontalScrollPosition(0)):this._lockedColumnCount<this._visibleColumns.length?(this.setMaxHorizontalScrollPosition(this._displayableColumns.length-this._visibleColumns.length+1),this._columnGrouping&&this.getHorizontalScrollPosition()>this.getMaxHorizontalScrollPosition()&&this._setSuperSuperHorizontalScrollPosition(this.getMaxHorizontalScrollPosition())):(this.setMaxHorizontalScrollPosition(Math.max(0,this._displayableColumns.length-this._lockedColumnCount+1)),this._setSuperSuperHorizontalScrollPosition(Math.min(this.getHorizontalScrollPosition(),this.getMaxHorizontalScrollPosition())))}}}},l.prototype._updateSubContent=function(){var t,e=0,i=0;if(this._visibleColumns&&this._getOptimumColumns()!=this._visibleColumns){for(t=0;t<this._lockedColumnCount;++t)e+=this._displayableColumns[t].getWidth();if(this._visibleColumns.length>this._lockedColumnCount)for(t=this._lockedColumnCount;t<this._lockedColumnCount+this.getHorizontalScrollPosition();++t)i+=this._displayableColumns[t].getWidth();0==this.getHorizontalScrollPosition()?(this._listSubContent.setScrollRect(null),this._listSubContent.setX(0)):(0<this._lockedColumnCount?this._listSubContent.setX(e):this._listSubContent.setX(0),0<e?this._listSubContent.setScrollRect(new zd(e+i,0,this._listContent.getWidth()-e,this._listContent.getHeight())):this._listSubContent.setScrollRect(new zd(i,0,this._listContent.getWidth(),this._listContent.getHeight())))}else this._listSubContent.setScrollRect(null),this._listSubContent.setX(0)},l.prototype._seekPositionIgnoreError=function(t,e){if(t)try{t.seek(e,0)}catch(i){}},l.prototype._reduceRows=function(t){for(var e;0<=t&&this._rowInfo[t].y>=this._listContent.getHeight();){var i=this._listItems[t].length;for(e=0;e<i;e++)this._addToFreeItemRenderers(this._listItems[t][e]);e=this._rowInfo[t].uid,delete this._visibleData[e],this._removeIndicators(e),this._listItems.pop(),this._rowInfo.pop(),t--}},l.prototype._makeAdditionalRows=function(e){var i;if(this._iterator){i=this._iterator.getBookmark();try{this._iterator.seek(t.getCURRENT(),this._listItems.length-this._lockedRowCount)}catch(s){this._lastSeekPending=new Da(t.getCURRENT(),this._listItems.length-this._lockedRowCount),s.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}}this._makeRowsAndColumns(0,this._rowInfo[e].y+this._rowInfo[e].height,this._listContent.getWidth(),this._listContent.getHeight(),0,e+1),this._seekPositionIgnoreError(this._iterator,i)},l.prototype._adjustSelectionSettings=function(t){this._bSelectionChanged&&(this._bSelectionChanged=!1,this._bSelectedIndicesChanged&&(t||null==this._selectedIndices)&&(this._bSelectedIndexChanged=this._bSelectedIndicesChanged=!1,this._commitSelectedIndices(this._selectedIndices)),this._bSelectedItemChanged&&(t||null==this._selectedItem)&&(this._bSelectedIndexChanged=this._bSelectedItemChanged=!1,this._commitSelectedItem(this._selectedItem)),this._bSelectedItemsChanged&&(t||null==this._selectedItems)&&(this._bSelectedIndexChanged=this._bSelectedItemsChanged=!1,this._commitSelectedItems(this._selectedItems)),this._bSelectedIndexChanged&&(t||-1==this._selectedIndex)&&(this._commitSelectedIndex(this._selectedIndex),this._bSelectedIndexChanged=!1))},l.prototype._getLines=function(){var t=this._listSubContent.getChildByName("lines");return t||(t=new u,t._useDelayInvalidate=!0,t.name="lines",this._listSubContent.addChild(t)),this._listSubContent.setChildIndex(t,this._listSubContent.getNumChildren()-1),t},l.prototype._getLockedContent=function(){var t=this._listContent.getChildByName("lockedContent");return t||(t=new u,t.name="lockedContent",t._useDelayInvalidate=!0,this._listContent.addChild(t)),this._listContent.setChildIndex(t,this._listContent.getNumChildren()-1),t},l.prototype._getLinesBody=function(t,e){var i=t.getChildByName(e);return i||(i=new u,i.name=e,i._useDelayInvalidate=!0,t.addChild(i)),i},l.prototype._updateHeadersList=function(t){var e,i,s=t?t.length:0;for(e=0;e<s;e++)i=t[e],this._orderedHeadersList.push(i),i.visibleChildren&&0<i.visibleChildren.length&&this._updateHeadersList(i.visibleChildren)},l.prototype._measureItems=function(){if(this._itemsNeedMeasurement&&(this._itemsNeedMeasurement=!1,isNaN(this._explicitRowHeight)))if(this._iterator&&0<this._columns.length){this._measuringObjects||(this._measuringObjects={}),this._visibleColumns=this._columns,this._columnsInvalid=!0;var t,e,i,s=this.getSizeStyle("paddingTop"),r=this.getSizeStyle("paddingBottom"),n=this._iterator.getCurrent(),o=0,a=this._columns.length;for(i=0;i<a;i++)e=this._columns[i],e.getVisible()&&(t=this._getMeasuringRenderer(e,!1,n),this._setupRendererFromData(e,t,n),o=Math.max(o,t.getExplicitOrMeasuredHeight()+r+s));this._setRowHeightInternal(Math.max(o,this._cachedPaddingTop+this._cachedPaddingBottom+17))}else this._setRowHeightInternal(this._cachedPaddingTop+this._cachedPaddingBottom+17)},l.prototype._removeOldHeaders=function(){var t;if(this._columnGrouping){if(this.headerItems&&this.headerItems.length)for(;this.headerItems.length;)for(var e=this.headerItems.pop();e.length;)t=e.pop(),t.getParent().removeChild(t)}else{if(this._headerItemsList&&this._headerItemsList.length)for(;this._headerItemsList.length;)t=this._headerItemsList.pop(),t.getParent().removeChild(t);if(this._groupedColumns)for(t=0;t<this._groupedColumns.length;t++)this._groupedColumns[t]instanceof fb&&this._columnGroupRendererChanged(this._groupedColumns[t])}},l.prototype._columnGroupRendererChanged=function(t){var e,i=t.children?t.children.length:0;if(0<i)for(this._columnRendererChanged(t),e=0;e<i;e++)t.children[e]instanceof fb&&this._columnGroupRendererChanged(t.children[e])},l.prototype._updateSortIndexAndDirection=function(){if(this._sortableColumns){if(this.getDataProvider()){var t=this.getDataProvider().getSort();if(t){if(t=t.getFields())if(1!=t.length)this._lastSortIndex=this._sortIndex,this._sortIndex=-1,this._lastSortIndex!=this._sortIndex&&this.invalidateDisplayList();else for(var t=t[0],e=this._columns.length,i=0;i<e;i++)if(this._columns[i].getDataField()==t.name){this._sortIndex=this._columns[i].sortable?i:-1,this._sortDirection=t.descending?"DESC":"ASC";break}}else this._sortIndex=this._lastSortIndex=-1}}else this._lastSortIndex=this._sortIndex,this._sortIndex=-1,this._lastSortIndex!=this._sortIndex&&this.invalidateDisplayList()},l.prototype._createRow=function(t,e,i,s,r){var n;if(e=null,this._itemPending)for(i=this._getOptimumColumns(),s={},n=0;n<i.length;n++)s[i[n].getDataField()]="Data Loading";else s=r?this._iterator.getCurrent():null;for(this._currentColNum=i=0,this._listItems[this._currentRowNum]||(this._listItems[this._currentRowNum]=[],this._isSpanCollectionView()&&this._itemAttributes&&(this._itemAttributes[this._currentRowNum]=[])),r?(e=this._itemToUID(s),this._setupRenderer(s,e)):i=1<this._currentRowNum?this._rowInfo[this._currentRowNum-1].height:this._rowHeight,0<this._listContentDocumentFragment.childNodes.length&&this._listContent.element.appendChild(this._listContentDocumentFragment),0<this._listSubContentDocumentFragment.childNodes.length&&this._listSubContent.element.appendChild(this._listSubContentDocumentFragment),i=this._layoutRow(r,t,i);this._listItems[this._currentRowNum].length>this._currentColNum;)t=this._listItems[this._currentRowNum].pop(),this._addToFreeItemRenderers(t);if(r&&this._variableRowHeight&&(s=Math.ceil(this._calculateRowHeight(s,i,!0)),i!=s&&this._listItems[this._currentRowNum]))for(i=s,s=i-this._cachedPaddingTop-this._cachedPaddingBottom,t=0;t<this._listItems[this._currentRowNum].length;t++)this._listItems[this._currentRowNum][t].setActualSize(this._listItems[this._currentRowNum][t].getWidth(),s);if("top"==this._cachedVerticalAlign)for(t=0;t<this._currentColNum;t++)n=this._listItems[this._currentRowNum][t],n.setY(this._currentItemTop+this._cachedPaddingTop);else if("bottom"==this._cachedVerticalAlign)for(t=0;t<this._currentColNum;t++)n=this._listItems[this._currentRowNum][t],s=n.getExplicitOrMeasuredHeight(),n.setY(this._currentItemTop+i-this._cachedPaddingBottom-Math.min(s,i-this._cachedPaddingTop-this._cachedPaddingBottom));else for(t=0;t<this._currentColNum;t++)n=this._listItems[this._currentRowNum][t],!this._columnGrouping&&this._isSpanCollectionView()&&this._itemAttributes[this._currentRowNum][t]&&(1==this._itemAttributes[this._currentRowNum][t].type||2==this._itemAttributes[this._currentRowNum][t].type)&&this._itemAttributes[this._currentRowNum][t].ca&&1<this._itemAttributes[this._currentRowNum][t].ca.rowSpan?n.setVisibility(!1):(s=(i-this._cachedPaddingBottom-this._cachedPaddingTop-n.getExplicitOrMeasuredHeight())/2,n.setY(this._currentItemTop+this._cachedPaddingTop+Math.max(s,0)));t=null!=this._selectedData[e],s=this._highlightUID==e,n=this._caretUID==e,this._rowInfo[this._currentRowNum]=new we(this._currentItemTop,i,e),r&&this._drawVisibleItem(e,t,s,n),0==i&&(i=this._rowHeight),this._currentItemTop+=i,this._currentRowNum++},l.prototype._moveIterator=function(e){if(this._itemPending)return this._itemPending=!1,!0;if(this._iterator&&e)try{e=this._iterator.moveNext()}catch(i){i instanceof ge?this._itemPending=!0:i instanceof ca&&(this._lastSeekPending=new Da(t.getCURRENT(),0),i.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=e=!1)}return e},l.prototype._removeExtraSeparators=function(t,e,i){for(;i.getNumChildren()>t;)i.removeChildAt(i.getNumChildren()-1),e.pop()},l.prototype._drawVerticalSeparator=function(t,e,i,s,r,n){var o=!1;0<this._lockedColumnCount&&e==this._lockedColumnCount-1&&(o=!0);var a,l="vSeparator"+e,h="vLockedSeparator"+e,d=o?h:l,c=o?"verticalLockedSeparatorSkin":"verticalSeparatorSkin",l=t.getChildByName(l);a=t.getChildByName(h),h=o?a:l,(o=o?l:a)&&t.removeChild(o),!h&&(c=this.getStyle(c))&&(h=new c,h.name=d,h instanceof u&&h.setStyleName(this),t.addChild(h)),h?(t=isNaN(h.measuredWidth)?1:h.measuredWidth,h.setActualSize(t,this._listContent.getHeight()),h.move(r,n)):this._drawVerticalLine(t,e,i,s,r)},l.prototype._drawHeaderBackgroundSkin=function(t){var e=this._displayWidth;null!=this._verticalScrollBar&&"off"==this._horizontalScrollPolicy&&this._getHeaderVisible()&&(e=this.getBorderMetrics(),e=this.getWidth()-(e.left+e.right)),t.setActualSize(e,this._headerRowInfo.length?this._headerRowInfo[0].height:this._headerHeight)},l.prototype._findHeaderRenderer_ColumnGrouping=function(t){for(var e,i,s,r,n=!1,o=this._visibleHeaderInfos;!n;){for(s=o?o.length:0,r=0;r<s;r++)if(e=o[r].headerItem,i=e.getX(),o[r].actualColNum>=this._lockedColumnCount&&(i=this._getAdjustedXPos(e.getX())),t.x>=i&&t.x<i+e.getExplicitOrMeasuredWidth()){if(n=!0,t.y>e.getY()-this._cachedHeaderPaddingTop&&t.y<=e.getY()+e.getHeight()+this._cachedHeaderPaddingTop)return e;if(!(o[r].visibleChildren&&0<o[r].visibleChildren.length))return null;o=o[r].visibleChildren;break}if(!n)break;n=!1}return null},l.prototype._findHeaderRenderer=function(t){var e,i,s,r,n,o=0,a=this.headerItems.length,l=this._getOptimumColumns();for(r=0;r<a;r++){if(this.headerItems[r].length&&t.y<o+this._headerRowInfo[r].height){if(s=this.headerItems[r].length,1==s){e=this.headerItems[r][0];break}for(n=i=0;n<this._lockedColumnCount;n++)if(i+=l[n].getWidth(),t.x<i){e=this.headerItems[r][n];break}if(e)break;for(n=this._lockedColumnCount+this.getHorizontalScrollPosition();n<s;n++)if(i+=l[n].getWidth(),t.x<i){e=this.headerItems[r][n];break}}o+=this._headerRowInfo[r].height}return e},l.prototype._mouseIsUp=function(){v.documentRemoveEvent("mouseup",this._mouseUpHandler,this),v.documentRemoveEvent("selectstart",this._documentSelectStartHandler,this),this._dragEnabled||0==this._dragScrollingInterval||(clearInterval(this._dragScrollingInterval),this._dragScrollingInterval=0)},l.prototype._scrollColumnGroupIfNeeded=function(t,e){var i=this._isColumnFullyVisible(this._displayableColumns[e.actualColNum].colNum);0!=i&&this._scrollToViewColumn(this._displayableColumns[e.actualColNum].colNum,this._displayableColumns[t.actualColNum].colNum,i)},l.prototype._findRenderer=function(t,e,i,s){if(s=3<arguments.length?s:0,t.y<s)return null;var r,n,o,a,l,h,d=e.length,c=this._getOptimumColumns();for(l=0;l<d;l++){if((o=e[l].length)&&t.y<s+i[l].height){if(1==o){(r=e[l][0])&&!r.getVisible()&&this._isSpanCollectionView()&&(n=this._itemAttributes[l][0])&&0<=n.oRno&&(r=e[n.oRno][n.oCno]);break}for(h=a=n=0;h<o;h++)if(this._columnGrouping&&0<this._lockedColumnCount&&0<this.getHorizontalScrollPosition()&&h>=this._lockedColumnCount&&h<this._lockedColumnCount+this.getHorizontalScrollPosition()?a=this._listSubContent.getScrollRect()?this._listSubContent.getScrollRect().x:0:n+=c[h].getWidth(),
t.x<n+a){(r=e[l][h])&&!r.getVisible()&&this._isSpanCollectionView()&&this._itemAttributes[l]&&(n=this._itemAttributes[l][h])&&0<=n.oRno&&(r=e[n.oRno][n.oCno]);break}if(r)break}s+=i[l].height}return r},l.prototype._clearSelectionData=function(){this._selectedData={},this._firstSelectionData=null},l.prototype._clearSelectorColumnSelection=function(){var t;if(this._selectorColumns&&0<this._selectorColumns.length)for(t=0;t<this._selectorColumns.length;t++)this._selectorColumns[t].clearSelection()},l.prototype._removeSelectorColumnSelection=function(t){var e;if(this._selectorColumns&&0<this._selectorColumns.length)for(e=0;e<this._selectorColumns.length;e++)this._selectorColumns[e].removeSelection(t)},l.prototype._adjustScrollPosition=function(){if(!isNaN(this._horizontalScrollPositionPending)){var t=Math.min(this._horizontalScrollPositionPending,this.getMaxHorizontalScrollPosition());this._horizontalScrollPositionPending=NaN,l._super.setHorizontalScrollPosition.call(this,t)}isNaN(this._verticalScrollPositionPending)||(t=Math.min(this._verticalScrollPositionPending,this.getMaxVerticalScrollPosition()),this._verticalScrollPositionPending=NaN,l._super.setVerticalScrollPosition.call(this,t))},l.prototype._makeRowsAndColumnsWithExtraRows=function(t,e){var i,s=this.offscreenExtraRows/2;this._offscreenExtraRowsTop=Math.min(this.offscreenExtraRows/2,this.getVerticalScrollPosition());var r=this._scrollPositionToIndex(this.getHorizontalScrollPosition(),this.getVerticalScrollPosition()-this._offscreenExtraRowsTop);this._seekPositionSafely(r),r=this._iterator.getBookmark(),0<this._offscreenExtraRowsTop&&this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0,!0,this._offscreenExtraRowsTop);var n=this._offscreenExtraRowsTop?this._rowInfo[this._offscreenExtraRowsTop-1].y+this._rowHeight:0;if(i=this._makeRowsAndColumns(0,n,this._listContent.getWidth(),n+this._listContent.getHeightExcludingOffsets(),0,this._offscreenExtraRowsTop),0<s&&!this._iterator.getAfterLast()){var n=0>this._offscreenExtraRowsTop+i.y-1?0:this._rowInfo[this._offscreenExtraRowsTop+i.y-1].y+this._rowInfo[this._offscreenExtraRowsTop+i.y-1].height,o=this._listItems.length;if(i=this._makeRowsAndColumns(0,n,this._listContent.getWidth(),n,0,this._offscreenExtraRowsTop+i.y,!0,s),i.y<s&&(n=this._listItems.length-(o+i.y)))for(s=0;s<n;s++)this._listItems.pop(),this._rowInfo.pop(),this._isSpanCollectionView()&&this._itemAttributes&&this._itemAttributes.pop();this._offscreenExtraRowsBottom=i.y}i=this._listContent.getHeightExcludingOffsets(),this._listContent.topOffset=-this._offscreenExtraRowsTop*this._rowHeight,this._listContent.bottomOffset=0<this._offscreenExtraRowsBottom?this._listItems[this._listItems.length-1][0].getY()+this._rowHeight-i+this._listContent.topOffset:0,this._iteratorValid&&this._iterator.seek(r,0),this._adjustListContent(t,e)},l.prototype._makeRowsAndColumnsWithExtraColumns=function(t,e){var i=this.offscreenExtraColumns/2;this._offscreenExtraColumnsLeft=Math.min(this.offscreenExtraColumns/2,this.getHorizontalScrollPosition());var s=this._scrollPositionToIndex(this.getHorizontalScrollPosition()-this._offscreenExtraColumnsLeft,this.getVerticalScrollPosition());this._seekPositionSafely(s),s=this._iterator.getBookmark(),0<this._offscreenExtraColumnsLeft&&this._makeRowsAndColumns(0,0,0,this._listContent.getHeight(),0,0,!0,this._offscreenExtraColumnsLeft);var r=this._offscreenExtraColumnsLeft?this._listItems[0][this._offscreenExtraColumnsLeft-1].getX()+this.getColumnWidth():0,n=this._makeRowsAndColumns(r,0,r+this._listContent.getWidthExcludingOffsets(),this._listContent.getHeight(),this._offscreenExtraColumnsLeft,0);if(0<i&&!this._iterator.getAfterLast()){var r=0>this._offscreenExtraColumnsLeft+n.x-1?0:this._listItems[0][this._offscreenExtraColumnsLeft+n.x-1].getX()+this.getColumnWidth(),o=this._listItems[0].length,n=this._makeRowsAndColumns(r,0,r,this._listContent.getHeight(),this._offscreenExtraColumnsLeft+n.x,0,!0,i);if(n.x<i&&(o=this._listItems[0].length-(o+n.x)))for(i=0;i<this._listItems.length;i++)for(r=0;r<o;r++)this._listItems[i].pop();this._offscreenExtraColumnsRight=n.x}n=this._listContent.getWidthExcludingOffsets(),this._listContent.leftOffset=-this._offscreenExtraColumnsLeft*this.getColumnWidth(),this._listContent.rightOffset=0<this._offscreenExtraColumnsRight?this._listItems[0][this._listItems[0].length-1].x+this.getColumnWidth()-n+this._listContent.leftOffset:0,this._iterator.seek(s,0),this._adjustListContent(t,e)},l.prototype._removeSelectionData=function(t){var e=this._selectedData[t];this._firstSelectionData==e&&(this._firstSelectionData=e._nextSelectionData),null!=e._prevSelectionData&&(e._prevSelectionData._nextSelectionData=e._nextSelectionData),null!=e._nextSelectionData&&(e._nextSelectionData._prevSelectionData=e._prevSelectionData),delete this._selectedData[t]},l.prototype._destroyRow=function(t,e){var i,s,r=this._rowInfo[t].uid;for(this._removeIndicators(r),i=0;i<e;i++)s=this._listItems[t][i],s.getData()&&delete this._visibleData[r],this._addToFreeItemRenderers(s)},l.prototype._isCellAlreadySelected=function(t){if(!this._selectedCells||!this._selectedCells.length)return!1;var e,i=this._selectedCells.length;for(e=0;e<i;e++)if(this._selectedCells[e].rowIndex==t.rowIndex&&this._selectedCells[e].columnIndex==t.columnIndex)return!0;return!1},l.prototype._calculateSelectedIndexAndItem=function(){var t,e=0;for(t in this._selectedData){e=1;break}e?(this._selectedIndex=this._selectedData[t].index,this._selectedItem=this._selectedData[t].data):(this._selectedIndex=-1,this._selectedItem=null)},l.prototype._setSelectionIndicesLoop=function(e,i,s){for(s=2<arguments.length&&s;i.length;){if(e!=i[0])try{this._collectionIterator.seek(t.getCURRENT(),i[0]-e)}catch(r){if(r instanceof ca)return void r.addResponder(new S(this._selectionIndicesPendingResultHandler,this._selectionIndicesPendingFailureHandler,new Xc(s,e,i,t.getCURRENT(),i[0]-e)))}e=i[0],i.shift();var n=this._collectionIterator.getCurrent();s&&(this._selectedIndex=e,this._selectedItem=n,s=!1),this._addSelectionData(this._itemToUID(n),new Nb(n,e,(!1)))}this._initialized&&this._updateList(),this.dispatchEvent(new w("valueCommit"))},l.prototype._shiftSelectionLoop=function(e,i,s,r,n){var o,a;this._iterator.seek(t.getFIRST(),this._anchorIndex);try{do{if(o=this._iterator.getCurrent(),a=this._itemToUID(o),this._addSelectionData(a,new Nb(o,i,this._approximate)),this._visibleData[a]&&this._drawItem(this._visibleData[a],!0,a==this._highlightUID,!1,r),o===s){this._visibleData[a]&&this._drawItem(this._visibleData[a],!0,a==this._highlightUID,!0,r);break}e?i++:i--}while(e?this._iterator.moveNext():this._iterator.movePrevious())}catch(l){l instanceof ca&&(l.addResponder(new S(this._selectionPendingResultHandler,this._selectionPendingFailureHandler,new ve(e,i,s,r,n,t.getCURRENT(),0))),this._iteratorValid=!1)}try{this._iterator.seek(n,0),this._iteratorValid=!0}catch(l){l instanceof ca&&(this._lastSeekPending=new Da(n,0),l.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)))}},l.prototype._shiftCellSelectionLoop=function(e,i,s,r,n,o,a){n=i<e;var l,h,d=r<s,c=i;try{do{l=this._iterator.getCurrent(),h=this._itemToUID(l);for(var _=r;-1e3<c&&(this._addCellSelectionData(h,_,new ye(l,c,_,(!1))),this._addToSelectedCells(c,_),this._visibleCellRenderers[h]&&this._visibleCellRenderers[h][_.toString()]&&this._visibleCellRenderers[h][_.toString()].getVisible()&&this._drawCellItem(this._visibleCellRenderers[h][_.toString()],!0,h==this._highlightUID&&_==this._highlightColumnIndex,!1,o),_!=s&&-1!=_);)_=d?this._viewDisplayableColumnAtOffset(_,1,-1,!1):this._viewDisplayableColumnAtOffset(_,-1,-1,!1);if(c==e){this._visibleCellRenderers[h]&&this._visibleCellRenderers[h][_.toString()]&&this._drawCellItem(this._visibleCellRenderers[h][_.toString()],!0,h==this._highlightUID&&_==this._highlightColumnIndex,!0,o);break}n?c++:c--}while(n?this._iterator.moveNext():this._iterator.movePrevious())}catch(u){u instanceof ca&&(u.addResponder(new S(this._cellSelectionPendingResultHandler,this._cellSelectionPendingFailureHandler,new Se(c,i,_,r,l,o,a,t.getCURRENT(),0))),this._iteratorValid=!1)}try{this._iterator.seek(a,0),this._iteratorValid=!0}catch(u){u instanceof ca&&(this._lastSeekPending=new Da(a,0),u.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)))}},l.prototype._cellSelectionPendingResultHandler=function(t,e){this._iterator.seek(e.bookmark,e.offset),this._shiftCellSelectionLoop(e.index,e.anchorIndex,e.columnIndex,e.anchorColumnIndex,e.stopData,e.transition,e.placeHolder)},l.prototype._cellSelectionPendingFailureHandler=function(t,e){},l.prototype._flipSortOrder=function(t,e,i){return i.getSort()?(e=this._columns[e],i.getSort().getFields()[this._findSortField(t)].descending=!this._collection.getSort().getFields()[this._findSortField(t)].descending,i.getSort().getFields()[this._findSortField(t)].descending?(e.sortDescending=!0,"DESC"):(e.sortDescending=!1,"ASC")):null},l.prototype._adjustAfterSort=function(){var e,i=0;for(e in this._selectedData)i++;var s=this._anchorBookmark?this._anchorBookmark.getViewIndex():-1;if(0<=s&&(s!=this._anchorIndex||this._collection.getSort())){1==i&&(this._selectedIndex=this._anchorIndex=this._caretIndex=s,this._selectedData[e].index=s),e=this._indexToRow(s),e=Math.min(this.getMaxVerticalScrollPosition(),e);var r=this._indexToColumn(s),r=Math.min(this.getMaxHorizontalScrollPosition(),r),n=this._scrollPositionToIndex(r,e);try{this._iterator.seek(t.getCURRENT(),n-s)}catch(o){if(o instanceof ca)return this._lastSeekPending=new Da(t.getCURRENT(),n-s),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),void(this._iteratorValid=!1)}l._super.setVerticalScrollPosition.call(this,e),"vertical"!=this._listType&&l._super.setHorizontalScrollPosition.call(this,r)}else try{this._iterator.seek(t.getFIRST(),this.getVerticalScrollPosition())}catch(o){if(o instanceof ca)return this._lastSeekPending=new Da(t.getFIRST(),this.getVerticalScrollPosition()),o.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),void(this._iteratorValid=!1)}1<i&&this._commitSelectedItems(this.getSelectedItems())},l.prototype._commitSelectedItem=function(t,e){(e=!(1<arguments.length)||e)&&this._clearSelected(),null!=t&&this._commitSelectedItems([t])},l.prototype._commitSelectedItems=function(e){this._clearSelected();var i=null!=this._collection.getSort();try{this._collectionIterator.seek(t.getFIRST(),0)}catch(s){if(s instanceof ca)return void s.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc(i,0,e,null,0)))}this._setSelectionDataLoop(e,0,i)},l.prototype._setSelectionDataLoop=function(e,i,s){s=!(2<arguments.length)||s;var r;if(s)for(;e.length;){var n=e.pop();r=this._itemToUID(n);try{this._collectionIterator.findAny(n)}catch(o){if(o instanceof ca)return e.push(n),void o.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc(s,0,e,null,0)))}var a=this._collectionIterator.getBookmark().getViewIndex();if(!(0<=a)){try{this._collectionIterator.seek(t.getFIRST(),0)}catch(o){if(o instanceof ca)return void o.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc((!1),0,e,t.getFIRST(),0)))}return e.push(n),void this._setSelectionDataLoop(e,0,!1)}this._addSelectionData(r,new Nb(n,a,(!0))),0==e.length&&(this._selectedIndex=a)}else for(;e.length&&!this._collectionIterator.getAfterLast();){for(r=e.length,a=this._collectionIterator.getCurrent(),n=0;n<r;n++)if(a==e[n]){r=this._itemToUID(a),this._addSelectionData(r,new Nb(a,i,(!1))),e.splice(n,1),0==e.length&&(this._selectedIndex=i,this._selectedItem=a);break}try{this._collectionIterator.moveNext(),i++}catch(o){if(o instanceof ca)return void o.addResponder(new S(this._selectionDataPendingResultHandler,this._selectionDataPendingFailureHandler,new Xc((!1),i,e,t.getCURRENT(),1)))}}this._initialized&&this._updateList(),this.dispatchEvent(new w("valueCommit"))},l.prototype._getItemIndex=function(t){var e=0,i=this._collection.createCursor();do{if(i.getCurrent()===t)break;e++}while(i.moveNext());return e},l.prototype._adjustVerticalScrollPositionDownward=function(e){var i,s,r,n,o=this._iterator.getBookmark(),a=0,l=this.getSizeStyle("paddingTop"),h=this.getSizeStyle("paddingBottom");e=this._rowInfo[e-1].y+this._rowInfo[e-1].height,e=this._listContent.getHeight()-e;var d,c=0;try{this._iterator.getAfterLast()?this._iterator.seek(t.getLAST(),0):d=this._iterator.movePrevious()}catch(_){_ instanceof ca&&(d=!1)}if(!d){this._setSuperVerticalScrollPosition(0);try{this._iterator.seek(t.getFIRST(),0),this._iteratorValid||(this._iteratorValid=!0,this._lastSeekPending=null)}catch(_){if(_ instanceof ca)return this._lastSeekPending=new Da(t.getFIRST(),0),_.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1,this._invalidateList(),!0}return this._updateList(),!0}for(;0<e&&d;){var u;if(d)for(u=this._iterator.getCurrent(),a=0,r=this._columns.length,n=0;n<r;n++)s=this._columns[n],s.getVisible()&&(this._variableRowHeight&&(i=this._getMeasuringRenderer(s,!1,u),this._setupRendererFromData(s,i,u)),a=Math.max(a,this._variableRowHeight?i.getExplicitOrMeasuredHeight()+h+l:this._rowHeight));e-=a;try{d=this._iterator.movePrevious(),c++}catch(_){_ instanceof ca&&(d=!1)}}return 0>e&&c--,this._iterator.seek(o,0),this.setVerticalScrollPosition(Math.max(0,this.getVerticalScrollPosition()-c)),0<c&&!this._variableRowHeight&&this._configureScrollBars(),0<c},l.prototype._drawHorizontalSeparator=function(t,e,i,s,r){var n=!1;0<this._lockedRowCount&&e==this._lockedRowCount-1&&(n=!0);var o,a="hSeparator"+e,l="hLockedSeparator"+e,h=n?l:a,d=n?"horizontalLockedSeparatorSkin":"horizontalSeparatorSkin",a=t.getChildByName(a);o=t.getChildByName(l),l=n?o:a,(n=n?a:o)&&t.removeChild(n),!l&&(d=this.getStyle(d))&&(l=new d,l.name=h,l instanceof u&&l.setStyleName(this),t.addChild(l)),l?(t=isNaN(l.measuredHeight)?1:l.measuredHeight,l.setActualSize(this._displayWidth,t),l.move(0,r)):this._drawHorizontalLine(t,e,i,s,r)},l.prototype._validateGroupedColumns=function(t){var e,i={},s=[];for(e=0;e<t.length;e++)s.push(t[e]);for(;0<s.length;){if(e=s.shift(),t=this._itemToUID(e),null!=i[t])throw Error(B.getString("datamanagement","repeatColumnsNotAllowed"));if(i[t]=e,e instanceof fb&&(t=e,t.children))for(e=0;e<t.children.length;e++)s.push(t.children[e])}return!0},l.prototype._initializeGroupedHeaderInfo=function(t,e,i,s){var r,n,o,a,l=[];for(o=0;o<t.length;o++)r=new Te(t[o],e,o,i),n=this._itemToUID(t[o]),this._columnsToInfo[n]=r,t[o].owner=this,r.internalLabelFunction=s,this._selectedHeaderInfo&&this._selectedHeaderInfo.column==t[o]&&(this._selectedHeaderInfo=r),t[o]instanceof fb&&t[o].children&&0<t[o].children.length&&((t[o].getDataField()||t[o].getLabelFunction()||s)&&(a=null==s?function(t,e){return e.owner._getHeaderInfo(e).parent.column.itemToData(t)}:function(t,e){var i=e.owner._getHeaderInfo(e).parent,s=i.column,i=i.internalLabelFunction(t,i.column);return s.itemToData(i)}),r.children=this._initializeGroupedHeaderInfo(t[o].children,r,i+1,a)),l.push(r);return l},l.prototype._getLeafColumns=function(t){for(var e=0;e<t.length;)if(t[e]instanceof fb&&t[e].children&&0<t[e].children.length){var i=t.slice(0,e),s=t.slice(e+1),i=i.concat(this._getLeafColumns(t[e].children));t=i.concat(s),e=i.length}else e++;return t},l.prototype._measureHeaderHeights=function(t,e){var i,s=0,r=this._cachedHeaderPaddingTop+this._cachedHeaderPaddingBottom,n=t.length;for(i=0;i<n;i++){var o=this._explicitHeaderHeight?this._headerHeight:t[i].headerItem.getExplicitOrMeasuredHeight()+r;t[i].visibleChildren&&(o+=this._measureHeaderHeights(t[i].visibleChildren,e+1)),s=Math.max(s,o)}return this._headerRowInfo[e]||(this._headerRowInfo[e]=new we(0,0,this.uid)),this._headerRowInfo[e].height=Math.max(this._headerRowInfo[e].height,s),this._headerRowInfo[e].height},l.prototype._layoutHeaders=function(t,e,i,s){var r=e,n=this._cachedHeaderPaddingTop+this._cachedHeaderPaddingBottom,o=t.length;for(this._headerRowInfo[s].y=i,e=0;e<o;e++){t[e].headerItem.move(r,i+this._cachedHeaderPaddingTop);var a=t[e].headerItem.getHeight();t[e].visibleChildren&&this._layoutHeaders(t[e].visibleChildren,r,i+a+n,s+1),r=1!=t[e].headerColSpan?r+t[e].column.getWidth():r+t[e].headerItem.getExplicitOrMeasuredWidth()}},l.prototype._updateMovingColumnIndex=function(){if(this._movingColumnIndex=-1,this._movingColumn){var t,e=this._orderedHeadersList?this._orderedHeadersList.length:0;for(t=0;t<e;t++)if(this._orderedHeadersList[t].column==this._movingColumn){this._movingColumnIndex=t;break}}},l.prototype._getAdjustedLockedCount=function(t){return this._visibleHeaderInfos&&(t=Math.min(t,this._visibleHeaderInfos.length),this._visibleHeaderInfos[t-1])?this._visibleHeaderInfos[t-1].actualColNum+this._visibleHeaderInfos[t-1].columnSpan:0},l.prototype._setEditedItemPosition=function(t){this._bEditedItemPositionChanged=!0,this._proposedEditedItemPosition=t,this.invalidateDisplayList()},l.prototype._commitEditedItemPosition=function(t){if(this._enabled&&this._editable.length)if(this.itemEditorInstance&&t&&this.itemEditorInstance instanceof A&&this._editedItemPosition.rowIndex==t.rowIndex&&this._editedItemPosition.columnIndex==t.columnIndex)this.itemEditorInstance.focus();else{if(this.itemEditorInstance){var e;if(e=t?this._editedItemPosition&&t.rowIndex!=this._editedItemPosition.rowIndex?"newRow":"newColumn":"other",!this._endEdit(e)&&"other"!=e)return}if((this._editedItemPosition=t)&&!this._dontEdit){t=this._adjustItemPosition(t);var i;this._listItems[this._actualRowIndex]&&this._listItems[this._actualRowIndex][this._actualColIndex]&&(i=this._listItems[this._actualRowIndex][this._actualColIndex]),i?(e=new K(K.ITEM_EDIT_BEGIN,(!1),(!0)),e.columnIndex=this._displayableColumns[t].colNum,e.rowIndex=this._editedItemPosition.rowIndex,e.itemRenderer=i,this.dispatchEvent(e),this._lastEditedItemPosition=this._editedItemPosition,this._bEditedItemPositionChanged&&(this._bEditedItemPositionChanged=!1,this._commitEditedItemPosition(this._proposedEditedItemPosition),this._proposedEditedItemPosition=void 0),this.itemEditorInstance||this._commitEditedItemPosition(null)):this._commitEditedItemPosition(null)}}},l.prototype._adjustItemPosition=function(t){var e,i=t.rowIndex,s=t.columnIndex;if(this._displayableColumns.length!=this._columns.length){for(e=0;e<this._displayableColumns.length;e++)if(this._displayableColumns[e].colNum>=s){s=e;break}e==this._displayableColumns.length&&(s=0)}e=!1,this._isRowSelectionMode()?this._selectedIndex!=t.rowIndex&&(this._commitSelectedIndex(t.rowIndex),e=!0):this._isCellAlreadySelected(t)||(this._clearSelectedCells(),this._setSelectedCells([t]),e=!0);var r=this._lockedRowCount,n=this.getVerticalScrollPosition()+this._listItems.length-1,o=this._rowInfo[this._listItems.length-1].y+this._rowInfo[this._listItems.length-1].height>this._listContent.getHeight()?1:0;if(i>r){if(i<this.getVerticalScrollPosition()+r)this.setVerticalScrollPosition(i-r);else for(;(i>n||i==n&&i>this.getVerticalScrollPosition()+r&&o)&&this.getVerticalScrollPosition()!=this.getMaxVerticalScrollPosition();)this.setVerticalScrollPosition(Math.min(this.getVerticalScrollPosition()+(i>n?i-n:o),this.getMaxVerticalScrollPosition())),n=this.getVerticalScrollPosition()+this._listItems.length-1,o=this._rowInfo[this._listItems.length-1].y+this._rowInfo[this._listItems.length-1].height>this._listContent.getHeight()?1:0;this._actualRowIndex=i-this.getVerticalScrollPosition()}else i==r&&this.setVerticalScrollPosition(0),this._actualRowIndex=i;if(i=this.getHorizontalScrollPosition()+this._visibleColumns.length-1,r=this._getHeaderInfo(this._visibleColumns[this._visibleColumns.length-1]),r=Math.round(r.headerItem.getX()+r.column.getWidth())>this._listContent.getWidth()?1:0,s>this._lockedColumnCount){if(s<this.getHorizontalScrollPosition()+this._lockedColumnCount)this.setHorizontalScrollPosition(s-this._lockedColumnCount);else for(;(s>i||s==i&&s>this.getHorizontalScrollPosition()+this._lockedColumnCount&&r)&&this.getHorizontalScrollPosition()!=this.getMaxHorizontalScrollPosition();)this.setHorizontalScrollPosition(Math.min(this.getHorizontalScrollPosition()+(s>i?s-i:r),this.getMaxHorizontalScrollPosition())),i=this.getHorizontalScrollPosition()+this._visibleColumns.length-1,r=this._getHeaderInfo(this._visibleColumns[this._visibleColumns.length-1]),r=r.headerItem.getX()+r.headerItem.getWidth()>this._listContent.getWidth()?1:0;this._actualColIndex=this._absoluteToVisibleColumnIndex(this._displayToAbsoluteColumnIndex(s))}else s==this._lockedColumnCount&&this.setHorizontalScrollPosition(0),this._actualColIndex=s;var a;return this._listItems[this._actualRowIndex]&&this._listItems[this._actualRowIndex][this._actualColIndex]&&(a=this._listItems[this._actualRowIndex][this._actualColIndex]),a?(e&&(e=new L(L.CHANGE),e.columnIndex=t.columnIndex,e.rowIndex=t.rowIndex,e.itemRenderer=a,this.dispatchEvent(e)),s):-1},l.prototype._loseFocus=function(){this._setEditedItemPosition(null),this._losingFocus=!0,this.focus()},l.prototype._findNextEnterItemRenderer=function(t){if(I(this._proposedEditedItemPosition)){this._editedItemPosition=this._lastEditedItemPosition;for(var e=this._editedItemPosition.rowIndex,i=this._editedItemPosition.columnIndex,s=e;;){if(s+=t.shiftKey?-1:1,!(s<this._collection.getLength()&&0<=s)){this._setEditedItemPosition(null),this._loseFocus();break}e=s;var r=this._rowNumberToData(s);if(null==r){this._setEditedItemPosition(null),this._loseFocus();break}if(this._isDataEditable(r)&&(r=new K(K.ITEM_EDIT_BEGINNING,(!1),(!0)),r.columnIndex=i,r.dataField=this._columns[i].getDataField(),r.rowIndex=e,r.triggerEvent=t,this.dispatchEvent(r),!r.defaultPrevented))break}}},l.prototype._findNextItemRenderer=function(t){if(!this._lastEditedItemPosition)return!1;if(!this._editable.length)return this._loseFocus(),!1;if(!I(this._proposedEditedItemPosition))return!1;this._editedItemPosition=this._lastEditedItemPosition;for(var e,i=this._editedItemPosition.rowIndex,s=this._editedItemPosition.columnIndex,r=!1,n=t.shiftKey?-1:1,o=this._collection.getLength()-1,a=this._editedItemPosition.rowIndex;!r;){if(s+=n,(s>=this._columns.length||0>s)&&(s=0>s?this._columns.length-1:0,i+=n,i>o||0>i))return this.endEditOnBlur&&this._loseFocus(),!1;e=this._absoluteToVisibleIndices(i,s);var l=e.rowIndex,h=e.columnIndex;if(!(-1<h&&(l==this._listItems.length?--l:-1==l&&(l=0),e=null,this._listItems[l]&&this._listItems[l][h]&&(e=this._listItems[l][h]),e&&!e.getVisible()))){if(l=this._rowNumberToData(i),null==l)return!0;this._isDataEditable(l)&&this._columns[s].editable&&this._columns[s].getVisible()&&(r=!0,l=i==a?"newColumn":"newRow",!this.itemEditorInstance||this._endEdit(l))&&(l=new K(K.ITEM_EDIT_BEGINNING,(!1),(!0)),l.columnIndex=s,l.dataField=this._columns[s].getDataField(),l.rowIndex=i,l.triggerEvent=t,this.dispatchEvent(l),l.defaultPrevented&&(r=!1))}}return r},l.prototype._findStringLoop=function(e,i,s,r){for(;s!=r;s++){var n=this._itemToLabel(this._iterator.getCurrent()),n=n.substring(0,e.length);if(e==n||e.toUpperCase()==n.toUpperCase())return this._iterator.seek(i,0),this._scrollToIndex(s),this._commitSelectedIndex(s),e=this.indexToItemRenderer(s),i=this._itemRendererToIndices(e),s=new L(L.CHANGE),s.itemRenderer=e,i&&(s.columnIndex=i.x,s.rowIndex=i.y),this.dispatchEvent(s),!0;try{var o=this._iterator.moveNext()}catch(a){if(a instanceof ca)return a.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getCURRENT(),1,s+1,r))),this._iteratorValid=!1}if(!o&&r!=this._collection.getLength()){s=-1;try{this._iterator.seek(t.getFIRST(),0)}catch(a){if(a instanceof ca)return a.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,r))),this._iteratorValid=!1}}}return this._iterator.seek(i,0),this._iteratorValid=!0,!1},l.prototype._seekNextSafely=function(e,i){try{e.moveNext()}catch(s){this._lastSeekPending=new Da(t.getFIRST(),i),s.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}return this._iteratorValid},l.prototype._seekPreviousSafely=function(e,i){try{e.movePrevious()}catch(s){this._lastSeekPending=new Da(t.getFIRST(),i),s.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}return this._iteratorValid},l.prototype._getIndent=function(){var t,e=0;for(t in this._collection.getOpenNodes())e=Math.max(this._getItemDepth(this._collection.getOpenNodes()[t],0),e);return e*this.getStyle("indentation")},l.prototype._isSpanCollectionView=function(){return this._collection&&U(this._collection.extractAttributes)},l.prototype._cellFormatString=function(t,e){if(p(t))return"";if(!e)return F(t)?t:t.toString();var i,s;return 0<=e.toUpperCase().indexOf("YY")||0<=e.toUpperCase().indexOf("MM")||0<=e.toUpperCase().indexOf("DD")?(this._cellDateFormatter.formatString=e,F(t)?(i=t,0<i.indexOf("-")?i=i.replace(/-/g,"/"):0<i.indexOf(".")&&(i=i.replace(/\./g,"/")),i=this._cellDateFormatter.format(i)):i=this._cellDateFormatter.format(t),s=this._cellDateFormatter.error):e.match(/^((\#\,\#\#0)|0)(\.0+)?$/)?(0<=e.indexOf(",")?this._cellNumberFormatter.useThousandsSeparator=!0:this._cellNumberFormatter.useThousandsSeparator=!1,i=e.indexOf("."),this._cellNumberFormatter.precision=0<=i?e.length-i-1:0,i=this._cellNumberFormatter.format(t),s=this._cellNumberFormatter.error):e.match(/^((\#\,\#\#0)|0)(\.0+)?([^\#0-9]+)$/)?(s=/^((\#\,\#\#0)|0)(\.0+)?([^\#0-9]+)$/g.exec(e),0<=e.indexOf(",")?this._cellCurrencyFormatter.useThousandsSeparator=!0:this._cellCurrencyFormatter.useThousandsSeparator=!1,i=e.indexOf("."),this._cellCurrencyFormatter.precision=0<=i?e.length-i-this._cellCurrencyFormatter.currencySymbol.length-1:0,this._cellCurrencyFormatter.alignSymbol="right",this._cellCurrencyFormatter.currencySymbol=s[s.length-1],i=this._cellCurrencyFormatter.format(t),s=this._cellCurrencyFormatter.error):e.match(/^([^\#0-9]+)((\#\,\#\#0)|0)(\.0+)?$/)&&(s=/^([^\#0-9]+)((\#\,\#\#0)|0)(\.0+)?$/g.exec(e),0<=e.indexOf(",")?this._cellCurrencyFormatter.useThousandsSeparator=!0:this._cellCurrencyFormatter.useThousandsSeparator=!1,i=e.indexOf("."),this._cellCurrencyFormatter.precision=0<=i?e.length-i-1:0,this._cellCurrencyFormatter.alignSymbol="left",this._cellCurrencyFormatter.currencySymbol=s[1],i=this._cellCurrencyFormatter.format(t),s=this._cellCurrencyFormatter.error),s?F(t)?t:t.toString():i},l.prototype._getDataRowNo=function(t){return 0<this._lockedRowCount&&t<this._lockedRowCount?t:this.getVerticalScrollPosition()+t},l.prototype._buildUpCollectionEvents=function(e){var i=[],s=[],r=[],n=this._collection.createCursor(),o=this._collection.getLength()-1;n.seek(t.getLAST());do{if(n.getCurrent()===this._expandedItem)break;o--}while(n.movePrevious());if(e){if(e=this._getChildren(this._expandedItem,this._iterator.getView()),!e)return[];for(n=e.createCursor();!n.getAfterLast();){i.push(void 0);try{n.moveNext()}catch(a){if(a instanceof ca)break}}}else for(var n=[],l=0,n=this._getOpenChildrenStack(this._expandedItem,n);l<n.length;){var h=this.getSelectedItems();for(e=0;e<h.length;e++)h[e]==n[l]&&(this._bSelectedItemRemoved=!0);s.push(n[l]),l++}return 0<i.length&&(e=new y(y.COLLECTION_CHANGE),e.kind="add",e.location=o+1,e.items=i,r.push(e)),0<s.length&&(e=new y(y.COLLECTION_CHANGE),e.kind="remove",e.location=o,e.items=s,r.push(e)),r},l.prototype._getOpenChildrenStack=function(t,e){var i;if(null==t)return e;if(i=this._getChildren(t,this._iterator.getView()),!i)return[];for(var s=i.createCursor();!s.getAfterLast();){i=s.getCurrent(),e.push(i),this._isBranch(i)&&this.isItemOpen(i)&&this._getOpenChildrenStack(i,e);try{s.moveNext()}catch(r){if(r instanceof ca)break}}return e},l.prototype._getItemAttribute=function(t,e){var i;return this._itemAttributes[t]&&(i=this._itemAttributes[t][e]),i},l.prototype._getItemAttributeInVisibleColumns=function(t,e){var i=this._getOptimumColumns();if(i==this._visibleColumns)return this._getItemAttribute(t,e);var s,r=i.length;for(s=0;s<r;s++)if(i[s].colNum===this._visibleColumns[e].colNum)return this._getItemAttribute(t,s);return null},l.prototype._getVisibleColumnX=function(t){return 0==this.getHorizontalScrollPosition()?this._getHeaderInfo(this._visibleColumns[t]).headerItem.getX():0<this._lockedColumnCount?t<this._lockedColumnCount?this._getHeaderInfo(this._visibleColumns[t]).headerItem.getX():this._columnGrouping&&this._listSubContent?this._getHeaderInfo(this._visibleColumns[t]).headerItem.getX()-this._listSubContent.getScrollRect().x+this._listSubContent.getX():this._getHeaderInfo(this._visibleColumns[t]).headerItem.getX():this._getHeaderInfo(this._visibleColumns[t]).headerItem.getX()-this._getHeaderInfo(this._visibleColumns[0]).headerItem.getX()},l.prototype._setItemVisibleAndY=function(){if(!(null==this._listItems||0>=this._listItems.length)){var t,e,i,s=this._getOptimumColumns(),r=s.length,n=this._listItems.length,o=this._listContent.getHeight();for(e=0;e<n;e++)if(this._itemAttributes[e]&&0!=this._itemAttributes[e].length)for(i=0;i<r;i++){var a=this._listItems[e][i];if(t=this._itemAttributes[e][i],a&&t&&t.ca){t.vi&&a.getVisible()!=t.vi&&this._updateDisplayOfItemRenderer(a),a.setVisible(t.vi),t.rh=this._rowInfo[e].height,1<t.type&&(a.setData(t.ca._oItem),a.getListData().ouid=this._itemToUID(t.ca._oItem));var l=this._itemToUID(t.ca._oItem),h=s[i].colNum;if(2===t.type&&this._isCellSelectionMode()){var d=this._currentColNum;this._currentColNum=i,this._setVisibleDataItem(l,a),this._currentColNum=d}if(1===t.type||2===t.type){var c,_=0,d=e+t.ca.rowSpan-t.ca._rowGap;for(c=e;c<d&&!(this._listItems[c]&&(_+=this._rowInfo[c].height,0<this._lockedRowCount&&c==this._lockedRowCount-1));c++);_=Math.min(_,o-this._rowInfo[e].y),1<t.ca.rowSpan&&("bottom"==this._cachedVerticalAlign?a.setY(Math.ceil(this._rowInfo[e].y+_-this._cachedPaddingBottom-a.getExplicitOrMeasuredHeight())):"top"!=this._cachedVerticalAlign&&(a.getVisibility()||a.setVisibility(!0),a.setY(Math.ceil(this._rowInfo[e].y+(_-a.getExplicitOrMeasuredHeight())/2))),t.rh=_,a.getY()<this._rowInfo[e].y&&a.setY(this._rowInfo[e].y),t.w&&t.h&&a.setActualSize(t.w,t.h)),this._isCellSelectionMode()&&(this._cellSelectionIndicators[l]&&this._cellSelectionIndicators[l][h]?this._cellSelectionIndicators[l][h].getHeight()!=t.rh&&this._cellSelectionIndicators[l][h].setHeight(t.rh):this._cellSelectionData[l]&&this._cellSelectionData[l][h]&&(this._cellSelectionIndicators[a.getListData().uid]||(this._cellSelectionIndicators[a.getListData().uid]={}),l=new A("div","DataGridBackground"),this._cellSelectionIndicators[a.getListData().uid][h]=l,this._addIndicatorToSelectionLayer(l,a.getX()),this._drawSelectionIndicator(l,a.getX(),this._rowInfo[a.getListData().rowIndex].y,a.getWidth(),t.rh,this.getEnabled()?this.getStyle("selectionColor"):this.getStyle("selectionDisabledColor"),a)),a===this._highlightItemRenderer&&this._highlightIndicator.getHeight()!=t.rh&&this._highlightIndicator.setHeight(t.rh)),this._isRowSelectionMode()&&this._highlightUID===a.getListData().uid&&this._clearHighlight(a)}3===t.type&&(this._isCellSelectionMode()&&(this._cellSelectionIndicators[a.getListData().uid]&&this._cellSelectionIndicators[a.getListData().uid][h]&&this._removeCellIndicators(a.getListData().uid,h),a===this._highlightItemRenderer&&this._clearHighlight(a)),this._isRowSelectionMode()&&this._highlightUID===a.getListData().uid&&this._clearHighlight(a))}}this._needResetCellY=this._calledSetItemVisible=!0}},l.prototype._makeItemAttributes=function(t,e){e=1<arguments.length?e:0;var i,s,r=this._getOptimumColumns(),n=r.length;for(i=e;i<t;i++)if(this._itemAttributes[i]&&0!=this._itemAttributes[i].length)for(s=0;s<n;s++){
var o=this._itemAttributes[i][s];if(o.ca&&(1==o.ca._type?(o.type=1,o.vi=!0):i-e==this._lockedRowCount&&1<o.ca.rowSpan&&o.ca.colNo==r[s].colNum||s==this._lockedColumnCount&&1<o.ca.colSpan&&0==o.ca._rowGap||i-e==this._lockedRowCount&&s==this._lockedColumnCount?(o.type=2,o.ra=this._getRowAttribute(o.ca._oItem),o.vi=!0):(o.type=3,o.ra=this._getRowAttribute(o.ca._oItem),o.vi=!1),1==o.type||2==o.type)){for(var a,l,h=i+o.ca.rowSpan-o.ca._rowGap,d=s+o.ca.colSpan-(r[s].colNum-o.ca.colNo)-(r[s+o.ca.colSpan-1]?r[s+o.ca.colSpan-1].colNum-r[s].colNum+1-o.ca.colSpan:0),o=i;o<h&&o<t;o++){for(a=s;a<d&&!(a>=n)&&!(this._itemAttributes[o]&&0!=this._itemAttributes[o].length&&(l=this._itemAttributes[o][a])&&(l.oRno=i,l.oCno=s,l.vl=!1,l.hl=o==h-1||0<this._lockedRowCount&&o-e==this._lockedRowCount-1||o==t-1,0<this._lockedColumnCount&&a==this._lockedColumnCount-1));a++);if(l&&(l.vl=!0),0<this._lockedRowCount&&o==this._lockedRowCount-1)break}l&&(l.hl=!0)}}},l.prototype._getRowSpanHeight=function(t,e,i,s){i=2<arguments.length?i:0,s=3<arguments.length&&s;var r,n=this._getOptimumColumns(),o=0,a=0,l=0,h=0,d=this._cachedPaddingTop+this._cachedPaddingBottom;for(r=0;r<n.length;r++)this._itemAttributes[t]&&this._itemAttributes[t][r]&&(this._itemAttributes[t][r].ca&&1<this._itemAttributes[t][r].ca.rowSpan&&this._itemAttributes[t][r].ca._rowGap==this._itemAttributes[t][r].ca.rowSpan-1&&this._itemAttributes[t][r].h+d>o&&(o=this._itemAttributes[t][r].h+d,a=this._itemAttributes[t][r].ca.rowSpan),this._itemAttributes[t][r].vi&&this._itemAttributes[t][r].ra&&this._itemAttributes[t][r].ra.rowHeight&&(h=Math.max(h,this._itemAttributes[t][r].ra.rowHeight)),s&&(!this._itemAttributes[t][r].ca||1>=this._itemAttributes[t][r].ca.rowSpan)&&(l=Math.max(l,this._itemAttributes[t][r].h)));if(o>e){for(n=0,r=t-1;r>=i&&r>=t-a+1;r--)n+=this._rowInfo[r].height;o>n+e?e=Math.ceil(Math.max(e,o-n)):s&&(e=l?l+d:e,o>n+e&&(e=Math.ceil(Math.max(e,o-n))))}else if(s&&(e=l?l+d:e,o>e)){for(n=0,r=t-1;r>=i&&r>=t-a+1;r--)n+=this._rowInfo[r].height;o>n+e&&(e=Math.ceil(Math.max(o-n,e)))}return e=Math.ceil(Math.max(h,e))},l.prototype._resetCellY=function(){if(!(null==this._listItems||0>=this._listItems.length)){this._needResetCellY=!1;var t,e,i,s=this._getOptimumColumns().length,r=this._listItems.length;for(e=0;e<s;e++)for(i=0;i<r;i++)if(t=this._listItems[i][e],null!=t){var n=this._getItemAttribute(i,e);if(null!=n&&U(t.getListData)&&t.getListData()&&t.getData()!=t.getListData().item){if(2===n.type&&this._isCellSelectionMode()){var o=this._itemToUID(t.getData());this._removeIndicators(o)}t.setData(t.getListData().item),t.getListData().ouid=t.getListData().uid}}for(o in this._visibleData){for(s=!1,i=0;i<r;i++)if(this._listItems[i]&&this._listItems[i][0]&&this._itemToUID(this._listItems[i][0].getData())==o){s=!0;break}s||delete this._visibleData[o]}}},l.prototype._drawCellBackground=function(t,e,i,s,r,n,o,a,l){e<t.getNumChildren()?e=t.getChildAt(e):(e=new A("div","DataGridBackground"),e.name="Kool__background",this._backgroundDocumentFragment.appendChild(e.element),e.parentElement=t),t=e.element.style,t.left=i+"px",t.top=s+"px",i=Math.min(n,this._listContent.getHeight()-s),this._showDeletedRows&&this._changedData[l]&&"D"===this._changedData[l].job&&(o=this.getStyle("deletedRowBackgroundColor")),t.backgroundColor=o,t.width=r+"px",t.height=i+"px"},l.prototype._drawCellHorizontalLine=function(t,e,i,s,r,n,o){var a=new A("div","DataGridLineH"),l=a.element.style;0<this._lockedRowCount&&e==this._lockedRowCount-1?(a.setStyle("borderTopStyle","none"),a.setStyle("borderColor",this.getStyle("lockedLineColor")),e=this.getStyle("lockedLineStyle"),a.setStyle("borderBottomStyle",e),"double"==e?(a.setStyle("borderBottomWidth","3px"),a.setX(r-1)):(a.setStyle("borderBottomWidth","1px"),a.setX(r))):(l.borderColor=i,l.borderBottomStyle=s,l.left=r+"px"),l.top=n+"px",l.width=o+"px",this._backgroundDocumentFragment.appendChild(a.element),a.parentElement=t},l.prototype._drawCellHorizontalSeparator=function(t,e,i,s,r,n,o){var a=!1;0<this._lockedRowCount&&e==this._lockedRowCount-1&&(a=!0);var l,h="hSeparator"+e,d="hLockedSeparator"+e,c=a?d:h,_=a?"horizontalLockedSeparatorSkin":"horizontalSeparatorSkin",h=t.getChildByName(h);l=t.getChildByName(d),d=a?l:h,(a=a?h:l)&&t.removeChild(a),!d&&(_=this.getStyle(_))&&(d=new _,d.name=c,(c=d)&&c.setStyleName(this),t.addChild(d)),d?(t=isNaN(d.measuredHeight)?1:d.measuredHeight,d.setActualSize(o,t),d.move(0,n)):this._drawCellHorizontalLine(t,e,i,s,r,n,o)},l.prototype._redrawSelection=function(){var t,e,i,s=this._listItems.length;for(e=this._lockedRowCount;e<s;e++)if(this._isCellSelectionMode()){if(this._cellSelectionIndicators[this._rowInfo[e].uid])for(i in this._cellSelectionIndicators[this._rowInfo[e].uid]){t=this._visibleCellRenderers[this._rowInfo[e].uid][i];var r=this._getItemAttribute(e,this._absoluteToVisibleColumnIndex(Number(i)));t&&r&&(this._drawCellItem(t,!0),isNaN(r.rh)||this._cellSelectionIndicators[this._rowInfo[e].uid][i].getHeight()==r.rh||this._cellSelectionIndicators[this._rowInfo[e].uid][i].setHeight(r.rh))}}else this._isRowSelectionMode()&&this._selectionIndicators[this._rowInfo[e].uid]&&this._visibleData[this._rowInfo[e].uid]&&(t=this._visibleData[this._rowInfo[e].uid])&&this._drawItem(t,!0);this._needRedrawSelection=!1},l.prototype._drawHighlightRowIndicator=function(t,e,i,s,r,n,o){s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right,t.setWidthInline(s),t.setHeightInline(r),t.setStyle("backgroundColor",n),t.setX(e),t.setY(i),t.setVisibility(!0),e=this._visibleColumns.length,o=o.getListData().rowIndex,r=0;var a,l;if(t)for(;t.getNumChildren();)t.removeChildAt(0);for(i=0;i<e;i++)this._listItems[o][i]&&(s=this._getItemAttributeInVisibleColumns(o,i))&&s.ca&&1<s.ca.rowSpan&&0<=s.oRno&&(a=this._listItems[s.oRno][s.oCno])&&(s=this._getItemAttribute(s.oRno,s.oCno))&&(a=t.globalToLocal(a.getParent().localToGlobal(new ra(a.getX(),this._rowInfo[s.oRno].y))),l=new A("div","DataGridBackground"),l.setStyle("backgroundColor",n),l.setX(this._getVisibleColumnX(i)),l.setY(a.y),l.setWidthInline(this._visibleColumns[i].getWidth()),s.rh?l.setHeightInline(s.rh):l.setHeightInline(this._rowInfo[o].height),t.addChild(l)),r+=this._visibleColumns[i].getWidth()},l.prototype._drawSelectionRowIndicator=function(t,e,i,s,r,n,o){s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right,t.setWidthInline(s),t.setHeightInline(r),t.setStyle("backgroundColor",n),t.setX(e),t.setY(i),e=this._visibleColumns.length,o=o.getListData().rowIndex;var a;if(t)for(;t.getNumChildren();)t.removeChildAt(0);for(i=0;i<e;i++)this._listItems[o][i]&&(r=this._getItemAttributeInVisibleColumns(o,i))&&r.ca&&1<r.ca.rowSpan&&0<=r.oRno&&(s=this._listItems[r.oRno][r.oCno])&&(r=this._getItemAttribute(r.oRno,r.oCno))&&(s=t.globalToLocal(s.getParent().localToGlobal(new ra(s.getX(),this._rowInfo[r.oRno].y))),a=new A("div","DataGridBackground"),a.setStyle("backgroundColor",n),a.setX(this._getVisibleColumnX(i)),a.setY(s.y),a.setWidthInline(this._visibleColumns[i].getWidth()),r.rh?a.setHeightInline(r.rh):a.setHeightInline(this._rowInfo[o].height),t.addChild(a))},l.prototype._drawColumnBackgrounds=function(){var t=this._getNumColumns(),t=-1!=t?t:this._visibleColumns.length,e=this._getOptimumColumns();if(t>e.length&&(t=e.length),this._headerInfos&&this._hasHeaderItemsCreated(0)&&this._hasHeaderItemsCreated(t-1)){var i=this._listContent.getChildByName("colBGs");i||(i=new u,i.name="colBGs",i._useDelayInvalidate=!0,this._listContent.addChildAt(i,this._listContent.getChildIndex(this._listContent.getChildByName("rowBGs"))+1)),i.setVisible(!1);var s,r,n,o=-1;for(s=0;s<t;s++)if(r=e[s],n=this.getEnabled()?r.getStyle("backgroundColor"):r.getStyle("backgroundDisabledColor"))this._drawColumnBackground(i,s,n,r),o=s;else if(i&&(r=i.getChildByName(s.toString()))){for(;r.getNumChildren();)r.removeChildAt(0);i.removeChild(r)}if(i&&i.getNumChildren())for(s=0;s<i.getNumChildren();s++)t=i.getChildAt(s),parseInt(t.name)>o&&i.removeChild(t);i.setVisible(!0)}},l.prototype._setupRendererFromDataForSpan=function(t,e,i,s,r){this._setupRendererFromData(t,e,i);var n=-1,o=0;this._getDataRowNo(s),s=this._getCellAttribute(i,r);var a=this._getRowAttribute(i);if(this._applyCellStylesForItemRenderer(e,null),s){if((1==s._type||this._currentRowNum==this._lockedRowCount&&1<s.rowSpan&&s.colNo==r||this._currentColNum==this._lockedColumnCount&&1<s.colSpan&&0==s._rowGap||this._currentRowNum==this._lockedRowCount&&this._currentColNum==this._lockedColumnCount)&&(1!=s._type&&(a=this._getRowAttribute(s._oItem),e.getListData().label=this._columns[s.colNo].itemToLabel(s._oItem)),1<s.colSpan))for(i=r+1;i<r+s.colSpan&&(this._columns[i]&&i<s.colNo+s.colSpan&&(o+=this._columns[i].getWidth()),!(0<this._lockedColumnCount&&i==this._lockedColumnCount-1));i++);a&&a.styleName&&this._applyCellStylesForItemRenderer(e,a.styleName),s.styleName&&this._applyCellStylesForItemRenderer(e,s.styleName),s.formatString?"none"==s.formatString?e.getListData().label=this._columns[s.colNo].itemToLabel(s._oItem,!1):e.getListData().label=this._cellFormatString(this._itemToData(s._oItem,this._columns[s.colNo]),s.formatString):a&&a.formatString&&("none"==a.formatString?e.getListData().label=this._columns[s.colNo].itemToLabel(s._oItem,!1):e.getListData().label=this._cellFormatString(this._itemToData(s._oItem,this._columns[s.colNo]),a.formatString)),a&&a.rowHeight&&(n=a.rowHeight),o+=this._getWidthOfItem(e,t,r)}else a&&(a.styleName&&this._applyCellStylesForItemRenderer(e,a.styleName),a.formatString&&("none"==a.formatString?e.getListData().label=this._columns[s.colNo].itemToLabel(e.getData(),!1):e.getListData().label=this._cellFormatString(e.getData(),a.formatString)),a.rowHeight&&(n=a.rowHeight)),o=this._getWidthOfItem(e,t,r);return e.setExplicitWidth(o),n},l.prototype._importData=function(t,e,i){var s=!1;Xa(i)?i=Number(i):F(i)||(i=i.toString()),E(t)?G.getProperty(t,e)!=i&&(s=!0,G.setProperty(t,e,i)):t[e]!=i&&(s=!0,t[e]=i),s&&this._collection.itemUpdated(t,e)},l.prototype._addFooters=function(){var t;if(this._footers&&!(0>=this._footers.length))for(t=0;t<this._footers.length;t++)this.contains(this._footers[t])||this.addChild(this._footers[t])},l.prototype._removeFooters=function(){var t;if(this._footers&&!(0>=this._footers.length))for(t=0;t<this._footers.length;t++)this.contains(this._footers[t])&&this.removeChild(this._footers[t])},l.prototype._invalidateListFooters=function(){var t;if(this._footers&&!(0>=this._footers.length))for(t=0;t<this._footers.length;t++)this.contains(this._footers[t])&&this._footers[t].invalidateList()},l.prototype._itemToUID=function(t){return null==t?"null":V.getUID(t)},l.prototype._processCellsWaitingToBeDisplayed=function(){var t,e=[],i=this._pendingCellSelection.getLength();for(t=0;t<i;t++){var s=this._absoluteToVisibleIndices(this._pendingCellSelection.getItemAt(t).rowIndex,this._pendingCellSelection.getItemAt(t).columnIndex),r=s.rowIndex,s=s.columnIndex;this._listItems[r]&&this._listItems[r][s]&&(r=this._listItems[r][s],this._selectCellItem(r,!1,!0),e.push(t))}for(e.sort(function(t,e){return e-t}),i=e.length,t=0;t<i;t++)this._pendingCellSelection.removeItemAt(e[t]);0==this._pendingCellSelection.getLength()&&(this._cellsWaitingToBeDisplayed=!1)},l.prototype._getOptimumColumns=function(){return 0<this._rendererProviders.length&&"off"!=this._horizontalScrollPolicy||this._columnGrouping?this._displayableColumns:this._visibleColumns},l.prototype._clearIndicators=function(){if(this._isCellSelectionMode()&&this._clearCellIndicators(),this._isRowSelectionMode()){if(this._selectionLayer)for(;0<this._selectionLayer.getNumChildren();)this._selectionLayer.removeChildAt(0);this._selectionIndicators={},this._caretUID=this._caretIndicator=this._highlightUID=this._highlightIndicator=null}},l.prototype._isRowSelectionMode=function(){return"singleRow"==this._selectionMode||"multipleRows"==this._selectionMode||"selectorColumn"==this._selectionMode},l.prototype._isCellSelectionMode=function(){return"singleCell"==this._selectionMode||"multipleCells"==this._selectionMode},l.prototype._superMakeRowsAndColumns=function(t,e,i,s,r,n,o,a){if(r=0,this._currentColNum=this._lockedColumnCount,this._currentRowNum=this._lockedRowCount,!this._visibleColumns||0==this._visibleColumns.length)return this._purgeHeaderRenderers(),this._purgeItemRenderers(),this._visibleData={},new ra(0,0);for(this._invalidateSizeFlag=!0,this._currentItemTop=e,n<=this._lockedRowCount?(this._createHeaders(t,e),this._createLockedRows(t,e,i,s)):this._currentRowNum=n,n=null!=this._iterator&&!this._iterator.getAfterLast()&&this._iteratorValid;!o&&this._currentItemTop<s||o&&0<a;)o&&a--,this._createRow(t,e,i,s,n),n=this._moveIterator(n),++r;if(!o)for(;this._currentRowNum<this._listItems.length;){for(e=this._listItems.pop(),this._rowInfo.pop();e.length;)t=e.pop(),this._addToFreeItemRenderers(t);this._isSpanCollectionView()&&this._itemAttributes&&this._itemAttributes.length>this._listItems.length&&this._itemAttributes.pop()}return this._invalidateSizeFlag=!1,new ra(this._currentColNum,r)},l.prototype._makeRowsAndColumns=function(t,e,i,s,r,n,o,a){o=6<arguments.length&&o,a=7<arguments.length?a:0,this._visibleColumns&&0!=this._visibleColumns.length||(this._visibleCellRenderers={}),this._listContent._allowItemSizeChangeNotification=!1,this._listSubContent._allowItemSizeChangeNotification=!1,this._getHeaderVisible()&&this._itemsSizeChanged&&this._calculateHeaderHeight();var l=this._superMakeRowsAndColumns(t,e,i,s,r,n,o,a),h=this._getOptimumColumns();if(this.itemEditorInstance){this.itemEditorInstance.getParent().setChildIndex(this.itemEditorInstance,this.itemEditorInstance.getParent().getNumChildren()-1);var h=h[this._actualColIndex],d=this._listItems[this._actualRowIndex][this._actualColIndex],c=this._rowInfo[this._actualRowIndex];if(d&&!h.rendererIsEditor){var _=h.editorXOffset,u=h.editorYOffset,p=h.editorWidthOffset,g=h.editorHeightOffset,d=d.getX()+_;this.itemEditorInstance.move(d?d+1:0,c.y+u+1),this.itemEditorInstance.setActualSize(Math.min(h.getWidth()+p-(d?1:0),this._listContent.getWidth()-this._listContent.getX()-this.itemEditorInstance.getX()),Math.min(c.height+g,this._listContent.getHeight()-this._listContent.getY()-this.itemEditorInstance.getY())-1)}}return(h=this._listSubContent.getChildByName("lines"))&&this._listSubContent.setChildIndex(h,this._listSubContent.getNumChildren()-1),this._listContent._allowItemSizeChangeNotification=this._variableRowHeight,this._listSubContent._allowItemSizeChangeNotification=this._variableRowHeight,l},l.prototype._superAdjustListContent=function(t,e){var i=this.getViewMetrics();t=0<arguments.length?t:-1,e=1<arguments.length?e:-1,0>e&&(e=this._oldUnscaledHeight,t=this._oldUnscaledWidth);var s=this._listContent.leftOffset,r=this._listContent.topOffset;this._listContent.move(s,r),this._listContent.setActualSize(t+(Math.max(0,this._listContent.rightOffset)-s-i.left-i.right),e+(Math.max(0,this._listContent.bottomOffset)-r-i.top-i.bottom)),this._listSubContent.setActualSize(this._listContent.getWidth(),this._listContent.getHeight()),this._updateSubContent()},l.prototype._adjustListContent=function(t,e){var i,s,r,n=-1,o=0;if((this._showFootersOffForced||this._showFooters)&&null!=this._footers&&0<this._footers.length){for(s=!0,i=0;i<this._footers.length;i++){if(!this._footers[i].getExplicitHeight()){s=!1;break}r=this._footers[i],o+=r.getExplicitOrMeasuredHeight()}if(!s)if(this._variableRowHeight||isNaN(this._rowHeight))for(i=0;i<this._footers.length;i++)r=this._footers[i],o+=r.getExplicitOrMeasuredHeight();else n=this._rowHeight,o=this._rowHeight*this._footers.length;var a=0,l=0;if(this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(a=this._verticalScrollBar.getWidth()),this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(l=this._horizontalScrollBar.getHeight()),e-o-l-this._headerHeight>this._cachedPaddingTop+this._cachedPaddingBottom+17){this._showFootersOffForced&&(this._addFooters(),this._showFootersOffForced=!1),this._superAdjustListContent(t,e-o);var h=0;for(i=0;i<this._footers.length;i++)r=this._footers[i],s=0<=n?n:r.getExplicitOrMeasuredHeight(),r.setActualSize(t-2-a,s),r.move(this._listContent.getX(),e-l-o-1+h),h+=s}else this._superAdjustListContent(t,e),!this._showFootersOffForced&&this._showFooters&&(this._removeFooters(),this._showFootersOffForced=!0)}else this._superAdjustListContent(t,e)},l.prototype._purgeItemRenderers=function(){var t;for(this._rendererChanged=!1;this._listItems.length;){for(this._currentRowNum=this._listItems.length-1;this._listItems[this._currentRowNum].length;)t=this._listItems[this._currentRowNum].pop(),t.getParent().removeChild(t);this._listItems.pop()}this._rowMap={},this._rowInfo=[],this._itemAttributes=[]},l.prototype._purgeHeaderRenderers=function(){var t;if(this._columnGrouping){if(this._headerItemsList&&this._headerItemsList.length)for(;this._headerItemsList.length;)t=this._headerItemsList.pop(),this._addHeaderToFreeItemRenderers(t,t.getData())}else for(;this.headerItems.length;)for(var e=this.headerItems.pop();e.length;)t=e.pop(),this._addHeaderToFreeItemRenderers(t,t.getData())},l.prototype._configureScrollBars=function(){var t=this._horizontalScrollBar,e=this._verticalScrollBar,i=this._listItems.length;if(0==i+this.headerItems.length)(t||e)&&this._setScrollBarProperties(1,0,0,0);else{var s;for(1<i&&this._rowInfo[i-1].y+this._rowInfo[i-1].height>this._listContent.getHeight()&&i--,t=this.getVerticalScrollPosition()-this._lockedRowCount,e=0;i&&0==this._listItems[i-1].length&&(this._collection&&i+t>=this._collection.getLength());)i--,++e;0<this.getVerticalScrollPosition()&&0<e&&this._adjustVerticalScrollPositionDownward(Math.max(i,1))||(t=[this._collection?this._collection.getLength()-this._lockedRowCount:0,Math.max(i-this._lockedRowCount,1)],e=this._visibleColumns.length,s=this._getHeaderInfo(this._visibleColumns[this._visibleColumns.length-1]).headerItem.getX(),this._visibleColumns.length-1>this._lockedColumnCount&&(s=this._getAdjustedXPos(s)),1<e&&this._visibleColumns[e-1]==this._displayableColumns[this._displayableColumns.length-1]&&s+this._visibleColumns[e-1].getWidth()>this._displayWidth&&e--,s=[this._displayableColumns.length-this._lockedColumnCount,Math.max(e-this._lockedColumnCount,1)],this._setScrollBarProperties(s[0],s[1],t[0],t[1],this._hscrollColumns,this._lockedColumnCount),(!this._verticalScrollBar||!this._verticalScrollBar.getVisible())&&this._collection&&this._collection.getLength()-this._lockedRowCount>i-this._lockedRowCount&&this.setMaxVerticalScrollPosition(this._collection.getLength()-this._lockedRowCount-(i-this._lockedRowCount)),this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()||!(this._displayableColumns.length-this._lockedColumnCount>e-this._lockedColumnCount)||this.setMaxHorizontalScrollPosition(this._displayableColumns.length-this._lockedColumnCount-(e-this._lockedColumnCount)))}},l.prototype._drawRowBackgrounds=function(){var t=this.getStyle("alternatingItemColors"),e=this._listContent.getChildByName("rowBGs"),i=0,s=0,r=this.getVerticalScrollPosition(),n=0,o=this._listItems.length;if(this._isSpanCollectionView()&&this._setItemVisibleAndY(),e||(e=new u,e.mouseEnabled=!1,e._useDelayInvalidate=!0,e.name="rowBGs",this._listContent.addChildAt(e,0)),e.setVisible(!1),this._isSpanCollectionView()){if(!t||0==t.length)return void e.setVisible(!0);for(var a,l,h=this._visibleColumns.length,d=this._listItems.length,n=0;n<d;n++){for(r=0,o=-1,i="",l=0;l<h;l++)this._listItems[n]&&0!=this._listItems[n].length&&(a=(a=this._getItemAttributeInVisibleColumns(n,l))?a.ca&&a.ca.backgroundColor?a.ca.backgroundColor:a.ra&&a.ra.backgroundColor?a.ra.backgroundColor:a.ca?t[(this._getDataRowNo(n)-a.ca._rowGap)%t.length]:t[this._getDataRowNo(n)%t.length]:t[this._getDataRowNo(n)%t.length],i==a?r+=this._visibleColumns[l].getWidth():(0<r&&this._drawCellBackground(e,s++,o,this._rowInfo[n].y,r,this._rowInfo[n].height,i,n,this._rowInfo[n].uid),o=this._getVisibleColumnX(l),r=this._visibleColumns[l].getWidth(),i=a));0<r&&this._drawCellBackground(e,s++,o,this._rowInfo[n].y,r,this._rowInfo[n].height,i,n,this._rowInfo[n].uid)}0<this._backgroundDocumentFragment.childNodes.length&&e.element.appendChild(this._backgroundDocumentFragment)}else if(this._rootModel instanceof pb&&t){if(h=!1,(t=this.getStyle("depthColors"))?h=!0:t=this.getStyle("alternatingItemColors"),!t||0==t.length)return void e.setVisible(!0);for(n=this.getStyle("backgroundColor");i<o;){if(h)try{this._listItems[i][0]?(l=this._getItemDepth(this._listItems[i][0].getData(),i),this._drawRowBackground(e,s++,this._rowInfo[i].y,this._rowInfo[i].height,t[l-1],i,this._rowInfo[i].uid)):this._drawRowBackground(e,s++,this._rowInfo[i].y,this._rowInfo[i].height,n,i,this._rowInfo[i].uid)}catch(c){}else this._drawRowBackground(e,s++,this._rowInfo[i].y,this._rowInfo[i].height,t[r%t.length],r,this._rowInfo[i].uid);i++,r++}}else{if(!t||0==t.length)return void e.setVisible(!0);for(;i<this._lockedRowCount&&i<o;)this._drawRowBackground(e,s++,this._rowInfo[i].y,this._rowInfo[i].height,t[n%t.length],n,this._rowInfo[i].uid),i++,n++,r++;for(;i<o;)this._drawRowBackground(e,s++,this._rowInfo[i].y,this._rowInfo[i].height,t[r%t.length],r,this._rowInfo[i].uid),i++,r++}for(;e.getNumChildren()>s;)e.removeChildAt(e.getNumChildren()-1);e.setVisible(!0)},l.prototype._clearSeparators=function(){var t;if(this._separators){if(t=this._listSubContent.getChildByName("lines").getChildByName("header"))for(t=t.element;t.firstChild;)t.removeChild(t.firstChild),this._separators.pop();if(t=this._getLockedContent().getChildByName("lockedHeaderLines"))for(t=t.element;t.firstChild;)t.removeChild(t.firstChild),this._lockedSeparators.pop()}},l.prototype._drawLinesAndColumnBackgrounds=function(){this._drawHorizontalSeparators(),this._drawVerticalSeparators(),this._drawColumnBackgrounds()},l.prototype._getNumColumns=function(){if(this._columnGrouping){var t=this._getOptimumColumns();return t?t.length:0}return this.headerItems&&this.headerItems[0]?this.headerItems[0].length:-1},l.prototype._drawHorizontalSeparators=function(){var t=this.getStyle("horizontalGridLineColor"),e=this.getStyle("horizontalGridLineStyle"),i=this._getLockedContent(),s=i.getChildByName("lockedHorizontalLines");if(s){s.setVisible(!1);for(var r=s.element;r.firstChild;)r.removeChild(r.firstChild);s.setVisible(!0)}if(this.getStyle("horizontalGridLines")||0<this._lockedRowCount&&this._lockedRowCount<this._listItems.length){if(s||(s=new u,s.name="lockedHorizontalLines",s._useDelayInvalidate=!0,i.addChild(s)),s.setVisible(!1),this.getStyle("horizontalGridLines"))if(this._isSpanCollectionView()){this._calledDrawHorizontalSeparators=!0;var n,o,a,l,h,i=this._visibleColumns.length,r=this._listItems.length;for(o=0;o<r;o++)if(this._rowInfo[o].uid){for(a=-1,h=0,l=this._rowInfo[o].y+this._rowInfo[o].height,n=0;n<i;n++){var d=this._getItemAttributeInVisibleColumns(o,n);d?d.hl?(0>a&&(a=this._getVisibleColumnX(n)),h+=this._visibleColumns[n].getWidth()):(0<h&&this._drawCellHorizontalSeparator(s,o,t,e,a,l,h),a=-1,h=0):(0>a&&(a=this._getVisibleColumnX(n)),h+=this._visibleColumns[n].getWidth())}0<h&&this._drawCellHorizontalSeparator(s,o,t,e,a,l,h)}0<this._backgroundDocumentFragment.childNodes.length&&s.element.appendChild(this._backgroundDocumentFragment)}else for(i=0;i<this._listItems.length;i++)this._rowInfo[i].uid&&this._drawHorizontalSeparator(s,i,t,e,this._rowInfo[i].y+this._rowInfo[i].height);else this._drawHorizontalSeparator(s,this._lockedRowCount-1,t,e,this._rowInfo[this._lockedRowCount-1].y+this._rowInfo[this._lockedRowCount-1].height);s.setVisible(!0)}},l.prototype._drawVerticalSeparators=function(){var t=this._getLines(),e=this._getLockedContent(),i=e.getChildByName("lockedVerticalLines");this._isSpanCollectionView()&&(this._calledDrawVerticalSeparators=!0),i||(i=new u,i.name="lockedVerticalLines",i._useDelayInvalidate=!0,e.addChild(i));var s=e.getChildByName("lockedHeaderLines");if(s&&(s=e.getChildIndex(s),s>e.getChildIndex(i)&&e.setChildIndex(i,s)),i)for(var r=i.element;r.firstChild;)r.removeChild(r.firstChild);var n,o=this._getHeaderVisible()&&this._headerRowInfo&&this._headerRowInfo[0]?this._headerRowInfo[0].height:0,r=Math.min(this._visibleColumns?this._visibleColumns.length:0,Math.max(0,this._lockedColumnCount)),e=this.getStyle("verticalGridLines"),s=this.getStyle("verticalGridLineColor"),a=this.getStyle("verticalGridLineStyle");if(e&&r)for(n=0;n<r;n++)this._drawVerticalSeparator(i,n,s,a,this._getHeaderInfo(this._visibleColumns[n]).headerItem.getX()+this._visibleColumns[n].getWidth(),o);if(0<this._backgroundDocumentFragment.childNodes.length&&i.element.appendChild(this._backgroundDocumentFragment),t=this._getLinesBody(t,"verticalLines"))for(r=t.element;r.firstChild;)r.removeChild(r.firstChild);if(r=this._visibleColumns.length,r>this._visibleColumns.length&&(r=this._visibleColumns.length),e&&this._headerInfos&&this._hasHeaderItemsCreated(0)&&this._hasHeaderItemsCreated(r-1)){for(n=Math.max(0,this._lockedColumnCount);n<r-1;n++)i=this._getHeaderInfo(this._visibleColumns[n]),this._drawVerticalSeparator(t,this._absoluteToVisibleColumnIndex(this._visibleColumns[n].colNum),s,a,i.headerItem.getX()+this._visibleColumns[n].getWidth(),o);"cut"!=this._lastColumnWidthPolicy||this._visibleColumns[n]!=this._displayableColumns[this._displayableColumns.length-1]||this._visibleColumns[n].resizable||(i=this._getHeaderInfo(this._visibleColumns[n]),o=new A("div","DataGridLineV"),o.setStyle("borderColor",s),o.setX(i.headerItem.getX()+this._visibleColumns[n].getWidth()-1),o.setY(0),o.setHeightInline(this._listContent.getHeight()),this._backgroundDocumentFragment.appendChild(o.element),o.parentElement=t)}!e&&0<this._lockedColumnCount&&this._lockedColumnCount<r&&this._drawVerticalSeparator(t,this._lockedColumnCount-1,s,a,this._getHeaderInfo(this._visibleColumns[this._lockedColumnCount-1]).headerItem.getX()+this._visibleColumns[this._lockedColumnCount-1].getWidth(),0),0<this._backgroundDocumentFragment.childNodes.length&&t.element.appendChild(this._backgroundDocumentFragment)},l.prototype._clearHeaderHorizontalSeparators=function(){if(this._horizontalSeparators){for(var t=this._listSubContent.getChildByName("lines").getChildByName("headerHorizontalLines");t.getNumChildren();)t.removeChildAt(t.getNumChildren()-1),this._horizontalSeparators.pop();if(t=this._getLockedContent().getChildByName("lockedHeaderHorizontalLines"))for(;t.getNumChildren();)t.removeChildAt(t.getNumChildren()-1),this._horizontalLockedSeparators.pop()}},l.prototype._updateVisibleHeaders=function(){if(this._columnGrouping)return this._updateVisibleHeaderInfos(this._headerInfos).infos;var t,e=[],i=this._headerInfos?this._headerInfos.length:0,s=0;for(t=0;t<i;t++)this._headerInfos[t].visible=this._headerInfos[t].column.getVisible(),this._headerInfos[t].visible?(e.push(this._headerInfos[t]),this._headerInfos[t].actualColNum=s++,this._headerInfos[t].columnSpan=1):this._headerInfos[t].actualColNum=NaN,this._headerInfos[t].column.getHeaderColSpan()&&(this._headerInfos[t].headerColSpan=this._headerInfos[t].column.getHeaderColSpan());for(t=0;t<i;t++)if(1<this._headerInfos[t].headerColSpan)for(s=1;s<this._headerInfos[t].headerColSpan&&t+s<i;s++)this._headerInfos[t+s].headerColSpan=s-this._headerInfos[t].headerColSpan+1;return e},l.prototype._updateVisibleHeaderInfos=function(t,e,i){t=0<arguments.length?t:null,e=!(1<arguments.length)||e,i=2<arguments.length?i:0;var s,r,n=t?t.length:0,o=0,a=0;for(s=0;s<n;s++){var l=t[s];if(l.visible=!!e&&l.column.getVisible(),0==t[s].visible)l.visibleIndex=NaN,l.actualColNum=NaN,l.columnSpan=0,this._updateVisibleHeaderInfos(l.children,!1);else if(t[s].children&&0<t[s].children.length){var h=this._updateVisibleHeaderInfos(t[s].children,!0,i);l.visibleChildren=h.infos,null==l.visibleChildren?(l.visible=!1,l.actualColNum=NaN,l.columnSpan=0):(r||(r=[]),r.push(l),l.visibleIndex=o++,l.actualColNum=i,l.columnSpan=h.colSpan)}else r||(r=[]),l.visibleIndex=o++,r.push(l),l.actualColNum=i,l.columnSpan=1,l.column.getHeaderColSpan()&&(l.headerColSpan=l.column.getHeaderColSpan());a+=l.columnSpan,i+=l.columnSpan}for(s=0;s<n;s++)if((!t[s].children||0==t[s].children.length)&&1<t[s].headerColSpan)for(o=1;o<t[s].headerColSpan&&s+o<n;o++)t[s+o].headerColSpan=o-t[s].headerColSpan+1;return{infos:r,colSpan:a}},l.prototype._updateHeaderSearchList=function(){this._orderedHeadersList=[],this._updateHeadersList(this._visibleHeaderInfos)},l.prototype._createDisplayableColumns=function(){var t,e,i=this._columns.length;if(this._columnGrouping)for(this._displayableColumns=[],t=0;t<i;t++)this._getHeaderInfo(this._columns[t]).visible&&this._displayableColumns.push(this._columns[t]);else{for(this._displayableColumns=null,t=0;t<i;t++)if(this._displayableColumns&&this._columns[t].getVisible())this._displayableColumns.push(this._columns[t]);else if(!this._displayableColumns&&!this._columns[t].getVisible())for(this._displayableColumns=Array(t),e=0;e<t;e++)this._displayableColumns[e]=this._columns[e];this._displayableColumns||(this._displayableColumns=this._columns)}for(this._spanColumns=[],this._selectorColumns=[],t=0;t<i;t++)this._columns[t]instanceof C&&this._columns[t].getSpanable()&&this._spanColumns.push(this._columns[t]),this._columns[t]instanceof Aa&&this._selectorColumns.push(this._columns[t])},l.prototype._calculateHeaderHeight=function(){if(this._columnGrouping)return this._isMeasuringHeader=!0,this._createHeaders(0,0),this._isMeasuringHeader=!1,this._headerHeight;if(!this._columns.length)return this._rowHeight;var t,e,i,s,r,n=0,o=[],a=this.getSizeStyle("paddingTop"),l=this.getSizeStyle("paddingBottom");if(this._measuringObjects||(this._measuringObjects={}),this._getHeaderVisible()){for(n=0,s=this._columns.length,this._headerWordWrapPresent&&(this._headerHeight=this._originalHeaderHeight,this._explicitHeaderHeight=this._originalExplicitHeaderHeight),r=0;r<s;r++)e=this._columns[r],e.getVisible()&&(t=this._getMeasuringRenderer(e,!0,null),o[r]=t,i=this._makeListData(e,this.uid,0,e.colNum,e),this._rowMap[t.name]=i,t.setData(e),U(t.setListData)&&t.setListData(i),e._addStyleToHeaderItem(t),t.setWidth(e.getWidth()));for(r=0;r<s;r++)e=this._columns[r],e.getVisible()&&(t=o[r],t.setVisibility(!1),t.setVisible(!0),t.invalidateSize(),Ba.getInstance().validateClient(t,!0),t.setVisible(!1),t.setVisibility(!0),n=Math.max(n,this._explicitHeaderHeight?this._headerHeight:t.getExplicitOrMeasuredHeight()+l+a),this._columnHeaderWordWrap(e)&&(this._headerWordWrapPresent=!0));this._headerWordWrapPresent&&(this._originalHeaderHeight=this._headerHeight,this._originalExplicitHeaderHeight=this._explicitHeaderHeight,this._headerHeight=n)}return n},l.prototype._makeListData=function(t,e,i,s,r){var n,o;return t instanceof fb?new nd(null!=r.getHeaderText()?r.getHeaderText():"",t.getDataField(),(-1),e,this,i):(t instanceof C||!this._groupItemRenderer||!this._isBranch(t)||r.colNum!=this.getTreeColumnIndex()||(null!=this._groupLabelFunction?n=this._groupLabelFunction(t,r):null!=this._groupLabelField&&t.hasOwnProperty(this._groupLabelField)&&(n=t[this._groupLabelField]),n&&(o=new nd(n,r.getDataField(),s,e,this,i))),o||(n=t instanceof C?r._getHeaderLabel():r.itemToLabel(t),o=new nd(n,r.getDataField(),s,e,this,i)),this._iterator&&this._iterator instanceof Cb&&s==this.getTreeColumnIndex()&&!(t instanceof C)?this._initListData(t,o):o.item=t,o)},l.prototype._initializeHeaderInfo=function(t){if(this._columnGrouping)return this._initializeGroupedHeaderInfo(this._groupedColumns,null,0,null);var e,i=[];for(t=0;t<this._columns.length;t++)e=new Te(this._columns[t],null,t,0),i.push(e);return i},l.prototype._createHeaders=function(t,e){if(this._columnGrouping){if(this._visibleHeaderInfos&&(!this._visibleHeaderInfos[0].headerItem||e<this._visibleHeaderInfos[0].headerItem.getY()+this._visibleHeaderInfos[0].headerItem.getHeight())){this._purgeHeaderRenderers(),this._headerItemsList=[],this._lastColumnWidth=NaN,this._createHeaderItems(this._visibleHeaderInfos),this._headerRowInfo=[],this._measureHeaderHeights(this._visibleHeaderInfos,0);var i,s,r,n=this._cachedHeaderPaddingTop+this._cachedHeaderPaddingBottom,o=this._orderedHeadersList.length;
for(i=0;i<o;i++)if(s=this._orderedHeadersList[i],s.visible)if(r=this._headerRowInfo[s.depth].height-n,s.visibleChildren&&(r-=this._headerRowInfo[s.depth+1].height),"off"==this._horizontalScrollPolicy||isNaN(this._lastColumnWidth)||s.column!=this._displayableColumns[this._displayableColumns.length-1])if(1==s.headerColSpan)s.headerItem.setActualSize(s.column.getWidth(),r);else{var a,l=s.column.getWidth();for(a=1;a<s.headerColSpan&&i+a<o;a++)this._orderedHeadersList[i+a].visible&&0>=this._orderedHeadersList[i+a].headerColSpan&&(l=isNaN(this._lastColumnWidth)||this._orderedHeadersList[i+a].column!==this._displayableColumns[this._displayableColumns.length-1]?l+this._orderedHeadersList[i+a].column.getWidth():l+this._lastColumnWidth);s.headerItem.setActualSize(l,r)}else s.headerItem.setActualSize(this._lastColumnWidth,r);this._lastColumnWidth=NaN,this._layoutHeaders(this._visibleHeaderInfos,t,e,0),this._currentItemTop=this._getHeaderVisible()?this._headerRowInfo[0].height:0,this._headerHeight=this._explicitHeaderHeight?this._headerHeight:this._headerRowInfo[0].height}}else{l=!1,"off"==this._horizontalScrollPolicy||this._getOptimumColumns()==this._visibleColumns||this.headerItems[0]&&this.headerItems[0][0]&&!(e<this.headerItems[0][0].getY()+this.headerItems[0][0].getHeight())||(l=!0);var h,d;if(r=0,!this.headerItems[0]||!this.headerItems[0][0]||e<this.headerItems[0][0].getY()+this.headerItems[0][0].getHeight()){for(o=t,i=this._currentColNum=this._currentRowNum=n=0;i<this._headerInfos.length;i++)this._headerInfos[i].headerItem=null;for(var c=this._getOptimumColumns(),_=[],u=[];this._currentColNum<c.length;){if(i=c[this._currentColNum],this.headerItems[this._currentRowNum]?this.headerItems[this._currentRowNum][this._currentColNum]&&(a=this.headerItems[this._currentRowNum][this._currentColNum],this._addHeaderToFreeItemRenderers(a,a.getData())):this.headerItems[this._currentRowNum]=[],s=this._getHeaderRenderer(i,!0),0>=this._headerInfos[i.colNum].headerColSpan&&0!=o?s.setVisible(!1):s.setVisible(this._getHeaderVisible()),a=this._makeListData(i,this.uid,-1,i.colNum,i),this._rowMap[s.name]=a,s.setData(i),U(s.setListData)&&s.setListData(a),this.headerItems[this._currentRowNum][this._currentColNum]=s,this._headerInfos[i.colNum].headerItem=s,h=i.getWidth(),d=0,1<this._headerInfos[i.colNum].headerColSpan)for(a=1;a<this._headerInfos[i.colNum].headerColSpan&&i.colNum+a<this._headerInfos.length;a++)this._headerInfos[i.colNum+a].visible&&0>=this._headerInfos[i.colNum+a].headerColSpan&&(d+=this._headerInfos[i.colNum+a].column.getWidth());u[this._currentColNum]=d,s.setExplicitWidth(h+d),o+=h,this._currentColNum++}for(0<this._listContentDocumentFragment.childNodes.length&&this._listContent.element.appendChild(this._listContentDocumentFragment),0<this._listSubContentDocumentFragment.childNodes.length&&this._listSubContent.element.appendChild(this._listSubContentDocumentFragment),this._currentColNum=0;this._currentColNum<c.length;)i=c[this._currentColNum],s=this.headerItems[this._currentRowNum][this._currentColNum],s.setStyleName(i),i._addStyleToHeaderItem(s),this._explicitHeaderHeight?_[this._currentColNum]=this._headerHeight-this._cachedHeaderPaddingTop-this._cachedHeaderPaddingBottom:(0===s.measuredHeight&&s.invalidateSize(),Ba.getInstance().validateClient(s,!0),_[this._currentColNum]=s.getExplicitOrMeasuredHeight()),this._currentColNum++;for(o=t,this._currentColNum=0;this._currentColNum<c.length;)i=c[this._currentColNum],h=i.getWidth(),d=u[this._currentColNum],s=this.headerItems[this._currentRowNum][this._currentColNum],this._currentRowHeight=_[this._currentColNum],s.setActualSize(h+d,this._explicitHeaderHeight?this._headerHeight-this._cachedHeaderPaddingTop-this._cachedHeaderPaddingBottom:this._currentRowHeight),s.move(o,this._currentItemTop+this._cachedHeaderPaddingTop),o+=h,n=Math.ceil(Math.max(n,this._explicitHeaderHeight?this._headerHeight:this._currentRowHeight+this._cachedHeaderPaddingBottom+this._cachedHeaderPaddingTop)),r=Math.max(r,this._explicitHeaderHeight?this._headerHeight-this._cachedHeaderPaddingTop-this._cachedHeaderPaddingBottom:this._currentRowHeight),this._currentColNum++;if(this.headerItems[this._currentRowNum]){for(i=0;i<this.headerItems[this._currentRowNum].length;i++)this.headerItems[this._currentRowNum][i].setActualSize(this.headerItems[this._currentRowNum][i].getWidth(),r),(a=this.headerItems[this._currentRowNum][i])&&a.invalidateDisplayList();for(;this.headerItems[this._currentRowNum].length>this._currentColNum;)a=this.headerItems[this._currentRowNum].pop(),a.getParent().removeChild(a)}this._headerRowInfo[this._currentRowNum]=new we(this._currentItemTop,n,this.uid),this._getHeaderVisible()&&(this._currentItemTop+=s?n:0),this._explicitHeaderHeight||(this._headerHeight=s?n:0)}l&&(a=this._getLastColumnResidualWidth(),s=this._displayableColumns.length-1,l=this._displayableColumns[s],l=isNaN(l._explicitWidth)?l._preferredWidth:l._explicitWidth,s=this.headerItems[0][s])&&(s.setExplicitWidth(l+a),s.setActualSize(l+a,s.getHeight()))}},l.prototype._drawSeparators=function(){var t;this._getLines();var e=this._getOptimumColumns();this._headerSepSkinChanged&&(this._headerSepSkinChanged=!1,this._clearSeparators()),this._separators||(this._separators=[],this._lockedSeparators=[]),t=this._listSubContent.getChildByName("lines");var i=0,s=Math.max(0,e.length-1),r=this._getLockedContent(),n=r.getChildByName("lockedHeaderLines"),o=t.getChildByName("header");e&&0<e.length&&(0<this._lockedColumnCount&&(i=Math.min(this._lockedColumnCount,e.length),(e=i==e.length)&&i--,s-=i,e||s++,n||(n=new u,n.name="lockedHeaderLines",n._useDelayInvalidate=!0,r.addChild(n))),n&&this._createHeaderSeparators(i,this._lockedSeparators,n),o||(o=new u,o.name="header",o._useDelayInvalidate=!0,t.addChild(o)),this._createHeaderSeparators(s,this._separators,o)),n&&this._removeExtraSeparators(i,this._lockedSeparators,n),o&&this._removeExtraSeparators(s,this._separators,o)},l.prototype._getHeaderRenderer=function(t,e){var i;i=this._columnItemRendererFactory(t,!0,null);var s=t.uno;return this.useSameFreeItemRenderersTable&&!t.getHeaderRenderer()&&(s=-1),this._freeItemRenderersTable[s]&&this._freeItemRenderersTable[s][i.uno]&&this._freeItemRenderersTable[s][i.uno].length?(i=this._freeItemRenderersTable[s][i.uno].pop(),-1==s&&(i.element.className="Kool__DataGridHeaderRenderer "+t._cssName+" "+this.getStyle("headerStyleName"),i._classStyle=t)):(i=this._columnItemRenderer(t,!0,null),this._addRendererToContentArea(i,t,e)),i},l.prototype._addRendererToContentArea=function(t,e,i){if(this._columnGrouping&&t.getData()instanceof C)(e=this._getHeaderInfo(t.getData()))&&e.columnSpan+e.actualColNum<=this._lockedColumnCount?i?(this._listContentDocumentFragment.appendChild(t.element),t.parentElement=this._listContent,t._parent=this._listContent,t.setNestLevel(this._listContent._nestLevel+1),t.initialize()):this._listContent.addChild(t):i?(this._listSubContentDocumentFragment.appendChild(t.element),t.parentElement=this._listSubContent,t._parent=this._listSubContent,t.setNestLevel(this._listSubContent._nestLevel+1),t.initialize()):this._listSubContent.addChild(t);else{var s=!1;0<this._lockedColumnCount?(e=this._getHeaderInfo(e))&&e.columnSpan+e.actualColNum<=this._lockedColumnCount&&(s=!0):e.colNum<this._lockedColumnCount&&(s=!0),s?i?t.getParent()!=this._listContent&&(t.element.parentNode?this._listContent.addChild(t):(this._listContentDocumentFragment.appendChild(t.element),t.parentElement=this._listContent,t._parent=this._listContent,t.setNestLevel(this._listContent._nestLevel+1),t.initialize())):t.getParent()!=this._listContent&&this._listContent.addChild(t):i?t.getParent()!=this._listSubContent&&(t.element.parentNode?this._listSubContent.addChild(t):(this._listSubContentDocumentFragment.appendChild(t.element),t.parentElement=this._listSubContent,t._parent=this._listSubContent,t.setNestLevel(this._listSubContent._nestLevel+1),t.initialize())):t.getParent()!=this._listSubContent&&this._listSubContent.addChild(t)}},l.prototype._createLockedRows=function(e,i,s,r){var n,o,a=this._lockedRowCount,l=0;if(0<this._lockedRowCount&&(!this._listItems[this._lockedRowCount-1]||!this._listItems[this._lockedRowCount-1][0]||i<this._listItems[this._lockedRowCount-1][0].getY()+this._listItems[this._lockedRowCount-1][0].getHeight())){this._currentRowNum=0;var h;if(a&&this._iterator){h=this._iterator.getBookmark();try{this._iterator.seek(t.getFIRST())}catch(d){d instanceof ca&&(this._lastSeekPending=new Da(t.getFIRST(),0),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}}for(n=null!=this._iterator&&!this._iterator.getAfterLast()&&this._iteratorValid,o=0;o<a;o++)this._createRow(e,i,s,r,n),n=this._moveIterator(n),++l;if(h)try{this._iterator.seek(h,a)}catch(d){this._lastSeekPending=new Da(t.getCURRENT(),0),d.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1}}},l.prototype._hasHeaderItemsCreated=function(t){if(t=0<arguments.length?t:-1,!this._columnGrouping)return-1==t?this.headerItems&&this.headerItems[0]&&this.headerItems[0][0]:this.headerItems&&this.headerItems[0]&&this.headerItems[0][t];if(-1==t)return this._visibleHeaderInfos&&this._visibleHeaderInfos[0].headerItem;var e=this._getHeaderInfo(this._getOptimumColumns()[t]);return e&&e.headerItem},l.prototype._drawColumnBackground=function(t,e,i,s){for(s=t.getChildByName(e.toString()),s||(s=new A("div","DataGridBackground"),s.name=e.toString(),t.addChild(s));s.getNumChildren();)s.removeChildAt(0);if(this._columnGrouping){if(e>=this._lockedColumnCount&&e<this._lockedColumnCount+this.getHorizontalScrollPosition())return void s.setStyle("backgroundColor","transparent")}else if(0<this._lockedColumnCount&&e>this._lockedColumnCount&&e<this._lockedColumnCount)return void s.setStyle("backgroundColor","transparent");if(1>this._rowInfo.length)s.setStyle("backgroundColor","transparent");else{s.setStyle("backgroundColor",i),t=this._getHeaderInfo(this._getOptimumColumns()[e]);var r=t.headerItem.getX(),n=this._listContent.getHeight();e>=this._lockedColumnCount&&(r=this._getAdjustedXPos(r));var o=0,a=this._headerRowInfo[0].y;if(this._getHeaderVisible()&&(a+=this._headerRowInfo[0].height),this._isSpanCollectionView()){for(var l,h,o=this._listItems.length,d=a,a=0;a<o;a++)if(!isNaN(this._rowInfo[a].height)&&this._rowInfo[a].uid){var c=this._getItemAttribute(a,e);if(c?c.ca&&c.ca.backgroundColor||c.ra&&c.ra.backgroundColor?(h=c,l=null):!h&&l?l.setHeightInline(l.getHeightInline()+this._rowInfo[a].height):(l=new A("div","DataGridBackground"),l.setWidthInline(t.headerItem.getWidth()),l.setHeightInline(this._rowInfo[a].height),l.setX(r),l.setY(d),l.setStyle("backgroundColor",i),s.addChild(l),h=null):(!h&&l?l.setHeightInline(l.getHeightInline()+this._rowInfo[a].height):(l=new A("div","DataGridBackground"),l.setWidthInline(t.headerItem.getWidth()),l.setHeightInline(this._rowInfo[a].height),l.setX(r),l.setY(d),l.setStyle("backgroundColor",i),s.addChild(l)),h=null),d+=this._rowInfo[a].height,d>n)break}}else{if(this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&this.getVerticalScrollPosition()<this.getMaxVerticalScrollPosition())o=n-a;else for(e=0;e<this._listItems.length;e++)this._rowInfo[e].uid&&(o+=this._rowInfo[e].height);s.setWidthInline(t.headerItem.getWidth()),s.setHeightInline(o),s.setX(r),s.setY(a)}}},l.prototype._getAdjustedXPos=function(t){return this._listSubContent.getScrollRect()&&(t=0==this._listSubContent.getX()?t-this._listSubContent.getScrollRect().x:t-(this._listSubContent.getScrollRect().x-this._listSubContent.getX())),t},l.prototype._layoutRow=function(t,e,i){var s,r,n=0,o=this._currentItemTop+this._cachedPaddingTop,a=this._cachedPaddingTop+this._cachedPaddingBottom,l=this._getOptimumColumns(),h=Math.max(this._listContent.getHeight()-(this._getHeaderVisible()&&this._headerRowInfo&&this._headerRowInfo[0]?this._headerRowInfo[0].height:0)-a,this._rowHeight);if(this._isSpanCollectionView()){if(t){var d;for(this._currentColNum=0;this._currentColNum<l.length;){if(s=l[this._currentColNum],t=this._listItems[this._currentRowNum][this._currentColNum],d=this._itemAttributes[this._currentRowNum][this._currentColNum],this._applyCellStylesForItemRenderer(t,null),d.ca){if(1<d.ca.colSpan)for(r=0,n=this._currentColNum;n<this._currentColNum+d.ca.colSpan&&(l[n]&&l[n].colNum<d.ca.colNo+d.ca.colSpan&&(r+=l[n].getWidth()),!(0<this._lockedColumnCount&&n==this._lockedColumnCount-1));n++);else r=this._getWidthOfItem(t,s,this._currentColNum);d.ra&&d.ra.styleName&&this._applyCellStylesForItemRenderer(t,d.ra.styleName),d.ca.styleName&&this._applyCellStylesForItemRenderer(t,d.ca.styleName)}else r=this._getWidthOfItem(t,s,this._currentColNum),d.ra&&d.ra.styleName&&this._applyCellStylesForItemRenderer(t,d.ra.styleName);t.setExplicitWidth(r),d.w=r,U(t.invalidateSize)&&(this._wordWrapChanged||this._variableRowHeight)&&t.invalidateSize(),Ba.getInstance().validateClient(t,!0),this._currentRowHeight=Math.min(t.getExplicitOrMeasuredHeight(),h),d.h=this._currentRowHeight,n=this._variableRowHeight&&d.ra&&d.ra.rowHeight?d.ra.rowHeight:this._getRowHeight(t.getData()),t.setActualSize(r,this._variableRowHeight?this._currentRowHeight:Math.min(this._currentRowHeight,n-this._cachedPaddingTop-this._cachedPaddingBottom)),t.setX(e),d.oY=o,e+=s.getWidth(),!this._variableRowHeight||d.ca&&1<d.ca.rowSpan||t.getVisible()&&(i=Math.ceil(Math.max(i,this._currentRowHeight+a))),t.setVisible(d.vi),this._currentColNum++}}i=this._variableRowHeight?0<this._lockedRowCount&&this._currentRowNum>=this._lockedRowCount?this._getRowSpanHeight(this._currentRowNum,i,this._lockedRowCount):this._getRowSpanHeight(this._currentRowNum,i):0!=n?n:this._getRowHeight()}else{if(t)for(this._currentColNum=0;this._currentColNum<l.length;)s=l[this._currentColNum],t=this._listItems[this._currentRowNum][this._currentColNum],r=this._getWidthOfItem(t,s,this._currentColNum),t.setExplicitWidth(r),U(t.invalidateSize)&&(this._wordWrapChanged||this._variableRowHeight)&&t.invalidateSize(),Ba.getInstance().validateClient(t,!0),this._currentRowHeight=Math.min(t.getExplicitOrMeasuredHeight(),h),n=this._getRowHeight(t.getData()),t.setActualSize(r,this._variableRowHeight?this._currentRowHeight:Math.min(this._currentRowHeight,n-this._cachedPaddingTop-this._cachedPaddingBottom)),t.setX(e),e+=s.getWidth(),this._variableRowHeight&&t.getVisible()&&(i=Math.ceil(Math.max(i,this._variableRowHeight?this._currentRowHeight+a:n))),this._currentColNum++;this._variableRowHeight||(i=0!=n?n:this._getRowHeight())}return i},l.prototype._getRowHeight=function(t){return t=0<arguments.length?t:null,0<this._groupRowHeight&&this.getDataProvider()instanceof T&&this._rootModel.hasChildren(t)?this._groupRowHeight:this._rowHeight},l.prototype._drawRowBackground=function(t,e,i,s,r,n,o){e<t.getNumChildren()?n=t.getChildAt(e):(n=new A("div","DataGridBackground"),n.name="Kool__background",t.addChild(n)),n.setY(i),t=Math.min(s,this._listContent.getHeight()-i),this._showDeletedRows&&this._changedData[o]&&"D"===this._changedData[o].job&&(r=this.getStyle("deletedRowBackgroundColor")),this._listItems[e]&&0!=this._listItems[e].length||(r=this.getStyle("backgroundColor")),n.setStyle("backgroundColor",r),n.setWidth(this._displayWidth),n.setHeight(t)},l.prototype._createHeaderSeparators=function(t,e,i){var s,r,n,o,a=this._getOptimumColumns(),l=this.getSizeStyle("headerBorderTopWidth"),h=this.getSizeStyle("headerBorderBottomWidth");if(this._columnGrouping){var d=0<this._lockedColumnCount&&e!=this._lockedSeparators?this._lockedColumnCount-1:0;for(s=0;s<t;s++){o=s+d,r=this._getSeparator(s,e,i),n=r.getChildAt(0);var c=this._getHeaderInfo(a[o]),_=this._getHeaderInfo(a[o+1]),u=c.headerItem;if(!c||!c.visible||!u||0>=_.headerColSpan)r.setVisible(!1);else{for(r.setVisible(!0),o=u.getX()+a[o].getWidth()-Math.round(r.measuredWidth/2+.5),0<s&&(o=Math.max(o,e[s-1].getX()+Math.round(r.measuredWidth/2+.5))),r.setX(o);c!=_&&null!=c.parent&&null!=_.parent;)c.depth>_.depth?c=c.parent:(c.depth<_.depth||(c=c.parent),_=_.parent);c==_&&c?(r.setY(c.headerItem.getY()+c.headerItem.getHeight()+this._cachedHeaderPaddingBottom),u=u.getY()+u.getHeight()-c.headerItem.getY()-c.headerItem.getHeight()-h):(r.setY(l),u=u.getY()+u.getHeight()+this._cachedHeaderPaddingBottom-l-h),r.setWidthInline(n.measuredWidth+this._separatorAffordance),r.setHeightInline(u),r.getParent()!=i&&i.addChild(r),n.setActualSize(n.measuredWidth,u)}}}else for(s=0;s<t;s++)o=0<this._lockedColumnCount&&e!=this._lockedSeparators?s+this._lockedColumnCount-1:s,_=this._getHeaderInfo(a[o+1]),r=this._getSeparator(s,e,i),n=r.getChildAt(0),!this.headerItems||!this.headerItems[0]||!this.headerItems[0][o]||0>=_.headerColSpan?r.setVisible(!1):(r.setVisible(!0),r.setX(this.headerItems[0][o].getX()+a[o].getWidth()-Math.round(r.measuredWidth/2+.5)),0<s&&e[s-1].getVisible()&&r.setX(Math.max(r.getX(),e[s-1].getX()+Math.round(r.measuredWidth/2+.5))),r.setY(l),r.setWidthInline(n.measuredWidth+this._separatorAffordance),r.setHeightInline(this._headerHeight-l-h),r.getParent()!=i&&i.addChild(r),n.setActualSize(n.measuredWidth,(this._headerRowInfo.length?this._headerRowInfo[0].height:this._headerHeight)-l-h))},l.prototype._getSeparator=function(t,e,i){return t<i.getNumChildren()?t=i.getChildAt(t):(i=new(this.getStyle("headerSeparatorSkin")),i.setStyle("borderColor",this.getStyle("headerSeparatorColor")),i.owner=this,t=new u,t.setStyle("position","absolute"),t.addChild(i),t.owner=this,r.supportTouch?t.addEvent("touchstart",this._columnResizeMouseDownHandler,this):(t.addEvent("mouseover",this._columnResizeMouseOverHandler,this),t.addEvent("mouseout",this._columnResizeMouseOutHandler,this),t.addEvent("mousedown",this._columnResizeMouseDownHandler,this)),e.push(t)),t},l.prototype._absoluteToVisibleColumnIndex=function(t){var e,i=this._getOptimumColumns(),s=i.length;for(e=0;e<s;e++)if(i[e].colNum==t)return e;return-1},l.prototype._drawVerticalLine=function(t,e,i,s,r){var n,o,a,l,h,d=0,c=new A("div","DataGridLineV"),_=this._listContent.getHeight(),u=c.element.style;if(this._getHeaderVisible()&&(d=this._headerRowInfo[0].height),0<this._lockedColumnCount&&e==this._lockedColumnCount-1)u.borderColor=this.getStyle("lockedLineColor"),u.borderLeftStyle="none",o=this.getStyle("lockedLineStyle"),u.borderRightStyle=o?o:"","double"==o?(u.borderRightWidth="3px",s=r-1):(u.borderRightWidth="1px",s=r),u.left=s+"px",u.top=d+"px",u.height=_+"px",this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t;else{if(i=i?i:"",o=s?s:"",n=d,s=r,u.left=s+"px",u.borderColor=i,u.borderRightStyle=o,this._isSpanCollectionView()){if(0>=this._lockedColumnCount||e!=this._lockedColumnCount-1){l=0;var p,g=this._listItems.length;for(n=d-2,p=0;p<g;p++)if(0!=this._listItems[p].length)if(a=this._listItems[p][e],a.getVisible())a.getX()+a.getWidth()<=r+.001?(n<d&&(n=this._rowInfo[p].y),l+=this._rowInfo[p].height):0<l?(u.top=n+"px",u.height=l+"px",this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t,c=new A("div","DataGridLineV"),u=c.element.style,u.borderColor=i,u.borderRightStyle=o,u.left=s+"px",n=d-1,l=0):n=this._rowInfo[p].y+this._rowInfo[p].height;else if((h=this._getItemAttribute(p,e))&&h.ca)h.vl&&a.getX()+a.getWidth()<=r+.001?(n<d&&(n=this._rowInfo[p].y),l+=this._rowInfo[p].height):0<l?(u.top=n+"px",u.height=l+"px",this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t,c=new A("div","DataGridLineV"),u=c.element.style,u.borderColor=i,u.borderRightStyle=o,u.left=s+"px",n=d-1,l=0):n=this._rowInfo[p].y+this._rowInfo[p].height;else for(h=e-1;0<=h;h--)if(a=this._listItems[p][h],a.getVisible()){a.getX()+a.getWidth()<=r+.001&&(u.top=this._rowInfo[p].y+"px",u.height=n+"px",this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t,c=new A("div","DataGridLineV"),u=c.element.style,u.borderColor=i,u.borderRightStyle=o,u.left=s+"px");break}n==d-2&&(n=d)}}else if(0!=this._rendererProviders.length)for(l=0;l<this._listItems.length;l++)if(0!=this._listItems[l].length)if(a=this._listItems[l][e],n=this._rowInfo[l].y+this._rowInfo[l].height,a.getVisible())a.getX()+a.getWidth()<=r+.001&&(u.top=this._rowInfo[l].y+"px",u.height=n+"px",this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t,c=new A("div","DataGridLineV"),u=c.element.style,u.borderColor=i,u.borderRightStyle=o,u.left=s+"px");else for(h=e-1;0<=h;h--)if(a=this._listItems[l][h],a.getVisible()){a.getX()+a.getWidth()<=r+.001&&(this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t,u.top=this._rowInfo[l].y+"px",u.height=n+"px",c=new A("div","DataGridLineV"),u=c.element.style,u.borderColor=i,u.borderRightStyle=o,u.left=s+"px");break}n<d||(u.top=n+"px",u.height=_+"px",this._backgroundDocumentFragment.appendChild(c.element),c.parentElement=t)}},l.prototype._addHeaderToFreeItemRenderers=function(t,e){var i=this._itemRendererToFactoryMap[t.uid],s=e.uno;this.useSameFreeItemRenderersTable&&!e.getHeaderRenderer()&&(s=-1),t.setVisible(!1),this._freeItemRenderersTable[s]||(this._freeItemRenderersTable[s]={}),this._freeItemRenderersTable[s][i.uno]||(this._freeItemRenderersTable[s][i.uno]=[]),this._freeItemRenderersTable[s][i.uno].push(t)},l.prototype._updateSelectedCells=function(){switch(this._selectionMode){case"none":this._selectedCells&&(this._selectedCells=null);break;case"singleRow":this._selectedCells=[{rowIndex:this.selectedIndex,columnIndex:-1}];break;case"multipleRows":this._selectedCells=Ra.map(this.getSelectedIndices(),this._rowToCell)}},l.prototype._rowToCell=function(t,e,i){return{rowIndex:t,columnIndex:-1}},l.prototype._isDraggingAllowed=function(t){return!(!t.draggable||this._columnGrouping&&(t=this._getHeaderInfo(t).parent)&&0==t.column.childrenDragEnabled)},l.prototype._itemRendererToIndices=function(t){if(this._isHeaderItemRenderer(t))return null;if(t&&t.name in this._rowMap){var e,i=this._rowMap[t.name].rowIndex,s=this._listItems[i].length;for(e=0;e<s&&this._listItems[i][e]!=t;e++);t=new ra(e<this._lockedColumnCount?e:e+this.getHorizontalScrollPosition(),i<this._lockedRowCount?i:i+this.getVerticalScrollPosition()+this._offscreenExtraRowsTop)}else t=null;return t&&this._getOptimumColumns()!=this._visibleColumns&&t.x>=this._lockedColumnCount&&(t.x-=this.getHorizontalScrollPosition()),t},l.prototype._drawItem=function(t,e,i,s,r){if(e=1<arguments.length&&e,i=2<arguments.length&&i,s=3<arguments.length&&s,r=4<arguments.length&&r,t){var n,o=this._rowMap[t.name];if(o){if(!i||this._highlightItemRenderer&&this._highlightUID==o.uid?!i&&this._highlightItemRenderer&&o&&this._highlightUID==o.uid&&(this._highlightIndicator&&this._highlightIndicator.setVisibility(!1),this._highlightItemRenderer=null,this._highlightUID=""):(this._highlightIndicator?this._selectionLayer.setChildIndex(this._highlightIndicator,this._selectionLayer.getNumChildren()-1):(n=new A("div","DataGridBackground"),this._selectionLayer.addChild(n),this._highlightIndicator=n),n=this._highlightIndicator,n.getParent().setChildIndex(n,n.getParent().getNumChildren()-1),this._drawHighlightIndicator(n,t.getX(),this._rowInfo[o.rowIndex].y,t.getWidth(),this._rowInfo[o.rowIndex].height,this.getStyle("rollOverColor"),t),this._lastHighlightItemRenderer=this._highlightItemRenderer=t,this._highlightUID=o.uid),e){var a=this._runningDataEffect?t.getY()-this._cachedPaddingTop:this._rowInfo[o.rowIndex].y;this._selectionIndicators[o.uid]?(n=this._selectionIndicators[o.uid],n.getParent().setChildIndex(n,n.getParent().getNumChildren()-1),this._drawSelectionIndicator(n,t.getX(),a,t.getWidth(),this._rowInfo[o.rowIndex].height,this.getEnabled()?this.getStyle("selectionColor"):this.getStyle("selectionDisabledColor"),t)):(n=new A("div","DataGridBackground"),this._selectionLayer.addChild(n),n.getParent().setChildIndex(n,n.getParent().getNumChildren()-1),this._selectionIndicators[o.uid]=n,this._drawSelectionIndicator(n,t.getX(),a,t.getWidth(),this._rowInfo[o.rowIndex].height,this.getEnabled()?this.getStyle("selectionColor"):this.getStyle("selectionDisabledColor"),t),this._transition&&this._applySelectionEffect(n,o.uid,t))}else!e&&o&&this._selectionIndicators[o.uid]&&(this._selectionLayer.removeChild(this._selectionIndicators[o.uid]),delete this._selectionIndicators[o.uid]);s?this._showCaret&&(this._caretIndicator?this._selectionLayer.setChildIndex(this._caretIndicator,this._selectionLayer.getNumChildren()-1):(n=new A("div","DataGridBackground"),this._selectionLayer.addChild(n),this._caretIndicator=n),n=this._caretIndicator,n.getParent().setChildIndex(n,n.getParent().getNumChildren()-1),this._drawCaretIndicator(n,t.getX(),this._rowInfo[o.rowIndex].y,t.getWidth(),this._rowInfo[o.rowIndex].height,this.getStyle("selectionColor"),t),this._caretItemRenderer=t,this._caretUID=o.uid):!s&&this._caretItemRenderer&&this._caretUID==o.uid&&(this._caretIndicator&&this._caretIndicator.setVisibility(!1),this._caretItemRenderer=null,this._caretUID=""),t instanceof R&&t.invalidateDisplayList(),n=this._rowMap[t.name].rowIndex;for(var l=this._getOptimumColumns().length,h=0;h<l;h++){if((a=this._listItems[n][h])&&!a.getVisible())for(o=n-1;0<=o&&(!(a=this._listItems[o][h])||!a.getVisible());o--);this._updateDisplayOfItemRenderer(a)}this._isSpanCollectionView()&&e&&!this._calledSetItemVisible&&(this._needRedrawSelection=!0)}}},l.prototype._getPossibleDropPositions=function(t){if(this._columnGrouping&&null!=t)return(t=this._getHeaderInfo(t))&&t.parent&&t.parent.visibleChildren&&0<t.parent.visibleChildren.length?t.parent.visibleChildren:this._visibleHeaderInfos;t=this._visibleColumns?this._visibleColumns.length:0;var e,i=[];for(e=0;e<t;e++)i.push(this._getHeaderInfo(this._visibleColumns[e]));return i},l.prototype._unsetColumnDragParameters=function(){v.documentRemoveEvent("mousemove",this._columnDraggingMouseMoveHandler,this),v.documentRemoveEvent("mouseup",this._columnDraggingMouseUpHandler,this),v.documentRemoveEvent("selectstart",this._documentSelectStartHandler,this);var t=this._listContent.getChildByName("headerDragProxy");t&&this._listContent.removeChild(t),(t=this._selectionLayer.getChildByName("headerSelection"))&&this._selectionLayer.removeChild(t),this._columnDropIndicator&&this._columnDropIndicator.setVisible(!1),(t=this._listContent.getChildByName("columnDragOverlay"))&&this._listContent.removeChild(t),this._listContent.scrollRect=null,this._addClipMask(!1),this._startX=NaN,this._movingColumn=null,this._dropColumnIndex=-1},l.prototype._invalidateRenderer=function(t){t instanceof R&&(t.invalidateProperties(),t.invalidateSize(),t.invalidateDisplayList())},l.prototype._clearSelected=function(t){t=0<arguments.length&&t;for(var e in this._selectedData){var i=this._selectedData[e].data;this._removeSelectionData(e),(i=this._visibleData[this._itemToUID(i)])&&this._drawItem(i,!1,e==this._highlightUID,!1,t)}this._clearSelectionData(),this._selectedIndex=-1,this._selectedItem=null,this._anchorIndex=this._caretIndex=-1,this._anchorBookmark=this._caretBookmark=null},l.prototype._clearSelectedCells=function(t){t=0<arguments.length&&t;for(var e in this._cellSelectionData)for(var i in this._cellSelectionData[e]){var s=this._cellSelectionData[e][i].data;this._removeCellSelectionData(e,i);var r;this._visibleCellRenderers[this._itemToUID(s)]&&(r=this._visibleCellRenderers[this._itemToUID(s)][i]),r&&this._drawCellItem(r,!1,e==this._highlightUID&&this._highlightColumnIndex==i,!1,t)}this._selectedCells=[],this._clearCellSelectionData(),this._selectedIndex=-1,this._selectedItem=null,this._anchorIndex=this._caretIndex=-1,this._anchorBookmark=this._caretBookmark=null},l.prototype._scrollPositionToIndex=function(t,e){return this._iterator?e:-1},l.prototype._seekPositionSafely=function(e){try{this._iterator.seek(t.getFIRST(),e)}catch(i){i instanceof ca&&(this._lastSeekPending=new Da(t.getFIRST(),e),i.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}return this._iteratorValid},l.prototype._setupRenderer=function(t,e,i){i=2<arguments.length&&i;for(var s,r,n=[],o=this._getOptimumColumns(),a=o.length;this._currentColNum<a;)s=o[this._currentColNum],i?(r=this._getRenderer(s,t),this._addRendererToContentArea(r,s,!0),this._columnMap[r.name]=s):(r=this._listItems[this._currentRowNum][this._currentColNum],r&&this._itemToUID(r.getData())==e&&this._columnMap[r.name]==s||(r=this._getRenderer(s,t),this._addRendererToContentArea(r,s,!0),this._columnMap[r.name]=s,this._listItems[this._currentRowNum][this._currentColNum]&&this._addToFreeItemRenderers(this._listItems[this._currentRowNum][this._currentColNum]),this._listItems[this._currentRowNum][this._currentColNum]=r)),s=this._makeListData(t,e,this._currentRowNum,s.colNum,s),this._rowMap[r.name]=s,r.setData(t),r instanceof qa&&r.setListData(t?s:null),r.setVisible(!0),this._setVisibleDataItem(e,r),n[this._currentColNum]=r,this._currentColNum++;if(i&&this._listItems.splice(this._currentRowNum,0,n),0<this._rendererProviders.length){var n=this._listItems[this._currentRowNum].length,l=0;for(s=0;s<n;++s){r=this._listItems[this._currentRowNum][s];var h=this._rendererDescriptionMap[r.uno];h&&h.renderer?l=0==h.columnSpan?Math.max(l-1,a-s):Math.max(l-1,h.columnSpan-1):0<l&&(r.setVisible(!1),l--)}}if(this._isSpanCollectionView()){for(this._itemAttributes[this._currentRowNum]||(this._itemAttributes[this._currentRowNum]=[]),this._itemAttributes[this._currentRowNum].length>o.length&&this._itemAttributes[this._currentRowNum].splice(o.length,this._itemAttributes[this._currentRowNum].length-o.length),s=0;s<a;s++)r=this._listItems[this._currentRowNum][s],this._itemAttributes[this._currentRowNum][s]?(n=this._itemAttributes[this._currentRowNum][s],n.type=0,n.oCno=-1,n.oRno=-1,n.ca=null,n.ra=null,n.hl=!0,n.vl=!0,n.w=NaN,n.h=NaN,n.rh=NaN,n.oY=NaN):n=new Xe,n.vi=r.getVisible(),n.ra=this._getRowAttribute(this._iterator.getCurrent()),n.ca=this._getCellAttribute(this._iterator.getCurrent(),o[s].colNum),this._itemAttributes[this._currentRowNum][s]=n;for(this._makeItemAttributes(this._currentRowNum+1),this._getDataRowNo(this._currentRowNum),s=0;s<a;s++)r=this._listItems[this._currentRowNum][s],n=this._itemAttributes[this._currentRowNum][s],n.ca?(1<n.type&&(r.setData(n.ca._oItem),r.getListData().ouid=this._itemToUID(n.ca._oItem),r.getListData().label=this._columns[n.ca.colNo].itemToLabel(n.ca._oItem)),n.ca.formatString?"none"==n.ca.formatString?r.getListData().label=this._columns[n.ca.colNo].itemToLabel(n.ca._oItem,!1):r.getListData().label=this._cellFormatString(this._itemToData(n.ca._oItem,this._columns[n.ca.colNo]),n.ca.formatString):n.ra&&n.ra.formatString&&("none"==n.ra.formatString?r.getListData().label=this._columns[n.ca.colNo].itemToLabel(n.ca._oItem,!1):r.getListData().label=this._cellFormatString(this._itemToData(n.ca._oItem,this._columns[n.ca.colNo]),n.ra.formatString))):n.ra&&n.ra.formatString&&("none"==n.ra.formatString?r.getListData().label=o[s].itemToLabel(t,!1):r.getListData().label=this._cellFormatString(this._itemToData(t,o[s]),n.ra.formatString))}},l.prototype._setVisibleDataItem=function(t,e){this._isCellSelectionMode()&&t&&(this._visibleCellRenderers[t]||(this._visibleCellRenderers[t]={}),this._visibleCellRenderers[t][this._indexToColNum(this._currentColNum).toString()]=e),t&&0==this._currentColNum&&(this._visibleData[t]=e)},l.prototype._drawVisibleItem=function(t,e,i,s,r){if(e=1<arguments.length&&e,i=2<arguments.length&&i,s=3<arguments.length&&s,r=4<arguments.length&&r,this._isCellSelectionMode()){if(this._visibleCellRenderers[t])for(var n=0;n<this._columns.length;n++)this._drawCellItem(this._visibleCellRenderers[t][n.toString()],this._cellSelectionData&&this._cellSelectionData[t]&&this._cellSelectionData[t][n.toString()],this._highlightUID==t&&this._highlightColumnIndex==n,this._caretUID==t&&this._caretColumnIndex==n)}else this._visibleData[t]&&this._drawItem(this._visibleData[t],e,i,s)},l.prototype._addToFreeItemRenderers=function(t){t.setVisible(!1),t.setVisibility(!0),delete this._rowMap[t.name];
var e=this._itemToUID(t.getData());if(this._visibleData[e]==t&&delete this._visibleData[e],this._columnMap[t.name]){var e=this._columnMap[t.name],i=this._itemRendererToFactoryMap[t.uid],s=e.uno;this.useSameFreeItemRenderersTable&&!e.getItemRenderer()&&(s=-1),this._freeItemRenderersTable[s]||(this._freeItemRenderersTable[s]={}),this._freeItemRenderersTable[s][i.uno]||(this._freeItemRenderersTable[s][i.uno]=[]),this._freeItemRenderersTable[s][i.uno].push(t),delete this._columnMap[t.name]}else t.getParent().removeChild(t)},l.prototype._scrollHorizontally=function(t,e,i){},l.prototype._dragScroll=function(){var t,e=this,i=0;0!=e._dragScrollingInterval&&(Lb.isDragging?(i=e.getViewMetrics(),i=i.top+(e._variableRowHeight?e.getStyle("fontSize")/4:e._rowHeight)):i=(e.getSizeStyle("borderTopWidth")+e.getSizeStyle("borderBottomWidth"))/2+1,t=e._mouseY+e.getSizeStyle("borderTopWidth"),clearInterval(e._dragScrollingInterval),t<i?(i=e.getVerticalScrollPosition(),e.setVerticalScrollPosition(Math.max(0,i-1)),Lb.isDragging?t=100:(t=Math.min(0-t-30,0),t=.593*t*t+31),e._dragScrollingInterval=setInterval(function(){e._dragScroll()},t),i!=e.getVerticalScrollPosition()&&(t=new ma(ma.SCROLL),t.detail=!1,t.direction="vertical",t.position=e.getVerticalScrollPosition(),t.delta=e.getVerticalScrollPosition()-i,e.dispatchEvent(t))):t>e._unscaledHeight-i?(i=e.getVerticalScrollPosition(),e.setVerticalScrollPosition(Math.min(e.getMaxVerticalScrollPosition(),e.getVerticalScrollPosition()+1)),Lb.isDragging?t=100:(t=Math.min(t-e._unscaledHeight-30,0),t=.593*t*t+31),e._dragScrollingInterval=setInterval(function(){e._dragScroll()},t),i!=e.getVerticalScrollPosition()&&(t=new ma(ma.SCROLL),t.direction="vertical",t.position=e.getVerticalScrollPosition(),t.delta=e.getVerticalScrollPosition()-i,e.dispatchEvent(t))):e._dragScrollingInterval=setInterval(function(){e._dragScroll()},15))},l.prototype._selectItem=function(e,i,s,r){if(r=!(3<arguments.length)||r,this._isCellSelectionMode()&&!this._selectedHeaderInfo)return this._selectCellItem(e,i,s,r);var n=!1,o=e.getListData().item||e.getData();if(e&&this.isItemSelectable(o)){var a=this._iterator.getBookmark(),l=this.itemRendererToIndex(e),h=this._itemToUID(o);if("selectorColumn"==this._selectionMode){var n=!0,d=this.getSelectorColumnIndex();!(e instanceof Vb||e instanceof tb)&&0<=d&&this._columns[d].syncWithRowClick&&(null!=this._columns[d].getSecondLabelFunction()&&(n=this._columns[d].itemToSecondLabel(o)),n&&(this._selectedData[h]?this._columns[d]._removeSelectedItem(h,e):this._columns[d]._addSelectedItem(h,o,l,e))),this._drawItem(this._visibleData[h],!!this._selectedData[h],h==this._highlightUID,!0,!1),this._iterator.seek(t.getCURRENT(),l-this.indicesToIndex(this.getVerticalScrollPosition(),this.getHorizontalScrollPosition())),this._caretIndex=l,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=l,this._anchorBookmark=this._iterator.getBookmark(),this._iterator.seek(a,0),n=!1}else if(this._allowMultipleSelection&&(i||s))if(i&&this._allowMultipleSelection){if(this._anchorBookmark){h=this._anchorBookmark,n=this._anchorIndex,d=this._anchorIndex<l,this._clearSelected(!1),this._caretIndex=l,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=n,this._anchorBookmark=h;try{this._iterator.seek(this._anchorBookmark,0)}catch(c){c instanceof ca&&(c.addResponder(new S(this._selectionPendingResultHandler,this._selectionPendingFailureHandler,new ve(d,l,o,r,a,t.getCURRENT(),0))),this._iteratorValid=!1)}this._shiftSelectionLoop(d,this._anchorIndex,o,r,a)}n=!0}else s&&this._allowMultipleSelection&&(this._selectedData[h]?(this._removeSelectionData(h),this._drawItem(this._visibleData[h],!1,h==this._highlightUID,!0,r),e.getData()==this._selectedItem&&this._calculateSelectedIndexAndItem()):(this._addSelectionData(h,new Nb(o,l,this._approximate)),this._drawItem(this._visibleData[h],!0,h==this._highlightUID,!0,r),this._selectedIndex=l,this._selectedItem=o),this._iterator.seek(t.getCURRENT(),l-this.indicesToIndex(this.getVerticalScrollPosition(),this.getHorizontalScrollPosition())),this._caretIndex=l,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=l,this._anchorBookmark=this._iterator.getBookmark(),this._iterator.seek(a,0),n=!0);else{if(d=0,this._allowMultipleSelection){var _=this._firstSelectionData;null!=_&&(d++,_._nextSelectionData&&d++)}s&&this._selectedData[h]?(n=!0,a=this._caretIndex,this._clearSelected(r),this._caretIndex=a):(this._selectedIndex!=l||this._bSelectedIndexChanged||this._allowMultipleSelection&&1!=d)&&(n=!0,this._clearSelected(r),this._addSelectionData(h,new Nb(o,l,this._approximate)),this._drawItem(this._visibleData[h],!0,h==this._highlightUID,!0,r),this._selectedIndex=l,this._selectedItem=o,this._iterator.seek(t.getCURRENT(),this._selectedIndex-this.indicesToIndex(this.getVerticalScrollPosition()-this._offscreenExtraRowsTop,this.getHorizontalScrollPosition()-this._offscreenExtraColumnsLeft)),this._caretIndex=this._selectedIndex,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=this._selectedIndex,this._anchorBookmark=this._iterator.getBookmark(),this._iterator.seek(a,0))}Xb&&(e.getEnabled()?e.focus():this.focus(),0<this._listSubContent.element.scrollTop&&(this._listSubContent.element.scrollTop=0))}else n=!1;return o instanceof C&&(this._selectedItem=null),n},l.prototype._isDataEditable=function(t){var e;if(this.isItemDeleted(t))return!1;if(this._rootModel&&(this._rootModel instanceof fa||this._rootModel instanceof ja)&&(this._rootModel.hasChildren(t)&&this._editable.indexOf("group"),t instanceof ic&&this._editable.indexOf("summary")),(e=-1!=this._editable.indexOf("item"))&&this._isSpanCollectionView()){if(this._collection instanceof va&&t instanceof ic)return-1!=this._editable.indexOf("summary");if((t=this._getRowAttribute(t))&&!t.editable)return!1}return e},l.prototype._updateDisplayOfItemRenderer=function(t){this._applyUserStylesForItemRenderer(t),t instanceof R&&t.invalidateDisplayList()},l.prototype._applyUserStylesForItemRenderer=function(t){if(t&&t instanceof u){var e,i,s=this._columnMap[t.name];if(this._isSpanCollectionView()){if(null!=this._styleFunction&&(i=this._styleFunction(t.getData(),s)))for(e in i)this._oldCellStyles[t.uno]||(this._oldCellStyles[t.uno]={}),null==this._oldCellStyles[t.uno][e]&&(this._oldCellStyles[t.uno][e]=m.getStyleInline(t,e)),t.setStyle(e,i[e]);if(s&&null!=s.getStyleFunction()&&(i=s.getStyleFunction()(t.getData(),s)))for(e in i)this._oldCellStyles[t.uno]||(this._oldCellStyles[t.uno]={}),null==this._oldCellStyles[t.uno][e]&&(this._oldCellStyles[t.uno][e]=m.getStyleInline(t,e)),t.setStyle(e,i[e])}else{if(this._oldStyles||(this._oldStyles={}),this._oldStyles[t.uno]){for(e in this._oldStyles[t.uno])t.clearStyle(e);delete this._oldStyles[t.uno]}if(null!=this._styleFunction&&(i=this._styleFunction(t.getData(),s)))for(e in i)this._oldStyles[t.uno]||(this._oldStyles[t.uno]={}),this._oldStyles[t.uno][e]=m.getStyleInline(t,e),t.setStyle(e,i[e]);if(s&&null!=s.getStyleFunction()&&(i=s.getStyleFunction()(t.getData(),s)))for(e in i)this._oldStyles[t.uno]||(this._oldStyles[t.uno]={}),this._oldStyles[t.uno][e]||(this._oldStyles[t.uno][e]=m.getStyleInline(t,e)),t.setStyle(e,i[e])}}},l.prototype._drawSelectionIndicator=function(t,e,i,s,r,n,o){this._isSpanCollectionView()&&this._isRowSelectionMode()?this._drawSelectionRowIndicator(t,e,i,s,r,n,o):(this._isRowSelectionMode()&&(s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right),t.setWidth(s),t.setHeight(r),t.setStyle("backgroundColor",n),t.setVisibility(!0),t.setX(e),t.setY(i))},l.prototype._drawHighlightIndicator=function(t,e,i,s,r,n,o){this._isSpanCollectionView()&&this._isRowSelectionMode()?this._drawHighlightRowIndicator(t,e,i,s,r,n,o):(this._isRowSelectionMode()&&(s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right),t.setWidthInline(s),t.setHeightInline(r),t.setStyle("backgroundColor",n),t.setVisibility(!0),t.setX(e),t.setY(i))},l.prototype._scrollVertically=function(e,i,s){this._iterator.seek(t.getCURRENT(),this._lockedRowCount);var r,n,o,a=this._rowInfo.length,l=this._isSpanCollectionView()&&this._itemAttributes;a>this._listItems.length&&(a=this._listItems.length);var h,d=this._listItems[0].length,c=0;if(r=0<this._lockedRowCount?this._rowInfo[this._lockedRowCount-1].y+this._rowInfo[this._lockedRowCount-1].height:this._rowInfo[0].y,s){for(s=this._lockedRowCount;s<a&&!(this._rowInfo[s].y>=r);s++);var _=s;if(l&&(this._makeItemAttributes(a,i+_),this._variableRowHeight)){for(s=i+_;s<a;s++)if((r=this._getRowSpanHeight(s,this._rowInfo[s].height,i+_))&&r!=this._rowInfo[s].height){if(this._needRedrawSelection=!0,h=r-this._rowInfo[s].height,this._rowInfo[s].height+=h,o=Math.min(d,this._listItems[s].length),"top"!=this._cachedVerticalAlign)for(r=0;r<o;r++)n=this._listItems[s][r],"middle"==this._cachedVerticalAlign?n.setY(n.getY()+h/2):n.setY(n.getY()+h);for(var u=s+1;u<a;u++)for(this._rowInfo[u].y+=h,o=Math.min(d,this._listItems[u].length),r=0;r<o;r++)n=this._listItems[u][r],n.setY(n.getY()+h)}s=_}for(;s<i+_;s++){c+=this._rowInfo[s].height;try{this._iterator.moveNext()}catch(p){if(p instanceof ca)return this._lastSeekPending=new Da(t.getFIRST(),e),p.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),void(this._iteratorValid=!1)}}for(s=this._lockedRowCount;s<a;s++)if(o=Math.min(d,this._listItems[s].length),s<i+this._lockedRowCount)this._destroyRow(s,o);else if(0<i){for(r=0;r<o;r++)n=this._listItems[s][r],n.setY(n.getY()-c),l&&this._itemAttributes[s]&&(this._itemAttributes[s][r].oY-=c),n.getData()&&n instanceof qa&&(n.getListData().rowIndex=s),this._rowMap[n.name].rowIndex=s;this._rowInfo[s].y-=c,(o=this._rowInfo[s].uid)&&this._moveIndicators(o,-c,!1)}if(i){for(s=this._lockedRowCount+i;s<a;s++){for(o=this._listItems[s].length,r=0;r<o;r++)n=this._listItems[s][r],n.getData()&&n instanceof qa&&(n.getListData().rowIndex=s-i),this._rowMap[n.name].rowIndex=s-i,this._listItems[s-i][r]=n,l&&this._itemAttributes[s-i]&&(this._itemAttributes[s-i][r]=this._itemAttributes[s][r]);this._listItems[s-i].length>o&&(this._listItems[s-i].splice(o,this._listItems[s-i].length-o),l&&this._itemAttributes[s-i]&&this._itemAttributes[s-i].splice(o,this._itemAttributes[s-i].length-o)),o||(this._listItems[s-i].splice(0,this._listItems[s-i].length),l&&this._itemAttributes[s-i]&&this._itemAttributes[s-i].splice(0,this._itemAttributes[s-i].length)),this._rowInfo[s-i]=this._rowInfo[s]}this._listItems.splice(a-i,this._listItems.length-a+i),this._rowInfo.splice(a-i,this._rowInfo.length-a+i),l&&(this._itemAttributes.splice(a-i,this._itemAttributes.length-a+i),this._makeItemAttributes(this._listItems.length))}e=this._rowInfo&&0<this._rowInfo.length?this._rowInfo[a-i-1].y+this._rowInfo[a-i-1].height:0,s=this._iterator.getBookmark();try{this._iterator.seek(t.getCURRENT(),a-this._lockedRowCount-i)}catch(p){p instanceof ca&&(this._lastSeekPending=new Da(s,0),p.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}this._makeRowsAndColumns(0,e,this._listContent.getWidth(),this._listContent.getHeight(),0,a-i),this._iterator.seek(s,0)}else{for(e=0<this._lockedRowCount?this._rowInfo[this._lockedRowCount-1].y+this._rowInfo[this._lockedRowCount-1].height:this._rowInfo[0].y,s=0;s<i;s++)this._listItems.splice(this._lockedRowCount,0,null),this._rowInfo.splice(this._lockedRowCount,0,null),l&&this._itemAttributes.splice(this._lockedRowCount,0,null);try{this._iterator.seek(t.getCURRENT(),-i)}catch(p){p instanceof ca&&(this._lastSeekPending=new Da(t.getCURRENT(),(-i)),p.addResponder(new S(this._seekPendingResultHandler,this._seekPendingFailureHandler,this._lastSeekPending)),this._iteratorValid=!1)}if(s=this._iterator.getBookmark(),_=this._makeRowsAndColumns(0,e,this._listContent.getWidth(),this._listContent.getHeight(),0,this._lockedRowCount,!0,i),this._iterator.seek(s,0),0==_.y&&(this.setVerticalScrollPosition(0),this._rowInfo.splice(this._lockedRowCount,i),this._listItems.splice(this._lockedRowCount,i),l&&this._itemAttributes.splice(this._lockedRowCount,i)),l&&(this._makeItemAttributes(this._listItems.length),this._variableRowHeight))for(s=this._lockedRowCount+_.y;s<this._listItems.length;s++)if((r=this._getRowSpanHeight(s,this._rowInfo[s].height,this._lockedRowCount,!0))&&r!=this._rowInfo[s].height){if(this._needRedrawSelection=!0,h=r-this._rowInfo[s].height,this._rowInfo[s].height+=h,o=Math.min(d,this._listItems[s].length),"top"!=this._cachedVerticalAlign)for(r=0;r<o;r++)n=this._listItems[s][r],"middle"==this._cachedVerticalAlign?n.setY(n.getY()+h/2):n.setY(n.getY()+h),n.setActualSize(n.getWidth(),this._rowInfo[s].height);for(u=s+1;u<a;u++)for(this._rowInfo[u].y+=h,o=Math.min(d,this._listItems[u].length),r=0;r<o;r++)n=this._listItems[u][r],n.setY(n.getY()+h),this._itemAttributes[u]&&this._itemAttributes[u][r]&&(this._itemAttributes[u][r].oY+=h)}for(s=0;s<_.y;s++)c+=this._rowInfo[this._lockedRowCount+s].height;for(a=this._listContent.getHeight(),e+=c,s=this._lockedRowCount+_.y;s<this._listItems.length;s++){if(o=this._listItems[s],c=this._rowInfo[s],d=!1,_=e-c.y,c.y=e,o.length)for(r=0;r<o.length;r++)n=o[r],h=n.getY(),l&&this._itemAttributes[s]&&this._itemAttributes[s][r]?(n.setY(h+_),this._itemAttributes[s][r].oY+=_,0==this._itemAttributes[s][r].type?h+_>=a&&(d=!0):this._itemAttributes[s][r].oY>=a&&n.getVisible()?d=!0:d||r!=o.length-1||3!=this._itemAttributes[s][r].type||h+_>=a&&(d=!0)):(n.setY(h+_),h+_>=a&&(d=!0)),d||(this._rowMap[n.name].rowIndex+=i);else c.y>=a&&(d=!0);if(o=this._rowInfo[s].uid,d){if(d=this._listItems[s],this._selectedData[o]&&this._isSpanCollectionView())for(r=0;r<d.length;r++)if(!d[r].getVisible())for(_=s-1;0<=_;_--)if((n=this._listItems[_][r])&&n.getVisible()){this._updateDisplayOfItemRenderer(n);break}for(d.length&&d[0].getData()&&this._removeIndicators(o),r=0;r<d.length;r++)d[r]&&d[r].getData()&&(delete this._visibleData[o],this._addToFreeItemRenderers(d[r]));this._listItems.splice(s,1),this._rowInfo.splice(s,1),l&&this._itemAttributes.splice(s,1),s--}o&&(this._moveIndicators(o,e,!0),this._selectionIndicators[o]&&this._selectionIndicators[o].setY(e),this._highlightUID==o&&this._highlightIndicator.setY(e),this._caretUID==o&&this._caretIndicator.setY(e+1)),e+=c.height}}this._iterator.seek(t.getCURRENT(),-this._lockedRowCount)},l.prototype._removeIndicators=function(t){if(this._isCellSelectionMode()){for(var e in this._cellSelectionIndicators[t])this._removeCellIndicators(t,e);for(e in this._visibleCellRenderers[t])delete this._visibleCellRenderers[t][e];delete this._visibleCellRenderers[t],t==this._highlightUID&&(this._highlightUID=this._highlightItemRenderer=null,this._highlightIndicator&&this._highlightIndicator.setVisibility(!1))}this._isRowSelectionMode()&&(this._selectionIndicators[t]&&(this._selectionLayer.removeChild(this._selectionIndicators[t]),this._selectionIndicators[t]=null),t==this._highlightUID&&(this._highlightUID=this._highlightItemRenderer=null,this._highlightIndicator&&this._highlightIndicator.setVisibility(!1)),t==this._caretUID&&(this._caretUID=this._caretItemRenderer=null,this._caretIndicator&&this._caretIndicator.setVisibility(!1)))},l.prototype._moveIndicators=function(t,e,i){if(t&&(i||0!=e)){if(this._isCellSelectionMode()){if(this._cellSelectionIndicators[t])for(var s in this._cellSelectionIndicators[t])i?this._cellSelectionIndicators[t][s].setY(e):this._cellSelectionIndicators[t][s].setY(this._cellSelectionIndicators[t][s].getY()+e)}else this._selectionIndicators[t]&&(i?this._selectionIndicators[t].setY(e):this._selectionIndicators[t].setY(this._selectionIndicators[t].getY()+e));this._highlightUID==t&&(i?this._highlightIndicator.setY(e):this._highlightIndicator.setY(this._highlightIndicator.getY()+e)),this._caretUID==t&&(i?this._caretIndicator.setY(e+1):this._caretIndicator.setY(this._caretIndicator.getY()+e))}},l.prototype._initListData=function(t,e){if(null!=t){var i=this.isItemOpen(t);this._isBranch(t),this._itemToUID(t),this._displayDisclosureIcon&&(e.disclosureIcon=this.getStyle(i?"disclosureOpenIcon":"disclosureClosedIcon")),e.open=i,e.hasChildren=this._rootModel.hasChildren(t),e.depth=this._itemPending?1:this._getItemDepth(t,e.rowIndex),e.indent=(e.depth-1)*this.getStyle("indentation"),e.item=t,null!=this._groupIconFunction&&this._isBranch(t)&&null!=this._groupIconFunction(t,e.depth)?e.icon=this._groupIconFunction(t,e.depth):e.icon=this.itemToIcon(t)}},l.prototype._clearAllSelection=function(){this._isCellSelectionMode()&&(this._clearSelectedCells(),this._clearCellIndicators()),this._isRowSelectionMode()&&(this._clearSelected(),this._clearIndicators())},l.prototype._selectCellItem=function(e,i,s,r){if(r=!(3<arguments.length)||r,!this.selectable||!e||!this._itemRendererToIndices(e)||this._isHeaderItemRenderer(e))return!1;var n=!1,o=this._iterator.getBookmark(),a=this._itemRendererToIndices(e);if(0>a.x)return!1;var l=a.y,h=this._displayToAbsoluteColumnIndex(a.x),d=e.getData(),d=this._itemToUID(d);if("singleCell"==this._selectionMode||"multipleCells"==this._selectionMode&&!s&&!i){var c=0;if("multipleCells"==this._selectionMode){var _=this._firstCellSelectionData;null!=_&&(c++,_._nextSelectionData&&c++)}s&&this._cellSelectionData[d]&&this._cellSelectionData[d][h]?(n=!0,o=this._caretIndex,l=this._caretColumnIndex,this._clearSelectedCells(),this._caretIndex=o,this._caretColumnIndex=l):(this._selectedIndex!=l||this._selectedColumnIndex!=h||"multipleCells"==this._selectionMode&&1!=c||"singleCell"==this._selectionMode)&&(n=!0,this._clearSelectedCells(),this._addCellSelectionData(d,h,new ye(e.getData(),l,h,(!1))),this._addToSelectedCells(l,h),this._drawCellItem(e,!0,d==this._highlightUID&&h==this._highlightColumnIndex,!0,r),this._selectedColumnIndex=h,this._selectedIndex=a.y,this._iterator.seek(t.getCURRENT(),this._selectedIndex-this.getVerticalScrollPosition()),this._anchorColumnIndex=this._caretColumnIndex=this._selectedColumnIndex,this._anchorIndex=this._caretIndex=this._selectedIndex,this._anchorBookmark=this._caretBookmark=this._iterator.getBookmark(),this._iterator.seek(o,0))}else if(i&&"multipleCells"==this._selectionMode){if(this._anchorBookmark){n=this._anchorBookmark,a=this._anchorIndex,d=this._anchorColumnIndex,this._clearSelectedCells(),this._caretIndex=l,this._caretColumnIndex=h,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=a,this._anchorBookmark=n,this._anchorColumnIndex=d;try{this._iterator.seek(this._anchorBookmark,0)}catch(u){u instanceof ca&&(u.addResponder(new S(this._cellSelectionPendingResultHandler,this._cellSelectionPendingFailureHandler,new Se(l,this._anchorIndex,h,this._anchorColumnIndex,e.getData(),r,o,t.getCURRENT(),0))),this._iteratorValid=!1)}this._shiftCellSelectionLoop(l,this._anchorIndex,h,this._anchorColumnIndex,e.getData(),r,o),n=!0}}else s&&"multipleCells"==this._selectionMode&&(this._cellSelectionData[d]&&this._cellSelectionData[d][h.toString()]?(this._removeCellSelectionData(d,h),this._drawCellItem(this._visibleCellRenderers[d][h.toString()],!1,d==this._highlightUID&&h==this._highlightColumnIndex,!0,r),this._removeFromSelectedCells(l,h)):(this._addCellSelectionData(d,h,new ye(e.getData(),l,h,(!1))),this._visibleCellRenderers[d]&&this._drawCellItem(this._visibleCellRenderers[d][h.toString()],!0,d==this._highlightUID&&h==this._highlightColumnIndex,!0,r),this._addToSelectedCells(l,h),this._selectedIndex=l,this._selectedColumnIndex=h),this._iterator.seek(t.getCURRENT(),l-this.getVerticalScrollPosition()),this._caretIndex=l,this._caretColumnIndex=h,this._caretBookmark=this._iterator.getBookmark(),this._anchorIndex=l,this._anchorColumnIndex=h,this._anchorBookmark=this._iterator.getBookmark(),this._iterator.seek(o,0),n=!0);return this._checkAndCreateTempTextInput(),Xb&&(e.focus(),0<this._listSubContent.element.scrollTop&&(this._listSubContent.element.scrollTop=0)),n},l.prototype._checkAndCreateTempTextInput=function(){if(!(r.ie10||r.ie11||r.isMobile||Xb||"excel"!==this.editingKeyMode)&&this.getEditable().length){var t;t=this._columns[this._caretColumnIndex],t.rendererIsEditor||!t.itemEditor||t.itemEditor.generator!=Y||this.itemEditorInstance||(this._tempTextInput||(this._tempTextInput=t.itemEditor.newInstance()),this._addRendererToContentArea(this._tempTextInput,t),t=this._tempTextInput.getParent(),t.setChildIndex(this._tempTextInput,this._tempTextInput.getParent().getNumChildren()-1),this._columnGrouping&&(t===this._listSubContent?this._tempTextInput.setX(this._listSubContent.element.scrollLeft):0!=this._tempTextInput.getX()&&this._tempTextInput.setX(0)),this._tempTextInput.setText(""),this._tempTextInput.setActualSize(0,0),this._tempTextInput.setStyle("zIndex",-1),this._tempTextInput.setStyle("padding",0),this._tempTextInput.focus(),this._tempTextInput.callLater(this._tempTextInput.focus))}},l.prototype._displayToAbsoluteColumnIndex=function(t){return this._displayableColumns[t].colNum},l.prototype._clearCellIndicators=function(){for(var t in this._cellSelectionIndicators)for(var e in this._cellSelectionIndicators[t])this._removeCellIndicators(t,parseInt(e));this._highlightIndicator&&this._highlightIndicator.setVisibility(!1),this._cellSelectionIndicators={},this._visibleCellRenderers={}},l.prototype._indexToColNum=function(t){return this._getOptimumColumns()==this._visibleColumns?this._visibleToAbsoluteColumnIndex(t):this._getOptimumColumns()==this._displayableColumns?this._displayToAbsoluteColumnIndex(t):-1},l.prototype._clearPendingCells=function(){this._cellsWaitingToBeDisplayed=!1,this._pendingCellSelection.removeAll()},l.prototype._clearCellSelectionData=function(){this._cellSelectionData={},this._firstCellSelectionData=null},l.prototype._visibleToAbsoluteColumnIndex=function(t){return this._getOptimumColumns()[t].colNum},l.prototype._addCellSelectionData=function(t,e,i){null!=this._firstCellSelectionData&&(this._firstCellSelectionData._prevSelectionData=i),i._nextSelectionData=this._firstCellSelectionData,this._firstCellSelectionData=i,this._cellSelectionData[t]||(this._cellSelectionData[t]={}),this._cellSelectionData[t][e.toString()]=i},l.prototype._drawCellItem=function(t,e,i,s,r){if(e=1<arguments.length&&e,i=2<arguments.length&&i,s=3<arguments.length&&s,r=4<arguments.length&&r,t&&!this._isHeaderItemRenderer(t)){var n=this._itemRendererToIndices(t);if(n){var o,a=this._displayToAbsoluteColumnIndex(n.x),l=this._rowMap[t.name],h=t.getX(),d=this._rowInfo[l.rowIndex].height;if(this._isSpanCollectionView()&&(o=this._getItemAttribute(l.rowIndex,n.x))&&o.ca&&1<o.ca.rowSpan)if(o.rh)d=o.rh;else if(o.vi)for(var d=0,c=l.rowIndex;c<l.rowIndex+o.ca.rowSpan-o.ca._rowGap&&!(this._rowInfo[c]&&(d+=this._rowInfo[c].height,0<this._lockedRowCount&&c==this._lockedRowCount-1));c++);for(i&&(!this._highlightItemRenderer||this._highlightUID!=l.uid&&a!=this._highlightColumnIndex)?(this._highlightIndicator||(this._highlightIndicator=o=new A("div","DataGridBackground")),o=this._highlightIndicator,this._addIndicatorToSelectionLayer(o,n.x),this._drawHighlightIndicator(o,h,this._rowInfo[l.rowIndex].y,t.getWidth(),d,this.getStyle("rollOverColor"),t),this._highlightItemRenderer=t,this._highlightUID=l.uid,this._highlightColumnIndex=a):!i&&this._highlightItemRenderer&&l&&this._highlightUID==l.uid&&this._highlightColumnIndex==a&&(this._highlightIndicator&&this._highlightIndicator.setVisibility(!1),this._lastHighlightItemRenderer=this._highlightItemRenderer,this._highlightUID=this._highlightItemRenderer=null,this._highlightColumnIndex=-1),e?(this._isSpanCollectionView()&&!this._calledSetItemVisible&&(this._needRedrawSelection=!0),this._cellSelectionIndicators[l.uid]||(this._cellSelectionIndicators[l.uid]={}),this._cellSelectionIndicators[l.uid][a.toString()]||(o=new A("div","DataGridBackground"),this._cellSelectionIndicators[l.uid][a.toString()]=o),o=this._cellSelectionIndicators[l.uid][a.toString()],this._addIndicatorToSelectionLayer(o,n.x),this._drawSelectionIndicator(o,h,this._rowInfo[l.rowIndex].y,t.getWidth(),d,this.getEnabled()?this.getStyle("selectionColor"):this.getStyle("selectionDisabledColor"),t)):!e&&l&&this._cellSelectionIndicators[l.uid]&&this._cellSelectionIndicators[l.uid][a.toString()]&&(o=this._cellSelectionIndicators[l.uid][a.toString()],o.getParent()&&o.getParent().removeChild(o),delete this._cellSelectionIndicators[l.uid][a.toString()],this._atLeastOneProperty(this._cellSelectionIndicators[l.uid])||delete this._cellSelectionIndicators[l.uid]),s?this._showCaret&&(this._caretIndicator||(this._caretIndicator=o=new A("div","DataGridBackground")),o=this._caretIndicator,this._addIndicatorToSelectionLayer(o,n.x),this._drawCaretIndicator(o,h+1,this._rowInfo[l.rowIndex].y,t.getWidth()-1,d,this.getStyle("selectionColor"),t),this._caretItemRenderer=t,this._caretUID=l.uid,this._caretColumnIndex=a):!s&&this._caretItemRenderer&&this._caretUID==l.uid&&this._caretColumnIndex==a&&(this._caretIndicator&&this._caretIndicator.setVisibility(!1),this._caretUID=this._caretItemRenderer=null),t instanceof R&&t.invalidateDisplayList(),n=this._rowMap[t.name].rowIndex,h=this._getOptimumColumns(),a=0;a<h.length;a++)l=this._listItems[n][a],this._updateDisplayOfItemRenderer(l)}}},l.prototype._addIndicatorToSelectionLayer=function(t,e){e<this._lockedColumnCount?t.getParent()!=this._selectionLayer?this._selectionLayer.addChild(t):t.getParent().setChildIndex(t,t.getParent().getNumChildren()-1):t.getParent()!=this._movingSelectionLayer?this._movingSelectionLayer.addChild(t):t.getParent().setChildIndex(t,t.getParent().getNumChildren()-1)},l.prototype._removeCellIndicators=function(t,e){this._cellSelectionIndicators[t]&&this._cellSelectionIndicators[t][e.toString()]&&(this._cellSelectionIndicators[t][e.toString()].getParent().removeChild(this._cellSelectionIndicators[t][e.toString()]),delete this._cellSelectionIndicators[t][e.toString()],this._atLeastOneProperty(this._cellSelectionIndicators[t])||delete this._cellSelectionIndicators[t]),t==this._highlightUID&&e==this._highlightColumnIndex&&(this._lastHighlightItemRenderer=this._highlightItemRenderer,this._highlightUID=this._highlightItemRenderer=null,this._highlightIndicator&&this._highlightIndicator.setVisibility(!1)),t==this._caretUID&&e==this._caretColumnIndex&&(this._caretUID=this._caretItemRenderer=null,this._caretIndicator&&this._caretIndicator.setVisibility(!1))},l.prototype._atLeastOneProperty=function(t){for(var e in t)return!0;return!1},l.prototype._removeCellSelectionData=function(t,e){if(this._cellSelectionData[t]){var i=this._cellSelectionData[t][e.toString()];this._firstCellSelectionData==i&&(this._firstCellSelectionData=i._nextSelectionData),null!=i._prevSelectionData&&(i._prevSelectionData._nextSelectionData=i._nextSelectionData),null!=i._nextSelectionData&&(i._nextSelectionData._prevSelectionData=i._prevSelectionData),delete this._cellSelectionData[t][e.toString()],this._atLeastOneProperty(this._cellSelectionData[t])||delete this._cellSelectionData[t]}},l.prototype._selectData=function(t,e,i,s){if(this._isCellSelectionMode()){var r=this._selectedColumnIndex;this._cellSelectionData[t]&&this._cellSelectionData[t][r]||(this._cellSelectionIndicators[t]&&this._cellSelectionIndicators[t][r]?this._selectCellItem(this._cellSelectionData[t][r],!1,!1):(this._clearSelectedCells(),this._addCellSelectionData(t,r,new ye(e,i,r,(!1))),this._selectedColumnIndex=this._caretColumnIndex=this._anchorColumnIndex=r,this._selectedIndex=this._caretIndex=this._anchorIndex=i,this._caretBookmark=this._anchorBookmark=s))}else this._selectedData[t]||(this._visibleData[t]?this._selectItem(this._visibleData[t],!1,!1):(this._clearSelected(),this._addSelectionData(t,new Nb(e,i,this._approximate)),this._caretIndex=this._selectedIndex=i,this._caretBookmark=s,this._anchorIndex=i,this._anchorBookmark=s,this._selectedItem=e))},l.prototype._absoluteToVisibleIndices=function(t,e){var i=-1,s=-1;if((t<this._lockedRowCount||t>=this.getVerticalScrollPosition())&&t<=this.getVerticalScrollPosition()+(this._listItems.length?this._listItems.length-1:0)&&(i=t>=this._lockedRowCount&&t>=this.getVerticalScrollPosition()?t-this.getVerticalScrollPosition():t),-1<i){var r=this._visibleColumns;r&&0<r.length&&e>=r[0].colNum&&e<=r[r.length-1].colNum&&(s=e>=this._lockedColumnCount?this._absoluteToVisibleColumnIndex(e):e)}return{rowIndex:i,columnIndex:s}},l.prototype._copySelectedItems=function(t){t=!(0<arguments.length)||t;for(var e=[],i=this._firstSelectionData;null!=i;)t?e.push(i.data):e.push(i.index),i=i._nextSelectionData;return e},l.prototype._updateList=function(){this._removeClipMask();var t=this._iterator?this._iterator.getBookmark():null;this._clearIndicators(),this._visibleData={},this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0),this._iterator&&this._iterator.seek(t,0),this._drawRowBackgrounds(),this._configureScrollBars(),this._addClipMask(!0)},l.prototype._viewDisplayableColumnAtOffset=function(t,e,i,s){i=2<arguments.length?i:-1,s=!(3<arguments.length)||s;var r=this._absoluteToDisplayColumnIndex(t);if(-1==r)return-1;for(var n=this._displayableColumns.length,r=r+e;0<=r&&r<=n-1;r+=e){if(-1<i){var o,a=this._absoluteToVisibleIndices(i,this._displayToAbsoluteColumnIndex(r));if(this._listItems[a.rowIndex]&&(o=this._listItems[a.rowIndex][a.columnIndex]),o&&!o.getVisible()){if(!this._isSpanCollectionView())continue;if(a=this._itemAttributes[a.rowIndex][a.columnIndex],!(a&&0<=a.oRno))continue}}if(n=this._displayToAbsoluteColumnIndex(r),0>n||n>this._columns.length-1)break;return s&&(o=this._isColumnFullyVisible(n),0!=o&&this._scrollToViewColumn(n,t,o)),n}return-1},l.prototype._absoluteToDisplayColumnIndex=function(t){var e,i=this._displayableColumns.length;for(e=0;e<i;e++)if(this._displayableColumns[e].colNum==t)return e;return-1},l.prototype._isColumnFullyVisible=function(t,e){e=1<arguments.length?e:-1,-1==e&&(e=this.getVerticalScrollPosition());var i=this._absoluteToVisibleIndices(e,t),s=i.rowIndex,i=i.columnIndex;if(0>s)return!1;var r=-1==i?-1:0;if(-1!=i&&1<=this._listItems.length&&1<=this._visibleColumns.length){var n=this._listItems[s][i].getX();this._getOptimumColumns()==this._displayableColumns&&i>this._lockedColumnCount&&(n=this._getAdjustedXPos(n));var o=Math.floor(n+this._listItems[s][i].getWidth());if(o>this._listContent.getWidth())return o-this._listContent.getWidth();if(this._listSubContent.getScrollRect()&&(o<=this._listSubContent.getX()||n==this._listItems[s][i].getX()&&n==this._listSubContent.getX()))return-1}return r},l.prototype._selectColumnHeader=function(t){if(this._columnGrouping&&null!=this._selectedHeaderInfo)this._selectColumnGroupHeader(this._selectedHeaderInfo);else{var e,i=-1;for(e=0;e<this._visibleColumns.length;e++)if(this._visibleColumns[e].colNum==t){i=e;break}if(-1==i&&(i=0,this._headerIndex=this._visibleColumns[0].colNum),t=this._selectionLayer.getChildByName("headerKeyboardSelection"),t||(t=new A("div","DataGridBackground"),t.name="headerKeyboardSelection",this._selectionLayer.addChild(t)),e=this._selectedHeaderInfo.headerItem){var s=e.getHeight()+this._cachedHeaderPaddingBottom+this._cachedHeaderPaddingTop-this.getSizeStyle("headerBorderBottomWidth"),r=e.getY()-this._cachedHeaderPaddingTop;1>r&&(r+=this.getSizeStyle("headerBorderTopWidth"),s-=this.getSizeStyle("headerBorderTopWidth")),t.setStyle("backgroundColor",this._isPressed||this._isKeyPressed?this.getStyle("selectionColor"):this.getStyle("headerRollOverColor")),t.setWidthInline(this._visibleColumns[i].getWidth()),t.setHeightInline(s),t.setX(this._getAdjustedXPos(e.getX())),t.setY(r),this._caretIndex=-1,this._isPressed=!1,this._selectItem(this._selectedHeaderInfo.headerItem,!1,!1)}}},l.prototype._selectColumnGroupHeader=function(t){var e,i,s,r=t.headerItem;t.actualColNum<this._lockedColumnCount?(e=this._selectionLayer,i=this._movingSelectionLayer):(e=this._movingSelectionLayer,i=this._selectionLayer),(s=e.getChildByName("headerKeyboardSelection"))||(s=i.getChildByName("headerKeyboardSelection")),s||(s=new A("div","DataGridBackground"),s.name="headerKeyboardSelection"),
s.getParent()!=e&&e.addChild(s),e=r.getHeight()+this._cachedHeaderPaddingBottom+this._cachedHeaderPaddingTop-this.getSizeStyle("headerBorderBottomWidth"),i=r.getY()-this._cachedHeaderPaddingTop,1>i&&(i+=this.getSizeStyle("headerBorderTopWidth"),e-=this.getSizeStyle("headerBorderTopWidth")),s.setStyle("backgroundColor",this._isPressed||this._isKeyPressed?this.getStyle("selectionColor"):this.getStyle("headerRollOverColor")),s.setWidth(r.getWidth()),s.setHeight(e),s.setX(r.getX()),s.setY(i),this._caretIndex=-1,this._isPressed=!1,this._selectItem(t.headerItem,!1,!1)},l.prototype._unselectColumnHeader=function(t,e){e=1<arguments.length&&e;var i=this._selectionLayer.getChildByName("headerKeyboardSelection");i||(i=this._movingSelectionLayer.getChildByName("headerKeyboardSelection")),i&&i.getParent().removeChild(i),this._selectedHeaderInfo=null,e&&(this._caretIndex=0,this._isPressed=!1,this._isCellSelectionMode()?(this._caretColumnIndex=t,this._selectItem(this._listItems[this._caretIndex][this._absoluteToVisibleColumnIndex(t)],!1,!1)):this._selectItem(this._listItems[this._caretIndex][0],!1,!1))},l.prototype._findSortField=function(t){var e;if(this._collection&&this._collection.getSort())for(e=0;e<this._collection.getSort().getFields().length;e++)if(this._collection.getSort().getFields()[e].name==t)return e;return-1},l.prototype._addSortField=function(t,e,i){var s=this._columns[e];if(s.sortable){var r=this._getHeaderInfo(s);if(!r||null==r.internalLabelFunction||null!=s.getSortCompareFunction()){if(r=!1,i.getSort()&&i.getSort().getFields())0==i.getSort().getFields().length&&(r=!0);else{var r=!0,n=new Ac;n.setFields([]),i.setSort(n)}r?(this._lastSortIndex=this._sortIndex,this._sortIndex=e,this._sortColumn=s,this._sortDirection="DESC"):(this._sortIndex=this._lastSortIndex=-1,this._sortDirection=this._sortColumn=null),s.sortDescending=!1,t=new sb(t),null!=s.getSortCompareFunction()&&t.setCompareFunction(s.getSortCompareFunction()),i.getSort().getFields().push(t)}}},l.prototype._removeSortField=function(t,e,i){if(t=this._columns[e],i&&i.getSort()&&i.getSort().getFields()&&i.getSort().getFields().length){e=-1;var s,r=i.getSort().getFields().length;for(s=0;s<r;s++)if(i.getSort().getFields()[s].name==t.getDataField()){e=s;break}-1!=e&&i.getSort().getFields().splice(e,1)}},l.prototype._indexToRow=function(t){return t},l.prototype._indexToColumn=function(t){return 0},l.prototype._invalidateHeaders=function(){var t,e=this._orderedHeadersList.length;for(t=0;t<e;t++)this._invalidateRenderer(this._orderedHeadersList[t].headerItem)},l.prototype._calculateRowHeight=function(t,e,i){i=2<arguments.length&&i;var s,r,n,o=0,a=this._columns.length;if(i&&this._visibleColumns.length==this._columns.length)return e;var l=this.getSizeStyle("paddingTop"),h=this.getSizeStyle("paddingBottom"),d=Math.max(this._listContent.getHeight()-(this._getHeaderVisible()&&this._headerRowInfo&&this._headerRowInfo[0]?this._headerRowInfo[0].height:0),this._rowHeight);for(this._measuringObjects||(this._measuringObjects={}),n=0;n<a;n++)i&&o<this._visibleColumns.length&&this._visibleColumns[o].colNum==this._columns[n].colNum?o++:(r=this._columns[n],r.getVisible()&&(s=this._getMeasuringRenderer(r,!1,t),this._setupRendererFromData(r,s,t),e=Math.max(e,s.getExplicitOrMeasuredHeight()+h+l)));return Math.min(e,d)},l.prototype._drawHorizontalLine=function(t,e,i,s,r){var n=new A("div","DataGridLineH"),o=n.element.style;0<this._lockedRowCount&&e==this._lockedRowCount-1?(n.setStyle("borderColor",this.getStyle("lockedLineColor")),n.setStyle("borderTopStyle","none"),e=this.getStyle("lockedLineStyle"),n.setStyle("borderBottomStyle",e),"double"==e?n.setStyle("borderBottomWidth","3px"):n.setStyle("borderBottomWidth","1px")):(o.borderColor=i,o.borderBottomStyle=s),o.left=0,o.top=r+"px",o.width=this._displayWidth+"px",t.addChild(n)},l.prototype._rowNumberToData=function(e){var i=this._collection.createCursor();return i.seek(t.getFIRST(),e),i.getAfterLast()?null:i.getCurrent()},l.prototype._drawCaretIndicator=function(t,e,i,s,r,n,o){this._isRowSelectionMode()&&(s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right),t.setWidthInline(s),t.setHeightInline(r-1),t.setStyle("borderColor",n),t.setStyle("borderWidth","1px"),t.setStyle("borderStyle","solid"),t.setVisibility(!0),t.setX(e),t.setY(i+1)},l.prototype._scrollToViewColumn=function(t,e,i){if(t!=e){var s=this._absoluteToDisplayColumnIndex(t),r=this._absoluteToDisplayColumnIndex(e);if(t=s-r,i&&s>r&&this._columns[this.getHorizontalScrollPosition()].getWidth()<i)for(s=this.getHorizontalScrollPosition(),i-=this._columns[s].getWidth(),s++;s<this._columns.length&&0<=i;s++)t++,i-=this._columns[s].getWidth();i=Math.max(0,this.getHorizontalScrollPosition()+t),0<this._lockedColumnCount&&e==this._lockedColumnCount-1&&(i=0),e=new ma(ma.SCROLL),e.detail=!1,e.direction="horizontal",e.delta=t,e.position=i,this.dispatchEvent(e),this.setHorizontalScrollPosition(i)}},l.prototype._finishCellKeySelection=function(){var t;this._listContent.getHeight();var e,i=!1,s=this._caretColumnIndex;if(this._bSelectItem&&0<=this._caretIndex-this.getVerticalScrollPosition()){this._caretIndex-this.getVerticalScrollPosition()>this._listItems.length-1&&(this._caretIndex=this._listItems.length-1+this.getVerticalScrollPosition());var r=this._absoluteToVisibleIndices(this._caretIndex,this._caretColumnIndex);if(t=r.rowIndex,r=r.columnIndex,0<=t&&0<=r&&(e=this._listItems[t][r]),this._isSpanCollectionView()){if(e&&!e.getVisible()){var n=this._getItemAttribute(t,r);if(n&&n.ca&&0<=n.oRno)if(40==this._lastKey&&n.ca&&1<n.ca.rowSpan&&0<n.ca._rowGap)this._listItems[t+n.ca.rowSpan-n.ca._rowGap]&&this._listItems[t+n.ca.rowSpan-n.ca._rowGap][n.oCno]&&(t=t+n.ca.rowSpan-n.ca._rowGap,e=this._listItems[t][n.oCno]);else if(39==this._lastKey&&n.ca&&1<n.ca.colSpan)for(;e&&!e.getVisible()&&(this._listItems[t]&&this._listItems[t][r+1]);)r++,s++,e=this._listItems[t][r];else s=n.oCno,e=this._listItems[n.oRno][n.oCno]}}else for(;e&&!e.getVisible()&&(this._listItems[t]&&this._listItems[t][r-1]);)e=this._listItems[t][r],r--,s--;if(e)if(t=this._itemToUID(e.getData()),this._visibleCellRenderers[t]&&(e=this._visibleCellRenderers[t][s.toString()]),this._bShiftKey)this._selectCellItem(e,this._bShiftKey,this._bCtrlKey),i=!0;else if(this._bCtrlKey)32==this._lastKey?this._selectCellItem(e,this._bShiftKey,this._bCtrlKey,!0):(this._drawCellItem(e,this._cellSelectionData[t]&&null!=this._cellSelectionData[t][s.toString()],t==this._highlightUID&&this._caretColumnIndex==this._highlightColumnIndex,!0),i=!0,Xb&&e.focus());else{if(i=this._caretIndex,this._clearSelectedCells(),this._isSpanCollectionView())for(t in this._cellSelectionIndicators)(r=this._cellSelectionIndicators[t][s.toString()])&&r.getParent()&&(r.getParent().removeChild(r),delete this._cellSelectionIndicators[t][s.toString()],this._atLeastOneProperty(this._cellSelectionIndicators[t])||delete this._cellSelectionIndicators[t]);this._selectedIndex=this._anchorIndex=this._caretIndex=i,this._anchorColumnIndex=this._selectedColumnIndex=this._caretColumnIndex,this._selectCellItem(e,this._bShiftKey,this._bCtrlKey,!1),i=!0}}!this._bSelectItem&&0<=this._caretColumnIndex-this.getHorizontalScrollPosition()&&(this._caretColumnIndex-this.getHorizontalScrollPosition()>this._columns.length-1&&(this._caretColumnIndex=this._columns.length-1+this.getHorizontalScrollPosition()),0<=this._caretIndex-this.getVerticalScrollPosition()&&(e=this._absoluteToVisibleIndices(this._caretIndex,this._caretColumnIndex),e=this._listItems[e.rowIndex][e.columnIndex]),e&&(t=this._itemToUID(e.getData()),this._visibleCellRenderers[t]&&(e=this._visibleCellRenderers[t][s.toString()]),this._bShiftKey?(this._selectCellItem(e,this._bShiftKey,this._bCtrlKey),i=!0):this._bCtrlKey?this._drawCellItem(e,this._cellSelectionData[t]&&null!=this._cellSelectionData[t][s.toString()],t==this._highlightUID&&this._caretColumnIndex==this._highlightColumnIndex,!0):(i=this._caretIndex,this._clearSelectedCells(),this._selectedIndex=this._anchorIndex=this._caretIndex=i,this._selectCellItem(e,this._bShiftKey,this._bCtrlKey,!1),i=!0))),i&&(s=new L(L.CHANGE),s.itemRenderer=e,(e=this._itemRendererToIndices(e))&&(s.rowIndex=e.y,s.columnIndex=this._displayToAbsoluteColumnIndex(e.x)),this.dispatchEvent(s))},l.prototype._moveSelectionVertically=function(t,e,i){var s;this._showCaret=!0;var r=this._listItems.length;if(0!=r){var n=0;this._rowInfo[r-1].y+this._rowInfo[r-1].height>this._listContent.getHeight()&&n++;var o=!1;switch(this._bSelectItem=!1,t){case 38:0<this._caretIndex&&(this._caretIndex--,this._bSelectItem=o=!0);break;case 40:this._caretIndex<this._collection.getLength()-1?(this._caretIndex++,this._bSelectItem=o=!0):this._caretIndex==this._collection.getLength()-1&&n&&this.getVerticalScrollPosition()<this.getMaxVerticalScrollPosition()&&(s=this.getVerticalScrollPosition()+1);break;case 33:this._caretIndex<this._lockedRowCount?this._caretIndex=s=0:this._caretIndex>this.getVerticalScrollPosition()+this._lockedRowCount&&this._caretIndex<this.getVerticalScrollPosition()+r?this._caretIndex=this.getVerticalScrollPosition()+this._lockedRowCount:(this._caretIndex=Math.max(this._caretIndex-r+this._lockedRowCount,0),s=Math.max(this._caretIndex-this._lockedRowCount,0)),this._bSelectItem=!0;break;case 34:this._caretIndex<this._lockedRowCount?s=0:this._caretIndex>=this.getVerticalScrollPosition()+this._lockedRowCount&&this._caretIndex<this.getVerticalScrollPosition()+r-n-1?this._caretIndex=Math.min(this.getVerticalScrollPosition()+this._listItems.length+this._lockedRowCount,this._collection.getLength()-1):s=this._lockedRowCount>=r-n-1?Math.min(this.getVerticalScrollPosition()+1,this.getMaxVerticalScrollPosition()):Math.min(this._caretIndex-this._lockedRowCount,this.getMaxVerticalScrollPosition()),this._bSelectItem=!0;break;case 36:0<this._caretIndex&&(s=this._caretIndex=0,this._bSelectItem=!0);break;case 35:this._caretIndex<this._collection.getLength()-1&&(this._caretIndex=this._collection.getLength()-1,s=this.getMaxVerticalScrollPosition(),this._bSelectItem=!0);break;case 32:this._bSelectItem=o=!0}if(o&&(this._caretIndex<this._lockedRowCount?s=0:this._caretIndex<this.getVerticalScrollPosition()+this._lockedRowCount?s=this._caretIndex-this._lockedRowCount:this._caretIndex>=this.getVerticalScrollPosition()+r-n&&(s=Math.min(this.getMaxVerticalScrollPosition(),this._caretIndex-r+n+1))),!isNaN(s)&&(this.getVerticalScrollPosition()!=s&&(r=new ma(ma.SCROLL),r.detail=!1,r.direction="'vertical",r.delta=s-this.getVerticalScrollPosition(),r.position=s,this.setVerticalScrollPosition(s),this.dispatchEvent(r)),!this._iteratorValid))return void(this._keySelectionPending=!0);this._bShiftKey=e,this._bCtrlKey=i,this._lastKey=t,this._finishKeySelection()}},l.prototype._moveSelectionHorizontally=function(t,e,i){var s;i=!1,e&&33==t?(s=Math.max(this.getHorizontalScrollPosition()-(this._visibleColumns.length-this._lockedColumnCount),0),s!=this.getHorizontalScrollPosition()&&(i=!0)):e&&34==t&&(s=Math.min(this.getMaxHorizontalScrollPosition(),this._columns.length-1),s=Math.min(this.getHorizontalScrollPosition()+(this._visibleColumns.length-this._lockedColumnCount),s),s!=this.getHorizontalScrollPosition()&&(i=!0)),i&&(t=new ma(ma.SCROLL),t.detail=!1,t.direction="horizontal",t.delta=s-this.getHorizontalScrollPosition(),t.position=s,this.setHorizontalScrollPosition(s),this.dispatchEvent(t),-1!=this._headerIndex&&this._unselectColumnHeader(this._headerIndex))},l.prototype._finishKeySelection=function(){if(this._isCellSelectionMode())this._finishCellKeySelection();else{var t;t=this._listItems.length;var e=this._rowInfo[t-1].y+this._rowInfo[t-1].height>this._listContent.getHeight()?1:0;34==this._lastKey&&(this._caretIndex=this._lockedRowCount>=t-e-1?Math.min(this.getVerticalScrollPosition()+this._lockedRowCount,this._collection.getLength()-1):Math.min(this.getVerticalScrollPosition()+t-e-1,this._collection.getLength()-1));var i,e=!1;this._bSelectItem&&0<=this._caretIndex-this.getVerticalScrollPosition()&&(this._caretIndex-this.getVerticalScrollPosition()>this._listItems.length-1&&(this._caretIndex=this._listItems.length-1+this.getVerticalScrollPosition()),i=this._listItems[this._caretIndex-this.getVerticalScrollPosition()][0])&&(t=this._itemToUID(i.getListData().item),i=this._visibleData[t])&&(32==this._lastKey?e=this._selectItem(i,this._bShiftKey,this._bCtrlKey):(this._bCtrlKey||(this._selectItem(i,this._bShiftKey,this._bCtrlKey),e=!0),this._bCtrlKey&&(this._drawItem(i,null!=this._selectedData[t],t==this._highlightUID,!0),Xb&&i.focus()))),e&&(t=new L(L.CHANGE),t.itemRenderer=i,(i=this._itemRendererToIndices(i))&&(t.rowIndex=i.y,t.columnIndex=i.x),this.dispatchEvent(t))}},l.prototype._drawHeaderHorizontalSeparators=function(){this._horizontalSeparators||(this._horizontalSeparators=[],this._horizontalLockedSeparators=[]);var t,e=this._getLines(),i=e.getChildByName("headerHorizontalLines");i||(i=new u,i.name="headerHorizontalLines",i._useDelayInvalidate=!0,e.addChild(i)),1<e.getNumChildren()&&(t=e.getChildByName("header"))&&(t=e.getChildIndex(t),t+1<e.getNumChildren()&&e.setChildIndex(i,t+1)),this._numSeparators=0;var s;for(this._visibleHeaderInfos&&(!isNaN(this._lockedColumnCountVal)&&0<this._lockedColumnCountVal?(s=this._visibleHeaderInfos.slice(0,this._lockedColumnCountVal),t=this._visibleHeaderInfos.slice(this._lockedColumnCountVal)):t=this._visibleHeaderInfos,this._createHeaderHorizontalSeparators(t,this._horizontalSeparators,i));i.getNumChildren()>this._numSeparators;)i.removeChildAt(i.getNumChildren()-1),this._horizontalSeparators.pop();var r;if(this._numSeparators=0,0<this._lockedColumnCount&&(i=this._getLockedContent(),r=i.getChildByName("lockedHeaderHorizontalLines"),r||(r=new u,r.name="lockedHeaderHorizontalLines",r._useDelayInvalidate=!0,i.addChild(r)),1<i.getNumChildren()&&(t=i.getChildByName("lockedHeaderLines"))&&(t=i.getChildIndex(t),t+1<e.getNumChildren()&&i.setChildIndex(r,t+1)),this._createHeaderHorizontalSeparators(s,this._horizontalLockedSeparators,r)),r)for(;r.getNumChildren()>this._numSeparators;)r.removeChildAt(r.getNumChildren()-1),this._horizontalLockedSeparators.pop()},l.prototype._createHeaderHorizontalSeparators=function(t,e,i){var s,r,n=t.length;for(s=0;s<n;s++)if(t[s].visible&&t[s].visibleChildren&&0<t[s].visibleChildren.length){var o=this._getHorizontalSeparator(this._numSeparators,e,i),a=o.getChildAt(0);t[s].headerItem||o.setVisible(!1),this._numSeparators++,o.setVisible(!0),r=t[s].column.getWidth(),a.setActualSize(r,2),o.setX(t[s].headerItem.getX()),r=t[s].depth,o.setY(this._headerRowInfo[r].y+(this._headerRowInfo[r].height-this._headerRowInfo[r+1].height)-2),this._createHeaderHorizontalSeparators(t[s].children,e,i)}},l.prototype._getHorizontalSeparator=function(t,e,i){var s,r=this.getStyle("headerHorizontalSeparatorSkin");return t<i.getNumChildren()?(t=i.getChildAt(t),s=t.getChildAt(0)):(t=new u,t._useDelayInvalidate=!0,t.setStyle("position","absolute"),i.addChild(t)),s&&(s instanceof r?s=t.getChildAt(0):(t.removeChildAt(0),s=null)),s||(s=new r,s.setStyle("borderColor",this.getStyle("headerHorizontalSeparatorColor")),t.addChild(s)),e.push(t),t},l.prototype._adjustAfterRemove=function(t,e,i){if(this._isCellSelectionMode()){var s,r=t.length;for(e=0;e<r;e++){var n=V.getUID(t[e]);if(this._cellSelectionData[n])for(s in this._cellSelectionData[n])this._removeCellIndicators(n,Number(s)),this._removeCellSelectionData(n,Number(s)),i=!0}}else s=this.getSelectedItems().length,this._selectedIndex>e&&(this._selectedIndex-=t.length,i=!0),this._bSelectedItemRemoved&&1>s&&(this._selectedIndex=this._getItemIndex(this._expandedItem),this._bSelectedIndexChanged=this._bSelectionChanged=i=!0,this.invalidateDisplayList());return i},l.prototype._layoutItemEditor=function(){if(this._rootModel instanceof pb){var t=this._rowMap[this.getEditedItemRenderer().name].indent;this.itemEditorInstance.move(this.itemEditorInstance.getX()+t,this.itemEditorInstance.getY()),this.itemEditorInstance.setActualSize(this.itemEditorInstance.getWidth()-t,this.itemEditorInstance.getHeight())}},l.prototype._endEdit=function(t){var e=this;if(!e.getEditedItemRenderer())return!0;e._inEndEdit=!0;var i=new K(K.ITEM_EDIT_END,(!1),(!0));return i.columnIndex=e._editedItemPosition.columnIndex,i.dataField=e._columns[e._editedItemPosition.columnIndex].getDataField(),i.rowIndex=e._editedItemPosition.rowIndex,i.itemRenderer=e.getEditedItemRenderer(),i.reason=t,e.dispatchEvent(i),e._dontEdit=null!=e.itemEditorInstance,e._dontEdit||"cancelled"!=t||(e._losingFocus=!0,e.focus(),r.ie8&&(e._tempTextInput||setTimeout(function(){e.focus()},100))),e._inEndEdit=!1,!i.defaultPrevented},l.prototype._isBranch=function(t){return!(!this._rootModel||null==t)&&this._rootModel.canHaveChildren(t)},l.prototype._getDepth=function(t){return this._rootModel instanceof pb&&this._collection instanceof T?this.getDataProvider().getNodeDepth(t):-1},l.prototype._applyCellStylesForItemRenderer=function(t,e){if(t&&t instanceof A){var i;if(e)this._oldCellStyles[t.uno]?null==this._oldCellStyles[t.uno][e]&&(this._oldCellStyles[t.uno][e]="styleName"):(this._oldCellStyles[t.uno]={},this._oldCellStyles[t.uno][e]="styleName"),m.addClass(t.element,e),t.styleChanged&&t.styleChanged("styleName");else if(this._oldCellStyles[t.uno]){for(i in this._oldCellStyles[t.uno])"styleName"==this._oldCellStyles[t.uno][i]?(m.removeClass(t.element,i),t.styleChanged&&t.styleChanged("styleName")):t.clearStyle(i);delete this._oldCellStyles[t.uno]}}},l.prototype.createChildren=function(){if(l._super.createChildren.call(this),this._listContent||(this._listContent=new Bb(this),this._listContent.id="_listContent",this._listContent.name="_listContent",this._listContent.setStyle("position","absolute"),this.addChild(this._listContent)),this._selectionLayer||(this._selectionLayer=new u,this._selectionLayer.name="selectionLayer",this._selectionLayer._useDelayInvalidate=!0,this._selectionLayer.setStyle("position","absolute"),this._selectionLayer.setX(0),this._listContent.addChild(this._selectionLayer)),this._listSubContent||(this._listSubContent=new Bb(this),this._listSubContent.setStyle("position","absolute"),this._listSubContent.setY(0),this._listSubContent.name="listSubContent",this._listSubContent.setAttr("id","Kool__Content"+this._listSubContent.uno),this._listContent.addChild(this._listSubContent)),this._movingSelectionLayer||(this._movingSelectionLayer=new u,this._movingSelectionLayer.name="movingSelectionLayer",this._movingSelectionLayer._useDelayInvalidate=!0,this._movingSelectionLayer.setStyle("position","absolute"),this._movingSelectionLayer.setX(0),this._listSubContent.addChild(this._movingSelectionLayer)),Xb){this.setAttr("role","application");var t=document.createElement("label");t.innerHTML=B.getString("datagrid","ariaEditable"),t.id="Kool__"+this.uno+"_editableLabel",t.style.position="absolute",t.style.display="none",this.element.appendChild(t)}},l.prototype.setStyle=function(t,e){"headerStyleName"==t&&l._super.setStyle.call(this,"oldHeaderStyleName",this.getStyle("headerStyleName")),l._super.setStyle.call(this,t,e)},l.prototype.styleChanged=function(t){if(l._IS_ITEM_STYLE[t])this._itemsSizeChanged=!0,this.invalidateDisplayList();else if("paddingTop"===t||"headerPaddingTop"===t)this._cachedPaddingTopInvalid=!0,this.invalidateProperties();else if("paddingBottom"===t||"headerPaddingBottom"===t)this._cachedPaddingBottomInvalid=!0,this.invalidateProperties();else if("verticalAlign"===t)this._cachedVerticalAlignInvalid=!0,this.invalidateProperties();else if("dataChangeEffect"===t)this._cachedDataChangeEffect=null;else if(this._listItems){var e,i,s,r=this._listItems.length;for(e=0;e<r;e++)for(s=this._listItems[e].length,i=0;i<s;i++)this._listItems[e][i]&&this._listItems[e][i].styleChanged(t)}l._super.styleChanged.call(this,t),this._invalidateSizeFlag&&(this._itemsNeedMeasurement=!0,this.invalidateProperties()),Tb.sizeInvalidatingStyles[t]&&(this._scrollAreaChanged=!0),e=!1,"headerBackgroundSkin"===t?this._headerBGSkinChanged=e=!0:"headerSortSeparatorSkin"===t?e=!0:"headerSeparatorSkin"===t&&(e=this._headerSepSkinChanged=!0),e&&(this._itemsSizeChanged=!0),"sortFontFamily"!==t&&"sortFontSize"!==t&&"sortFontStyle"!==t&&"sortFontWeight"!==t||(this._rendererChanged=this._itemsSizeChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},l.prototype.commitProperties=function(){this._dataProviderChanged&&(this._dataProviderChanged=!1,this._hierarchicalCollectionInstance?(this._setSuperDataProvider(this._hierarchicalCollectionInstance),this._hierarchicalCollectionInstance.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this,!1,-50)):this._rootModel instanceof pb&&(this._rootModel instanceof ke&&(this._hierarchicalCollectionView=new ga),this._hierarchicalCollectionView.setSource(this._rootModel),this._setSuperDataProvider(this._hierarchicalCollectionView),this._hierarchicalCollectionView.addEventListener(y.COLLECTION_CHANGE,this._collectionChangeHandler,this,!1,-50))),(this._rootModel instanceof fa||this._rootModel instanceof ja)&&this._rootModel.grouping&&(this._groupLabelField=this._rootModel.grouping.label),(this._groupedColumnsChanged||this._columnsChanged)&&(this._selectedColumnIndex=this._highlightColumnIndex=this._anchorColumnIndex=-1),this._groupedColumnsChanged?(this._columnGrouping=!0,this._columnsChanged=!1,this._removeOldHeaders(),this._columnsToInfo={},this._headerInfos=this._initializeHeaderInfo(this._groupedColumns),this._headerInfoInitialized=!0,0<this._lockedColumnCount&&(this._lockedColumnCountChanged=!0),this._setSuperColumns(this._getLeafColumns(this._groupedColumns.slice(0)))):this._columnsChanged&&(this._columnsChanged=this._columnGrouping=!1,this._removeOldHeaders(),this._setSuperColumns(this._columnsValue)),this._displayItemsExpandedChanged&&(this._displayItemsExpandedChanged=!1,this._displayItemsExpanded&&this.expandAll()),this._columnsInvalid&&(this._columnsChanged&&!this._headerInfoInitialized&&(this._headerInfoInitialized=!0,this._headerInfos=this._initializeHeaderInfo(this._columns),this._columnsChanged=this._headerInfoInitialized=!1),this._columnsChanged=!1,this._visibleHeaderInfos=this._updateVisibleHeaders(),this._updateHeaderSearchList(),this._createDisplayableColumns()),l._super.commitProperties.call(this),this._cachedPaddingTopInvalid&&(this._cachedPaddingTopInvalid=!1,this._cachedPaddingTop=this.getSizeStyle("paddingTop"),this._cachedHeaderPaddingTop=this.getSizeStyle("headerPaddingTop"),this._itemsSizeChanged=!0,this.invalidateDisplayList()),this._cachedPaddingBottomInvalid&&(this._cachedPaddingBottomInvalid=!1,this._cachedPaddingBottom=this.getSizeStyle("paddingBottom"),this._cachedHeaderPaddingBottom=this.getSizeStyle("headerPaddingBottom"),this._itemsSizeChanged=!0,this.invalidateDisplayList()),this._cachedVerticalAlignInvalid&&(this._cachedVerticalAlignInvalid=!1,this._cachedVerticalAlign=this.getStyle("verticalAlign"),this._itemsSizeChanged=!0,this.invalidateDisplayList());var t;this._columnCountChanged&&(1>this._columnCount&&(this._columnCount=this._defaultColumnCount),!isNaN(this._explicitWidth)&&isNaN(this._explicitColumnWidth)&&0<this._explicitColumnCount&&(t=this.getViewMetrics(),this._setColumnWidthInternal((this._explicitWidth-t.left-t.right)/this.getColumnCount())),this._columnCountChanged=!1),this._rowCountChanged&&(1>this._rowCount&&(this._rowCount=this._defaultRowCount),!isNaN(this._explicitHeight)&&isNaN(this._explicitRowHeight)&&0<this._explicitRowCount&&(t=this.getViewMetrics(),this._setRowHeightInternal((this._explicitHeight-t.top-t.bottom)/this._rowCount)),this._rowCountChanged=!1),this._measureItems(),this._lockedColumnCountChanged&&(this._columnGrouping?this._setSuperLockedColumnCount(this._getAdjustedLockedCount(this._lockedColumnCountVal)):this._setSuperLockedColumnCount(this._lockedColumnCountVal),this._clearHeaderHorizontalSeparators(),this._lockedColumnCountChanged=!1),this._groupedColumnsChanged&&(this._headerInfoInitialized=this._groupedColumnsChanged=!1),this._selectedCellsChanged&&(this._setSelectedCells(this._temporary_selectedCells),this._selectedCellsChanged=!1,this._temporary_selectedCells=null),-1!=this._anchorColumnIndex&&0==this._columns[this._anchorColumnIndex].getVisible()&&(this._anchorColumnIndex=-1),-1!=this._highlightColumnIndex&&0==this._columns[this._highlightColumnIndex].getVisible()&&(this._highlightColumnIndex=-1),-1!=this._selectedColumnIndex&&0==this._columns[this._selectedColumnIndex].getVisible()&&(this._selectedColumnIndex=-1),this._isSpanCollectionView()&&(this._collection.getGrid()&&this._collection.getGrid()==this||this._collection.setGrid(this)),this._footersChanged&&(this._footersChanged=!1,this._showFooters&&this._footers&&this._addFooters()),this._showFootersChanged&&(this._showFootersChanged=!1,this._footers&&(this._showFooters?this._addFooters():this._removeFooters()))},l.prototype.measure=function(){l._super.measure.call(this);var t=this.getViewMetrics(),e=1>this._explicitColumnCount?this._defaultColumnCount:this._explicitColumnCount,i=1>this._explicitRowCount?this._defaultRowCount:this._explicitRowCount;if(isNaN(this._explicitRowHeight)?(this.measuredHeight=this._rowHeight*i+t.top+t.bottom,this.measuredMinHeight=this._rowHeight*Math.min(i,2)+t.top+t.bottom):(this.measuredHeight=this._explicitRowHeight*i+t.top+t.bottom,this.measuredMinHeight=this._explicitRowHeight*Math.min(i,2)+t.top+t.bottom),isNaN(this._explicitColumnWidth)?(this.measuredWidth=this.getColumnWidth()*e+t.left+t.right,this.measuredMinWidth=this.getColumnWidth()*Math.min(e,1)+t.left+t.right):(this.measuredWidth=this._explicitColumnWidth*e+t.left+t.right,this.measuredMinWidth=this._explicitColumnWidth*Math.min(e,1)+t.left+t.right),"auto"==this._verticalScrollPolicy&&this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this.measuredWidth-=this._verticalScrollBar.getMinWidth(),this.measuredMinWidth-=this._verticalScrollBar.getMinWidth()),"auto"==this._horizontalScrollPolicy&&this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this.measuredHeight-=this._horizontalScrollBar.getMinHeight(),this.measuredMinHeight-=this._horizontalScrollBar.getMinHeight()),e=this._columns.length,0==e)this.measuredWidth=160,this.measuredMinWidth=40;else{for(var s=0,r=0,i=0;i<e;i++)this._columns[i].getVisible()&&(s+=this._columns[i]._preferredWidth,isNaN(this._minColumnWidth)&&(r+=this._columns[i].getMinWidth()));isNaN(this._minColumnWidth)||(r=e*this._minColumnWidth),this.measuredWidth=s+t.left+t.right,this.measuredMinWidth=r+t.left+t.right,"auto"==this._verticalScrollPolicy&&this._verticalScrollBar&&this._verticalScrollBar.getVisible()&&(this.measuredWidth-=this._verticalScrollBar.getMinWidth(),this.measuredMinWidth-=this._verticalScrollBar.getMinWidth()),"auto"==this._horizontalScrollPolicy&&this._horizontalScrollBar&&this._horizontalScrollBar.getVisible()&&(this.measuredHeight-=this._horizontalScrollBar.getMinHeight(),this.measuredMinHeight-=this._horizontalScrollBar.getMinHeight())}},l.prototype._superUpdateDisplayList=function(t,e){if(this._oldUnscaledWidth!=t||this._oldUnscaledHeight!=e||this._itemsSizeChanged||this._bSelectionChanged||this._scrollAreaChanged){this._oldUnscaledWidth!=t&&(this._itemsSizeChanged=!0),l._super.updateDisplayList.call(this,t,e);var i;this._adjustListContent(t,e);var s=this._collection&&0<this._collection.getLength();s&&this._adjustScrollPosition(),this._removeClipMask(),0<this._listContent.getWidth()&&0<this._listContent.getHeight()&&this._selectionLayer.setStyle("backgroundColor","#808080"),this._rendererChanged?this._purgeItemRenderers():this._dataEffectCompleted&&this._partialPurgeItemRenderers(),this._oldUnscaledWidth==t&&!this._scrollAreaChanged&&!this._itemsSizeChanged&&0<this._listItems.length&&this._iterator&&1==this.getColumnCount()?(i=this._listItems.length-1,this._oldUnscaledHeight>e?this._reduceRows(i):this._makeAdditionalRows(i)):(this._iterator&&(i=this._iterator.getBookmark()),this._clearIndicators(),this._iterator?this.offscreenExtraColumns?this._makeRowsAndColumnsWithExtraColumns(t,e):this._makeRowsAndColumnsWithExtraRows(t,e):this._makeRowsAndColumns(0,0,this._listContent.getWidth(),this._listContent.getHeight(),0,0),this._seekPositionIgnoreError(this._iterator,i)),this._oldUnscaledWidth=t,this._oldUnscaledHeight=e,this._configureScrollBars(),this._addClipMask(!0),this._wordWrapChanged=this._itemsSizeChanged=!1,this._adjustSelectionSettings(s),this._keySelectionPending&&this._iteratorValid&&(this._keySelectionPending=!1,this._finishKeySelection())}},l.prototype.updateDisplayList=function(t,e){if(this._calledSetItemVisible=this._needRedrawSelection=!1,this._listContent&&this._listSubContent){this._tween&&this._tween.endTween(),this._cellsWaitingToBeDisplayed&&this._processCellsWaitingToBeDisplayed();var i=!1,s=this.getViewMetrics();if(this._displayWidth!=t-s.right-s.left&&(this._displayWidth=t-s.right-s.left,i=this._columnsInvalid=!0),this._resetSetColumnPreferredWidth(),this._createHScrollColumns(),this._calculateColumnSizes(),this._rendererChanged&&this._purgeItemRenderers(),this._superUpdateDisplayList(t,e),"off"==this._horizontalScrollPolicy||this._getOptimumColumns()==this._visibleColumns||this._itemsSizeChanged||this._bSelectionChanged||this._scrollAreaChanged||!this._subContentScrolled||(this._configureScrollBars(),this._subContentScrolled=!1),this._collection&&this._collection.getLength()&&(0<this._listItems.length&&this._setRowCountInternal(this._listItems.length),this._headerInfos&&this._headerInfos.length?this._setColumnCountInternal(this._headerInfos.length):this._setColumnCountInternal(0)),this._bEditedItemPositionChanged&&(this._bEditedItemPositionChanged=!1,this._commitEditedItemPosition(this._proposedEditedItemPosition),this._proposedEditedItemPosition=void 0,this._itemsSizeChanged=!1),s=this._listContent.getChildByName("headerBG"),this._headerBGSkinChanged&&(this._headerBGSkinChanged=!1,s&&this._listContent.removeChild(s),s=null),!s){s=new u,s.name="headerBG",s._useDelayInvalidate=!0,this._listContent.addChildAt(s,this._listContent.getChildIndex(this._selectionLayer));var r=this.getStyle("headerBackgroundSkin");null!=r&&(r=new r,r instanceof u&&r.setStyleName(this),s.addChild(r))}this._getHeaderVisible()?(s.setVisible(!0),0<s.getNumChildren()&&this._drawHeaderBackgroundSkin(s.getChildAt(0))):s.setVisible(!1),this._getHeaderVisible()?this._drawSeparators():this._clearSeparators(),!this._columnGrouping&&(s=this._getLines())&&((r=this._getLinesBody(s,"verticalLines"))&&r.setVisible(!0),(s=s.getChildByName("header"))&&s.setVisible(!0)),this._drawLinesAndColumnBackgrounds(),this._drawRowBackgrounds(),this._getHeaderVisible()&&this._columnGrouping?this._drawHeaderHorizontalSeparators():this._clearHeaderHorizontalSeparators(),i&&this._updateSubContent(),this._collection&&(this._collectionLength=this._collection.getLength()),this._columnGrouping&&this._selectedHeaderInfo?this._selectColumnGroupHeader(this._selectedHeaderInfo):this._columnGrouping||-1==this._headerIndex||(this._selectedHeaderInfo=this._getHeaderInfo(this._columns[this._headerIndex]),this._selectColumnHeader(this._headerIndex)),this._needRedrawSelection&&this._redrawSelection()}},l.prototype.invalidateList=function(){this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.isItemHighlighted=function(t,e,i){if(null==t)return!1;if(F(t)||(t=this._itemToUID(t)),this._isRowSelectionMode()){if(!this._isSpanCollectionView())return t===this._highlightUID&&!this._selectionIndicators[t];if(t===this._highlightUID)return I(this._selectedData[t]);if(!I(e)&&!I(i)&&this._itemAttributes[e]&&this._itemAttributes[e][i]&&this._itemAttributes[e][i].ca){var s,r,n=!1;for(s=e;s<this._listItems.length;s++)if(this._listItems[s]&&this._listItems[s][i])if(r=this._listItems[s][i],!n&&r.getVisible()&&r.getListData().ouid===t){if(r.getListData().uid===this._highlightUID)return I(this._selectedData[r.getListData().uid]);n=!0}else if(n){if(r.getVisible())break;if(r.getListData().uid===this._highlightUID)return I(this._selectedData[r.getListData().uid]);
}}}else if(this._cellSelectionData[t])var o=!I(this._cellSelectionData[t][i]);return I(e)||I(i)||(r=this._listItems[e]?this._listItems[e][i]:null),(t===this._highlightUID||r===this._highlightItemRenderer)&&i==this._highlightColumnIndex&&!o},l.prototype.removeDataEffectItem=function(e){this._modifiedCollectionView&&this._modifiedCollectionView.removeItem(this._dataItemWrappersByRenderer[e.uno]),this._iterator.seek(t.getCURRENT()),this._invalidateDisplayListFlag?(this._itemsSizeChanged=!0,this.validateDisplayList()):this.invalidateList()},l.prototype.addDataEffectItem=function(e){this._modifiedCollectionView&&this._modifiedCollectionView.addItem(this._dataItemWrappersByRenderer[e.uno]),this._iterator.getAfterLast()?this._iterator.seek(t.getFIRST()):this._iterator.seek(t.getCURRENT()),this._invalidateDisplayListFlag?(this._itemsSizeChanged=!0,this.validateDisplayList()):this.invalidateList()},l.prototype.unconstrainRenderer=function(t){this.unconstrainedRenderers[t]=!0},l.prototype.getRendererSemanticValue=function(t,e){return this._modifiedCollectionView.getSemantics(this._dataItemWrappersByRenderer[t.uno])==e},l.prototype.itemRendererContains=function(t,e){return!(!e||!t)&&t.owns(e)},l.prototype.isItemSelected=function(t,e,i){if(null==t)return!1;if(F(t)||(t=this._itemToUID(t)),this._isRowSelectionMode()){if(!this._isSpanCollectionView())return!I(this._selectedData[t]);if(this._selectedData[t]&&this._visibleData[t])return!0;if(!I(e)&&!I(i)&&this._itemAttributes[e]&&this._itemAttributes[e][i]&&this._itemAttributes[e][i].ca)for(var s,r=!1;e<this._listItems.length;e++)if(this._listItems[e]&&this._listItems[e][i])if(s=this._listItems[e][i],!r&&s.getVisible()&&s.getListData().ouid===t){if(this._selectedData[s.getListData().uid])return!0;r=!0}else if(r){if(s.getVisible())break;if(this._selectedData[s.getListData().uid])return!0}}else if(this._cellSelectionData[t])return!I(this._cellSelectionData[t][i]);return!1},l.prototype.getFieldSortInfo=function(t){var e,i,s;if(!this._sortExpertMode&&this._visualSortInfo[t.colNum])return this._visualSortInfo[t.colNum];if(e=this._getHeaderInfo(t),this._columnGrouping&&t&&this._collection&&this._collection.getSort()&&null!=e.internalLabelFunction){for(i=this._collection.getSort().getFields().length,e=0;e<i;e++)if((s=this._itemToUID(t))&&this._collection.getSort().getFields()[e].name==s)return new Zc(e+1,this._collection.getSort().getFields()[e].descending,Zc.ACTUALSORT,i)}else if(t&&this._collection&&this._collection.getSort())for(t.getDataField()||(s=this._itemToUID(t)),i=this._collection.getSort().getFields().length,e=0;e<i;e++)if(t.getDataField()&&this._collection.getSort().getFields()[e].name==t.getDataField()||s&&this._collection.getSort().getFields()[e].name==s)return new Zc(e+1,this._collection.getSort().getFields()[e].descending,Zc.ACTUALSORT,i);return null},l.prototype.isItemSelectable=function(t){return!(!this.selectable||null==t)},l.prototype.itemRendererToIndex=function(t){return t.name in this._rowMap?(t=this._rowMap[t.name].rowIndex,t<this._lockedRowCount?t:t+this.getVerticalScrollPosition()):Number.MIN_VALUE},l.prototype.indicesToIndex=function(t,e){return t*this._columnCount+e},l.prototype.indexToItemRenderer=function(t){var e=this.getVerticalScrollPosition()-this._offscreenExtraRowsTop;return t<e||t>=e+this._listItems.length?null:this._listItems[t-e][0]},l.prototype.moveFocusToHeader=function(t){t=0<arguments.length?t:-1,this._getHeaderVisible()&&-1==this._headerIndex&&0<this._visibleColumns.length&&(-1==t&&(t=this._visibleColumns[0].colNum),this._selectedHeaderInfo=this._getHeaderInfo(this._columns[t]),this._headerIndex=t,this._selectColumnHeader(this._headerIndex))},l.prototype.findString=function(e){if(!this._collection||0==this._collection.getLength())return!1;var i=this._iterator.getBookmark(),s=this.getSelectedIndex(),r=s+1;if(-1==this.getSelectedIndex()){try{this._iterator.seek(t.getFIRST(),0)}catch(n){if(n instanceof ca)return n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,this._collection.getLength()))),this._iteratorValid=!1}s=this._collection.getLength(),r=0}else{try{this._iterator.seek(t.getFIRST(),s)}catch(n){if(n instanceof ca)return this._anchorIndex==this._collection.getLength()-1?n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,this._collection.getLength()))):n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,this._anchorBookmark,1,this._anchorIndex+1,this._anchorIndex))),this._iteratorValid=!1}var o=!1;try{o=this._iterator.moveNext()}catch(n){if(n instanceof ca)return n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,this._anchorBookmark,1,this._anchorIndex+1,this._anchorIndex))),this._iteratorValid=!1}if(!o){try{this._iterator.seek(t.getFIRST(),0)}catch(n){if(n instanceof ca)return n.addResponder(new S(this._findPendingResultHandler,this._findPendingFailureHandler,new Nc(e,i,t.getFIRST(),0,0,this._collection.getLength()))),this._iteratorValid=!1}s=this._collection.getLength(),r=0}}return this._findStringLoop(e,i,r,s)},l.prototype.createItemEditor=function(t,e){if(this.errorInEditing=!1,this._rootModel instanceof pb&&t==this.getTreeColumnIndex()){var i=this._displayableColumns[t];0!=i.editorXOffset&&0!=i.editorWidthOffset||(i.editorXOffset=12,i.editorWidthOffset=-12)}if(this._displayableColumns.length!=this._columns.length){for(i=0;i<this._displayableColumns.length;i++)if(this._displayableColumns[i].colNum>=t){t=i;break}i==this._displayableColumns.length&&(t=0)}i=this._displayableColumns[t],e>this._lockedRowCount&&this.getVerticalScrollPosition(),t>this._lockedColumnCount&&(t-=this.getHorizontalScrollPosition());var s=this._listItems[this._actualRowIndex][this._actualColIndex],n=this._rowInfo[this._actualRowIndex];if(s instanceof qa&&(s.getListData().label=i.itemToLabel(s.getData(),!1)),i.rendererIsEditor)this.itemEditorInstance=s;else{var o=0,a=-2,l=0,h=4;this.itemEditorInstance||(o=i.editorXOffset,a=i.editorYOffset,l=i.editorWidthOffset,h=i.editorHeightOffset,i.itemEditor&&i.itemEditor.generator==Y&&this._tempTextInput?(r.ie10||r.ie11||this._startEditingByKeyboardEvent||!this._tempTextInput.isFocused()||this._tempTextInput.blur(),this.itemEditorInstance=this._tempTextInput,this.itemEditorInstance.clearStyle("zIndex"),this.itemEditorInstance.clearStyle("padding")):(this.itemEditorInstance=i.itemEditor.newInstance(),this._startEditingByKeyboardEvent=!1),this.itemEditorInstance.owner=this,this.itemEditorInstance.setStyleName(i),Xb&&(this.itemEditorInstance.setTabIndex(-1),this.itemEditorInstance.setAttr("aria-labelledby","Kool__"+this.uno+"_Column"+t)),this.itemEditorInstance!=this._tempTextInput&&this._addRendererToContentArea(this.itemEditorInstance,i)),this.itemEditorInstance!=this._tempTextInput&&this.itemEditorInstance.getParent().setChildIndex(this.itemEditorInstance,this.itemEditorInstance.getParent().getNumChildren()-1),this.itemEditorInstance.setVisible(!0);var d=this._listContent.getHeight(),c=d-this._listContent.getY(),h=Math.min(n.height+h,c-this.itemEditorInstance.getY(),d-n.y),o=s.getX()+o;if(this.itemEditorInstance.move(o?o+1:0,n.y+a+1),this.itemEditorInstance.setActualSize(this.getEditedItemRenderer().getWidth()+l-(o?1:0),h-1),r.firefox?this.itemEditorInstance.addEventListener("blur",this._itemEditorFocusOutHandler,this):this.itemEditorInstance.addEventListener("focusout",this._itemEditorFocusOutHandler,this),this.itemEditorInstance instanceof lb&&(this.itemEditorInstance.setName("Kool__DataGridColumn_"+i.getDataField()),m.setPxStyle(this.itemEditorInstance.element,"padding",0)),this._isSpanCollectionView()&&(n=this._getItemAttribute(this._actualRowIndex,this._actualColIndex))&&n.ca&&1<n.ca.rowSpan&&(1<n.type?s&&0<=n.oRno&&(s=this._listItems[n.oRno][n.oCno])&&(this.itemEditorInstance.setData(i.itemToLabel(s.getData(),!1)),this.itemEditorInstance.setY(s.getY()+h>c?c-h:s.getY())):s&&this.itemEditorInstance.setY(s.getY()+h>c?c-h:s.getY())),this._layoutItemEditor(),i.editorProperties){var _,i=i.editorProperties;F(i)&&(i=ua.findFunction(i));for(_ in i)jc(this.itemEditorInstance,_)?Ja(this.itemEditorInstance,_,i[_]):U(this.itemEditorInstance.getStyle)&&this.itemEditorInstance.setStyle(_,i[_])}}this.itemEditorInstance.addEvent("keydown",this._editorKeyDownHandler,this),v.documentAddEvent("mouseup",this._editorMouseUpHandler,this),r.ie8L||v.windowAddEvent("blur",this._editorBlurHandler,this),v.documentAddEvent("resize",this._editorStageResizeHandler,this)},l.prototype.destroyItemEditor=function(){if(this.itemEditorInstance){this.itemEditorInstance.removeEvent("keydown",this._editorKeyDownHandler,this),v.documentRemoveEvent("mouseup",this._editorMouseUpHandler,this),r.ie8L||v.windowRemoveEvent("blur",this._editorBlurHandler,this),v.documentRemoveEvent("resize",this._editorStageResizeHandler,this),this.itemEditorInstance.getErrorString()?this.itemEditorInstance.setErrorString(""):this.itemEditorInstance instanceof lb&&this.itemEditorInstance.saveAutocomplete();var t=new K(K.ITEM_FOCUS_OUT);t.columnIndex=this._editedItemPosition.columnIndex,t.rowIndex=this._editedItemPosition.rowIndex,t.itemRenderer=this.itemEditorInstance,this.dispatchEvent(t),this._columns[this._editedItemPosition.columnIndex].rendererIsEditor||(this.itemEditorInstance&&this.itemEditorInstance instanceof A&&this.itemEditorInstance.blur(),document.activeElement==document.body&&this.focus(),this.itemEditorInstance.getParent().removeChild(this.itemEditorInstance)),this._editedItemPosition=this.itemEditorInstance=null}this._startEditingByKeyboardEvent=this.errorInEditing=!1,this._tempTextInput&&this._tempTextInput.getParent()&&this._tempTextInput.getParent().removeChild(this._tempTextInput),this._tempTextInput=null,this._checkAndCreateTempTextInput()},l.prototype.measureHeightOfItems=function(t,e){return t=0<arguments.length?t:-1,e=1<arguments.length?e:0,this._measureHeightOfItemsUptoMaxHeight(t,e)},l.prototype.isItemOpen=function(t){return t=this._itemToUID(t),null!=this._collection.getOpenNodes()[t]},l.prototype.expandItem=function(t,e,i,s,r){if(i=2<arguments.length&&i,s=3<arguments.length?s:0,null!=this._iterator){r&&(this._lastUserInteraction=r),this._expandedItem=t,this._listContent._allowItemSizeChangeNotification=!1,this._listSubContent._allowItemSizeChangeNotification=!1;var n,o=this._itemToUID(t);if(this._isBranch(t)&&this.isItemOpen(t)!=e&&!this._isOpening)if(this.itemEditorInstance&&this._endEdit("other"),this._hideFilterInstance(),this._oldLength=this._collectionLength,this._iterator.getBookmark(),new y(y.COLLECTION_CHANGE,(!1),(!0),"expand").items=[t],e?this._collection.openNode(t):this._collection.closeNode(t),this._rowsTweened=Math.abs(this._oldLength-this._collection.getLength()),this.isItemVisible(t)){if(this._visibleData[o])for(n=this._listItems.length,this._rowIndex=0;this._rowIndex<n;this._rowIndex++)if(this._rowInfo[this._rowIndex].uid==o){this._rowIndex++;break}this.getTreeColumnIndex(),this.getStyle("openDuration"),s&&(o=this._eventItemRenderer?this._eventItemRenderer:this._visibleData[this._itemToUID(t)],this._dispatchAdvancedDataGridEvent(e?K.ITEM_OPEN:K.ITEM_CLOSE,t,o,this._lastUserInteraction),this._eventItemRenderer=this._lastUserInteraction=null),this._itemsSizeChanged=!0,this.invalidateDisplayList(),!this._wordWrap&&this._initialized&&l._super.setMaxHorizontalScrollPosition.call(this,0<this._userMaxHorizontalScrollPosition?this._userMaxHorizontalScrollPosition+this._getIndent():l._super.getMaxHorizontalScrollPosition.call(this)),this._listContent._allowItemSizeChangeNotification=this._variableRowHeight,this._listSubContent._allowItemSizeChangeNotification=this._variableRowHeight}else{var a=e?this._buildUpCollectionEvents(!0):this._buildUpCollectionEvents(!1);for(n=0;n<a.length;n++)this._collection.dispatchEvent(a[n]);s&&(this._dispatchAdvancedDataGridEvent(e?K.ITEM_OPEN:K.ITEM_CLOSE,t,this._visibleData[o],this._lastUserInteraction),this._lastUserInteraction=null)}}},l.prototype.itemToIcon=function(t){if(null==t)return null;var e,i=this.isItemOpen(t),s=this._isBranch(t),r=this._itemToUID(t);if(r=this.itemIcons&&this.itemIcons[r]?this.itemIcons[r][i?"iconID2":"iconID"]:null)return r;if(null!=this._iconFunction)return this._iconFunction(t);if(s)return this.getStyle(i?"folderOpenIcon":"folderClosedIcon");if(E(t))try{G.hasElementProperty(t,this._iconField)&&(e=G.getProperty(t,this._iconField))}catch(n){}else if(Ea(t))try{this._iconField&&t[this._iconField]?e=t[this._iconField]:t.icon&&(e=t.icon)}catch(n){}return null==e&&(e=this.getStyle("defaultLeafIcon")),e},l.prototype.setItemIcon=function(t,e,i){this.itemIcons||(this.itemIcons={}),i||(i=e),this.itemIcons[this._itemToUID(t)]={iconID:e,iconID2:i},this._itemsSizeChanged=!0,this.invalidateDisplayList()},l.prototype.isItemVisible=function(t){return!!this._visibleData[this._itemToUID(t)]||!!((t=this.getParentItem(t))&&(t=this._itemToUID(t),this._visibleData[t]&&this._collection.getOpenNodes()[t]))},l.prototype.getParentItem=function(t){return null==t?null:t&&this._collection&&this._collection.getParentItem?this._collection.getParentItem(t):null},l.prototype.expandAll=function(){if(this.getDataProvider()instanceof T&&this._iterator){for(this._iterator.seek(t.getFIRST());!this._iterator.getAfterLast();)this.expandChildrenOf(this._iterator.getCurrent(),!0),this._iterator.moveNext();this._iterator.seek(t.getFIRST(),this.getVerticalScrollPosition())}},l.prototype.collapseAll=function(){if(this.getDataProvider()instanceof T&&this._iterator){this._clearSelected();for(var e in this._collection.getOpenNodes())this._dispatchAdvancedDataGridEvent(K.ITEM_CLOSE,e,this._visibleData[this._itemToUID(e)]);e=this.getVerticalScrollPosition(),this.setVerticalScrollPosition(0),this._collection.setOpenNodes({}),this.setVerticalScrollPosition(e>=this._collection.getLength()?this._collection.getLength()-1:e),this._iterator.seek(t.getFIRST(),this.getVerticalScrollPosition())}},l.prototype.expandChildrenOf=function(t,e){if(null!=this._iterator&&this._isBranch(t)){this._dispatchAdvancedDataGridEvent(K.ITEM_OPENING,t,null,null,e,!1,!0);var i,s=0;if(null!=t&&this._rootModel.canHaveChildren(t)&&this._rootModel.hasChildren(t)&&(i=this._getChildren(t,this._iterator.getView())),i)for(var r=i[s];r;){this._isBranch(r)&&this.expandChildrenOf(r,e);try{r=i[s++]}catch(n){n instanceof vc&&(r=null)}}}},l.prototype.selectionToClipboard=function(e,i){var s;if(this._copyEnabled&&0!=this._columns.length){var n,o,a,l,h,d,c,_,u,p;if(this._isCellSelectionMode()){if(!this._selectedCells||0==this._selectedCells.length)return;if(d=s="",o={},a=0,p=this._selectedCells.slice(),p=Ra.sortOn(p,"rowIndex","columnIndex"),this.copyWithHeader||e){for(n=[],a=this._selectedCells.slice(),a=Ra.sortOn(a,"columnIndex"),u=0;u<a.length;u++)o.hasOwnProperty(a[u].columnIndex)||(n.push(this._columns[a[u].columnIndex]),o[a[u].columnIndex]=1);for(o=n.length,a=0;a<o;a++)l=n[a],c=null!=l.getHeaderText()?l.getHeaderText():l.getDataField(),null==c?_="":(_=c.toString(),_=_.replace(/<[br]*>/gi,"\n").replace(/<[a-zA-Z\/][^>]*>/g,""),_=hb.encode(_,"\t")),this.copyValueFunction&&(_=this.copyValueFunction(_,c,l,l)),s+=_,a<o-1&&(s+="\t");a=0}for(u=0;u<p.length;u++){if(this._collection instanceof T)for(n=0,o=this._collection.createCursor(),o.seek(t.getFIRST());!o.getAfterLast();){if(n==p[u].rowIndex){h=o.getCurrent();break}o.moveNext(),n++}else h=this._collection.getItemAt(p[u].rowIndex);l=this._columns[p[u].columnIndex],c=this._itemToData(h,l,l.copyWithItemRendererDataProvider,p[u].rowIndex),_=null==c?"":dc(c)?l.formatter?l.formatter.format(c):c.toString():hb.encode(c.toString(),"\t"),this.copyValueFunction&&(_=this.copyValueFunction(_,c,h,l)),u==p.length-1||p[u].rowIndex!=p[u+1].rowIndex?(d=0==a?_:d+"\t"+_,s=0==s.length?d:s+"\n"+d,d="",a=0):(d=0==a?_:d+"\t"+_,a++)}}else if(this._isRowSelectionMode()){if(h=this.getSelectedItems(),!h||0==h.length)return;if(n=this.copyWithAllColumns?this._columns:this._displayableColumns,o=n.length,s="",this.copyWithHeader||e){for(a=0;a<o;a++)l=n[a],c=null!=l.getHeaderText()?l.getHeaderText():l.getDataField(),null==c?_="":(_=c.toString(),_=_.replace(/<[br]*>/gi,"\n").replace(/<[a-zA-Z\/][^>]*>/g,""),_=hb.encode(_,"\t")),this.copyValueFunction&&(_=this.copyValueFunction(_,c,l,l)),s+=_,a<o-1&&(s+="\t");s+="\n"}for(p=h.slice(),(d=this.getSelectedIndices())&&1<d.length&&d[0]<d[1]&&(p.reverse(),d.reverse()),u=p.length-1;0<=u;u--){for(h=p[u],a=0;a<o;a++)l=n[a],c=this._itemToData(h,l,l.copyWithItemRendererDataProvider,d[u]),_=null==c?"":dc(c)?l.formatter?l.formatter.format(c):c.toString():hb.encode(c.toString(),"\t"),this.copyValueFunction&&(_=this.copyValueFunction(_,c,h,l)),s+=_,a<o-1&&(s+="\t");0<u&&(s+="\n")}}s&&r.setClipboard(s,this,i)}},l.prototype.pasteFrom=function(t){t=r.getClipboard(this),this.clipboardPaste(t)},l.prototype.clipboardPaste=function(t){if(t&&!(0>t.length)){var e,i;e=new hb("\t"),bb(this.parsingDate)&&(e.parsingDate=this.parsingDate),t=e.parse(t);var s,r,n,o=e.parsedFieldCount,a=this.getSelectedIndex();if(!(0>a)){for(this.getParent()instanceof D?n=this.getParent():this.getParent().getParent()instanceof D&&(n=this.getParent().getParent()),e=0;e<t.length;e++){s=t[e];var l,h=this._isRowSelectionMode()?0:this._selectedColumnIndex;if(a>=this._collection.getLength()?(l={},n?n.addItemAt(l):(this.addChangedData(l,"I"),this._collection.addItem(l))):l=this._collection.getItemAt(a),this._isDataEditable(l)&&!(l instanceof ic))for(i=0;i<o;i++){r=s["F"+i];var d=this._absoluteToDisplayColumnIndex(h);if(d>=this._displayableColumns.length)break;var c;(d=this._displayableColumns[d])&&d.editable?(this.pasteParseFunction&&(s["F"+i]=r=this.pasteParseFunction(r,s,l,d)),d=d.getDataField(),c=E(l)?G.getProperty(l,d):l[d],r==c?h+=1:(c=new K(K.PASTE_EDIT_END,(!1),(!0)),c.columnIndex=h,c.dataField=d,c.rowIndex=a,c.reason="other",c.item=l,c.newValue=r,this.dispatchEvent(c),c.defaultPrevented||this._importData(l,d,r),h++)):h+=1}a++}this._collection instanceof va&&this._collection.getSource()instanceof P&&this._collection.refresh(),this.invalidateList()}}},l.prototype.expandLevel=function(e){if(e=0<arguments.length?e:1,this.getDataProvider()instanceof T&&this._iterator){var i=this.getDataProvider().createCursor();for(i.seek(t.getFIRST());!i.getAfterLast();)i.getCurrentDepth()<=e?this.expandChildrenOf(i.getCurrent(),!0):this.expandChildrenOf(i.getCurrent(),!1),i.moveNext()}},l.prototype.invalidateProperties=function(){var t;if(l._super.invalidateProperties.call(this),this._showFooters&&null!=this._footers&&0<this._footers.length)for(t=0;t<this._footers.length;t++)this._footers[t].invalidateProperties()},l.prototype.invalidateDisplayList=function(){var t;if(l._super.invalidateDisplayList.call(this),this._showFooters&&null!=this._footers&&0<this._footers.length)for(t=0;t<this._footers.length;t++)this._footers[t].invalidateDisplayList()},l.prototype.addChangedData=function(t,e){var i=this._itemToUID(t);this._changedData[i]?"I"===this._changedData[i].job&&"D"===e?this.removeChangedData(t):this._changedData[i]="I"===this._changedData[i].job&&"U"===e?{job:"I",data:t}:"D"===this._changedData[i].job?{job:"D",data:t}:{job:e,data:t}:this._changedData[i]={job:e,data:t},this.invalidateList()},l.prototype._getChangedDataFlag=function(t){return(t=this._changedData[this._itemToUID(t)])?t.job:null},l.prototype.removeChangedData=function(t){delete this._changedData[this._itemToUID(t)]},l.prototype.resetChangedData=function(){this._changedData={},this.invalidateList()},l.prototype.isItemDeleted=function(t){return null!=t&&(!!this._showDeletedRows&&(F(t)?this._changedData[t]&&"D"===this._changedData[t].job:(t=this._itemToUID(t),this._changedData[t]&&"D"===this._changedData[t].job)))},l.prototype.autoFit=function(t){if(t&&"DataGridColumn"==t.className){var e,i=0,s=0,r=0,n=this._collection.createCursor(),o=t.getItemRenderer()&&t.getItemRenderer()instanceof kb?t.getItemRenderer().generator:null;if(t.resizable&&o!==be&&o!==Qb&&o!==zc){for(o!==Eb&&o!==Sd||(s=24),this._rootModel instanceof pb&&t.colNum==this.getTreeColumnIndex()?(s+=this._getIndent(),(this.getDisplayDisclosureIcon()||this.getStyle("defaultLeafIcon"))&&(s+=16),(this.getStyle("folderOpenIcon")||this.getStyle("folderClosedIcon"))&&(s+=16)):s+=4,t.getStyle("fontWeight")&&m.isBold(t.getStyle("fontWeight"))&&(s+=3);!(n.getAfterLast()||(e=n.getCurrent(),e=this._pivotData?this._itemToData(e,t,!1,r):t.itemToLabel(e),o===ud&&(e=e.replace(/\n/g,"</br>")),e=this.measureText(e),i=Math.max(i,e.width),n.moveNext(),r++,500<r)););t.getSizeStyle("paddingLeft")&&(i+=t.getSizeStyle("paddingLeft")),t.getSizeStyle("paddingRight")&&(i+=t.getSizeStyle("paddingRight")),i+=s,i=i>this.getWidth()-20?this.getWidth()-20:Math.max(i,t.getMinWidth()),this._resizeColumn(t.colNum,i),i=new K(K.COLUMN_STRETCH),i.columnIndex=t.colNum,i.dataField=t.getDataField(),i.localX=this._lastPt?this._lastPt.x:0,this.dispatchEvent.call(this,i)}}},l.prototype.getFieldFilterInfo=function(t){return this._visualFilterInfo[t.getDataField()]?this._visualFilterInfo[t.getDataField()]:null},l.prototype.setColumnFiltering=function(t,e,i,s,r){var n,o,a,l,h=[];if(i||s){switch(a=this._columns[t],r?U(r)?o="custom":F(r)&&(o=r):(o=a.getStyle("type"),a.filterType&&F(a.filterType)&&(o=a.filterType.toLowerCase()),o||((l=a.getFormatter())?l instanceof jd||l instanceof Cd?o="number":l instanceof id?o="date":(a.getItemRendererDataProvider()||a.getItemRendererDataProviderField())&&(o="itemrendererdataprovider"):a.getItemRendererDataProvider()||a.getItemRendererDataProviderField()?o="itemrendererdataprovider":p(a.trueValue)||p(a.falseValue)||(o="boolean")),o=o||"none"),o){case"custom":break;case"int":case"float":case"number":r=ab.prototype.numberFilter;break;case"range":r=ab.prototype.rangeFilter;break;case"date":r=ab.prototype.dateFilter;break;case"boolean":r=ab.prototype.booleanFilter;break;case"itemrendererdataprovider":r=ab.prototype.itemRendererDataProviderFilter;break;default:r=ab.prototype.noneFilter}this._visualFilterInfo[e]={dataField:e,filterData:s,columnIndex:t,column:a,filterFunction:r,operator:i?ua.copy(i):null}}else delete this._visualFilterInfo[e];h=[];for(n in this._visualFilterInfo)h.push(this._visualFilterInfo[n]);this._hideFilterInstance(),this._collection&&(h?(t=function(t){var e,i,s,r,n,o,a=h;if(a)for(e=0,i=a.length;e<i;e++){if(r=a[e].column,o=a[e].operator,n=a[e].filterData,r){if(r.getDataField()!=a[e].dataField)break;s=r.itemToData(t)}if(a[e].filterFunction&&!a[e].filterFunction(t,s,o,n,r))return!1}return!0},U(this._collection.setFilterFunction)?this._collection.setFilterFunction(t):this._collection.filterFunction=t):U(this._collection.setFilterFunction)?this._collection.setFilterFunction(null):this._collection.filterFunction=null,this._collection.refresh())},l.prototype.clearColumnFilters=function(){this._visualFilterInfo={},this._collection&&(U(this._collection.setFilterFunction)?this._collection.setFilterFunction(null):this._collection.filterFunction=null,this._collection.refresh())},l.prototype.getColumnDistinctData=function(e,i){var s,r,n,o,a={},l=[];if(this._collection){if(this._collection._localIndex&&(n=this._collection._localIndex,this._collection._localIndex=null),s=this._columns[e],!s||s.getDataField()!=i)return l;for(o=this._collection.createCursor(),o.seek(t.getFIRST());!o.getAfterLast();)r=o.getCurrent(),r=s.itemToData(r),I(a[r])&&(a[r]=1,l.push(r)),o.moveNext();this._collection._localIndex=n}return l},l.prototype.getDisplayableColumns=function(){return this._displayableColumns},M._defaultStyles={cellTextAlign:"right",columnAxisHeaderStyleName:void 0,rowAxisHeaderStyleName:void 0},M._propertyType={headerRendererProviders:Array,itemRendererProviders:Array},z(M,l),M.COLUMN_AXIS=0,M.ROW_AXIS=1,M.SLICER_AXIS=2,M.PIVOT_MEMBER=0,M.PIVOT_LEVEL=1,M.PIVOT_HIERARCHY=2,M.PIVOT_DIMENSION=3,M.prototype.setVerticalScrollPosition=function(t){M._super.setVerticalScrollPosition.call(this,t),this.getStyle("horizontalGridLines")&&this._drawRowHeaderHorizontalSeparators()},M.prototype.getDataProvider=function(){return this._pivotData},M.prototype.setDataProvider=function(t){(!t||!p(t)&&t instanceof gc)&&(this._pivotData=t,this._dataProviderChanged=!0,this.invalidateProperties())},M.prototype.getItemRendererProviders=function(){return this._itemRendererProvidersUnSorted},M.prototype.setItemRendererProviders=function(t){var e;for(this._itemRendererProviders=t.sort(this._compareFunction),this._cellRenderersMap=[],e=0;e<this._pivotElements.length;e++)this._cellRenderersMap[this._pivotElements[e]]={};for(e=0;e<this._itemRendererProviders.length;e++)t[e].getRenderer()&&(this._rendererChanged=this._itemsSizeChanged=!0),this._cellRenderersMap[t[e].getType()][t[e].getUniqueName().replace(/\(/g,"[").replace(/\)/g,"]")]=e;this._itemRendererProvidersUnSorted=t,this._itemRendererProvidersChanged=!0,this.invalidateDisplayList()},M.prototype.getHeaderRendererProviders=function(){return this._headerRendererProvidersUnSorted},M.prototype.setHeaderRendererProviders=function(t){var e;for(this._headerRendererProviders=t.sort(this._compareFunction),this._headerRenderersMap=[],e=0;e<this._pivotElements.length;e++)this._headerRenderersMap[this._pivotElements[e]]={};for(e=0;e<this._headerRendererProviders.length;e++)t[e].getRenderer()&&(this._rendererChanged=this._itemsSizeChanged=!0),this._headerRenderersMap[t[e].getType()][t[e].getUniqueName().replace(/\(/g,"[").replace(/\)/g,"]")]=e;this._headerRendererProvidersUnSorted=t,this._headerRendererProvidersChanged=!0,this.invalidateDisplayList()},M.prototype._compareFunction=function(t,e){return t.type>e.type?-1:t.type<e.type?1:0},M.prototype._setupRenderer=function(t,e,i){if(M._super._setupRenderer.call(this,t,e,i),i=0,t=t.getMembers?t.getMembers():t.members,this._rowHeadersMap[e]||(this._rowHeadersMap[e]=[]),this._rowHeadersMap[e][0]&&this._rowHeadersMap[e][0].initialized)for(i=0;i<t.getLength();i++)this._listItems[this._currentRowNum][i].setVisible(this._rowHeadersMap[e][i].visible);else{for(;i<this._currentRowLabels.length&&t.getItemAt(i).getName()==this._currentRowLabels[i].member.getName();)this._rowHeadersMap[e][i]||(this._rowHeadersMap[e][i]=new Ke),this._rowHeadersMap[e][i].visible=!1,this._rowHeadersMap[e][i].renderer=this._currentRowLabels[i].renderer,this._rowHeadersMap[e][i].initialized=!0,this._listItems[this._currentRowNum][i].setVisible(!1),i++;for(this._currentRowLabels.splice(i,this._currentRowLabels.length);i<t.getLength();)this._rowHeadersMap[e][i]||(this._rowHeadersMap[e][i]=new Ke),this._rowHeadersMap[e][i].visible=!0,this._rowHeadersMap[e][i].renderer=this._listItems[this._currentRowNum][i],this._rowHeadersMap[e][i].initialized=!0,this._listItems[this._currentRowNum][i].setVisible(!0),this._currentRowLabels.push({member:t.getItemAt(i),renderer:this._listItems[this._currentRowNum][i]}),i++}},M.prototype._makeListData=function(t,e,i,s,r){var n,o;if(!(t instanceof C)){if(this._groupItemRenderer&&r.colNum<this._numHeaderCols)return o=(n=t.getMembers().getItemAt(r.colNum))?n.getDisplayName():" ",e=new nd(o,r.getDataField(),s,e,this,i),this._isMeasuring||(e.indent=this._getIndent(t,n,s)),e.item=t,e;if(r.colNum>=this._numHeaderCols)return o=i,i>=this._lockedRowCount&&(o+=Math.max(0,this.getVerticalScrollPosition())),n=r.colNum-this._numHeaderCols,o=(o=this._pivotData.getCell(o,n))&&!isNaN(o.getValue())?String(o.getValue()):this.defaultCellString,n=this._columnAxis.getItemAt(n),o=t instanceof vd?this._getFormattedCellValue(o,t,n):this._getFormattedCellValue(o,null,n),s=new nd(o,r.getDataField(),s,e,this,i),s.item=t,s}return M._super._makeListData.call(this,t,e,i,s,r)},M.prototype._setupRendererFromData=function(t,e,i){this._isMeasuring=!0,M._super._setupRendererFromData.call(this,t,e,i),this._isMeasuring=!1},M.prototype._columnItemRendererFactory=function(t,e,i){var s;if(!e&&t.colNum<this._numHeaderCols)s=t.getItemRenderer()?t.getItemRenderer():this._groupItemRenderer;else if(e)if(t.getHeaderRenderer())s=t.getHeaderRenderer();else{var r=this._getHeaderInfo(t);r&&r.actualColNum>=this._numHeaderCols&&(s=this._groupItemRenderer)}return s||(s=M._super._columnItemRendererFactory.call(this,t,e,i)),s},M.prototype._getHeaderRenderer=function(t){var e=M._super._getHeaderRenderer.call(this,t);if(t==this._hierarchiesHeaderColumn&&0<this._columnAxis.getLength()){t=this._columnAxis.getItemAt(0).getMembers();var i,s=t.getLength(),r=[],n=[];for(i=0;i<s;i++)n.push(t.getItemAt(i).getHierarchy()),r.push(this.getHeaderRenderer());e.setFactories(r),e.setDataProvider(n)}return e},M.prototype._generateGroup=function(t,e){if(e=1<arguments.length?e:-1,(-1==e||e>this._columnAxis.getLength())&&(e=this._columnAxis.getLength()),e<t)return[];var i,s=new fb,r=[],n=[];for(i=t;i<e;i++){for(var o=this._columnAxis.getItemAt(i).getMembers(),a=0;a<o.getLength()&&o.getItemAt(a)==r[a];)a++;for(0<a&&a==o.getLength()&&a--,r.splice(a,r.length),n.splice(a,n.length);a<o.getLength();){var l,h=0<a?n[a-1]:s;a==o.getLength()-1?(l=new C(o.getItemAt(a).getDisplayName()),l.setStyle("textAlign",this.getStyle("cellTextAlign"))):(l=new fb(o.getItemAt(a).getDisplayName()),l.children=[]),this._columnNames[l.uno]=o.getItemAt(a),n.push(l),r.push(o.getItemAt(a)),h.children.push(l),a++}}return s.children},M.prototype._generateCols=function(){this._columnNames={};var t=new fb;return t.children=this._generateGroup(0),this._hierarchiesHeaderColumn=t,t.setHeaderRenderer(new kb(Yb)),t},M.prototype._getFormattedCellValue=function(t,e,i){return(e=this._getCellRendererInfo(e,i))&&e.formatter?this._applyFormatting(t,e.formatter):this.cellFormatter?this._applyFormatting(t,this.cellFormatter):t},M.prototype._getIndent=function(t,e,i){var s=0;if(t=this._itemToUID(t),this._rowHeadersMap[t]&&this._rowHeadersMap[t][i])s=this._rowHeadersMap[t][i].indent;else{if(0<this._currentRowNum){var r=this._listItems[this._currentRowNum-1];if(i<r.length){var n=r[i].getData().getMembers().getItemAt(i).getLevel(),n=n?n.getDepth():0;e=e.getLevel()?e.getLevel().getDepth():0,e==n?s=r[i].getListData().indent:e>n?s=r[i].getListData().indent+(e-n)*this.getStyle("indentation"):n>e&&(s=r[i].getListData().indent+(e-n)*this.getStyle("indentation"),s=0<=s?s:r[i].getListData().indent)}}else e=e.getLevel()?e.getLevel().getDepth():0,this._cachedMinRowIndents&&i<this._cachedMinRowIndents.length&&(s=Math.max(0,(e-this._cachedMinRowIndents[i])*this.getStyle("indentation")));this._rowHeadersMap[t]||(this._rowHeadersMap[t]=[]),this._rowHeadersMap[t][i]||(this._rowHeadersMap[t][i]=new Ke),this._rowHeadersMap[t][i].indent=s}return s},M.prototype._columnToAxisPosition=function(t){t=this._getHeaderInfo(t);var e=this._seekColumn(t.actualColNum-this._numHeaderCols);return{member:e.getMembers().getItemAt(t.depth),position:e,positionIndex:t.actualColNum,memberIndex:t.depth}},M.prototype._seekColumn=function(t){var e=null;try{e=this._columnAxis.getItemAt(t)}catch(i){}return e},M.prototype._applyRenderer=function(){var t,e=this._orderedHeadersList?this._orderedHeadersList.length:0;for(t=this._numHeaderCols+1;t<e;t++){var i=this._orderedHeadersList[t].column;if(this._headerRendererProvidersChanged){var s=this._getRendererInfo(this._columnNames[i.uno],!0);s&&(s.getRenderer()&&i.setHeaderRenderer(s.getRenderer()),s.headerWordWrap&&i.setHeaderWordWrap(s.headerWordWrap),s.styleName&&i.setStyle("headerStyleName",s.styleName))}}},M.prototype._rowHeaderWordWrap=function(t){return(t=this._getRendererInfo(t,!0))&&t.headerWordWrap},M.prototype._getRenderer=function(t,e,i){if(t.colNum<this._numHeaderCols)var s=e.getMembers().getItemAt(t.colNum),s=this._getRendererInfo(s,!0);else s=this._columnAxis.getItemAt(t.colNum-this._numHeaderCols),s=this._getCellRendererInfo(e instanceof vd?e:null,s);return s?(e=s.getRenderer()?s.getRenderer().newInstance():M._super._getRenderer.call(this,t,e),s.styleName&&e.setStyleName(s.styleName),e):(e=M._super._getRenderer.call(this,t,e,i),e.setStyleName(t),e)},M.prototype._drawSelectionIndicator=function(t,e,i,s,r,n,o){
this._isRowSelectionMode()?(e=this._getRowHeadersWidth(),s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right-e,t.setWidthInline(s),t.setHeightInline(r),t.setStyle("backgroundColor",n),t.setVisibility(!0),t.setX(e),t.setY(i)):M._super._drawSelectionIndicator.call(this,t,e,i,s,r,n,o)},M.prototype._drawHighlightIndicator=function(t,e,i,s,r,n,o){this._isRowSelectionMode()?(e=this._getRowHeadersWidth(),s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right-e,t.setWidthInline(s),t.setHeightInline(r),t.setStyle("backgroundColor",n),t.setVisibility(!0),t.setX(e),t.setY(i)):M._super._drawHighlightIndicator.call(this,t,e,i,s,r,n,o)},M.prototype._drawCaretIndicator=function(t,e,i,s,r,n,o){this._isRowSelectionMode()?(e=this._getRowHeadersWidth(),s=this.getViewMetrics(),s=this._unscaledWidth-s.left-s.right-e,t.setWidthInline(s),t.setHeightInline(r-1),t.setStyle("borderColor",n),t.setStyle("borderWidth","1px"),t.setStyle("borderStyle","solid"),t.setVisibility(!0),t.setX(e),t.setY(i+1)):M._super._drawCaretIndicator.call(this,t,e,i,s,r,n,o)},M.prototype._getRowHeadersWidth=function(){var t,e=0;for(t=0;t<this._numHeaderCols;t++)e+=this._columns[t].getWidth();return e},M.prototype._mouseOverHandler=function(t){var e=this._headerRowInfo.length?this._headerRowInfo[0].height:this._headerHeight,i=v.getEventPageXY(t),i=this._listContent.globalToLocal(i);i.y<e||M._super._mouseOverHandler.call(this,t)},M.prototype._keyDownHandler=function(t){this._getHeaderVisible()&&0==this.getSelectedIndex()&&0==this._caretIndex&&38==t.keyCode&&!t.ctrlKey&&!t.shiftKey||38==t.keyCode&&0==this._caretIndex&&-1==this.getSelectedIndex()||M._super._keyDownHandler.call(this,t)},M.prototype._itemRendererToIndices=function(t){if(t&&!this._isHeaderItemRenderer(t)&&this._isCellSelectionMode()){var e=M._super._itemRendererToIndices.call(this,t);if(this._displayToAbsoluteColumnIndex(e.x)<this._numHeaderCols)return null}return M._super._itemRendererToIndices.call(this,t)},M.prototype._drawRowBackground=function(t,e,i,s,r,n){e<t.getNumChildren()?e=t.getChildAt(e):(e=new A("div","DataGridBackground"),e.name="Kool__background",t.addChild(e)),e.setY(i),e.setX(this._getRowHeadersWidth()),t=Math.min(s,this._listContent.getHeight()-i),i=this.getViewMetrics(),e.setStyle("backgroundColor",r),e.setWidth(this._unscaledWidth-i.left-i.right,s),e.setHeight(t)},M.prototype._applyUserStylesForItemRenderer=function(t){if(t&&t instanceof u){var e=t.getListData();if(!(e.columnIndex<this._numHeaderCols)){var i=Number(e.label),s=e.rowIndex;s>=this._lockedRowCount&&(s+=Math.max(0,this.getVerticalScrollPosition())+Math.max(0,this._lockedRowCount)),s=s<this._rowAxis.getLength()&&this._rowAxis.getItemAt(s)instanceof vd?this._rowAxis.getItemAt(s):null,e=this._columnAxis.getItemAt(e.columnIndex-this._numHeaderCols),this._oldStyles||(this._oldStyles={});var r;if(this._oldStyles[t.uno]){for(r in this._oldStyles[t.uno])t.clearStyle(r);delete this._oldStyles[t.uno]}if(null!=this._styleFunction&&(i=this._styleFunction(s,e,i)))for(r in i)this._oldStyles[t.uno]||(this._oldStyles[t.uno]={}),this._oldStyles[t.uno][r]=t.getStyle(r),t.setStyle(r,i[r])}}},M.prototype._viewDisplayableColumnAtOffset=function(t,e,i,s){return this._absoluteToDisplayColumnIndex(t)==this._numHeaderCols&&0>e?-1:M._super._viewDisplayableColumnAtOffset.call(this,t,e,i,s)},M.prototype.commitProperties=function(){if(this._dataProviderChanged){var t=this._dataProviderChanged=!1,e=!1;if(this._pivotData&&(this._rowAxis=this._pivotData.getAxis(M.ROW_AXIS).getPositions(),this._columnAxis=this._pivotData.getAxis(M.COLUMN_AXIS).getPositions(),this._pivotData.getAxis(M.SLICER_AXIS)&&(this._slicerAxis=this._pivotData.getAxis(M.SLICER_AXIS).getPositions()),t=this._rowAxis&&this._rowAxis.getLength(),e=this._columnAxis&&this._columnAxis.getLength()),e){if(e=[],t){var i=this._rowAxis.getItemAt(0).getMembers();for(this._numHeaderCols=i.getLength(),this._cachedMinRowIndents=[],t=0;t<i.getLength();t++){var s=i.getItemAt(t).getHierarchy(),s=new C(s.getDisplayName());s.setStyle("fontWeight","bold"),s.setStyle("verticalAlign","middle"),e.push(s),this._cachedMinRowIndents.push(i.getItemAt(t).getLevel().getDepth())}this.setLockedColumnCount(this._numHeaderCols)}else t={},this._numHeaderCols=0,this.setLockedColumnCount(0),t.members=new P([]),this._rowAxis=new P([t]);t=[this._generateCols()],this.setGroupedColumns(e.concat(t)),this._currentRowLabels=[],this._rowHeadersMap={},(this._headerRendererProviders&&0<this._headerRendererProviders.length||this._itemRendererProviders&&0<this._itemRendererProviders.length)&&(this._itemRendererProvidersChanged=this._headerRendererProvidersChanged=!0,this.invalidateDisplayList()),M._super.setDataProvider.call(this,this._rowAxis)}else this._numHeaderCols=0,this.setGroupedColumns([]),this.setLockedColumnCount(0),M._super.setDataProvider.call(this,null)}M._super.commitProperties.call(this)},M.prototype.styleChanged=function(t){"rowAxisHeaderStyleName"==t?this._applyNewAxisStyles(M.ROW_AXIS):"columnAxisHeaderStyleName"==t&&this._applyNewAxisStyles(M.COLUMN_AXIS),M._super.styleChanged.call(this,t)},M.prototype._createHeaders=function(t,e){this._applyNewAxisStyles(M.ROW_AXIS),M._super._createHeaders.call(this,t,e),this._applyNewAxisStyles(M.COLUMN_AXIS)},M.prototype._applyNewAxisStyles=function(t){if(t==M.COLUMN_AXIS){if(t=this.getStyle("columnAxisHeaderStyleName")){var e=this._orderedHeadersList[this._numHeaderCols].headerItem;e&&e.getStyle("axisHeaderStyleName")!=t&&e.setStyle("axisHeaderStyleName",t)}}else if(t==M.ROW_AXIS&&this.getStyle("rowAxisHeaderStyleName"))for(e=this.getStyle("rowAxisHeaderStyleName"),t=0;t<this._numHeaderCols;t++)this._orderedHeadersList[t].column.setStyle("headerStyleName",e)},M.prototype.updateDisplayList=function(t,e){(this._headerRendererProvidersChanged||this._itemRendererProvidersChanged)&&(this._applyRenderer(),this._itemRendererProvidersChanged=this._headerRendererProvidersChanged=!1),M._super.updateDisplayList.call(this,t,e);var i=this._listContent.getChildByName("rowHeaderBG");if(!i){i=new u,i.name="rowHeaderBG",this._listContent.addChildAt(i,this._listContent.getChildIndex(this._selectionLayer));var s=this.getStyle("headerBackgroundSkin");null!=s&&(s=new s,s instanceof u&&s.setStyleName(this),i.addChild(s))}i.setVisible(!0),this._drawRowHeaderBackground(i)},M.prototype._drawLinesAndColumnBackgrounds=function(){M._super._drawLinesAndColumnBackgrounds.call(this),this.getStyle("horizontalGridLines")&&this._drawRowHeaderHorizontalSeparators()},M.prototype._drawRowHeaderHorizontalSeparators=function(){var t=this._listContent.getChildByName("lockedContent");t||(t=new u,t.name="lockedContent",this._listSubContent.addChild(t),this._listSubContent.setChildIndex(t,this._listContent.getNumChildren()-1));var e=t.getChildByName("horizontalRowHeaderLines");for(e||(e=new u,e.name="horizontalRowHeaderLines",t.addChild(e)),e.setVisible(!1),t=e.element;t.firstChild;)t.removeChild(t.firstChild);e.setVisible(!0);for(var i=this.getStyle("horizontalGridLineColor"),t=0;t<this._listItems.length;t++)this._drawRowHeaderHorizontalLine(e,t,i,this._rowInfo[t].y+this._rowInfo[t].height)},M.prototype._drawRowHeaderHorizontalLine=function(t,e,i,s){var r,n,o,a,l=0;if(this._listItems[e+1]&&!this._listItems[e+1][0])for(a=0;a<this._numHeaderCols;a++)r=new A("div","DataGridLineH"),n=r.element.style,n.borderColor=i,n.left=l+"px",n.top=s+"px",l+=this._columns[a].getWidth(),n.width=this._columns[a].getWidth()+"px",t.addChild(r);else for(a=0;a<this._numHeaderCols;a++)r||(r=new A("div","DataGridLineH"),n=r.element.style,n.borderColor=i),n.left=l+"px",n.top=s+"px",o=l,l+=this._columns[a].getWidth(),this._listItems[e+1]&&this._listItems[e+1][a]&&this._listItems[e+1][a].getVisible()&&(n.width=l-o+"px",t.addChild(r),r=null)},M.prototype._drawHorizontalLine=function(t,e,i,s,r){var n,o=0,a=this.getViewMetrics(),l=new A("div","DataGridLineH"),h=l.element.style;for(n=0;n<this._numHeaderCols;n++)o+=this._columns[n].getWidth();0<this._lockedRowCount&&e==this._lockedRowCount-1?(l.setStyle("borderColor",this.getStyle("lockedLineColor")),l.setStyle("borderTopStyle","none"),e=this.getStyle("lockedLineStyle"),l.setStyle("borderBottomStyle",e),"double"==e?l.setStyle("borderBottomWidth","3px"):l.setStyle("borderBottomWidth","1px")):(h.borderColor=i,h.borderBottomStyle=s),h.left=o+"px",h.top=r+"px",h.width=this._unscaledWidth-a.left-a.right+"px",t.addChild(l)},M.prototype._drawVerticalLine=function(t,e,i,s,r){if(0<this._lockedColumnCount&&e==this._lockedColumnCount-1){e=new A("div","DataGridLineV");var n=e.element.style;n.borderColor=i,n.borderRightStyle=s?s:"",n.left=r+"px",t.addChild(e)}else M._super._drawVerticalLine.call(this,t,e,i,s,r)},M.prototype._drawRowHeaderBackground=function(t){this.getViewMetrics(),this._getHeaderVisible();var e,i=this.getStyle("headerColors"),i=[i[0],i[0],i[1]],s=0;for(e=0;e<this._numHeaderCols;e++)s+=this._columns[e].getWidth();i&&(r.ie8L||r.ie9?t.setStyle("filter","progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='"+i[0]+"', EndColorStr='"+i[1]+"')"):(e=r.getCssPrefix(),t.setStyle("backgroundImage",e+"linear-gradient(top, "+i[0]+" 0%, "+i[0]+" 0%, "+i[1]+" 100%)"),t.setStyle("backgroundImage","linear-gradient(to bottom, "+i[0]+" 0%, "+i[0]+" 0%, "+i[1]+" 100%)")))},M.prototype._applyFormatting=function(t,e){if(null!=e&&null!=t){var i=e.format(t);return e.error&&!1===e.returnValueWhenError?null:i}return t},M.prototype._getCellRendererInfo=function(t,e){for(var i,s=this._numHeaderCols-1;0<=s;){if(i=t.getMembers().getItemAt(s),i=this._getRendererInfo(i,!1))return i;s--}for(s=0;s<e.getMembers().getLength();){if(i=e.getMembers().getItemAt(s),i=this._getRendererInfo(i,!1))return i;s++}return null},M.prototype._getRendererInfo=function(t,e){var i;if(i=e?this._headerRenderersMap:this._cellRenderersMap,!i)return null;var s,r;for(s=0;s<this._pivotElements.length;s++)if(this._pivotElements[s]==M.PIVOT_MEMBER?r=t.getUniqueName():this._pivotElements[s]==M.PIVOT_LEVEL?r=t.getLevel().getUniqueName():this._pivotElements[s]==M.PIVOT_HIERARCHY?r=t.getHierarchy().getUniqueName():this._pivotElements[s]==M.PIVOT_DIMENSION&&(r=t.getDimension().getUniqueName()),!p(i[this._pivotElements[s]][r]))return i=i[this._pivotElements[s]][r],e?this._headerRendererProviders[i]:this._itemRendererProviders[i];return null},M.prototype._itemToData=function(t,e,i,s){return this._groupItemRenderer&&e.colNum<this._numHeaderCols?(t=t.getMembers().getItemAt(e.colNum))?t.getDisplayName():" ":e.colNum>=this._numHeaderCols?(i=s,s>=this._lockedRowCount&&(i+=Math.max(0,this.getVerticalScrollPosition())),e=e.colNum-this._numHeaderCols,s=(s=this._pivotData.getCell(i,e))&&!isNaN(s.getValue())?String(s.getValue()):this.defaultCellString,e=this._columnAxis.getItemAt(e),s=t instanceof vd?this._getFormattedCellValue(s,t,e):this._getFormattedCellValue(s,null,e)):null};var Ke=function(){};gb.prototype.startParsing=function(t){var e,i,s=t.childNodes;for(e=this._getClassInfo(t),this._root=new e("div","KoolGrid"),this._setPropsStyles(t,this._root,e),this._wrapper.addChild(this._root),this._csses={},(t=t.getElementsByTagName("Style"))&&t[0]&&this._parseStyle(t[0].textContent||t[0].text),t=0,e=s.length;t<e;t++)if(i=s[t],1==i.nodeType&&"Style"!=i.nodeName)if(jc(this._root,i.nodeName))i=this._commitSubNodes(i.nodeName,i.childNodes,this._root,i),this._setPropsStylesByNode(i,this._root);else if(!this._parseExtraLayout(i))break;this._checkUnMatchedComponentId()},gb.prototype._parseStyle=function(t){var e=t.replace(/\s+(?=([^"]*"[^"]*")*[^"]*$)(?=([^']*'[^']*')*[^']*$)/g,""),i=e.match(/(\.\w*|\w*)\s*\{/g),s=e.match(/\{.*?\}/gi);if(i&&s){if(i.length!=s.length)throw"Style tag is invalid in the layout";var r,n,o,a,l;t=[];var h=[];for(r=0,o=i.length;r<o;r++)t[r]=i[r].replace(/\{/g,""),l=s[r].replace(/\{|\}/g,""),h[r]=l.split(";");for(r=0,o=h.length;r<o;r++){for(s=h[r],e=[],n=0,a=s.length;n<a;n++)i={},l=s[n].split(":"),2<=l.length&&(i.name=Mc.removeHyphen(l[0]),i.value=l[1].replace(/\\"|"|'/g,""),p(i.value)||!Tb.mustHavePxStyles[i.name]||isNaN(Number(i.value))||(i.value+="px"),0==i.value.indexOf("0x")&&(i.value=i.value.replace(/0x/,"#")),e[n]=i);h[r]=e}var d,s=-1,i=m.findLocalCSSSheetIndex("Kool__"+this._wrapper.uno);if(0>i){for(r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style"),o.type="text/css",o.styleSheet?o.styleSheet.cssText=".Kool__"+this._wrapper.uno+" {color: blue;}":o.innerHTML=".Kool__"+this._wrapper.uno+" {color: blue;}",r.appendChild(o),o=o.sheet?o.sheet:o.styleSheet,r=0;document.styleSheets.length;r++)if(document.styleSheets[r]==o){i=r;break}0>i&&(i=m.findCSSSheetIndex("Kool__"+this._wrapper.uno))}if(0>i)throw"can not create styles in layout";for(r=0,o=t.length;r<o;r++)if(n=t[r],l=n.substr(0,1),"."!=l&&/[A-Z]/.test(l))for(gb.classMap[n]?(gb.classMap[n]._defaultStyles||(gb.classMap[n]._defaultStyles={}),d=gb.classMap[n]._defaultStyles):d=null,0>s&&(s=Tb.productCSSSheetIndex,0>s&&(s=m.findCSSSheetIndex("Kool__(\\S)*"),0<=s&&0>Tb.productCSSSheetIndex&&(Tb.productCSSSheetIndex=s))),e=0<=s?m.getCSSRule(s,"Kool__"+n):null,n=0,a=h[r].length;n<a;n++)l=h[r],e&&!p(e.style[l[n].name])?e.style[l[n].name]=l[n].value:d&&(d[l[n].name]=this._convertValue(l[n].value,!0));else for(l=n.replace(".",""),e=new kc(l,"Kool__"+this._wrapper.uno,(!1),i),this._csses[l]=e,n=0,a=h[r].length;n<a;n++)l=h[r],e.setStyle(l[n].name,this._convertValue(l[n].value,!0))}},gb.prototype._getClassInfo=function(t){return t=t.nodeName,gb.classMap[t]?gb.classMap[t]:null},gb.prototype._getClassInfoByName=function(t){return gb.classMap[t]?gb.classMap[t]:null},gb.prototype._parseExtraLayout=function(t){var e=this._tryCorrectNewInstance(t);return null==e?(alert(B.getString("koolgridweb","unknownObject",[t.nodeName])),!1):(e instanceof A&&this._root.addChild(e),!0)},gb.prototype._commitSubNodes=function(t,e,i,s){var r={};if(r.name=t,this._getClassInfoByName(t))return e&&0<e.length?this._tryCorrectNewInstance(e[0].parentNode,i):this._tryCorrectNewInstance(s,i),r;var n,o,a,l,h=[];for(n=0,l=e.length;n<l;n++)if(o=e[n],1==o.nodeType){var d=this._tryCorrectNewInstance(o);if(!d){alert(B.getString("koolgridweb","unknownObject",[o.nodeName]));break}if(jc(i,t))this._getClassPropertyType(i,t)==Array?(h.push(d),r.data=h):r.data=d;else{for(a=o=0;a<s.childNodes.length;a++)1==s.childNodes[a].nodeType&&o++;1<o?(h.push(d),r.data=h):r.data=d}}return r},gb.prototype._tryCorrectNewInstance=function(t,e){var i,s,r=t.nodeName,n=this._getClassInfo(t);if(n){if(i=new n,i.className||(i.className=r),n._chgDefaultValue)for(s in n._chgDefaultValue)i[s]=n._chgDefaultValue[s];e&&i instanceof A&&(e.addChild(i),e.move(0,0)),s=n._defaultProperty;var o,a;if(a=G.getFirstElementChild(t),0<t.childNodes.length&&a&&!jc(i,a.nodeName)&&s&&jc(i,s))o=this._commitSubNodes(s,t.childNodes,i,t),this._setPropsStylesByNode(o,i);else if(t.childNodes&&0<t.childNodes.length)for(s=0,a=t.childNodes.length;s<a;s++)o=t.childNodes[s],1==o.nodeType&&(o=this._commitSubNodes(o.nodeName,o.childNodes,i,o),this._setPropsStylesByNode(o,i));if(r.indexOf("DataGrid")==r.length-8)return this._grid=i,this._grid.setSortExpertMode(!0),this._grid.sortableColumns=!1,this._grid.draggableColumns=!1,this._grid.autoHeight=!1,this._grid.minHeightRowCount=NaN,this._grid.maxHeightRowCount=NaN,this._grid.getDataProvider()||this._grid._rootModel?this._grid.getDataProvider()&&(this._grid.getDataProvider()instanceof na?(this._grid.getDataProvider().setSource([]),this._collection=this._grid.getDataProvider()):this._grid.getDataProvider()instanceof xa&&(this._grid.getDataProvider().setSource(),this._collection=this._grid.getDataProvider())):("xml"==this.dataType?this._grid.setDataProvider(new Hb):this._grid.setDataProvider(new P),this._collection=this._grid.getDataProvider()),this._setPropsStyles(t,i,n.classPath),this._firstEditableField=-1,this._grid.addEventListener(K.ITEM_EDIT_BEGINNING,this._wrapper._itemEditBeginningHandler,this._wrapper,!1,1),this._grid.addEventListener(K.ITEM_EDIT_END,this._wrapper._itemEditEndHandler,this._wrapper,!1,1),this._grid.addEventListener(K.ITEM_FOCUS_IN,this._wrapper._itemFocusInHandler,this._wrapper,!1,1),this._grid.addEventListener(K.PASTE_EDIT_END,this._wrapper._pasteEditEndHandler,this._wrapper,!1,1),this._grid.addEventListener(K.ITEM_VALUE_CHANGE,this._wrapper._itemValueChangeHandler,this._wrapper),this._grid.addEventListener(L.ITEM_ROLL_OVER,this._wrapper._itemRollOverHandler,this._wrapper),this._grid.addEventListener("creationComplete",this._wrapper._gridCreationCompleteHandler,this._wrapper),this._grid.addEvent("keydown",this._wrapper._gridKeyDownHandler,this._wrapper),this._grid;"DataGridRendererProvider"!=r&&("OLAPCube"==r?(this._wrapper._olapCube=i,this._wrapper._olapCube.addEventListener("complete",this._wrapper._olapCubeCompleteHandler,this._wrapper,!1,1)):"HttpServiceRepeater"==r||"HttpMultiServiceRepeater"==r?this._wrapper._httpService=i:"DataGridGroupingPanel"==r&&(this._groupingPanel=i,this._groupingPanel.setPercentWidth(100),this._groupingPanel.setHeight(40))),this._setPropsStyles(t,i,n)}return i},gb.prototype._setPropsStyles=function(t,e,i){var s,r,n,o,a;for(o=0,a=t.attributes.length;o<a;o++)if(s=t.attributes[o].name,r=t.attributes[o].value,"id"==s)this._addIds(Mc.trim(r),e),e.hasOwnProperty(s)&&Ja(e,s,r);else if("styleName"==s&&e instanceof u)e.setStyleName(this._csses[r]?this._csses[r]:r);else if(jc(e,s))try{bb(bd(e,s))?("true"!=r&&"false"!=r&&alert(B.getString("koolgridweb","errorSetBoolean",[s])),Ja(e,s,"true"==r)):"width"==s&&-1!=r.indexOf("%")?e.setPercentWidth(Number(r.replace("%",""))):"height"==s&&-1!=r.indexOf("%")?e.setPercentHeight(Number(r.replace("%",""))):F(bd(e,s))?Ja(e,s,r):Xa(bd(e,s))?Ja(e,s,Number(r)):dc(bd(e,s))?Ja(e,s,new Date(Date.parse(r))):this._setExtraProperty(s,r,t.attributes[o],t,e,i)}catch(h){Ja(e,s,Xa(r)?r:parseFloat(r))}else if("labelJsFunction"==s&&e instanceof xe)Ja(e,"labelFunction",ua.findFunction(r));else if("labelJsFunction"==s&&e instanceof wb)Ja(e,"labelFunction",ua.findFunction(r));else if("labelJsFunction"==s&&jc(e,"labelFunction"))Ja(e,"labelFunction",ua.findFunction(r));else if("secondLabelJsFunction"==s&&jc(e,"secondLabelFunction"))Ja(e,"secondLabelFunction",ua.findFunction(r));else if("headerLabelJsFunction"==s&&jc(e,"headerLabelFunction"))Ja(e,"headerLabelFunction",ua.findFunction(r));else if("styleJsFunction"==s&&jc(e,"styleFunction"))Ja(e,"styleFunction",ua.findFunction(r));else if("itemEditBeginningJsFunction"==s&&e instanceof l)this._wrapper._itemEditBeginningJsFunc=r;else if("itemEditEndJsFunction"==s&&e instanceof l)this._wrapper._itemEditEndJsFunc=r;else if("pasteEditEndJsFunction"==s&&e instanceof l)this._wrapper._pasteEditEndJsFunc=r;else if("itemFocusInJsFunction"==s&&e instanceof l)this._wrapper._itemFocusInJsFunc=r;else if("dataTipJsFunction"==s&&jc(e,"dataTipFunction"))Ja(e,"dataTipFunction",ua.findFunction(r));else if("filterJsFunction"==s&&jc(e,"filterFunction"))Ja(e,"filterFunction",ua.findFunction(r));else if("pasteParseJsFunction"==s&&e instanceof l)Ja(e,"pasteParseFunction",ua.findFunction(r));else if("copyValueJsFunction"==s&&e instanceof l)Ja(e,"copyValueFunction",ua.findFunction(r));else if("scrollTipJsFunction"==s&&e instanceof l)Ja(e,"scrollTipFunction",ua.findFunction(r));else if("dataJsFunction"==s&&e instanceof ob)Ja(e,"dataFunction",ua.findFunction(r));else if("icon"==s&&e instanceof C)e.setStyle(s,r);else if(Xb&&0==s.indexOf("aria-"))e.setAttr(s,r);else if(("disclosureClosedIcon"==s||"disclosureOpenIcon"==s||"folderClosedIcon"==s||"folderOpenIcon"==s||"defaultLeafIcon"==s)&&e instanceof l)-1!=r.indexOf("{")&&-1!=r.indexOf("}")?(r=this._removeBrace(r),"null"==r&&e.setStyle(s,null)):e.setStyle(s,r);else{var d;U(e.getStyle)&&(d=e.getStyle(s)),!I(d)&&Xa(d)?e.setStyle(s,Xa(r)?r:parseFloat(r)):!I(d)&&bb(d)?e.setStyle(s,0!=r&&"false"!=r):U(e.setStyle)?-1!=r.indexOf("{")&&-1!=r.indexOf("}")?(r=this._removeBrace(r),"null"==r?e.setStyle(s,null):F(r)?(n=this._getComponentById(r))?e.setStyle(s,n):alert(B.getString("koolgridweb","unknownVariable",[r])):Ea(r)&&e.setStyle(s,r)):-1!=r.indexOf("[")&&-1!=r.indexOf("]")?(r=r.replace("[",""),r=r.replace("]",""),r=r.split(","),e.setStyle(s,r)):this._setCorrectStyle(i,e,s,r):alert(B.getString("koolgridweb","unknownProperty",[s]))}},gb.prototype._setCorrectStyle=function(t,e,i,s){if(0<i.indexOf("StyleName")&&this._csses[s])e.setStyle(i,this._csses[s]);else{p(s)||!Tb.mustHavePxStyles[i]||isNaN(Number(s))||(s+="px");try{var n=Mc.removeHyphen(r.getCssPrefix()+i),o=this._convertValue(s,!1);e.element&&p(e.element.style[i])&&!p(e.element.style[n])||e._rules&&p(e._rules.style[i])&&!p(e._rules.style[n])?e.setStyle(n,o):e.setStyle(i,o)}catch(a){}}},gb.prototype._convertValue=function(t,e){var i=Number(t);return t?"true"==t||"false"==t?"true"==t:isNaN(i)?e&&F(t)&&0<=t.indexOf(",")?t.split(","):t:i:t},gb.prototype._setExtraProperty=function(t,e,i,s,r,n){var o;try{if(bd(r,t)instanceof se||"itemRenderer"==t||"headerRenderer"==t||"renderer"==t||"itemEditor"==t){var a=this._getClassInfoByName(e);a&&Ja(r,t,new kb(a))}else if("trueValue"===t||"falseValue"===t)Ja(r,t,e);else if("true"==e||"false"==e)Ja(r,t,"true"==e);else if("filterFunction"==t&&r instanceof C)Ja(r,"filterFunction",ua.findFunction(e));else if("sortCompareFunction"==t&&r instanceof C)if("numericSort"==e){var l=r.getDataField();l||(l=s.getAttribute("dataField")),Ja(r,"sortCompareFunction",this._wrapper._numericSort(l))}else if(0<=e.indexOf("GroupingSort")){var h="first";i=!1,0<=e.indexOf("last")&&(h="last"),0<=e.indexOf("Numeric")&&(i=!0),Ja(r,"sortCompareFunction",this._wrapper._groupingSortCompareFunction(h,i,r))}else Ja(r,"sortCompareFunction",ua.findFunction(e));else if(-1!=e.indexOf("}")&&-1!=e.indexOf("["))-1!=e.indexOf("'")&&(e=e.replace(/'/g,'"')),-1!=e.indexOf("\\&apos;")&&(e=e.replace(/\\&apos;/g,"'")),(h="object"==typeof JSON?JSON.parse(e):te(e))&&Ja(r,t,h);else if(-1!=e.indexOf("{")&&-1!=e.indexOf("}"))if(o=this._removeBrace(e),"null"==o)Ja(r,t,null);else if(F(o)){var d=this._getComponentById(o,r,t);d&&Ja(r,t,d)}else Ea(o)&&Ja(r,t,o);else if(-1!=e.indexOf("[")&&-1!=e.indexOf("]")){e=e.replace("[",""),e=e.replace("]","");var c=e.split(",");Ja(r,t,c)}else Ja(r,t,e)}catch(_){return alert(B.getString("koolgridweb","errorSetProperty",[t])+_.message),!1}return!0},gb.prototype._getClassPropertyType=function(t,e){t.className||U(t)&&(t.name||t.toString().match(/function ([^\(]+)/));var i=t.constructor._propertyType?t.constructor._propertyType[e]:null;return i?i:null},gb.prototype._addIds=function(t,e){this._wrapper._componentIds[t]=e},gb.prototype._getComponentById=function(t,e,i){return e=1<arguments.length?e:null,i=2<arguments.length?i:null,"$"==t.charAt(0)?(this._wrapper._componentIds[t]={target:e,name:i,id:t},null):this._wrapper._componentIds[t]?this._wrapper._componentIds[t]:(this._wrapper._unmatchedComponentIds.push({target:e,name:i,id:t}),null)},gb.prototype._checkUnMatchedComponentId=function(){var t,e;if(this._wrapper._unmatchedComponentIds&&!(0>=this._wrapper._unmatchedComponentIds.length))for(t=0;t<this._wrapper._unmatchedComponentIds.length;t++)e=this._wrapper._unmatchedComponentIds[t],this._wrapper._componentIds[e.id]?Ja(e.target,e.name,this._wrapper._componentIds[e.id]):alert(B.getString("koolgridweb","unknownVariable",[e.id]))},gb.prototype._removeBrace=function(t){if(!t)return null;var e,i=t.indexOf("{"),s=t.indexOf("}");if((t=Mc.trim(t.substring(i+1,s)))&&0<=t.indexOf(":"))try{e="{"+t.replace(/\'/g,'"')+"}",t="object"==typeof JSON?JSON.parse(e):te(e)}catch(r){alert(B.getString("koolgridweb","errorSetProperty",[e])+r.message)}return t},gb.prototype._setPropsStylesByNode=function(t,e){jc(e,t.name)?Ja(e,t.name,t.data):U(e.setStyle)&&e.setStyle(t.name,t.data)},gb.classMap={KoolGrid:u,DataGrid:l,DataGridColumn:C,DataGridSelectorColumn:Aa,DataGridColumnGroup:fb,DataGridRowStateColumn:kd,DataGridGroupingPanel:oc,CheckBoxHeader:Ab,CheckBoxHeaderSelector:tb,CheckBoxItem:nc,CheckBoxItemSelector:Vb,ComboBoxHeader:vb,ComboBoxItem:Qb,DataProviderItem:be,HtmlEditableItem:dd,HtmlItem:Hd,IconItem:Eb,ImageItem:zc,IndexNoItem:ce,RadioButtonItem:Fc,RadioButtonItemSelector:fc,SpanItem:mb,GroupItem:Jc,TextAreaItem:ud,EditableIconItem:Sd,CheckBoxEditor:Ub,ComboBoxEditor:rd,DateEditor:ne,DynamicComboBoxEditor:sd,ExComboBoxEditor:td,AutocompleteTextInput:lb,MonthEditor:oe,DataGridFooter:Va,DataGridFooterColumn:wb,PagingCollection:$a,SpanArrayCollection:na,SpanCellAttribute:ib,SpanCollection:ea,SpanXMLListCollection:xa,SpanSummaryCollection:va,SpanMergingField:Ie,SpanSummaryField:function(t,e){this.uno=Sa.elementNo++,this.dataField=0<arguments.length?t:null,this.summaryOperation=1<arguments.length?e:"SUM",this.targetDataField=this.cellAttribute=void 0},SpanSummaryRow:xe,SpanSummaryObject:Pd,SpanHierarchicalData:ke,SpanRowAttribute:xc,Grouping:he,GroupingCollection:fa,GroupingField:ie,HierarchicalData:pb,SummaryField:Fe,SummaryRow:je,SpanGroupingCollection:ja,SpanGroupingField:Yd,SpanGroupingSummaryField:Ge,SpanGroupingSummaryRow:He,DataGridSparkColumn:Pa,SparkLine:me,SparkColumn:Be,SparkWinLoss:Ce,DataGridHeaderRenderer:Wa,DataGridItemRenderer:mb,DataGridSortItemRenderer:ec,PivotDataGrid:M,PivotDataGridItemRendererProvider:Me,PivotDataGridHeaderRendererProvider:Le,OLAPCube:La,OLAPDimension:ub,OLAPMeasure:wd,OLAPAttribute:ob,OLAPHierarchy:Qa,OLAPLevel:db,OLAPQuery:Zb,OLAPQueryAxis:gd,OLAPSet:Fb,OLAPResult:gc,OLAPMember:Sb,OLAPAxisPosition:vd,OLAPTuple:$b,AsyncResponder:le,ArrayCollection:P,Box:Ic,Canvas:Ed,CheckBox:Ka,ClassFactory:kb,ComboBox:za,ContextMenu:Dc,ContextMenuItem:function(t,e,i,s){this.caption=0<arguments.length?t:void 0,this.separatorBefore=1<arguments.length&&e,this.enabled=!(2<arguments.length)||i,this.visible=!(3<arguments.length)||s},ExComboBox:Z,NumberFormatter:jd,CurrencyFormatter:ae,DateFormatter:id,Image:Ua,Label:mc,NumberMaskFormatter:Wd,NumericStepper:ya,PercentFormatter:Cd,RadioButton:qb,ProgressBar:Fa,TextArea:Oa,TextInput:Y,Sort:Ac,SortField:sb,XMLListCollection:Hb},KoolGrid={version:"4.0",productName:"KoolGrid",defaultHeight:280,defaultWidth:420,domReadyDelayCall:!0,domReadyInteractive:!1,instances:{},licenseURL:null,setAssetsPath:function(t){Ma=t},create:function(t,e,i,s,r){if(p(s)&&(s="100%"),p(r)&&(r="100%"),p(e))throw"target is undefined for "+this.productName;var n,o,a,l,h,d=[],c={};if(!I(i))if(F(i))for(d=i.split("&"),n=0,o=d.length;n<o;n++)a=d[n],h=a.indexOf("="),l=a.substring(0,h),a=a.substring(h+1,a.length),c[l]=a;else Ea(i)&&(c=i);p(c.licenseURL)||(KoolGrid.licenseURL=decodeURIComponent(c.licenseURL)),p(c.assetsPath)||(Ma=c.assetsPath),bb(c.accessibility)?Xb=c.accessibility:p(c.accessibility)||(Xb="true"==c.accessibility),p(c.localeChain)||B.setLocaleChain(c.localeChain),sa.domReadyDelayCall=KoolGrid.domReadyDelayCall,sa.domReadyInteractive=KoolGrid.domReadyInteractive,sa.domReady(function(){var n=document.getElementById(e);if(!n)throw e+" is undefined for "+this.productName;KoolGrid.instances[t]&&KoolGrid.instances[t].destroy();var o=new D(t,e,i,s,r);return KoolGrid.instances[t]=o,o.setNestLevel(1),n.appendChild(o.element),o.initialize(),o},this,t)},setConfig:function(t){if(t){var e,i,s,r;for(e in t){var n=t[e];if("Styles"===e)for(s in n){var o=m.findCSSSheet(s);if(o){r=n[s];for(var a in r)i=r[a],o.style[a]=i}}else if("ResourceBundle"===e)for(s in n){var l,h=n[s];for(l in h){r=h[l];for(var d in r)i=r[d],B.resources[s]||(B.resources[s]={}),B.resources[s][l]||(B.resources[s][l]={}),B.resources[s][l][d]=i}}else if(h=gb.classMap[e])for(s in n)if("Styles"===s)for(a in r=n[s])i=r[a],p(h._defaultStyles[a])?(o=m.findCSSSheet("Kool__"+e))&&(o.style[a]=i):h._defaultStyles[a]=i;else if("Constants"===s){r=n[s];for(var c in r)i=r[c],p(h[c])||(h[c]=i)}else if("Properties"===s){r=n[s];var _,o=h.toString();for(_ in r)if(i=r[_],p(h[_])){var u="set"+_.substr(0,1).toUpperCase()+_.substr(1);h.prototype[u]||h[u]?(h._chgDefaultValue||(h._chgDefaultValue={}),h._chgDefaultValue["_"+_]=i):0<=o.indexOf("."+_)&&(h._chgDefaultValue||(h._chgDefaultValue={}),h._chgDefaultValue[_]=i)}else h[_]=i}}}},resize:function(){for(var t in KoolGrid.instances)KoolGrid.instances[t].resize(t)}},KoolGrid.resizing=KoolGrid.resize;var xrzhcn="",ReplacementFor_dsmInterval;z(D,u),D.prototype.getCollection=function(){return this._collection},D.prototype.getLastRollOverIndex=function(){return this._lastRollOverIndex},D.prototype.getGridData=function(){return this._gridData},D.prototype.setGridData=function(t){this._gridData=t,this._gridDataChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},D.prototype.getFilterFunction=function(){return this._filterJsFunc},D.prototype.setFilterFunction=function(t){this._filterJsFunc=t,this._collection&&(t?U(t)?U(this._collection.setFilterFunction)?this._collection.setFilterFunction(t):this._collection.filterFunction=t:U(this._collection.setFilterFunction)?this._collection.setFilterFunction(ua.findFunction(t)):this._collection.filterFunction=ua.findFunction(t):U(this._collection.setFilterFunction)?this._collection.setFilterFunction(null):this._collection.filterFunction=null,this._collection.refresh())},D.prototype.getLayoutXML=function(){return this._layout},D.prototype.setLayoutXML=function(t){this._layout=t,this._layoutChanged=!0,this.invalidateProperties(),this.invalidateDisplayList()},D.prototype._createGrid=function(){this._removeGridEventListener(),this._root&&(this._root.resetInvalidate(),Sa.remove(this._root),this.removeChild(this._root),this._grid=this._root=null),this._componentIds={},this._unmatchedComponentIds=[],this._itemFocusInJsFunc=this._pasteEditEndJsFunc=this._itemEditEndJsFunc=this._itemEditBeginningJsFunc=this._filterJsFunc=this._gridDataTipJsFunc=null,this.resetChangedData(),this.removeAllData=!1;var t=this._layout.getElementsByTagName("KoolGrid")[0];0<=t.nodeName.indexOf("#")&&(t=t.firstChild);var e=new gb(this);e.startParsing(t),this._root=e._root,this._grid=e._grid,this._groupingPanel=e._groupingPanel,this.setGridActualSize(this._gridRootWidth,this._gridRootHeight),this.undoable=this._grid.undoable;try{dSM(this._grid._listSubContent.element.id)}catch(i){}this._httpService&&this._httpService.serviceStart()},D.prototype.excelCSVImport=function(t,e){t=0<arguments.length?t:0,this.excelCSVImporter&&(this.excelCSVImporter.removeEventListener(pd.PARSE_COMPLETE,this._excelCSVImporterParseCompleteHandler,this),this.excelCSVImporter.removeEventListener("close",this._excelCSVImporterCloseHandler,this),this.excelCSVImporter._removePopUp(),this.excelCSVImporter=null);var i=new Jb;return this.excelCSVImporter=i,Xa(t)?this._excelCSVImportOption=t:(this._excelCSVImportOption=Xa(t.layoutChangeOption)?t.layoutChangeOption:0,bb(t.UTF8)&&(i.UTF8=t.UTF8),bb(t.UTF8Visible)&&(i.UTF8Visible=t.UTF8Visible),Xa(t.headerRowCount)&&(i.headerRowCount=t.headerRowCount),bb(t.headerRowCountVisible)&&(i.headerRowCountVisible=t.headerRowCountVisible),bb(t.useGroupedColumn)&&(i.useGroupedColumn=t.useGroupedColumn),t.parseFunction&&(i.parseFunction=t.parseFunction),t.defaultCharSet&&(i.defaultCharSet=t.defaultCharSet),bb(t.forceUseServer)&&(i.forceUseServer=t.forceUseServer),bb(t.parsingDate)&&(i.parsingDate=t.parsingDate),t.fileExtentions&&(i.fileExtentions=t.fileExtentions)),i.addEventListener(pd.PARSE_COMPLETE,this._excelCSVImporterParseCompleteHandler,this),i.addEventListener("close",this._excelCSVImporterCloseHandler,this),i.popUp(this._grid,e),i},D.prototype.excelImport=function(t,e){t=0<arguments.length?t:0,this.excelImporter&&(this.excelImporter.removeEventListener(qd.PARSE_COMPLETE,this._excelImporterParseCompleteHandler,this),this.excelImporter.removeEventListener("close",this._excelImporterCloseHandler,this),this.excelImporter._removePopUp(),this.excelImporter=null);var i=new hc;return this.excelImporter=i,this._excelImportOption=Xa(t.layoutChangeOption)?t.layoutChangeOption:0,Xa(t.headerRowCount)&&(i.headerRowCount=t.headerRowCount),bb(t.headerRowCountVisible)&&(i.headerRowCountVisible=t.headerRowCountVisible),bb(t.useGroupedColumn)&&(i.useGroupedColumn=t.useGroupedColumn),
t.parseFunction&&(i.parseFunction=t.parseFunction),bb(t.forceUseServer)&&(i.forceUseServer=t.forceUseServer),bb(t.selectSheet)&&(i.selectSheet=t.selectSheet),t.fileExtentions&&(i.fileExtentions=t.fileExtentions),i.addEventListener(qd.PARSE_COMPLETE,this._excelImporterParseCompleteHandler,this),i.addEventListener("close",this._excelImporterCloseHandler,this),i.popUp(this._grid,e),i},D.prototype.excelExportSave=function(t,e){t=0<arguments.length?t:null,e=1<arguments.length&&e,this._exportExcelSaveUrl=t,this._exportExcelUploadUrl=null,this._exportExcelAsync=e,this._grid instanceof l?(this._grid.addEventListener(J.EXPORT_SAVE_COMPLETE,this._excelExportSaveCompleteHandler,this),this._grid.addEventListener(J.EXPORT_SAVE_ERROR,this._excelExportSaveErrorHandler,this),this._exportExcelAsync?(this._grid.addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this._grid.addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this._grid.exportExcelMake(this._exportExcelAsync)):this._excelExportAlertClickHandler()):alert(B.getString("koolgridweb","notExportObject"))},D.prototype.excelExportUpload=function(t,e){t=0<arguments.length?t:null,e=1<arguments.length&&e,this._exportExcelUploadUrl=t,this._exportExcelSaveUrl=null,this._exportExcelAsync=e,this._grid?(this._grid.addEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelExportUploadCompleteHandler,this),this._grid.addEventListener(J.EXPORT_UPLOAD_ERROR,this._excelExportUploadErrorHandler,this),this._exportExcelAsync?(this._grid.addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this._grid.addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this._grid.exportExcelMake(this._exportExcelAsync)):this._excelExportAlertClickHandler()):alert(B.getString("koolgridweb","notExportObject"))},D.prototype.excelMultiExportSave=function(t,e,i){e=1<arguments.length?e:null,i=2<arguments.length&&i;var s,r=t;if(r)for(s=0;s<r.length;s++)r[s]instanceof D&&(r[s]=r[s].getDataGrid());else r=[];this._exportExcelSaveUrl=e,this._exportExcelUploadUrl=null,this._exportExcelAsync=i,this._grid instanceof l?(this._multExporter=new Oc,this._multExporter.exportGrids=[this._grid].concat(r),this._multExporter.exportFileName=this._grid.exportFileName,this._multExporter.addEventListener(J.EXPORT_SAVE_COMPLETE,this._excelMultiExportSaveCompleteHandler,this),this._multExporter.addEventListener(J.EXPORT_SAVE_ERROR,this._excelMultiExportSaveErrorHandler,this),this._multExporter.addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelMultiExportMakeCompleteHandler,this),this._multExporter.addEventListener(J.EXPORT_MAKE_ERROR,this._excelMultiExportMakeErrorHandler,this),this._multExporter.exportExcelMake(this._exportExcelAsync)):alert(B.getString("koolgridweb","notExportObject"))},D.prototype.excelMultiExportUpload=function(t,e,i){e=1<arguments.length?e:null,i=2<arguments.length&&i;var s,r=t;if(r)for(s=0;s<r.length;s++)r[s]instanceof D&&(r[s]=r[s].getDataGrid());else r=[];this._exportExcelUploadUrl=e,this._exportExcelSaveUrl=null,this._exportExcelAsync=i,this._grid?(this._multExporter=new Oc,this._multExporter.exportGrids=[this._grid].concat(r),this._multExporter.exportFileName=this._grid.exportFileName,this._multExporter.addEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelMultiExportUploadCompleteHandler,this),this._multExporter.addEventListener(J.EXPORT_UPLOAD_ERROR,this._excelMultiExportUploadErrorHandler,this),this._multExporter.addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelMultiExportMakeCompleteHandler,this),this._multExporter.addEventListener(J.EXPORT_MAKE_ERROR,this._excelMultiExportMakeErrorHandler,this),this._multExporter.exportExcelMake(this._exportExcelAsync)):alert(B.getString("koolgridweb","notExportObject"))},D.prototype._getCollectionItemAt=function(e){if(0<=e&&this._collection&&e<this._collection.getLength()){if(this._collection instanceof T){var i=this._collection.createCursor();return i.seek(t.getFIRST(),e),i.getCurrent()}return this._collection.getItemAt(e)}return null},D.prototype._getCollectionItemIndex=function(e){if(!e||!this._collection)return-1;if(this._collection instanceof T){var i=0;e=V.getUID(e);var s=this._collection.createCursor();for(s.seek(t.getFIRST());!s.getAfterLast();){if(V.getUID(s.getCurrent())===e)return i;s.moveNext(),i++}return-1}return this._collection.getItemIndex(e)},D.prototype._getSpanSummaryCollectionSourceIndex=function(t){var e=-1;if(t=this._getCollectionItemAt(t)){var i=this._collection.getSource();i&&(e=i.getItemIndex(t))}return e},D.prototype._cloneData=function(t){if(E(t)){var e=t.cloneNode(!0),i=V.getUID(t);return t.hasOwnProperty?e.uid=i:e.setAttribute("rm_internal_uid",i),e}return m.clone(t,!0)},D.prototype._setChangedDataAdd=function(t,e,i,s,r){var n=V.getUID(t);e={idx:e,job:"I",uid:n,cflag:this._grid._getChangedDataFlag(t),data:t,srcIdx:i,parent:s,makeBranch:r,hsp:this._grid.getHorizontalScrollPosition()},this._undoStack.splice(this._undoStackPointer+1,this._undoStack.length),this._undoStack.push(e),this._undoStackPointer=this._undoStack.length-1,this._grid.addChangedData(t,"I")},D.prototype._setChangedDataUpdate=function(t,e,i){var s=V.getUID(t);e={idx:i,job:"U",uid:s,ouid:V.getUID(e),cflag:this._grid._getChangedDataFlag(e),data:t,oldData:e,hsp:this._grid.getHorizontalScrollPosition()},this._undoStack.splice(this._undoStackPointer+1,this._undoStack.length),this._undoStack.push(e),this._undoStackPointer=this._undoStack.length-1,this._grid.addChangedData(t,"U")},D.prototype._setChangedDataUpdateField=function(t,e,i,s,r,n,o){var a=n,l=V.getUID(r);if(I(a))for(n=0;n<this._grid.getColumns().length;n++)if(this._grid.getColumns()[n].getDataField()==s){a=n;break}t={idx:i,job:"UF",uid:l,cflag:this._grid._getChangedDataFlag(r),data:r,fieldName:s,newValue:t,oldValue:e,hsp:I(a)?this._grid.getHorizontalScrollPosition():a,callF:o},this._undoStack.splice(this._undoStackPointer+1,this._undoStack.length),this._undoStack.push(t),this._undoStackPointer=this._undoStack.length-1,this._grid&&this._grid.addChangedData(r,"U")},D.prototype._setChangedDataRemove=function(t,e,i,s,r){var n,o,a=V.getUID(t);for(n=0;n<=this._undoStackPointer;n++)if(this._undoStack[n].uid==a){o=this._undoStack[n];break}return e={idx:e,job:"D",uid:a,cflag:this._grid._getChangedDataFlag(t),data:t,srcIdx:i,parent:s,children:r,hsp:this._grid.getHorizontalScrollPosition()},this._undoStack.splice(this._undoStackPointer+1,this._undoStack.length),this._undoStack.push(e),this._undoStackPointer=this._undoStack.length-1,this._grid&&this._grid.addChangedData(t,"D"),o},D.prototype.undo=function(){if(this.undoable&&this._grid&&this._collection&&!(0==this._undoStack.length||0>this._undoStackPointer)){for(var t=!0,e=!1,i=!1,s=-1,r=-1;t&&0<=this._undoStackPointer;){var n=this._undoStack[this._undoStackPointer];if(!n){this._undoStackPointer--;break}switch(s=n.idx,r=n.hsp,n.job){case"I":n.data&&0<=n.idx&&(s=V.getUID(this._getCollectionItemAt(n.idx))==n.uid?n.idx:this._getCollectionItemIndex(n.data),this._collection instanceof T?(this._collection.removeChild(n.parent,n.data),n.parent&&n.makeBranch&&(E(n.parent)?G.setAttribute(n.parent,"isBranch","false"):delete n.parent[this._collection.getSource().childrenField])):0<=s&&(this._collection instanceof va?this._collection.getSource().removeItemAt(this._collection.getSource().getItemIndex(n.data)):this._collection.removeItemAt(s)),this._grid.removeChangedData(n.data)),e=!0,t=!1;break;case"U":n.data&&0<=n.idx&&(V.getUID(this._getCollectionItemAt(n.idx))==n.uid?this._collection.setItemAt(n.oldData,n.idx):(s=this._getCollectionItemIndex(n.data),0<=s&&this._collection.setItemAt(n.oldData,s)),n.cflag?this._grid.addChangedData(n.data,n.cflag):this._grid.removeChangedData(n.data),this._collection instanceof T&&(this._grid._isBranch(n.oldData)?this._grid.isItemOpen(n.oldData)||(r=-1):this._grid.isItemOpen(this.getParentItem(n.oldData))||(r=-1))),e=!0,t=!1;break;case"UF":if(n.data&&0<=n.idx&&(E(n.data)?G.setProperty(n.data,n.fieldName,n.oldValue):n.data[n.fieldName]=n.oldValue,n.cflag?this._grid.addChangedData(n.data,n.cflag):this._grid.removeChangedData(n.data),this._collection instanceof va&&this._collection.refresh(),this._grid.invalidateList(),this._collection instanceof T&&(this._grid._isBranch(n.data)?this._grid.isItemOpen(n.data)||(r=-1):this._grid.isItemOpen(this.getParentItem(n.data))||(r=-1))),"IVCEVT"==n.callF&&0<this._undoStackPointer&&"IVCEVT"==this._undoStack[this._undoStackPointer-1].callF)break;e=!0,t=!1;break;case"D":if(n.data&&0<=n.idx){if(this._grid&&this._grid.getShowDeletedRows()){if(n.children)for(t=0;t<n.children.length;t++)"D"==this._grid._getChangedDataFlag(n.children[t])&&this._grid.removeChangedData(n.children[t]);this._grid.invalidateList()}else i=!0,this._collection instanceof T?(this._collection.addChildAt(n.parent,n.data,n.srcIdx),s=V.getUID(this._getCollectionItemAt(n.idx))==n.uid?n.idx:this._getCollectionItemIndex(n.data)):this._collection instanceof va?this._collection.getSource().addItemAt(n.data,n.srcIdx):this._collection.addItemAt(n.data,n.idx);this._grid.removeChangedData(n.data),n.cflag&&this._grid.addChangedData(n.data,n.cflag)}e=!0,t=!1;break;case"UR":n.data&&(n.cflag?this._grid.addChangedData(n.data,n.cflag):this._grid.removeChangedData(n.data))}this._undoStackPointer--}return e&&n&&(t=new Hc(Hc.UNDO_REDO_DATA_CHANGED),t.columnIndex=n.hsp,t.dataField=n.fieldName,t.item=n,t.newValue=n.oldValue,t.reason="undo "+n.job,t.rowIndex=n.idx,t.value=n.newValue,this.dispatchEvent(t)),0<=s&&0<=r&&(i?this._grid.callLater(this._grid._adjustItemPosition,[{rowIndex:s,columnIndex:r}]):this._grid._adjustItemPosition({rowIndex:s,columnIndex:r})),n}},D.prototype.redo=function(){if(this.undoable&&this._grid&&this._collection&&!(this._undoStackPointer>=this._undoStack.length-1)){for(var t=!0,e=!1,i=!1,s=-1,r=-1;t&&this._undoStackPointer<this._undoStack.length-1;){this._undoStackPointer++;var n=this._undoStack[this._undoStackPointer];if(!n)break;switch(s=n.idx,r=n.hsp,n.job){case"I":n.data&&0<=n.idx&&(i=!0,this._collection instanceof T?(n.parent&&n.makeBranch&&(E(n.parent)?G.setAttribute(n.parent,"isBranch","true"):n.parent[this._collection.getSource().childrenField]=[]),this._collection.addChildAt(n.parent,n.data,n.srcIdx),s=V.getUID(this._getCollectionItemAt(n.idx))==n.uid?n.idx:this._getCollectionItemIndex(n.data)):this._collection instanceof va?this._collection.getSource().addItemAt(n.data,n.srcIdx):this._collection.addItemAt(n.data,s),this._grid.addChangedData(n.data,"I")),e=!0,t=!1;break;case"U":n.data&&0<=n.idx&&(V.getUID(this._getCollectionItemAt(n.idx))==n.ouid?this._collection.setItemAt(n.data,n.idx):(s=this._getCollectionItemIndex(n.oldData),0<=s&&this._collection.setItemAt(n.data,s)),this._grid.addChangedData(n.data,"U"),this._collection instanceof T&&(this._grid._isBranch(n.data)?this._grid.isItemOpen(n.data)||(r=-1):this._grid.isItemOpen(this.getParentItem(n.data))||(r=-1))),e=!0,t=!1;break;case"UF":if(n.data&&0<=n.idx&&(E(n.data)?G.setProperty(n.data,n.fieldName,n.newValue):n.data[n.fieldName]=n.newValue,this._grid.addChangedData(n.data,"U"),this._collection instanceof va&&this._collection.refresh(),this._grid.invalidateList(),this._collection instanceof T&&(this._grid._isBranch(n.data)?this._grid.isItemOpen(n.data)||(r=-1):this._grid.isItemOpen(this.getParentItem(n.data))||(r=-1))),"IVCEVT"==n.callF){if(this._undoStackPointer<this._undoStack.length-1&&"IVCEVT"==this._undoStack[this._undoStackPointer+1].callF)break;s=0}e=!0,t=!1;break;case"D":if(n.data&&0<=n.idx){if(this._grid&&this._grid.getShowDeletedRows()){if(n.children)for(t=0;t<n.children.length;t++)this._grid.addChangedData(n.children[t],"D")}else this._collection instanceof T&&this._collection.removeChild(n.parent,n.data),s=V.getUID(this._getCollectionItemAt(n.idx))==n.uid?n.idx:this._getCollectionItemIndex(n.data),0<=s&&(this._collection instanceof va?this._collection.getSource().removeItemAt(this._collection.getSource().getItemIndex(n.data)):this._collection instanceof T||this._collection.removeItemAt(s));this._grid.addChangedData(n.data,"D")}e=!0,t=!1;break;case"UR":n.data&&this._grid.removeChangedData(n.data)}}return e&&n&&(t=new Hc(Hc.UNDO_REDO_DATA_CHANGED),t.columnIndex=n.hsp,t.dataField=n.fieldName,t.item=n,t.newValue=n.newValue,t.reason="redo "+n.job,t.rowIndex=n.idx,t.value=n.oldValue,this.dispatchEvent(t)),0<=s&&0<=r&&(i?this._grid.callLater(this._grid._adjustItemPosition,[{rowIndex:s,columnIndex:r}]):this._grid._adjustItemPosition({rowIndex:s,columnIndex:r})),n}},D.prototype.getLength=function(){return this._collection?this._collection.getLength():0},D.prototype.getItemAt=function(t){return this._collection?this._getCollectionItemAt(t):null},D.prototype.getItemFieldAt=function(t,e){if(!this._collection)return null;var i=this._getCollectionItemAt(t);return i?E(i)?G.getProperty(i,e):i[e]:null},D.prototype.addItemAt=function(t,e,i,s){if(e=1<arguments.length?e:-1,i=!(2<arguments.length)||i,s=3<arguments.length?s:-1,!(this._collection&&this._collection instanceof la))return-1;if(i&&!this.enableSortModeEditing){if(this._collection.getSort())return alert(B.getString("koolgridweb","errorSortModeAddItem")),-1;if(null!=this._collection.filterFunction)return alert(B.getString("koolgridweb","errorFilterModeAddItem")),-1}try{var r,n,o=e;if(this._collection instanceof va){var a=this._collection.getSource();if(!a)return-1;if(r=t,!r)return-1;if(0<=e){var l=0;for(n=0;n<e;n++)this._collection.getItemAt(n)instanceof ic&&l++;a.addItemAt(r,e-l),this._setChangedDataAdd(a.getItemAt(e-l),e,e-l),o=this._collection.getItemIndex(r)}else{for(l=0,n=this._collection.getLength()-1;0<=n&&this._collection.getItemAt(n)instanceof ic;n--)l++;o=this._collection.getLength()-l,a.addItem(r),this._setChangedDataAdd(a.getItemAt(a.getLength()-1),o,a.getLength()-1)}}else r=t,0<=e?this._collection.addItemAt(r,e):(this._collection.addItem(r),o=e=this._collection.getLength()-1),this._setChangedDataAdd(this._collection.getItemAt(e),e);if(this._collection.enableAutoUpdate(),(this._collection.getSort()||null!=this._collection.filterFunction)&&(this._collection.refresh(),o=this._collection.getItemIndex(r)),i&&this._grid.getEditable().length)if(0<=s)this._grid.setEditedItemPosition({columnIndex:s,rowIndex:o});else{if(0>this._firstEditableField){for(n=0;n<this._grid.getColumns().length;n++)if(this._grid.getColumns()[n].getVisible()&&this._grid.getColumns()[n].editable&&(r=!0,p(this._itemEditBeginningJsFunc)||(r=ua.findFunction(this._itemEditBeginningJsFunc)(e,n,t,this._grid.getColumns()[n].getDataField())),r)){this._firstEditableField=n;break}this._firstEditableField==this._grid.getColumns().length&&(this._firstEditableField=-1)}0<=this._firstEditableField&&(this._collection.getSort()||null!=this._collection.filterFunction?0<=o&&this._grid.setEditedItemPosition({columnIndex:this._firstEditableField,rowIndex:o}):this._grid.setEditedItemPosition({columnIndex:this._firstEditableField,rowIndex:o}))}}catch(h){alert(B.getString("koolgridweb","errorUpdateData")+" "+h.message)}return o},D.prototype.setItemAt=function(t,e,i,s){if(i=2<arguments.length&&i,s=3<arguments.length?s:-1,this._collection&&!(this._collection instanceof gc))try{var r,n,o,a=t;if(a&&(this._collection instanceof va?(r=this._getSpanSummaryCollectionSourceIndex(e),0<=r?(n=this._getCollectionItemAt(r),this._collection.getSource().setItemAt(a,r),a=this._collection.getSource().getItemAt(r)):(n=this._getCollectionItemAt(e),this._collection.setItemAt(a,e),a=this._collection.getItemAt(e))):(n=this._getCollectionItemAt(e),this._collection.setItemAt(a,e),a=this._collection.getItemAt(e)),this._setChangedDataUpdate(a,n,e),this._collection.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"replace",e)),this._collection.enableAutoUpdate(),i&&this._grid.getEditable().length))if(0<=s)this._grid.setEditedItemPosition({columnIndex:s,rowIndex:e});else{if(0>this._firstEditableField){for(o=0;o<this._grid.getColumns().length;o++)if(this._grid.getColumns()[o].getVisible()&&this._grid.getColumns()[o].editable){this._firstEditableField=o;break}this._firstEditableField==this._grid.getColumns().length&&(this._firstEditableField=-1)}0<=this._firstEditableField&&this._grid.setEditedItemPosition({columnIndex:this._firstEditableField,rowIndex:e})}}catch(l){alert(B.getString("koolgridweb","errorUpdateData")+" "+l.message)}},D.prototype.setItemFieldAt=function(t,e,i){if(this._collection&&!(this._collection instanceof gc))try{var s,r=this._getCollectionItemAt(e);E(r)?(s=G.getProperty(r,i),G.setProperty(r,i,t)):(s=r[i],r[i]=t),this._setChangedDataUpdateField(t,s,e,i,r),this._collection instanceof va&&this._collection.refresh(),this._collection.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"replace",e)),this._collection.enableAutoUpdate()}catch(n){alert(B.getString("koolgridweb","errorUpdateData")+" "+n.message)}},D.prototype.removeItemAt=function(t){if(t=0<arguments.length?t:-1,!(this._collection&&this._collection instanceof la))return-1;try{var e,i=t,s=!!this._grid&&this._grid.getShowDeletedRows();if(!(0<=t)){if(!(0<=this._grid.getSelectedIndex()&&this._grid.getSelectedIndex()<this._collection.getLength()))return alert(B.getString("koolgridweb","selectDeleteRow")),-1;i=this._grid.getSelectedIndex()}if(this._collection instanceof va){var r=this._getSpanSummaryCollectionSourceIndex(i);if(!(0<=r))return-1;e=this._setChangedDataRemove(this._getCollectionItemAt(i),i,r),s?e&&"I"===e.job&&(this._grid.removeChangedData(e.data),this._collection.removeItemAt(i)):this._collection.getSource().removeItemAt(r)}else e=this._setChangedDataRemove(this._getCollectionItemAt(i),i),s?e&&"I"===e.job&&(this._grid.removeChangedData(e.data),this._collection.removeItemAt(i)):this._collection.removeItemAt(i);s?this._grid&&this._grid.invalidateList():(this._collection.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"remove",i)),this._collection.enableAutoUpdate())}catch(n){alert(B.getString("koolgridweb","errorDeleteData")+" "+n.message)}return i},D.prototype.removeAll=function(){try{if(this._collection)if(this._collection instanceof T){var t=this._collection.getSource().getSource();t&&(t instanceof la?t.removeAll():this.getCollection().getSource().setSource(null))}else this._collection instanceof va?this._collection.getSource()&&this._collection.getSource().removeAll():this._collection.removeAll();this._undoStack=[],this._undoStackPointer=-1,this.removeAllData=!0}catch(e){alert(B.getString("koolgridweb","errorDeleteData")+" "+e.message)}},D.prototype.addChildItemAt=function(t,e,i,s,r){if(i=1<arguments.length?i:-1,s=!(2<arguments.length)||s,r=3<arguments.length?r:-1,!(this._collection&&this._collection instanceof T))return-1;if(s&&!this.enableSortModeEditing){if(this._collection.getSort())return alert(B.getString("koolgridweb","errorSortModeAddItem")),-1;if(null!=this._collection.filterFunction)return alert(B.getString("koolgridweb","errorFilterModeAddItem")),-1}try{var n,o,a=!1,l=i,h=e,d=this._getCollectionItemAt(l);if(t&&!this._grid._isBranch(t)&&(E(t)?G.setAttribute(t,"isBranch","true"):t[this._collection.getSource().childrenField]=[],a=!0),0<=i)if(o=this._collection.getChildren(t),d==t)this._collection.addChild(t,h),l=o.getLength()-1,E(d)&&(h=o.getItemAt(l)),this._setChangedDataAdd(h,i,l,t,a);else{if(!o){if(o=this._collection.getSource().getRoot(),E(o)){for(n=0;n<this._collection._treeData.getLength();n++)if(this._collection._treeData.getItemAt(n)==d){l=n;break}}else l=Ra.indexOf(o,d);return this._collection.addChildAt(t,h,l),E(d)&&(h=this._collection._treeData.getItemAt(l)),this._setChangedDataAdd(h,i,l,t,a),-1}l=o.getItemIndex(d),this._collection.addChildAt(t,h,l),E(d)&&(h=o.getItemAt(l)),this._setChangedDataAdd(h,i,l,t,a)}else this._collection.addChild(t,h),l=i=this._collection.getLength()-1,E(d)&&(h=this._getCollectionItemAt(l)),this._setChangedDataAdd(h,i,l,t,a);if(this._collection.enableAutoUpdate(),(this._collection.getSort()||null!=this._collection.filterFunction)&&(this._collection.refresh(),l=this._getCollectionItemAt(h)),s&&this._grid.getEditable().length)if(0<=r)this._grid.setEditedItemPosition({columnIndex:r,rowIndex:l});else{if(0>this._firstEditableField){for(n=0;n<this._grid.getColumns().length;n++)if(this._grid.getColumns()[n].getVisible()&&this._grid.getColumns()[n].editable&&(o=!0,p(this._itemEditBeginningJsFunc)||(o=ua.findFunction(this._itemEditBeginningJsFunc)(i,n,e,this._grid.getColumns()[n].getDataField())),o)){this._firstEditableField=n;break}this._firstEditableField==this._grid.getColumns().length&&(this._firstEditableField=-1)}0<=this._firstEditableField&&(this._collection.getSort()||null!=this._collection.filterFunction?0<=l&&this._grid.setEditedItemPosition({columnIndex:this._firstEditableField,rowIndex:l}):this._grid.setEditedItemPosition({columnIndex:this._firstEditableField,rowIndex:l}))}}catch(c){alert(B.getString("koolgridweb","errorUpdateData")+" "+c.message)}return l},D.prototype.removeChildItemAt=function(t){if(t=0<arguments.length?t:-1,!(this._collection&&this._collection instanceof T))return-1;try{var e,i=t,s=!!this._grid&&this._grid.getShowDeletedRows();if(!(0<=t)){if(!(0<=this._grid.getSelectedIndex()&&this._grid.getSelectedIndex()<this._collection.getLength()))return alert(B.getString("koolgridweb","selectDeleteRow")),-1;i=this._grid.getSelectedIndex()}var r,n,o,a=this._getCollectionItemAt(i);if(a){if(r=this._collection.getParentItem(a))n=this._collection.getChildren(r),i=n.getItemIndex(a);else if(n=this._collection.getSource().getRoot(),E(n)){for(o=0;o<this._collection._treeData.getLength();o++)if(this._collection._treeData.getItemAt(o)==a){i=o;break}}else i=Ra.indexOf(n,a);if(n=this.getAllChildren(a),e=this._setChangedDataRemove(a,t,i,r,n),s){if(e&&"I"===e.job)this._grid.removeChangedData(e.data),this._collection.removeChild(r,a);else if(n)for(o=0;o<n.length;o++)"I"===this._grid._getChangedDataFlag(n[o])?(this._grid.removeChangedData(n[o]),this._collection.removeChild(this._collection.getParentItem(n[o]),n[o])):this._grid.addChangedData(n[o],"D")}else this._collection.removeChild(r,a);s?this._grid&&this._grid.invalidateList():(this._collection.dispatchEvent(new y(y.COLLECTION_CHANGE,(!1),(!1),"remove",i)),this._collection.enableAutoUpdate())}}catch(l){alert(B.getString("koolgridweb","errorDeleteData")+" "+l.message)}return i},D.prototype.getParentItem=function(t){return null==t?null:this._collection&&this._collection instanceof T?this._collection.getParentItem(t):null},D.prototype.getParentItemAt=function(t){return null==t||0>t?null:this._collection&&this._collection instanceof T?this._collection.getParentItem(this._getCollectionItemAt(t)):null},D.prototype.getAllChildren=function(t,e){var i,s,r;if(!(this._collection&&this._collection instanceof T))return null;if(e||(e=[]),null==t)return e;if(i=this._collection.getChildren(t))for(r=0;r<i.getLength();r++)s=i.getItemAt(r),e.push(s),this._collection.getSource().hasChildren(s)&&(e=this.getAllChildren(s,e));return e},D.prototype.getChangedData=function(t,e){var i,s,r,n,o,a,l,h=[];try{if(this._allDataImported)for(s=i=0,r=this._collection.getLength();i<r;i++)l=this._getCollectionItemAt(i),l instanceof ic||h.push({idx:s++,job:"I",data:l});else{var d=this._makeChangedData();for(r=d.getLength(),i=0;i<r;i++)a=d.getItemAt(i),"D"==a.job&&(l={idx:a.idx,job:a.job},a.data&&E(a.data)?(l.data=this._toXMLString(a.data),a.parent&&(l.parent=this._toXMLString(a.parent))):(l.data=a.data,a.parent&&(l.parent=a.parent)),h.push(l));for(i=0;i<r;i++)a=d.getItemAt(i),"D"!=a.job&&(l={idx:a.idx,job:a.job},a.data&&E(a.data)?(l.data=this._toXMLString(a.data),a.parent&&(l.parent=this._toXMLString(a.parent))):(l.data=a.data,a.parent&&(l.parent=a.parent)),h.push(l));if(t)for(s=0,n=this._collection.getLength();s<n;s++){for(o=!1,l=this._getCollectionItemAt(s),i=0;i<r;i++)if(d.getItemAt(i).data===l){o=!0;break}o||h.push({idx:s,job:"N",data:l})}}}catch(c){alert(B.getString("koolgridweb","errorConvertData")+" "+c.message)}return e?this.clone(h):h},D.prototype._objectToXMLString=function(t){var e,i="";if(ha(t))for(e=0;e<t.length;e++)i+=this._objectToXMLString(t[e]);else for(e in t)t.hasOwnProperty(e)&&"rm_internal_uid"!=e&&(p(t[e])?i+="<"+e+"/>":(i+="<"+e+">",i=Ea(t[e])?i+this._objectToXMLString(Object(t[e])):i+G.escapeXML(t[e].toString()),i+="</"+e+">\n"));return i},D.prototype._toXMLString=function(t){return window.XMLSerializer?(new window.XMLSerializer).serializeToString(t):t.xml},D.prototype._makeChangedData=function(){var t,e,i,s,r,n,o=new P;for(t=0;t<=this._undoStackPointer;t++)if(s=this._undoStack[t])switch(s.job){case"I":case"UAI":for(e=0,i=o.getLength();e<i;e++)r=o.getItemAt(e),r.idx>=s.idx&&"D"!=r.job&&r.idx++;e={idx:s.idx,job:"I",data:s.data},s.parent&&(e.parent=s.parent),o.addItem(e);break;case"U":case"UAU":for(e=0,i=o.getLength();e<i&&(r=o.getItemAt(e),V.getUID(r.data)!=s.uid||"D"==r.job);e++);e<o.getLength()?(o.getItemAt(e).data=s.data,s.parent&&(o.getItemAt(e).parent=s.parent)):(e={idx:s.idx,job:"U",data:s.data},s.parent&&(e.parent=s.parent),o.addItem(e));break;case"UF":for(e=0,i=o.getLength();e<i&&(r=o.getItemAt(e),V.getUID(r.data)!=s.uid||"D"==r.job);e++);e>=i&&(e={idx:s.idx,job:"U",data:s.data},s.parent&&(e.parent=s.parent),o.addItem(e));break;case"D":case"UAD":for(n=!0,e=0;e<o.getLength();e++)r=o.getItemAt(e),V.getUID(r.data)==s.uid?"I"==r.job?(o.removeItemAt(e--),n=!1):"U"==r.job&&o.removeItemAt(e--):r.idx>=s.idx&&"D"!=r.job&&r.idx--;if(s.children)for(e=0;e<o.getLength();e++)for(r=o.getItemAt(e),i=0;i<s.children.length;i++)if(V.getUID(r.data)==V.getUID(s.children[i])){o.removeItemAt(e--);break}n&&(e={idx:s.idx,job:"D",data:s.data},s.parent&&(e.parent=s.parent),o.addItem(e));break;case"UR":for(e=0;e<o.getLength();e++)V.getUID(o.getItemAt(e).data)===s.uid&&o.removeItemAt(e--)}return o},D.prototype.getChangedDataXML=function(t){var e,i,s,r,n,o,a,l;try{if(this._allDataImported)for(i=e=0,s=this._collection.getLength();e<s;e++)a=this._getCollectionItemAt(e),a instanceof ic||(l=l?l+"\n":"",l+="<idx>"+i+"</idx>\n",l+="<job>I</job>\n",l+="<data>"+this._objectToXMLString(a)+"</data>",i++);else{var h=this._makeChangedData();for(s=h.getLength(),e=0;e<s;e++)o=h.getItemAt(e),"D"==o.job&&(l=l?l+"\n":"",l+="<idx>"+o.idx+"</idx>\n",l+="<job>"+o.job+"</job>\n",l=o.data&&E(o.data)?l+("<data>"+this._toXMLString(o.data)+"</data>"):l+("<data>"+this._objectToXMLString(o.data)+"</data>"),o.parent&&(l=E(o.parent)?l+("<parent>"+this._toXMLString(o.parent)+"</parent>"):l+("<parent>"+this._objectToXMLString(o.parent)+"</parent>")));for(e=0;e<s;e++)o=h.getItemAt(e),"D"!=o.job&&(l=l?l+"\n":"",l+="<idx>"+o.idx+"</idx>\n",l+="<job>"+o.job+"</job>\n",o.data&&(E(o.data)?l+="<data>"+this._toXMLString(o.data)+"</data>":F(o.data)?l+="<data>"+o.data+"</data>":Ea(o.data)&&(l+="<data>"+this._objectToXMLString(o.data)+"</data>"),o.parent&&(E(o.parent)?l+="<parent>"+this._toXMLString(o.parent)+"</parent>":F(o.parent)?l+="<parent>"+o.parent+"</parent>":Ea(o.parent)&&(l+="<parent>"+this._objectToXMLString(o.parent)+"</parent>"))));if(t)for(i=0,r=this._collection.getLength();i<r;i++){for(n=!1,a=this._getCollectionItemAt(i),e=0;e<s;e++)if(h.getItemAt(e).data===a){n=!0;break}n||(l=l?l+"\n":"",l+="<idx>"+i+"</idx>\n",l+="<job>N</job>\n",l+="<data>"+this._objectToXMLString(a)+"</data>")}}}catch(d){alert(B.getString("koolgridweb","errorConvertData")+" "+d.message)}return l&&(l="<changedData>\n"+l+"</changedData>"),l},D.prototype.addChangedData=function(t,e){var i=this._collection.getItemIndex(t);"I"==e?this._setChangedDataAdd(t,i):"U"==e?this._setChangedDataUpdate(t,this._getCollectionItemAt(i),i):"D"==e&&this._setChangedDataRemove(t,i)},D.prototype.removeChangedData=function(t){var e={idx:-1,job:"UR",uid:V.getUID(t),cflag:this._grid._getChangedDataFlag(t),data:t,hsp:0};this._undoStack.splice(this._undoStackPointer+1,this._undoStack.length),this._undoStack.push(e),this._undoStackPointer=this._undoStack.length-1,this._grid&&this._grid.removeChangedData(t)},D.prototype.resetChangedData=function(){this._allDataImported=!1,this._grid&&this._grid.resetChangedData(),this._undoStack=[],this._undoStackPointer=-1},D.prototype.getObjectById=function(t){return(t=this._componentIds[t])&&E(t)?this._toXMLString(t):t},D.prototype.newClassInstance=function(t){return gb.classMap[t]?new gb.classMap[t]:null},D.prototype.newFactoryInstance=function(t){return gb.classMap[t]?new kb(gb.classMap[t]):null},D.prototype.isItemOpen=function(t){return!(!this._grid||0>t)&&(!!(t=this._getCollectionItemAt(t))&&this._grid.isItemOpen(t))},D.prototype.expandItem=function(t,e,i,s,r){if(i=2<arguments.length&&i,s=3<arguments.length&&s,r=4<arguments.length?r:null,this._grid&&!(0>t)){var n=this._getCollectionItemAt(t);n&&this._grid.expandItem(n,e,i,s,r)}},D.prototype._numericSort=function(t){return function(e,i){var s,r;return E(e)?(s=G.getProperty(e,t),s=""==s||null==s?null:Number(s)):s=""==e[t]||null==e[t]?null:Number(e[t]),E(i)?(r=G.getProperty(i,t),r=""==r||null==r?null:Number(r)):r=""==i[t]||null==i[t]?null:Number(i[t]),ua.numericCompare(s,r)}},D.prototype._groupingSortCompareFunction=function(t,e,i){return function(s,r){return s instanceof ic?"first"==t?i.sortDescending?1:-1:i.sortDescending?-1:1:r instanceof ic?"first"==t?i.sortDescending?-1:1:i.sortDescending?1:-1:e?ua.numericCompare(Number(s[i.getDataField()]),Number(r[i.getDataField()])):ua.stringCompare(s[i.getDataField()],r[i.getDataField()])}},D.prototype.getDataGridColumnFieldNames=function(){if(!this._grid)return null;var t,e,i=[];for(t=0;t<this._grid.getColumns().length;t++)e=this._grid.getColumns()[t],e.getDataField()&&i.push(e.getDataField());return i},D.prototype.getFound=function(){return this._found},D.prototype.setFound=function(t){var e=new w("searchResultChanged");t!=this._found&&(this._found=t),e.found=t,this.dispatchEvent(e)},D.prototype.getSearchString=function(){return this._searchString},D.prototype.setSearchString=function(t){this._searchString=t,this._searchStringChanged=!0},D.prototype.getSearchColumns=function(){return this._searchColumns},D.prototype.setSearchColumns=function(t){this._searchColumns=t,this._searchStringChanged=!0},D.prototype.search=function(t,e){return t=0<arguments.length?t:null,e=!(1<arguments.length)||e,t&&(this._searchString=t),this._searchStringChanged&&(this._grid.setSelectedIndex(-1),this._searchStringChanged=!1),this._searchString?(this._searchExpression=this._searchRegExp(this._searchString,e?"ig":"g"),this._searchItem()):(this._searchExpression=null,this.setFound(!1),!1)},D.prototype.searchNext=function(){return this._searchExpression?this._searchItem(!0,!0):(alert(B.getString("koolgridweb","enterSearchString")),!1)},D.prototype.searchPrevious=function(){return this._searchExpression?this._searchItem(!1,!0):(alert(B.getString("koolgridweb","enterSearchString")),!1)},D.prototype._searchItem=function(e,i){e=!(0<arguments.length)||e,i=1<arguments.length&&i;var s=this._collection.createCursor(),r=!1;0<=this._grid.getSelectedIndex()?s.seek(t.getFIRST(),this._grid.getSelectedIndex()):s.seek(t.getFIRST()),i&&(e?s.moveNext():s.movePrevious());var n,o=this._collection.getLength();for(n=0;n<o;n++){if(this._matchItem(s.getCurrent())){r=!0;break}e?s.moveNext():s.movePrevious(),s.getAfterLast()&&s.seek(t.getFIRST()),s.getBeforeFirst()&&s.seek(t.getLAST())}return r&&(this._grid.setSelectedItem(s.getCurrent()),this._grid.getSelectedIndex()<this._grid.getVerticalScrollPosition()&&this._grid.setVerticalScrollPosition(this._grid.getSelectedIndex()),this._grid.getSelectedIndex()>this._grid.getVerticalScrollPosition()+this._grid.getRowCount()-this._grid.getLockedRowCount()-2&&this._grid.setVerticalScrollPosition(this._grid.getSelectedIndex()-this._grid.getRowCount()+this._grid.getLockedRowCount()+2)),this.setFound(r),r},D.prototype._matchItem=function(t){var e,i,s,r,n;for(s=this._searchColumns?this._searchColumns:this._grid.getColumns(),e=0,i=s.length;e<i;e++)if(r=s[e],r.getVisible()&&(n=r.itemToLabel(t,!1),!p(n))){if(this._searchExpression.test(n))return this._searchExpression.lastIndex=0,!0;if(n=r._applyFormatting(n),this._searchExpression.test(n))return this._searchExpression.lastIndex=0,
!0;if((r.getItemRendererDataProvider()||r.getItemRendererDataProviderField())&&(n=r.dataProviderToLabel(t,r.itemToData(t)),this._searchExpression.test(n)))return this._searchExpression.lastIndex=0,!0}return!1},D.prototype._searchRegExp=function(t,e,i,s){e=1<arguments.length?e:"i",i=!(2<arguments.length)||i,s=!(3<arguments.length)||s;var r;return r=t.replace(/[\^\$\\\.\+\(\)\[\]\{\}\|]/g,"\\$&"),r=r.replace(/[\?]/g,"."),r=r.replace(/[\*]/g,".*?"),new RegExp(r,e)},D.prototype.createChildren=function(){if(D._super.createChildren.call(this),!this._grid){var t=this.element;t.setLayout=this.setLayout,t.setData=this.setData,t.setLayoutURLEx=this.setLayoutURLEx,t.setDataURLEx=this.setDataURLEx,t.addData=this.addData,t.addDataURLEx=this.addDataURLEx,t.setDataType=this.setDataType,t.addLoadingBar=this.addLoadingBar,t.removeLoadingBar=this.removeLoadingBar,t.addProgressBar=this.addProgressBar,t.removeProgressBar=this.removeProgressBar,t.destroy=this.destroy,t.clear=this.clear,t.resize=this.resize,t.resizing=this.resize,t.getRoot=this.getRoot,t.id=this._paramId;var e,i,s,r,n,o={};if(!I(this._jsVars))if(F(this._jsVars))for(t=this._jsVars.split("&"),e=0,i=t.length;e<i;e++)s=t[e],n=s.indexOf("="),0>n||(r=s.substring(0,n),s=s.substring(n+1,s.length),-1<(n=s.indexOf("function"))&&(s=s.substring(n+9,s.indexOf("(")),s=window[s]),"true"!==s&&"false"!==s||(s="true"===s),o[r]=s,jc(this,r)&&Ja(this,r,s));else if(Ea(this._jsVars))for(r in o=this._jsVars)jc(this,r)&&Ja(this,r,o[r]);p(o.dataType)||this.setDataType(o.dataType);try{this.prr(gb.classMap)}catch(a){}r=this._getTargetSize(),this._gridRootWidth=r.width,this._gridRootHeight=r.height,this.setActualSize(r.width,r.height),this.layoutURL&&this.setLayoutURLEx(this.layoutURL),this.KoolOnLoadCallFunction&&ua.findFunction(this.KoolOnLoadCallFunction)(this._paramId)}},D.prototype.commitProperties=function(){if(D._super.commitProperties.call(this),this._layoutChanged&&(this._layoutChanged=!1,this._createGrid()),this._gridDataChanged){if(this._grid&&(this._grid.addEventListener("updateComplete",this._gridUpdateCompleteHandler,this),jc(this._grid,"dataProvider"))){var t=this._componentIds.$gridData;t?t.target&&t.name&&(this._olapCube&&t.target==this._olapCube?(E(this._gridData)?Ja(t.target,t.name,new Hb(this._gridData)):Ja(t.target,t.name,new P(this._gridData)),t.target.refresh.call(t.target)):(Ja(t.target,t.name,this._gridData),(t.target instanceof fa||t.target instanceof ja||t.target instanceof va)&&t.target.refresh.call(t.target),this._collection=this._grid.getDataProvider())):(this._grid.setDataProvider(this._gridData),this._collection=this._grid.getDataProvider())}this.resetChangedData(),this._gridDataChanged=this.removeAllData=!1}},D.prototype.updateDisplayList=function(t,e){D._super.updateDisplayList.call(this,t,e);var i,s,r=this.getNumChildren();for(s=0;s<r;s+=1)i=this.getChildAt(s),i instanceof H&&(i.getWidth(),i.getHeight(),i.move(0,0),i.setActualSize(this.getWidth(),this.getHeight()))},D.prototype.setLayout=function(t){var e=this.selfElement?this.selfElement:this;if(F(t))try{e.setLayoutXML(G.parse(t))}catch(i){throw B.getString("koolgridweb","invalidLayoutXML")+(i.message||i)}else{if(!E(t))throw"Invalid layout XML";e.setLayoutXML(t)}e.dataSet&&e._pushDataIntoWrapper()},D.prototype.setData=function(t){var e=this.selfElement?this.selfElement:this;e.dataSet=e._dataSetting(t),e._pushDataIntoWrapper()},D.prototype.setLayoutURLEx=function(t){var e=this.selfElement?this.selfElement:this;e.addLoadingBar(),e._layout=null,e.layoutURL=t,Ae({url:t,onSuccess:function(t){if(F(t))e.setLayoutXML(G.parse(t));else{if(!E(t))throw"Invalid layout";e.setLayoutXML(t)}e.dataSet?(e._pushDataIntoWrapper(),e.removeLoadingBar()):(e.removeLoadingBar(),!e._dataURLInProcess&&e.dataURL&&e.setDataURLEx(e.dataURL))},onError:function(t){throw e.removeLoadingBar(),"XMLHttpRequest is failed to open the url, "+e.layoutURL+" : "+t}})},D.prototype.setDataURLEx=function(t){var e=this.selfElement?this.selfElement:this;e.addLoadingBar(),e._gridData=null,e.dataSet=null,e.dataURL=t,e._dataURLInProcess=!0,Ae({url:t,onSuccess:function(t){e.dataSet=e._dataSetting(t),e._pushDataIntoWrapper(),e._dataURLInProcess=!1,e.removeLoadingBar()},onError:function(i){throw e.removeLoadingBar(),e._dataURLInProcess=!1,"XMLHttpRequest is failed to open the url, "+t+" : "+i}})},D.prototype.addData=function(t,e){var i=this.selfElement?this.selfElement:this;i._grid&&i._collection&&(i._collection instanceof T||(Xa(e)&&0<=e?i._collection.addAllAt(i._dataSetting(t),e):i._collection.addAll(i._dataSetting(t))))},D.prototype.addDataURLEx=function(t,e,i){i=!(2<arguments.length)||i;var s=this.selfElement?this.selfElement:this;i&&s.lastAddURL==t||(s.lastAddURL=t,s.addLoadingBar(),Ae({url:t,onSuccess:function(t){s.addData(t,e),s.removeLoadingBar()},onError:function(e){throw s.removeLoadingBar(),"XMLHttpRequest is failed to open the url, "+t+" : "+e}}))},D.prototype.destroy=function(){var t=this.selfElement?this.selfElement:this;t._removeGridEventListener(),t._root&&(t._root.resetInvalidate(),Sa.remove(t._root),t.removeChild(t._root),t._root=null),t._grid=null,t._componentIds=null,t._unmatchedComponentIds=null,t._collection=null,t._gridData=null,t._layout=null,t._undoStack=[],t._undoStackPointer=-1,Sa.remove(t),t.element.parentNode.removeChild(t.element),delete KoolGrid.instances[t._paramId],sa.destroy(t._paramId)},D.prototype.clear=function(){var t=this.selfElement?this.selfElement:this;t._removeGridEventListener(),t._root&&(t._root.resetInvalidate(),Sa.remove(t._root),t.removeChild(t._root),t._root=null),t._grid=null,t._componentIds={},t._unmatchedComponentIds=[],t._collection=null,t._gridData=null,t._layout=null,t.resetChangedData()},D.prototype.getRoot=function(){return this.selfElement},D.prototype.getDataGrid=function(){return(this.selfElement?this.selfElement:this)._grid},D.prototype.getRemoveAllData=function(){return this.removeAllData},D.prototype.addLoadingBar=function(){var t=this.selfElement?this.selfElement:this;p(t)||(t._inLoadingBarCount++,t.showLoadingBar&&(t._loadingBar||(t._loadingBar=document.createElement("div"),t._loadingBar.style.boxSizing="border-box",t._loadingBar.style.position="absolute",t._loadingBar.className="Kool__Preloader"),t.element.contains(t._loadingBar)||t.element.appendChild(t._loadingBar)))},D.prototype.removeLoadingBar=function(){var t=this.selfElement?this.selfElement:this;p(t)||(t._inLoadingBarCount--,0>=t._inLoadingBarCount&&t._loadingBar&&t.element.contains(t._loadingBar)&&(t.element.removeChild(t._loadingBar),t._inLoadingBarCount=0))},D.prototype.getProgressBar=function(){return(this.selfElement?this.selfElement:this)._progressBar},D.prototype.addProgressBar=function(){var t=this.selfElement?this.selfElement:this;!p(t)&&t.showLoadingBar&&(t._progressBar||(t._progressBar=new Fa,t._progressBar.setLabelPlacement(Fa.CENTER),t._progressBar.setActualSize(200,24),t._progressBar.move((t.getWidth()-t._progressBar.getWidth())/2,(t.getHeight()-t._progressBar.getHeight())/2)),t.contains(t._progressBar)||t.addChild(t._progressBar))},D.prototype.removeProgressBar=function(){var t=this.selfElement?this.selfElement:this;p(t)||t._progressBar&&t.contains(t._progressBar)&&t.removeChild(t._progressBar)},D.prototype.showGroupingPanel=function(){var t=this.selfElement?this.selfElement:this;!p(t)&&t._groupingPanel&&(t._groupingPanel.setVisible(!0),t.setGridActualSize(t._gridRootWidth,t._gridRootHeight))},D.prototype.hideGroupingPanel=function(){var t=this.selfElement?this.selfElement:this;!p(t)&&t._groupingPanel&&(t._groupingPanel.setVisible(!1),t.setGridActualSize(t._gridRootWidth,t._gridRootHeight))},D.prototype.setDataType=function(t){(this.selfElement?this.selfElement:this).dataType=t},D.prototype.resize=function(){var t=this.selfElement?this.selfElement:this,e=t._getTargetSize();!e||e.width==t._gridRootWidth&&e.height==t._gridRootHeight||(t._gridRootWidth=e.width,t._gridRootHeight=e.height,t.setActualSize(e.width,e.height),t._grid&&(t.setGridActualSize(e.width,e.height),t._grid.invalidateDisplayList()))},D.prototype.setGridActualSize=function(t,e){this._grid&&(this._groupingPanel&&this._groupingPanel.getVisible()?(this._grid.setActualSize(t,e-this._groupingPanel.getHeight()),this._grid.setY(this._groupingPanel.getHeight())):(this._grid.setY(0),this._grid.setActualSize(t,e)))},D.prototype.addResourceBundle=function(t,e,i){B.addResourceBundle(t,e,i)},D.prototype.getResourceBundle=function(t,e){return B.getResourceBundle(t,e)},D.prototype.setResourceBundleString=function(t,e,i,s){B.getResourceBundle(t,e)[i]=s},D.prototype.clone=function(t,e,i){if(e=1<arguments.length?e:"_rattr",i=2<arguments.length?i:"_attr",!(t instanceof Object))return t;var s;switch(s=t.constructor){case RegExp:s=new s(t);break;case Date:s=new s(t.getTime());break;default:s=new s}for(var r in t)!r||"rm_internal_uid"===r||r===e||0<=r.indexOf(i)&&r.lastIndexOf(i)===r.length-i.length||(s[r]=this.clone(t[r]));return s},D.prototype.calculateAutoHeight=function(){if(this._grid&&this._grid.autoHeight){var t,e=this._grid.getMaxHeight(),i=this._grid.getMinHeight(),s=this._grid.maxHeightRowCount,r=this._grid.minHeightRowCount,n=document.getElementById(this._paramTarget),o=m.getOffsetHeight(n),a=this._collection?this._collection.getLength():0,l=this._grid.getRowHeight()*a,h=this._grid._getHeaderVisible()&&this._grid._headerRowInfo&&this._grid._headerRowInfo[0]?this._grid._headerRowInfo[0].height:0,d=m.getBorderMetrics(this._grid),d=d.top+d.bottom,c=this._grid._horizontalScrollBar?this._grid._horizontalScrollBar.getHeight():0,_=0;if(this._grid._footers)for(t=0;t<this._grid._footers.length;t++)_+=this._grid._footers[t].getExplicitOrMeasuredHeight();this._grid.getVariableRowHeight()?(l=2e3<e?this._grid.measureHeightOfItems(0,a):this._grid.measureHeightOfItems(0,250<a?250:a),isNaN(s)||(e=this._grid.measureHeightOfItems(0,s)+h+_+d+c),isNaN(r)||(i=this._grid.measureHeightOfItems(0,r)+h+_+d+c)):(isNaN(s)||(e=this._grid.getRowHeight()*s+h+_+d+c),isNaN(r)||(i=this._grid.getRowHeight()*r+h+_+d+c)),s=h+Math.max(l,1)+_+d+c,s<e?(m.setPxStyle(n,"height",Math.max(s,i)),this.resize()):o<e&&(m.setPxStyle(n,"height",e),this.resize())}},D.prototype._getTargetSize=function(){var t,e;return(e=document.getElementById(this._paramTarget))?(t=p(this._paramWidth)?KoolGrid.defaultWidth:/%/.test(this._paramWidth)?m.getRootSize(e,"width",this._paramWidth):parseInt(this._paramWidth),e=p(this._paramHeight)?KoolGrid.defaultHeight:/%/.test(this._paramHeight)?m.getRootSize(e,"height",this._paramHeight):parseInt(this._paramHeight),{width:t,height:e}):null},D.prototype._pushDataIntoWrapper=function(){this.setGridData(this.dataSet)},D.prototype._dataSetting=function(t){var e;if(F(t)){var i=this.dataType.toLowerCase();if("json"==i)try{e="object"==typeof JSON?JSON.parse(t):te(t)}catch(s){return void alert(B.getString("koolgridweb","invalidJSON")+s.message)}else if("fastcsv"==i)try{var r=new hb;r.parsingDate=this.parsingDate,this._useDataGridFields&&this.getDataGrid()&&r.setFieldNames(this.getDataGridColumnFieldNames()),e=r.fastParse(t)}catch(s){return void alert(B.getString("koolgridweb","invalidCSV")+s.message)}else if("csv"==i)try{var n=new hb;n.parsingDate=this.parsingDate,this._useDataGridFields&&this.getDataGrid()&&n.setFieldNames(this.getDataGridColumnFieldNames()),e=n.parse(t)}catch(s){return void alert(B.getString("koolgridweb","invalidCSV")+s.message)}else if("fasttsv"==i)try{var o=new hb("\t");o.parsingDate=this.parsingDate,this._useDataGridFields&&this.getDataGrid()&&o.setFieldNames(this.getDataGridColumnFieldNames()),e=o.fastParse(t)}catch(s){return void alert(B.getString("koolgridweb","invalidTSV")+s.message)}else if("tsv"==i)try{var a=new hb("\t");a.parsingDate=this.parsingDate,this._useDataGridFields&&this.getDataGrid()&&a.setFieldNames(this.getDataGridColumnFieldNames()),e=a.parse(t)}catch(s){return void alert(B.getString("koolgridweb","invalidTSV")+s.message)}else try{e=G.parse(t)}catch(s){return void alert(B.getString("koolgridweb","invalidXML")+s.message)}return e}return t},D.prototype._removeGridEventListener=function(){this._grid&&(this._grid.removeEventListener(L.ITEM_ROLL_OVER,this._itemRollOverHandler,this),this._grid.removeEventListener(K.ITEM_EDIT_BEGINNING,this._itemEditBeginningHandler,this),this._grid.removeEventListener(K.ITEM_EDIT_END,this._itemEditEndHandler,this),this._grid.removeEventListener(K.ITEM_FOCUS_IN,this._itemFocusInHandler,this),this._grid.removeEventListener(K.PASTE_EDIT_END,this._pasteEditEndHandler,this),this._grid.removeEventListener(K.ITEM_VALUE_CHANGE,this._itemValueChangeHandler,this),this._grid.removeEvent("keydown",this._gridKeyDownHandler,this))},D.prototype._eventDelayDispatcher=function(t){this.callLater(this.dispatchEvent,[t])},D.prototype._gridCreationCompleteHandler=function(t){this._grid.removeEventListener("creationComplete",this._gridCreationCompleteHandler,this),this._eventDelayDispatcher(new w("layoutComplete"))},D.prototype._gridUpdateCompleteHandler=function(t){this._collection=this._grid.getDataProvider(),this._collection&&bb(this._collection.async)&&this._collection.async&&this._collection._timer||(this.calculateAutoHeight(),this._grid.removeEventListener("updateComplete",this._gridUpdateCompleteHandler,this),this._eventDelayDispatcher(new w("dataComplete")))},D.prototype._excelCSVImporterParseCompleteHandler=function(t){t=t.currentTarget.selfElement,t.addEventListener("complete",this._excelCSVImporterCompleteHandler,this),t.insertIntoDataGrid(this._grid,this._excelCSVImportOption)},D.prototype._excelCSVImporterCompleteHandler=function(t){t=t.currentTarget.selfElement,t.removeEventListener("complete",this._excelCSVImporterCompleteHandler,this),this.importFileName=t.importFileName,this.dataSet=this._grid.getDataProvider().getSource(),this._grid.getDataProvider()!==this._collection&&(this._collection=this._grid.getDataProvider(),t=this._componentIds.$gridData)&&(t.target=this._collection),this._undoStack=[],this._undoStackPointer=-1,this._allDataImported=!0,this.dispatchEvent(new w("importComplete")),this.excelCSVImporter=null},D.prototype._excelCSVImporterCloseHandler=function(t){t=t.currentTarget.selfElement,t.removeEventListener(pd.PARSE_COMPLETE,this._excelCSVImporterParseCompleteHandler,this),t.removeEventListener("close",this._excelCSVImporterCloseHandler,this),this.excelCSVImporter=null},D.prototype._excelImporterParseCompleteHandler=function(t){t=t.currentTarget.selfElement,t.addEventListener("complete",this._excelImporterCompleteHandler,this),t.insertIntoDataGrid(this._grid,this._excelImportOption)},D.prototype._excelImporterCompleteHandler=function(t){t=t.currentTarget.selfElement,t.removeEventListener("complete",this._excelImporterCompleteHandler,this),this.importFileName=t.importFileName,this.dataSet=this._grid.getDataProvider().getSource(),this._grid.getDataProvider()!==this._collection&&(this._collection=this._grid.getDataProvider(),t=this._componentIds.$gridData)&&(t.target=this._collection),this._undoStack=[],this._undoStackPointer=-1,this._allDataImported=!0,this.dispatchEvent(new w("importComplete")),this.excelImporter=null},D.prototype._excelImporterCloseHandler=function(t){t=t.currentTarget.selfElement,t.removeEventListener(qd.PARSE_COMPLETE,this._excelImporterParseCompleteHandler,this),t.removeEventListener("close",this._excelImporterCloseHandler,this),this.excelImporter=null},D.prototype._excelExportAlertClickHandler=function(){this._exportExcelAsync?this._exportExcelUploadUrl?this._grid.exportExcelUpload(this._exportExcelUploadUrl,!0):this._grid.exportExcelSave(this._exportExcelSaveUrl,!0):(this._grid.addEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this._grid.addEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this._grid.exportExcelMake(this._exportExcelAsync))},D.prototype._excelExportMakeCompleteHandler=function(t){this._grid.removeEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this._grid.removeEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this.dispatchEvent(t),this._exportExcelAsync?this._excelExportAlertClickHandler():this._exportExcelUploadUrl?this._grid.exportExcelUpload(this._exportExcelUploadUrl):this._grid.exportExcelSave(this._exportExcelSaveUrl)},D.prototype._excelExportMakeErrorHandler=function(t){this._grid.removeEventListener(J.EXPORT_MAKE_COMPLETE,this._excelExportMakeCompleteHandler,this),this._grid.removeEventListener(J.EXPORT_MAKE_ERROR,this._excelExportMakeErrorHandler,this),this.dispatchEvent(t),alert(B.getString("koolgridweb","makeExcelError",[t.text]))},D.prototype._excelExportSaveCompleteHandler=function(t){this._grid.removeEventListener(J.EXPORT_SAVE_COMPLETE,this._excelExportSaveCompleteHandler,this),this._grid.removeEventListener(J.EXPORT_SAVE_ERROR,this._excelExportSaveErrorHandler,this),this.dispatchEvent(t)},D.prototype._excelExportSaveErrorHandler=function(t){this._grid.removeEventListener(J.EXPORT_SAVE_COMPLETE,this._excelExportSaveCompleteHandler,this),this._grid.removeEventListener(J.EXPORT_SAVE_ERROR,this._excelExportSaveErrorHandler,this),this.dispatchEvent(t),alert(B.getString("koolgridweb","saveExcelError",[t.text]))},D.prototype._excelExportUploadCompleteHandler=function(t){this._grid.removeEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelExportUploadCompleteHandler,this),this._grid.removeEventListener(J.EXPORT_UPLOAD_ERROR,this._excelExportUploadErrorHandler,this),this.dispatchEvent(t)},D.prototype._excelExportUploadErrorHandler=function(t){this._grid.removeEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelExportUploadCompleteHandler,this),this._grid.removeEventListener(J.EXPORT_UPLOAD_ERROR,this._excelExportUploadErrorHandler,this),this.dispatchEvent(t),alert(B.getString("koolgridweb","uploadExcelError",[t.text]))},D.prototype._excelMultiExportMakeCompleteHandler=function(t){this._multExporter.removeEventListener(J.EXPORT_MAKE_COMPLETE,this._excelMultiExportMakeCompleteHandler,this),this._multExporter.removeEventListener(J.EXPORT_MAKE_ERROR,this._excelMultiExportMakeErrorHandler,this),this.dispatchEvent(t),this._exportExcelUploadUrl?this._multExporter.exportExcelUpload(this._exportExcelUploadUrl,this._exportExcelAsync):this._multExporter.exportExcelSave(this._exportExcelSaveUrl,this._grid.element,this._exportExcelAsync)},D.prototype._excelMultiExportMakeErrorHandler=function(t){this._multExporter.removeEventListener(J.EXPORT_MAKE_COMPLETE,this._excelMultiExportMakeCompleteHandler,this),this._multExporter.removeEventListener(J.EXPORT_MAKE_ERROR,this._excelMultiExportMakeErrorHandler,this),this.dispatchEvent(t),alert(B.getString("koolgridweb","makeExcelError",[t.text]))},D.prototype._excelMultiExportSaveCompleteHandler=function(t){this._multExporter.removeEventListener(J.EXPORT_SAVE_COMPLETE,this._excelMultiExportSaveCompleteHandler,this),this._multExporter.removeEventListener(J.EXPORT_SAVE_ERROR,this._excelMultiExportSaveErrorHandler,this),this.dispatchEvent(t)},D.prototype._excelMultiExportSaveErrorHandler=function(t){this._multExporter.removeEventListener(J.EXPORT_SAVE_COMPLETE,this._excelMultiExportSaveCompleteHandler,this),this._multExporter.removeEventListener(J.EXPORT_SAVE_ERROR,this._excelMultiExportSaveErrorHandler,this),this.dispatchEvent(t),alert(B.getString("koolgridweb","saveExcelError",[t.text]))},D.prototype._excelMultiExportUploadCompleteHandler=function(t){this._multExporter.removeEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelMultiExportUploadCompleteHandler,this),this._multExporter.removeEventListener(J.EXPORT_UPLOAD_ERROR,this._excelMultiExportUploadErrorHandler,this),this.dispatchEvent(t)},D.prototype._excelMultiExportUploadErrorHandler=function(t){this._multExporter.removeEventListener(J.EXPORT_UPLOAD_COMPLETE,this._excelMultiExportUploadCompleteHandler,this),this._multExporter.removeEventListener(J.EXPORT_UPLOAD_ERROR,this._excelMultiExportUploadErrorHandler,this),this.dispatchEvent(t),alert(B.getString("koolgridweb","uploadExcelError",[t.text]))},D.prototype._itemEditEndHandler=function(t){if(!(0>t.rowIndex||t.rowIndex>=this._collection.getLength())){var e,i,s,r;try{e=bd(t.currentTarget.selfElement.itemEditorInstance,this._grid.getColumns()[t.columnIndex].editorDataField)}catch(n){}try{i=E(t.itemRenderer._listData.item)?G.getProperty(t.itemRenderer._listData.item,t.itemRenderer._listData.dataField):t.itemRenderer._listData.item[t.itemRenderer._listData.dataField]}catch(n){}if(r=t.itemRenderer?t.itemRenderer.getData():this._getCollectionItemAt(t.rowIndex),"cancelled"==t.reason){if(this._itemEditEndJsFunc)try{s=ua.findFunction(this._itemEditEndJsFunc)(t.rowIndex,t.columnIndex,r,t.dataField,i,e,t.reason)}catch(n){}}else{var o=this._grid.getColumns()[t.columnIndex].getStyle("type"),a=this._grid.getColumns()[t.columnIndex].getStyle("maxChars")?this._grid.getColumns()[t.columnIndex].getStyle("maxChars"):this._grid.getColumns()[t.columnIndex].getStyle("maxLength"),l=this._grid.getColumns()[t.columnIndex].getStyle("required");if(Ha.getInstance().alwaysShowErrorTip=this._grid.alwaysShowErrorTip,!l||e&&0!=e.length)if(e===i||Xa(e)&&e==parseFloat(i)||Xa(i)&&parseFloat(e)==i||""==e&&p(i)){if(this._itemEditEndJsFunc){try{s=ua.findFunction(this._itemEditEndJsFunc)(t.rowIndex,t.columnIndex,r,t.dataField,i,e,"sameValue")}catch(n){s=null}s&&(t.currentTarget.selfElement.itemEditorInstance&&this._grid.itemEditorInstance.setErrorString(s),t.preventDefault())}}else{if(o&&0<o.length&&e)if("int"==o){if(o=parseInt(e),isNaN(o)||o.toString()!=e)return this._grid.itemEditorInstance.setErrorString(B.getString("koolgridweb","mustEnterInterger")),void t.preventDefault()}else if("float"==o&&(o=parseFloat(e),isNaN(o)||/^\s*$/.test(e)||isNaN(e)))return this._grid.itemEditorInstance.setErrorString(B.getString("koolgridweb","mustEnterNumber")),void t.preventDefault();if(a&&(o=F(a)?parseInt(a):a,e.length>o))return this._grid.itemEditorInstance.setErrorString(B.getString("koolgridweb","maxChars",[a])),void t.preventDefault();if(this._itemEditEndJsFunc){try{s=ua.findFunction(this._itemEditEndJsFunc)(t.rowIndex,t.columnIndex,r,t.dataField,i,e,t.reason)}catch(n){s=null}if(s)return this._grid.itemEditorInstance&&this._grid.itemEditorInstance.setErrorString(s),void t.preventDefault()}this._setChangedDataUpdateField(e,i,t.rowIndex,t.dataField,r,t.columnIndex),this._collection instanceof va&&this.callLater(function(){var t=this;t._collection.refresh(),t.callLater(function(){t._grid.itemEditorInstance&&t._grid.itemEditorInstance.focus()})}),s=new Hc(Hc.ITEM_DATA_CHANGED),s.columnIndex=t.columnIndex,s.dataField=t.dataField,s.item=r,s.newValue=e,s.reason=t.reason,s.rowIndex=t.rowIndex,s.value=i,this._eventDelayDispatcher(s),t.currentTarget.selfElement.itemEditorInstance&&t.currentTarget.selfElement.itemEditorInstance instanceof Y&&this.callLater(this._grid.invalidateList)}else this._grid.itemEditorInstance.setErrorString(B.getString("koolgridweb","needInput")),t.preventDefault()}}},D.prototype._pasteEditEndHandler=function(t){var e,i=t.newValue.toString();try{e=E(t.item)?G.getProperty(t.item,t.dataField):t.item[t.dataField].toString()}catch(s){}if(i!=e){var r=this._grid.getColumns()[t.columnIndex],n=r.getStyle("type"),o=r.getStyle("maxChars")?r.getStyle("maxChars"):r.getStyle("maxLength"),r=r.getHeaderText()?r.getHeaderText():r.getDataField();if(n&&0<n.length&&i)if("int"==n){if(n=parseInt(i),isNaN(n)||n.toString()!=i)return alert(B.getString("koolgridweb","pasteMustEnterInterger",[r,i])),void t.preventDefault()}else if("float"==n&&(n=parseFloat(i),isNaN(n)||/^\s*$/.test(i)||isNaN(i)))return alert(B.getString("koolgridweb","pasteMustEnterNumber",[r,i])),void t.preventDefault();if(o&&(n=F(o)?parseInt(o):o,i.length>n))return alert(B.getString("koolgridweb","pasteMaxChars",[r,o,i])),void t.preventDefault();if(this._pasteEditEndJsFunc){o=!1;try{o=ua.findFunction(this._pasteEditEndJsFunc)(t.rowIndex,t.columnIndex,t.item,t.dataField,e,i)}catch(s){o=!1}if(!o)return void t.preventDefault()}this._setChangedDataUpdateField(i,e,t.rowIndex,t.dataField,t.item,t.columnIndex),o=new Hc(Hc.ITEM_DATA_CHANGED),o.columnIndex=t.columnIndex,o.dataField=t.dataField,o.item=t.item,o.newValue=i,o.reason=t.reason,o.rowIndex=t.rowIndex,o.value=e,this.dispatchEvent(o)}},D.prototype._itemEditBeginningHandler=function(t){if(this._itemEditBeginningJsFunc){var e,i=!1;try{e=t.itemRenderer?t.itemRenderer.getData():this._getCollectionItemAt(t.rowIndex),i=ua.findFunction(this._itemEditBeginningJsFunc)(t.rowIndex,t.columnIndex,e,t.dataField)}catch(s){i=!1}i||t.preventDefault()}},D.prototype._itemFocusInHandler=function(t){var e=t.item,i=this._grid.getColumns()[t.columnIndex],s=i.getStyle("type"),i=i.getStyle("maxChars")?i.getStyle("maxChars"):i.getStyle("maxLength"),r=t.itemRenderer;if(r&&(r instanceof Y&&r.getListData()&&" "==r.getListData().label&&e&&!e[t.dataField]&&r.setText(""),s&&0<s.length&&("int"==s?r.setRestrict?(r.setRestrict(/^[-+]?\d*$/g),this._grid._tempTextInput!==r||r.getText().match(/^-?\d?$/)||r.setText("")):r.getTextInput&&r.getTextInput().setRestrict(/^[-+]?\d*$/g):"float"==s&&(r.setRestrict?(r.setRestrict(/^[-+]?\d*\.?\d*$/g),this._grid._tempTextInput!==r||r.getText().match(/^-?\.?\d?$/)||r.setText("")):r.getTextInput&&r.getTextInput().setRestrict(/^[-+]?\d*\.?\d*$/g))),i&&(r.setMaxChars?r.setMaxChars(i):r.getTextInput&&r.getTextInput().setMaxChars(i))),this._itemFocusInJsFunc)try{ua.findFunction(this._itemFocusInJsFunc)(t.rowIndex,t.columnIndex,e,t.dataField)}catch(n){}},D.prototype._itemValueChangeHandler=function(t){var e=!(t.itemRenderer instanceof Ab)||t.itemRenderer._getCheckBox().getSelected();this._setChangedDataUpdateField(e,!e,t.rowIndex,t.dataField,t.item,t.columnIndex,"IVCEVT");var i=new Hc(Hc.ITEM_DATA_CHANGED);i.columnIndex=t.columnIndex,i.dataField=t.dataField,i.item=t.item,i.newValue=e,i.reason=t.reason,i.rowIndex=t.rowIndex,i.value=!e,this.dispatchEvent(i)},D.prototype._itemRollOverHandler=function(t){this._lastRollOverIndex=t.rowIndex},D.prototype._gridKeyDownHandler=function(t){this.undoable&&this._grid&&this._collection&&(this._grid.itemEditorInstance||(90==t.keyCode&&t.ctrlKey?this.undo():89==t.keyCode&&t.ctrlKey&&this.redo()))},D.prototype._oladCudeFault=function(t,e){alert("Error in query.")},D.prototype._oladCudeResult=function(t,e){t?(this._grid.setDataProvider(t),this._collection=this._grid.getDataProvider()):alert("No results from query.")},D.prototype._olapGetQuery=function(t){var e,i,s,r,n,o,a=new Zb,l=t.rowFields,h=a.getAxis(Zb.ROW_AXIS);if(l){var d=!0,c=!1;for(ha(l)||(d=!!I(l.crossjoin)||l.crossjoin,c=!I(l.useMembers)&&l.useMembers,l=l.sets),e=0;e<l.length;e++){var _=new Fb;if(s=t.findDimension(l[e].dimensionName),l[e].attributeName&&(i=s.findAttribute(l[e].attributeName),_.addElements(c?i.getMembers():i.getChildren())),l[e].members)for(i=0;i<l[e].members.length;i++)_.addElement(s.findMember(l[e].members[i]));d?r=r?r.crossJoin(_):_:h.addSet(_)}}if(d=t.columnFields,l=a.getAxis(Zb.COLUMN_AXIS),d){var c=!0,u=!1;for(ha(d)||(c=!!I(d.crossjoin)||d.crossjoin,u=!!I(d.useMembers)||d.useMembers,d=d.sets),e=0;e<d.length;e++){if(_=new Fb,s=t.findDimension(d[e].dimensionName),d[e].attributeName&&(i=s.findAttribute(d[e].attributeName),_.addElements(u?i.getMembers():i.getChildren())),d[e].members)for(i=0;i<d[e].members.length;i++)_.addElement(s.findMember(d[e].members[i]));c?n=n?n.crossJoin(_):_:l.addSet(_)}}if(s=t.measureFields){for(ha(s)||(I(s.crossjoin),s=s.sets),i=new Fb,e=0;e<s.length;e++)i.addElement(t.findDimension("Measures").findMember(s[e].measureName));n&&(n=n.crossJoin(i))}if(d=t.slicerFields,c=a.getAxis(Zb.SLICER_AXIS),d)for(_=!0,ha(d)||(_=!!I(d.crossjoin)||d.crossjoin,d=d.sets),e=0;e<d.length;e++){var p=new Fb;if(s=t.findDimension(d[e].dimensionName),d[e].attributeName&&(i=s.findAttribute(d[e].attributeName),p.addElements(u?i.getMembers():i.getChildren())),d[e].members)for(i=0;i<d[e].members.length;i++)p.addElement(s.findMember(d[e].members[i]));_?o=o?o.crossJoin(p):p:c.addSet(p)}return r&&h.addSet(r.hierarchize(!0)),n&&l.addSet(n.hierarchize(!0)),o&&c.addSet(o.hierarchize(!0)),a},D.prototype._olapCubeCompleteHandler=function(t){if(!t.defaultPrevented){t=t.currentTarget;var e=this._olapGetQuery(t);t.execute(e).addResponder(new le(this._oladCudeResult,this._oladCudeFault,null,this))}},D.prototype.removeSelectorColumnSelectedIndices=function(t){var e,i=this.getObjectById(t);if(!i)return null;if(e=i.getSelectedIndices(),!e)return e;for(e=e.sort(function(t,e){return t-e}),t=e.length-1;0<=t;t--)this.removeItemAt(e[t]);return i.clearSelection(),e},D.resources={"ko-KR":{koolgridweb:{invalidJSON:" JSON  .   . :",invalidXML:" XML  .   . :",invalidCSV:" CSV  .   . :",invalidTSV:" TSV  .   . :",invalidLayoutXML:" XML  .  XML  .",unknownObject:"   :{0}() .",unknownVariable:"   :{0}() .",unknownProperty:"   :{0}() .",errorSetProperty:":{0}    . :",errorSetBoolean:" {0}  true false .",notExportObject:"  DataGrid    .",makeExcelError:"     . :{0}",saveExcelError:"     .         . :{0}",uploadExcelError:"     . :{0}",alertTitleExport:"Export",errorUpdateData:"   .",errorDeleteData:"   .",errorConvertData:"    .",selectDeleteRow:"  ",enterSearchString:"  ",needInput:" .",mustEnterInterger:"  .",mustEnterNumber:"  .",maxChars:"    {0} .",pasteMustEnterInterger:"{0}    . (:{1})",pasteMustEnterNumber:"{0}    . (:{1})",pasteMaxChars:"{0}      {1} . (:{2})",errorSortModeAddItem:"    .",errorFilterModeAddItem:"    ."}},"en-US":{koolgridweb:{invalidJSON:"Invalid data in JSON format. Please refer to the data. Error:",invalidXML:"Invalid data in XML format. Please refer to the data. Error:",invalidCSV:"Invalid data in CSV format. Please refer to the data. Error:",invalidTSV:"Invalid data in TSV format. Please refer to the data. Error:",invalidLayoutXML:"The XML for Layout is malformed. Please check the XML",unknownObject:"An unknown object:{0} was defined.",unknownVariable:"An unknown variable:{0} was defined.",unknownProperty:"An unknown property:{0} was defined.",errorSetProperty:"An error has occurred in setting property:{0}. Error:",errorSetBoolean:"The value of the property {0} must be true or false.",notExportObject:"The current generated DataGrid does not support this feature.",makeExcelError:"An error occurred while making the file. Error:{0}",saveExcelError:"An error occurred while saving the file. Please check the file is in use. Error:{0}",uploadExcelError:"An error occurred while uploading the file. Error:{0}",alertTitleExport:"Export",errorUpdateData:"An error occurred while trying to modify the data.",errorDeleteData:"An error occurred while deleting data.",errorConvertData:"An error occurred while trying to convert the data.",selectDeleteRow:"Please select the rows to be deleted",enterSearchString:"Please enter a search string",needInput:"Input is required.",mustEnterInterger:"Please enter an integer.",mustEnterNumber:"Please enter a number.",maxChars:"The maximum number of characters that users can enter in the field is {0} characters.",pasteMustEnterInterger:"Please enter an integer in the column '{0}'. (Value: {1})",pasteMustEnterNumber:"Please enter the numbers in the column '{0}'. (Value: {1})",pasteMaxChars:"The maximum number of characters can be entered in the column {0} is {1} characters. (Value: {2})",errorSortModeAddItem:"In sort mode, you will not be able to add a row.",errorFilterModeAddItem:"In filter mode, you will not be able to add a row."}},"fr-FR":{koolgridweb:{invalidJSON:"Donnes invalides en format JSON. Veuillez vous rfrer aux donnes. Erreur.",
invalidXML:"Donnes invalides en format XML. Veuillez vous rfrer aux Donnes. Erreur.",invalidCSV:"Donnes invalides en format CSV. Veuillez vous rfrer aux Donnes. Erreur.",invalidTSV:"Donnes invalides en format TSV. Veuillez vous rfrer aux Donnes. Erreur.",invalidLayoutXML:"Le format XML est mal form, Merci de vrifier le XML.",unknownObject:"Un objet inconnu {0} a t dfini.",unknownVariable:"Une variable:{0} inconnue a t dfinie.",unknownProperty:"Une proprit:{0} inconnue a t dfinie.",errorSetProperty:"Une erreur est survenue pendant la dfinition des paramtres:{0}. Erreur.",errorSetBoolean:"La valeur de la proprit {0} doit tre soit fausse soit vraie.",notExportObject:"Le Datagrid gnr ne prend pas en charge cette fonction.",makeExcelError:"Une erreur est survenue pendant la cration du fichier. Erreur:{0}",saveExcelError:"Une erreur est survenue pendant la sauvegarde du fichier. Merci de vrifier si le fichier est en cours dutilisation. Erreur:{0}",uploadExcelError:"Une erreur est survenue pendant le tlchargement du fichier. Erreur:{0}",alertTitleExport:"Exporter",errorUpdateData:"Une erreur est survenue en essayant de modifier les donnes.",errorDeleteData:"Une erreur est survenue pendant la suppression des donnes.",errorConvertData:"Une erreur est survenue en essayant de convertir les donnes.",selectDeleteRow:"Veuillez  slectionner les lignes   supprimer.",enterSearchString:"Veuillez entre une chane de recherche.",needInput:"Une entre est requise.",mustEnterInterger:"Veuillez entrer un nombre entier.",mustEnterNumber:"Veuillez entrer un nombre.",maxChars:"Le nombre maximum de caractres que les utilisateurs peuvent entrer dans le champs est de {0}.",pasteMustEnterInterger:"Veuillez entrer un nombre entier dans la colonne {0}. (Valeur :{1}).",pasteMustEnterNumber:"Veuillez entrer les nombres dans la colonne {0}.. (Valeur: {1})",pasteMaxChars:"Le nombre maximum de caractres pouvant tre entrs dans la colonne {0} est de {1} caractre. (Valeur: {2})",errorSortModeAddItem:"En mode tri, vous ne pourrez pas ajouter de ligne.",errorFilterModeAddItem:"En mode filtre vous ne pourrez pas ajouter de ligne."}},"de-DE":{koolgridweb:{invalidJSON:"Ungltige Daten in JSON Format. Verweisen wir auf die Daten. Fehler.",invalidXML:"Ungltige Daten in XML Format. Verweisen wir auf die Daten. Fehler.",invalidCSV:"Ungltige Daten in CSV Format. Verweisen wir auf die Daten. Fehler.",invalidTSV:"Ungltige Daten in TSV Format. Verweisen wir auf die Daten. Fehler.",invalidLayoutXML:"Der XML Layout ist misgebildet. Bitte prfen Sie der XML.",unknownObject:"Unbekannt Objekt:{0} wurde definiert.",unknownVariable:"Unbekannt Variable:{0} wurde definiert.",unknownProperty:"Unbekannt Eigenschaft:{0} wurde definiert.",errorSetProperty:"Eine Felher trat in der Eigenschaftseinstellungen :{0}. Fehler:",errorSetBoolean:"Der Eigenschaft Wert {0} musst Richtig oder Falsch sein.",notExportObject:"Diese erzeugte DataGrid untersttzt nicht diese Funktion.",makeExcelError:"Ein Fehler trat bei der Herstellung der Datei. Fehler:{0}",saveExcelError:"Ein Fehler trat whrend bei der Speichern der Datei. Fehler:{0}",uploadExcelError:"Ein Fehler trat bei dem Hochladens der Datei. Fehler:{0}",alertTitleExport:"Exportieren",errorUpdateData:"Ein Fehler trat bei der Modifizierung der Daten.",errorDeleteData:"Ein Fehler trat bei der Lschung der Daten.",errorConvertData:"Ein Fehler trat bei der Umwandlung der Daten.",selectDeleteRow:"Bitte whlen Sie die Datenstze, die gelscht werden.",enterSearchString:"Bitte geben Sie eine gesuchte Zeichenfolge ein.",needInput:"Eine Eingabe  ist erforderlich.",mustEnterInterger:"Bitte geben Sie eine ganze Zahl.",mustEnterNumber:"Bitte geben Sie ein Zahl.",maxChars:"Das Zeichen die Benutzereingabe in den Feldern maximal umfassen darf, ist {0} Zeichen.",pasteMustEnterInterger:"Bitte geben Sie eine ganze Zahl in der Spalte {0}. (Wert: {1}).",pasteMustEnterNumber:"Bitte geben Sie die Anzahl in der Spalte {0}. (Wert: {1}).",pasteMaxChars:"Die Hchstzahl der Zeichen Sie geben knnen in der Spalte {0} ist {1} Zeichen. (Wert : {2})",errorSortModeAddItem:"Im Sortmodus Sie knnen nicht ein Datensatz fgen.",errorFilterModeAddItem:"Im Filtermodus Sie knnen nicht ein Datensatz fgen."}},"zh-CN":{koolgridweb:{invalidJSON:"JSON:",invalidXML:"XML:",invalidCSV:"CSV:",invalidTSV:"TSV:",invalidLayoutXML:"XMLXML",unknownObject:"{0}",unknownVariable:"{0}",unknownProperty:"{0}",errorSetProperty:"{0}:",errorSetBoolean:"{0}",notExportObject:"DataGrid",makeExcelError:"{0}",saveExcelError:"{0}",uploadExcelError:"{0}",alertTitleExport:"Export",errorUpdateData:"",errorDeleteData:"",errorConvertData:"",selectDeleteRow:"",enterSearchString:"",needInput:"",mustEnterInterger:"",mustEnterNumber:"",maxChars:"{0}",pasteMustEnterInterger:"{0}{1}",pasteMustEnterNumber:"{0}{1}",pasteMaxChars:"{0}{1} {2}",errorSortModeAddItem:"",errorFilterModeAddItem:""}}},B.addResourceBundle("koolgridweb",D.resources["ko-KR"].koolgridweb,"ko-KR"),B.addResourceBundle("koolgridweb",D.resources["en-US"].koolgridweb,"en-US"),B.addResourceBundle("koolgridweb",D.resources["fr-FR"].koolgridweb,"fr-FR"),B.addResourceBundle("koolgridweb",D.resources["de-DE"].koolgridweb,"de-DE"),B.addResourceBundle("koolgridweb",D.resources["zh-CN"].koolgridweb,"zh-CN")}();